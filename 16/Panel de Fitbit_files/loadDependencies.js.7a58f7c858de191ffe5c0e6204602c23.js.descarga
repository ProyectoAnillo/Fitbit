!function(e){function t(a){if(i[a])return i[a].exports;var n=i[a]={exports:{},id:a,loaded:!1};return e[a].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){e.exports=i(1)},function(e,t,i){(function(){define("hbs!galileo/tile/template/activeMinutesModalContents",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/chart","galileo/tile/template/helpers/i18n","hbs!galileo/tile/template/chartLegend"],function(e){var t=e.template(function(e,t,i,a,n){function s(e,t){var n,s,l,o="";return o+='\n<div class="goalContainer"></div>\n<div class="chart">\n    <div class="graphHeader">\n        <h3 class="graphTitle js_graphTitle">',l={hash:{}},n=i.i18n,s=n?n.call(e,"title_past_month",l):h.call(e,"i18n","title_past_month",l),(s||0===s)&&(o+=s),o+='</h3>\n    </div>\n    <div class="chartContainer"></div>\n    <div class="legendContainer">\n    	',s=c.invokePartial(a.galileo_tile_template_chartLegend,"galileo_tile_template_chartLegend",e,i,a),(s||0===s)&&(o+=s),o+="\n  	</div>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||e.partials;var l,o,r,h=i.helperMissing,c=this;return r={hash:{},inverse:c.noop,fn:c.program(1,s,n)},l=i["i18n-namespace"],o=l?l.call(t,"com.fitbit.app.ngd.chart",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.chart",r),o||0===o?o:""});return e.registerPartial("galileo_tile_template_activeMinutesModalContents",t),t}),define("galileo/tile/modal/activeMinutes",["require","mootools","jquery","../classes/modal","hbs!../template/activeMinutesModalContents","hbs!galileo/tile/template/help/activeMinutes","hbs!../template/chartLegend","i18n/i18n","i18n-load!com/fitbit/app/ngd/chart","i18n-load!com/fitbit/app/unit","i18n-load!com/fitbit/app/ngd/activeminutes"],function(e){e("mootools"),e("jquery");var t=e("../classes/modal"),i=e("hbs!../template/activeMinutesModalContents"),a=e("hbs!galileo/tile/template/help/activeMinutes"),n=(e("hbs!../template/chartLegend"),e("i18n/i18n")());n.namespace(e("i18n-load!com/fitbit/app/ngd/chart")),n.namespace(e("i18n-load!com/fitbit/app/unit")),n.namespace(e("i18n-load!com/fitbit/app/ngd/activeminutes"));var s=[{"class":"very_active",name:n("legend_very_active")},{"class":"fairly_active",name:n("legend_fairly_active")}];return new Class({Extends:t,title:n("activeminutes"),tileName:"activeMinutes",options:{tileClass:"activeMinutes",legendList:s,metricFormats:{weeklyTotal:[{unitPlural:n.plural("minute_reduced"),unitThreshold:1/0,format:"#,##0"}]}},load:function(){var t=this,i=this.getDate();e(["galileo/model/user","galileo/tile/element/goal/modal","galileo/model/goals","popup"],function(e,n,s,l){var o=e.viewer.activities().loadSummary.bind(this,"active-minutes",i),r=new l({className:"tiles-tooltip"});Function.join(o,function(e){var i=t.modal,s=t.body.find(".goalContainer"),l=new n(s,{metricFormats:t.options.metricFormats});l.render(e),i.overlay.on("click",l.stopProgressAnimation.bind(l)),t.body.find(".afterTitle").after('<span class="tileInfo">?</span>'),t.body.on("mouseover",".tileInfo",function(e){var t=$(e.target);t[0]&&"mouseover"===e.type&&r.showHTML(a,t)}),t.loadChart(),i.position()})})},renderTileTpl:function(e){return e.contents=i({legendList:this.options.legendList}),this.parent(e)},loadChart:function(){var t=this,i=t.body.find(".chartContainer"),a=t.modal;e(["galileo/graph/activeMinutes"],function(e){i.empty().append(e("active-minutes",i.width(),i.height())),a.position()})}})}),define("galileo/tile/modal/calories",["require","mootools","jquery","../classes/largeBasic","hbs!../template/stepsModalContents","hbs!../template/chartLegend","i18n/i18n","i18n-load!com/fitbit/app/ngd/calories","i18n-load!com/fitbit/app/ngd/chart","i18n-load!com/fitbit/app/unit"],function(e){e("mootools"),e("jquery");var t=e("../classes/largeBasic"),i=e("hbs!../template/stepsModalContents"),a=e("hbs!../template/chartLegend"),n=e("i18n/i18n")();return n.namespace(e("i18n-load!com/fitbit/app/ngd/calories")),n.namespace(e("i18n-load!com/fitbit/app/ngd/chart")),n.namespace(e("i18n-load!com/fitbit/app/unit")),new Class({Extends:t,title:n("calories_burned"),tileName:"calories",tileType:"calories-burned",options:{tileClass:"calories-burned",legendList:{"default":[{"class":"goal_met",name:n("legend_goal_met")}]},metricFormats:{weeklyTotal:[{unitPlural:n.plural("calorie"),unitThreshold:1/0,format:"#,##0"}],tooltipFormat:[{unitPlural:n.plural("calorie_reduced"),unitThreshold:1/0,format:"#,##0"}]}},renderTileTpl:function(e){return e.contents=i({}),this.parent(e)},loadChart:function(){var t=this,i=t.options.legendList,s=t.body.find(".chartContainer"),l=t.modal,o=this.getDate(),r=2,h=0,c=!0,d=30;e(["galileo/graph/caloriesBurnVsIntake"],function(e){var u=e(s.width(),s.height(),o,function(e,l){s.after($(a({legendList:i["default"]}))),t.body.find(".js_graphTitle").text(n("title_past_2_weeks"))},!1,t.options.metricFormats.tooltipFormat,void 0,{leftPadding:r,rightPadding:h,showGraphWeekLabels:c,yAxisLeftMargin:d});s.empty().append(u),l.position()})}})}),define("galileo/tile/modal/distance",["require","mootools","jquery","../classes/largeBasic","i18n/i18n","galileo/model/user","i18n-load!com/fitbit/app/ngd/distance","i18n-load!com/fitbit/app/ngd/chart","i18n-load!com/fitbit/app/unit"],function(e){e("mootools"),e("jquery");var t=e("../classes/largeBasic"),i=e("i18n/i18n")(),a=e("galileo/model/user");i.namespace(e("i18n-load!com/fitbit/app/ngd/distance")),i.namespace(e("i18n-load!com/fitbit/app/ngd/chart")),i.namespace(e("i18n-load!com/fitbit/app/unit"));var n=i.plural("US"==a.viewer.heightSystem?"mile":"kilometer"),s=i("distance");return"ko_KR"==a.viewer.locale&&(s+=" / "+n(1)),new Class({Extends:t,title:s,tileName:"distance",tileType:"distance",precision:1,options:{metricFormats:{weeklyTotal:[{unitPlural:n,unitThreshold:1/0,format:"#,##0.00"}],tooltipFormat:[{unitPlural:n,unitThreshold:1/0,format:"#,##0.00"}]},tileClass:"distance",legendList:[{"class":"goal_met",name:i("legend_goal_met")}]}})}),define("galileo/tile/modal/floors",["require","mootools","jquery","../classes/largeBasic","i18n/i18n","galileo/model/user","i18n-load!com/fitbit/app/ngd/floors","i18n-load!com/fitbit/app/ngd/chart","i18n-load!com/fitbit/app/unit"],function(e){e("mootools"),e("jquery");var t=e("../classes/largeBasic"),i=e("i18n/i18n")();e("galileo/model/user");return i.namespace(e("i18n-load!com/fitbit/app/ngd/floors")),i.namespace(e("i18n-load!com/fitbit/app/ngd/chart")),i.namespace(e("i18n-load!com/fitbit/app/unit")),new Class({Extends:t,title:i("floors"),tileName:"floors",tileType:"floors",options:{tileClass:"floors",legendList:[{"class":"goal_met",name:i("legend_goal_met")}],metricFormats:{weeklyTotal:[{unitPlural:i.plural("floor"),unitThreshold:1/0,format:"#,##0"}],tooltipFormat:[{unitPlural:i.plural("floor"),unitThreshold:1/0,format:"#,##0"}]}}})}),define("galileo/graph/sleep",["require","mootools","galileo/prototype/all","galileo/model/sleep","./tooltip","galileo/builder/text","highcharts","galileo/model/user","galileo/util/dateUtil","galileo/builder/util","galileo/builder/util","i18n/i18n","i18n-load!com/fitbit/app/ngd/sleep","i18n-load!com/fitbit/util/dateutil","galileo/color/graph"],function(e){function t(e,t,a,s,l,o,h,c){var d=40,g=t-2*d;e.rect(d,a/2-2,g,2,2).attr("fill",p.line).add();var f=[],m=[];if(l.entries.filter(function(e){return e.date==r.ajaxEncode(s)||e.date==r.ajaxEncode(r.minusDays(s,1))}).map(function(t){function i(e,t){return e=e.limit(0,1440),t=t.limit(0,1440),e==t?null:[e*g/1440+d,(t-e)*g/1440]}var n=t.endTime.split(":");n=60*Number(n[0])+Number(n[1]);var l=n+(t.date==r.ajaxEncode(s)?720:-720),o=l-Number(t.sleepDuration),h=i(o,l);h&&(f.push({left:h[0],right:h[0]+h[1],entry:t}),e.rect(h[0],0,h[1],a,a/2).attr("fill",{linearGradient:{x1:0,x2:1,y1:0,y1:0},stops:[[0,p.asleep.startGradient],[1,p.asleep.endGradient]]}).add(),t.breaks.map(function(t){if(!(t.magnitude<2)){var n=t.startTime.split(":");n=60*Number(n[0])+Number(n[1]),n-=720,o>n&&(n+=1440);var s=i(n,n+Number(t.duration));if(s){var l,r=p.restless.legend,c=p.awake.legend;l=t.magnitude>=3?c:r,e.rect(h[0],0,h[1],a,a/3).attr("fill",l).clip(e.clipRect(s[0],0,Math.max(s[1],1),a)).add()}}}),t.clusters.map(function(e){var t=i(e.start,e.end);t&&m.push({left:t[0],right:t[0]+t[1],"break":e})}))}),o){var v=u[r.minusDays(s,1).getDay()],y=u[s.getDay()],b={color:p.clock.text[0],fontSize:"12px",fontFamily:"Proxima Nova Regular"};e.text(v.toUpperCase(),5,a-4).css(b).add(),e.text(y.toUpperCase(),t-30,a-4).css(b).add()}h&&(f=f.concat(m));var w=null,_=null;c.on("mousemove",function(e){for(var t=e.pageX-c.offset().left,a=null,s=0;s<f.length;s++)f[s].left<=t&&t<=f[s].right&&(a=s);a!==w&&(w=a,_&&_.remove(),_=null===a?null:n(c.offset().left+(2*f[w].left+f[w].right)/3,c.offset().top+5,i(f[w])))}),c.on("mouseleave",function(){w=null,_&&_.remove(),_=null})}function i(e){var t,i,n,l,u,p,g=d("hour").charAt(0).toLowerCase(),f=d("minute").charAt(0).toLowerCase();return e.hasOwnProperty("entry")?(t=e.entry,i=Math.floor(t.minAsleep/60),n=t.minAsleep%60,l=a.timesAwake(t),$("<div>").css({paddingLeft:35,background:"transparent url(/images/dashboard/galileo/sleep/moonSun.png) no-repeat left 35px"}).append($("<span>").css("display","inline-block").css("vertical-align","top").append(s("uppercase 12px/30px #AEAEAE",r.localeFormat(new Date(t.dateInForJavascriptLocalFormatting),"MMM dd")),$("<br>"),s("12px/30px #AEAEAE",o.formatTime(r.forTime(t.startTime))),$("<br>"),s("12px/30px #AEAEAE",o.formatTime(r.forTime(t.endTime)))),c(20),h(1,90,"#AEAEAE"),c(20),$("<span>").css("display","inline-block").css("vertical-align","top").append(s("26px/30px #585858"," "+i+g+" "+n+f),s("14px/30px #3C3C3C"," "+d("asleep")),$("<br>"),s("14px/30px #3C3C3C",l.minsAwake),s("14px/30px #3C3C3C"," "+d("mins_awake")),s("14px/30px #AEAEAE"," ("+l.awake+d("suffix_x")+")"),$("<br>"),s("14px/30px #3C3C3C",l.minsRestless),s("14px/30px #3C3C3C"," "+d("mins_restless")),s("14px/30px #AEAEAE"," ("+l.restless+d("suffix_x")+")")).css("marginLeft",18))):(u=e["break"],p=r.minusDays(r.forTime("12:00"),1),$("<div>").append($("<span>").css("display","inline-block").css("vertical-align","top").append($("<br>"),s("12px/20px #3C3C3C",o.formatTime(r.plusMinutes(p,u.start))),$("<br>"),s("12px/20px #3C3C3C",o.formatTime(r.plusMinutes(p,u.end)))),c(20),h(1,60,"#AEAEAE"),c(20),$("<span>").css("display","inline-block").css("vertical-align","top").append(s("26px/30px #585858",u.end-u.start+" "+d("mins")),$("<br>"),"awake"==u.level?s("14px/26px #3C3C3C",d("awake")):s("14px/26px #3C3C3C",d("restless")))))}e("mootools"),e("galileo/prototype/all");var a=e("galileo/model/sleep"),n=e("./tooltip"),s=e("galileo/builder/text"),l=e("highcharts"),o=e("galileo/model/user").viewer,r=e("galileo/util/dateUtil"),h=e("galileo/builder/util").vline,c=e("galileo/builder/util").hspace,d=e("i18n/i18n")();d.namespace(e("i18n-load!com/fitbit/app/ngd/sleep")),d.namespace(e("i18n-load!com/fitbit/util/dateutil"));var u=r.getShortWeekdayNames(),p=e("galileo/color/graph").sleep;return function(e,i,n,s,o,h){h=h||new Date;var c=$("<div>"),d=new l.Renderer(c[0],e,i);return a.loadDays(r.minusDays(h,7),h,function(a){t(d,e,i,n,a,s,o,c)}),c}}),define("hbs!galileo/tile/template/sleepModal",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/unit","i18n-load!com/fitbit/app/ngd/sleep","galileo/tile/template/helpers/i18n","galileo/tile/template/helpers/domPlaceholder"],function(e){var t=e.template(function(e,t,i,a,n){function s(e,t){var a,n,s,l="";return l+='\n<div class = "goal">\n    <span class="metric asleep">\n        <span class="subtitle">',s={hash:{}},a=i.i18n,n=a?a.call(e,"last_night",s):c.call(e,"i18n","last_night",s),(n||0===n)&&(l+=n),l+='</span><br/>\n        <span class="number">',(n=i.hoursToday)?n=n.call(e,{hash:{}}):(n=e.hoursToday,n=typeof n===d?n.apply(e):n),l+=u(n)+'</span>\n        <span class="unit">',(n=i.hoursTodayUnit)?n=n.call(e,{hash:{}}):(n=e.hoursTodayUnit,n=typeof n===d?n.apply(e):n),l+=u(n)+' </span>\n        <span class="number">',(n=i.minutesToday)?n=n.call(e,{hash:{}}):(n=e.minutesToday,n=typeof n===d?n.apply(e):n),l+=u(n)+'</span>\n        <span class="unit">',(n=i.minutesTodayUnit)?n=n.call(e,{hash:{}}):(n=e.minutesTodayUnit,n=typeof n===d?n.apply(e):n),l+=u(n)+'</span>\n\n    </span>\n    <span class = "metric awake">\n        <span class="subtitle">',s={hash:{}},a=i.i18n,n=a?a.call(e,"awake",s):c.call(e,"i18n","awake",s),(n||0===n)&&(l+=n),l+='</span><br/>\n        <span class="number">'+u((a=e.timesAwake,a=null==a||a===!1?a:a.minsAwake,typeof a===d?a.apply(e):a))+'</span>\n        <span class="unit">'+u((a=e.timesAwake,a=null==a||a===!1?a:a.minsAwakeUnit,typeof a===d?a.apply(e):a))+" ("+u((a=e.timesAwake,a=null==a||a===!1?a:a.awake,typeof a===d?a.apply(e):a)),s={hash:{}},a=i.i18n,n=a?a.call(e,"suffix_x",s):c.call(e,"i18n","suffix_x",s),(n||0===n)&&(l+=n),l+=')</span>\n    </span>\n    <span class = "metric restless">\n        <span class="subtitle">',s={hash:{}},a=i.i18n,n=a?a.call(e,"restless",s):c.call(e,"i18n","restless",s),(n||0===n)&&(l+=n),l+='<span class="tileInfo">?</span></span><br/>\n        <span class="number">'+u((a=e.timesAwake,a=null==a||a===!1?a:a.minsRestless,typeof a===d?a.apply(e):a))+'</span>\n        <span class="unit">'+u((a=e.timesAwake,a=null==a||a===!1?a:a.minsRestlessUnit,typeof a===d?a.apply(e):a))+" ("+u((a=e.timesAwake,a=null==a||a===!1?a:a.restless,typeof a===d?a.apply(e):a)),s={hash:{}},a=i.i18n,n=a?a.call(e,"suffix_x",s):c.call(e,"i18n","suffix_x",s),(n||0===n)&&(l+=n),l+=')</span>\n    </span>\n\n\n    <div class="sleepchartToday">\n        ',s={hash:{}},l+=u((a=i.domPlaceholder,a?a.call(e,"sleepChartToday",s):c.call(e,"domPlaceholder","sleepChartToday",s)))+"\n    </div>\n\n    ",s={hash:{}},l+=u((a=i.domPlaceholder,a?a.call(e,"timeline1",s):c.call(e,"domPlaceholder","timeline1",s)))+'\n\n</div>\n<div class="pastSeven">\n    <span class="subtitle">',s={hash:{}},a=i.i18n,n=a?a.call(e,"past_seven_days",s):c.call(e,"i18n","past_seven_days",s),(n||0===n)&&(l+=n),l+='</span>\n\n    <div>\n        <div class="sleepchart">\n            ',s={hash:{}},l+=u((a=i.domPlaceholder,a?a.call(e,"sleepchart1",s):c.call(e,"domPlaceholder","sleepchart1",s)))+'\n        </div>\n        <div class="sleepchart">\n            ',s={hash:{}},l+=u((a=i.domPlaceholder,a?a.call(e,"sleepchart2",s):c.call(e,"domPlaceholder","sleepchart2",s)))+'\n        </div>\n        <div class="sleepchart">\n            ',s={hash:{}},l+=u((a=i.domPlaceholder,a?a.call(e,"sleepchart3",s):c.call(e,"domPlaceholder","sleepchart3",s)))+'\n        </div>\n        <div class="sleepchart">\n            ',s={hash:{}},l+=u((a=i.domPlaceholder,a?a.call(e,"sleepchart4",s):c.call(e,"domPlaceholder","sleepchart4",s)))+'\n        </div>\n        <div class="sleepchart">\n            ',s={hash:{}},l+=u((a=i.domPlaceholder,a?a.call(e,"sleepchart5",s):c.call(e,"domPlaceholder","sleepchart5",s)))+'\n        </div>\n        <div class="sleepchart">\n            ',s={hash:{}},l+=u((a=i.domPlaceholder,a?a.call(e,"sleepchart6",s):c.call(e,"domPlaceholder","sleepchart6",s)))+'\n        </div>\n        <div class="sleepchart">\n            ',s={hash:{}},l+=u((a=i.domPlaceholder,a?a.call(e,"sleepchart7",s):c.call(e,"domPlaceholder","sleepchart7",s)))+"\n        </div>\n    </div>\n\n\n    ",s={hash:{}},l+=u((a=i.domPlaceholder,a?a.call(e,"timeline2",s):c.call(e,"domPlaceholder","timeline2",s)))+'\n\n    <div class="legend">\n        <span class="sleep indicator"></span>\n        <span class="label" >',s={hash:{}},a=i.i18n,n=a?a.call(e,"sleep",s):c.call(e,"i18n","sleep",s),(n||0===n)&&(l+=n),l+='</span>\n        <span class="restless indicator"></span>\n        <span class="label" >',s={hash:{}},a=i.i18n,n=a?a.call(e,"restless",s):c.call(e,"i18n","restless",s),(n||0===n)&&(l+=n),l+='</span>\n        <span class="awake indicator"></span>\n        <span class="label"  >',s={hash:{}},a=i.i18n,n=a?a.call(e,"awake",s):c.call(e,"i18n","awake",s),(n||0===n)&&(l+=n),l+="</span>\n     </div>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var l,o,r,h="",c=i.helperMissing,d="function",u=this.escapeExpression,p=this;return r={hash:{},inverse:p.noop,fn:p.program(1,s,n)},l=i["i18n-namespace"],o=l?l.call(t,"com.fitbit.app.unit","com.fitbit.app.ngd.sleep",r):c.call(t,"i18n-namespace","com.fitbit.app.unit","com.fitbit.app.ngd.sleep",r),(o||0===o)&&(h+=o),h+="\n"});return e.registerPartial("galileo_tile_template_sleepModal",t),t}),define("hbs!galileo/tile/template/sleepModalTimeline",["handlebars"],function(e){var t=e.template(function(e,t,i,a,n){function s(e,t){var a,n="";return n+='\n        <span class="hour h',(a=i.index)?a=a.call(e,{hash:{}}):(a=e.index,a=typeof a===r?a.apply(e):a),n+=h(a)+'">',(a=i.label)?a=a.call(e,{hash:{}}):(a=e.label,a=typeof a===r?a.apply(e):a),n+=h(a)+"</span>\n    "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var l,o="",r="function",h=this.escapeExpression,c=this;return o+='<div class = "timeline">\n    ',l=i.each.call(t,t.hours,{hash:{},inverse:c.noop,fn:c.program(1,s,n)}),(l||0===l)&&(o+=l),o+="\n</div>\n"});return e.registerPartial("galileo_tile_template_sleepModalTimeline",t),t}),define("galileo/tile/modal/sleep",["require","mootools","jquery","shared/scripts/modal","../classes/modal","i18n/i18n","galileo/graph/sleep","galileo/model/sleep","galileo/builder/text","galileo/model/user","galileo/util/dateUtil","galileo/tile/template/helpers/domPlaceholder","hbs!./../template/sleepModal","hbs!./../template/sleepModalTimeline","i18n-load!com/fitbit/app/ngd/sleep","i18n-load!com/fitbit/util/dateutil","i18n-load!com/fitbit/app/unit"],function(e){function t(){var e={hours:[]};return[0,1,2,3,4,5,6,7,8,9,10,11,12].map(function(t){var i,a=2*t;if(l.clock12)i=""+(a>12?a-12:a),a%12===0&&(i=o.localeFormat(new Date(0,0,0,a-12,0,0),"hha"));else{var n=(12+a)%24;i=n>9?""+n:"0"+n}e.hours.push({index:t,label:i})}),c(e)}e("mootools"),e("jquery");var i=(e("shared/scripts/modal"),e("../classes/modal")),a=e("i18n/i18n")(),n=e("galileo/graph/sleep"),s=e("galileo/model/sleep"),l=(e("galileo/builder/text"),e("galileo/model/user").viewer),o=e("galileo/util/dateUtil"),r=e("galileo/tile/template/helpers/domPlaceholder"),h=e("hbs!./../template/sleepModal"),c=e("hbs!./../template/sleepModalTimeline");a.namespace(e("i18n-load!com/fitbit/app/ngd/sleep")),a.namespace(e("i18n-load!com/fitbit/util/dateutil")),a.namespace(e("i18n-load!com/fitbit/app/unit"));var d=a.plural("minute_reduced"),u=a.plural("hour_reduced");return new Class({Extends:i,title:a("sleep"),tileName:"sleep",options:{tileClass:"sleep"},load:function(){var e=this.getDate();s.loadDays(o.minusDays(e,7),e,function(i){var a,c=this.body,p=this.body.width(),g={},f=o.ajaxEncode(new Date),m=i.entries.filter(function(e){return f===e.date}).sortBy(function(e){return o.ajaxDecode(e.startDateTime).getTime()}),v=0,y={awake:0,minsAwake:0,restless:0,minsRestless:0},b=0,w=0;c.parent().closest(".content").addClass("sleepModal"),m.length&&(b=l.formatTime(o.forTime(m[0].startTime)),w=l.formatTime(o.forTime(m[m.length-1].endTime))),m.forEach(function(e){v+=e.minAsleep,a=s.timesAwake(e),y.awake+=a.awake,y.minsAwake+=a.minsAwake,y.restless+=a.restless,y.minsRestless+=a.minsRestless}),g.hoursToday=Math.floor(v/60),g.minutesToday=v%60,g.timesAwake=y,g.sleepStart=b,g.sleepEnd=w,g.hoursTodayUnit=u(g.hoursToday),g.minutesTodayUnit=d(g.minutesToday),g.timesAwake.minsAwakeUnit=d(g.timesAwake.minsAwake),g.timesAwake.minsRestlessUnit=d(g.timesAwake.minsRestless),g.sleepChartToday=n(p,18,e,!0,!0);for(var _=1;7>_;_++)g["sleepchart"+_]=n(p,18,o.minusDays(e,_),!0,!1);g.timeline1=t(25,p-74),g.timeline2=t(25,p-74),c.append(r(h,g)),this.modal.position()}.bind(this))}})}),define("galileo/tile/modal/steps",["require","mootools","jquery","../classes/largeBasic","i18n/i18n","galileo/model/user","i18n-load!com/fitbit/app/ngd/steps","i18n-load!com/fitbit/app/ngd/chart","i18n-load!com/fitbit/app/unit"],function(e){e("mootools"),e("jquery");var t=e("../classes/largeBasic"),i=e("i18n/i18n")();e("galileo/model/user");return i.namespace(e("i18n-load!com/fitbit/app/ngd/steps")),i.namespace(e("i18n-load!com/fitbit/app/ngd/chart")),i.namespace(e("i18n-load!com/fitbit/app/unit")),new Class({Extends:t,title:i("steps"),tileName:"steps",tileType:"steps",tileSteps:"steps",options:{tileClass:"steps",legendList:[{"class":"goal_met",name:i("legend_goal_met")}],metricFormats:{weeklyTotal:[{unitPlural:i.plural("step"),unitThreshold:1/0,format:"#,##0"}],tooltipFormat:[{unitPlural:i.plural("step"),unitThreshold:1/0,format:"#,##0"}]}}})}),define("hbs!galileo/tile/template/weightModalContents",["handlebars"],function(e){var t=e.template(function(e,t,i,a,n){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="goalContainer"></div>\n<div class="chartSection"></div>\n'});return e.registerPartial("galileo_tile_template_weightModalContents",t),t}),define("hbs!galileo/tile/template/weightBMIInfo",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/weight","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,a,n){function s(e,t){var a,n,s,h="";return h+='\n<h3 class="subHeading">',s={hash:{}},a=i.i18n,n=a?a.call(e,"recent",s):g.call(e,"i18n","recent",s),(n||0===n)&&(h+=n),h+='</h3>\n\n<div class="weightBMIContainer">\n    <ul class="metrics">\n        <li class="metric weight">\n            <span class="value">',(n=i.weightValue)?n=n.call(e,{hash:{}}):(n=e.weightValue,n=typeof n===u?n.apply(e):n),h+=p(n)+'</span>\n            <span class="unit">',(n=i.weightUnit)?n=n.call(e,{hash:{}}):(n=e.weightUnit,n=typeof n===u?n.apply(e):n),h+=p(n)+"</span>\n            ",n=i["if"].call(e,e.subUnits,{hash:{},inverse:f.noop,fn:f.program(2,l,t)}),(n||0===n)&&(h+=n),h+="\n        </li>\n        ",n=i["if"].call(e,e.fatValue,{hash:{},inverse:f.noop,fn:f.program(4,o,t)}),(n||0===n)&&(h+=n),h+='\n        <li class="metric bmi">\n            <div class="container">\n                <span class="label">',s={hash:{}},a=i.i18n,n=a?a.call(e,"bmi",s):g.call(e,"i18n","bmi",s),(n||0===n)&&(h+=n),h+='</span>\n                <span class="value">',(n=i.bmiValue)?n=n.call(e,{hash:{}}):(n=e.bmiValue,n=typeof n===u?n.apply(e):n),h+=p(n)+'</span>\n\n                <ul class="zones">\n                    <li class="zone">\n                        <input id="under-zone" type="radio" name="zone" value="under" disabled',n=i["if"].call(e,e.underZone,{hash:{},inverse:f.noop,fn:f.program(6,r,t)}),(n||0===n)&&(h+=n),h+='>\n                        <label for="under-zone" title="',s={hash:{}},a=i.i18n,n=a?a.call(e,"title_under",s):g.call(e,"i18n","title_under",s),(n||0===n)&&(h+=n),h+=': 0-18.5">\n                            ',s={hash:{}},a=i.i18n,n=a?a.call(e,"title_under",s):g.call(e,"i18n","title_under",s),(n||0===n)&&(h+=n),h+='\n                        </label>\n                    </li>\n                    <li class="zone">\n                        <input id="normal-zone" type="radio" name="zone" value="normal" disabled',n=i["if"].call(e,e.normalZone,{hash:{},inverse:f.noop,fn:f.program(6,r,t)}),(n||0===n)&&(h+=n),h+='>\n                        <label for="normal-zone" title="',s={hash:{}},a=i.i18n,n=a?a.call(e,"title_normal",s):g.call(e,"i18n","title_normal",s),(n||0===n)&&(h+=n),h+=': 18.5-25">\n                            ',s={hash:{}},a=i.i18n,n=a?a.call(e,"title_normal",s):g.call(e,"i18n","title_normal",s),(n||0===n)&&(h+=n),h+='\n                        </label>\n                    </li>\n                    <li class="zone">\n                        <input id="over-zone" type="radio" name="zone" value="over" disabled',n=i["if"].call(e,e.overZone,{hash:{},inverse:f.noop,fn:f.program(6,r,t)}),(n||0===n)&&(h+=n),h+='>\n                        <label for="over-zone" title="',s={hash:{}},a=i.i18n,n=a?a.call(e,"title_over",s):g.call(e,"i18n","title_over",s),(n||0===n)&&(h+=n),h+=': 25-30">\n                            ',s={hash:{}},a=i.i18n,n=a?a.call(e,"title_over",s):g.call(e,"i18n","title_over",s),(n||0===n)&&(h+=n),h+='\n                        </label>\n                    </li>\n                    <li class="zone last">\n                        <input id="obese-zone" type="radio" name="zone" value="obese" disabled',n=i["if"].call(e,e.obeseZone,{hash:{},inverse:f.noop,fn:f.program(6,r,t)}),(n||0===n)&&(h+=n),h+='>\n                        <label for="obese-zone" title="',s={hash:{}},a=i.i18n,n=a?a.call(e,"title_obese",s):g.call(e,"i18n","title_obese",s),(n||0===n)&&(h+=n),h+=': 30+">\n                            ',s={hash:{}},a=i.i18n,n=a?a.call(e,"title_obese",s):g.call(e,"i18n","title_obese",s),(n||0===n)&&(h+=n),h+="\n                        </label>\n                    </li>\n                </ul>\n            </div>\n        </li>\n    </ul>\n</div>\n"}function l(e,t){var a,n="";return n+='\n                <span class="value">',(a=i.weightSubValue)?a=a.call(e,{hash:{}}):(a=e.weightSubValue,a=typeof a===u?a.apply(e):a),n+=p(a)+'</span>\n                <span class="unit">',(a=i.weightSubUnit)?a=a.call(e,{hash:{}}):(a=e.weightSubUnit,a=typeof a===u?a.apply(e):a),n+=p(a)+"</span>\n            "}function o(e,t){var a,n,s,l="";return l+='\n        <li class="metric fat">\n            <span class="value">',(a=i.fatValue)?a=a.call(e,{hash:{}}):(a=e.fatValue,a=typeof a===u?a.apply(e):a),l+=p(a)+'</span>\n            <span class="unit">',s={hash:{}},a=i.i18n,n=a?a.call(e,"fat",s):g.call(e,"i18n","fat",s),(n||0===n)&&(l+=n),l+="</span>\n        </li>\n        "}function r(e,t){return" checked"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var h,c,d,u="function",p=this.escapeExpression,g=i.helperMissing,f=this;return d={hash:{},inverse:f.noop,fn:f.program(1,s,n)},h=i["i18n-namespace"],c=h?h.call(t,"com.fitbit.app.ngd.weight",d):g.call(t,"i18n-namespace","com.fitbit.app.ngd.weight",d),c||0===c?c:""});return e.registerPartial("galileo_tile_template_weightBMIInfo",t),t}),define("galileo/tile/modal/weight",["require","mootools","jquery","../classes/modal","hbs!../template/weightModalContents","i18n/i18n","hbs!../template/weightBMIInfo","galileo/model/user","galileo/tile/element/goal/modal","galileo/model/goals","galileo/widget/metric","galileo/util/weightUtil","underscore","i18n-load!com/fitbit/app/ngd/weight","i18n-load!com/fitbit/app/ngd/chart","i18n-load!com/fitbit/app/unit"],function(e){e("mootools"),e("jquery");var t=e("../classes/modal"),i=e("hbs!../template/weightModalContents"),a=e("i18n/i18n")(),n=e("hbs!../template/weightBMIInfo"),s=e("galileo/model/user"),l=(e("galileo/tile/element/goal/modal"),e("galileo/model/goals"),e("galileo/widget/metric")),o=e("galileo/util/weightUtil"),r=e("underscore");a.namespace(e("i18n-load!com/fitbit/app/ngd/weight")),a.namespace(e("i18n-load!com/fitbit/app/ngd/chart")),a.namespace(e("i18n-load!com/fitbit/app/unit"));var h=function(e){return{US:a.plural("pound_short")(2),UK:a.plural("stone_short")(2),METRIC:a.plural("kilogram_short")(2)}[e]};return new Class({Extends:t,title:a("weight_title"),tileName:"weight",afterTitle:"/ "+h(s.viewer.weightSystem),options:{tileClass:"weight",legendList:[{"class":"goal_line",name:a("weight_goal")}]},load:function(){var e=this,t=this.getDate(),i=s.viewer.activities(),a=i.loadWeightSummary.bind(i,t);Function.join(a,function(t){var i,a,h,c,d=e.modal,u=e.body.find(".goalContainer"),p=e.body.find(".weightBMIContainer"),g=o.getWeightFormat(t.unitType),f=new l(g,!1,!0);t.bodyCondition+"Zone";p.length&&p.remove(),f.update(t.currentWeight.units,t.currentWeight.subUnits),a=r.find(g,function(e){return"subUnit"===e.type}),h=f.getUnitValue(),c=f.getSubUnitValue(),i=$(n({weightValue:h.value,weightUnit:h.unit,weightSubValue:c?c.value:"",weightSubUnit:c?c.unit:"",subUnits:a?a:null,fatValue:"0.0"===t.bodyFat?"":t.bodyFat+"%",bmiValue:s.viewer.formatNumber(t.bmi,"#,###.0"),zoneKey:!0})),u.after(i),e.loadChart(),d.position()})},renderTileTpl:function(e){return e.contents=i({}),this.parent(e)},loadChart:function(){var t=this,i=t.body.find(".chartSection"),a=t.modal;e(["galileo/graph/weight"],function(e){i.empty().append(e(t.getDate())),a.position()})}})}),define("hbs!galileo/tile/template/calZoneModalContents",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/chart","i18n-load!com/fitbit/app/ngd/calzone","galileo/tile/template/helpers/i18n","hbs!galileo/tile/template/chartLegend"],function(e){var t=e.template(function(e,t,i,a,n){function s(e,t){var n,s,l,o="";return o+='\n<div class="goalContainer"></div>\n<div class="chart">\n    <div class="graphHeader">\n        <h3 class="graphTitle">',l={hash:{}},n=i.i18n,s=n?n.call(e,"title_past_2_weeks",l):c.call(e,"i18n","title_past_2_weeks",l),(s||0===s)&&(o+=s),o+='</h3>\n    </div>\n    <div class="chartContainer"></div>\n    ',s=d.invokePartial(a.galileo_tile_template_chartLegend,"galileo_tile_template_chartLegend",e,i,a),(s||0===s)&&(o+=s),o+="\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||e.partials;var l,o,r,h="",c=i.helperMissing,d=this;return r={hash:{},inverse:d.noop,fn:d.program(1,s,n)},l=i["i18n-namespace"],o=l?l.call(t,"com.fitbit.app.ngd.chart","com.fitbit.app.ngd.calzone",r):c.call(t,"i18n-namespace","com.fitbit.app.ngd.chart","com.fitbit.app.ngd.calzone",r),(o||0===o)&&(h+=o),h+="\n"});return e.registerPartial("galileo_tile_template_calZoneModalContents",t),t}),define("hbs!galileo/tile/template/calZoneModalGoal",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/goal","i18n-load!com/fitbit/app/ngd/calzone","galileo/tile/template/helpers/i18n","galileo/tile/template/helpers/domPlaceholder"],function(e){var t=e.template(function(e,t,i,a,n){function s(e,t){var a,n,s,o="";return o+="\n<h4>",s={hash:{}},a=i.i18n,n=a?a.call(e,"this_week_deficit",s):p.call(e,"i18n","this_week_deficit",s),(n||0===n)&&(o+=n),o+='</h4>\n<div class="goal">\n    <div class="weeklyDeficit">\n        ',s={hash:{}},o+=u((a=i.domPlaceholder,a?a.call(e,"deficit",s):p.call(e,"domPlaceholder","deficit",s)))+'\n    </div>\n    <ul class="daySummary">\n        ',n=i.each.call(e,e.day_results,{hash:{},inverse:g.noop,fn:g.program(2,l,t)}),(n||0===n)&&(o+=n),o+="\n    </ul>\n</div>\n"}function l(e,t){var a,n,s,l="";return l+="\n        ",s={hash:{},inverse:g.noop,fn:g.program(3,o,t)},a=i["i18n-namespace"],n=a?a.call(e,"com.fitbit.app.ngd.goal","com.fitbit.app.ngd.calzone",s):p.call(e,"i18n-namespace","com.fitbit.app.ngd.goal","com.fitbit.app.ngd.calzone",s),(n||0===n)&&(l+=n),l+="\n        "}function o(e,t){var a,n,s,l="";return l+='\n        <li class="statusIndicator ',(a=i.status)?a=a.call(e,{hash:{}}):(a=e.status,a=typeof a===d?a.apply(e):a),l+=u(a)+' ">\n            <div class="statusText">\n                <div class="day">\n                </div>\n                <div class="dayName">\n                    ',(a=i.day)?a=a.call(e,{hash:{}}):(a=e.day,a=typeof a===d?a.apply(e):a),l+=u(a)+'\n                </div>\n                <div class="status js_status">\n                    <div class="zoneUnder">\n                        ',s={hash:{}},a=i.i18n,n=a?a.call(e,"zone_under",s):p.call(e,"i18n","zone_under",s),(n||0===n)&&(l+=n),l+='\n                    </div>\n                    <div class="zoneIn">\n                        ',s={hash:{}},a=i.i18n,n=a?a.call(e,"zone_in",s):p.call(e,"i18n","zone_in",s),(n||0===n)&&(l+=n),l+='\n                    </div>\n                    <div class="zoneOver">\n                        ',s={hash:{}},a=i.i18n,n=a?a.call(e,"zone_over",s):p.call(e,"i18n","zone_over",s),(n||0===n)&&(l+=n),l+="\n                    </div>\n                </div>\n            </div>\n        </li>\n        "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,h,c,d="function",u=this.escapeExpression,p=i.helperMissing,g=this;return c={hash:{},inverse:g.noop,fn:g.program(1,s,n)},r=i["i18n-namespace"],h=r?r.call(t,"com.fitbit.app.ngd.goal","com.fitbit.app.ngd.calzone",c):p.call(t,"i18n-namespace","com.fitbit.app.ngd.goal","com.fitbit.app.ngd.calzone",c),
h||0===h?h:""});return e.registerPartial("galileo_tile_template_calZoneModalGoal",t),t}),define("hbs!galileo/graph/template/tooltipCalsInVsOut",["handlebars"],function(e){var t=e.template(function(e,t,i,a,n){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var s,l="",o="function",r=this.escapeExpression;return l+='<div class="graphTip">\n    <div class="date">\n        ',(s=i.date)?s=s.call(t,{hash:{}}):(s=t.date,s=typeof s===o?s.apply(t):s),l+=r(s)+'\n    </div>\n    <div class="details cals-out">\n        <span class="icon"></span>\n        ',(s=i.calsBurned)?s=s.call(t,{hash:{}}):(s=t.calsBurned,s=typeof s===o?s.apply(t):s),(s||0===s)&&(l+=s),l+='\n    </div>\n    <div class="details ',(s=i.calsClass)?s=s.call(t,{hash:{}}):(s=t.calsClass,s=typeof s===o?s.apply(t):s),l+=r(s)+'">\n        <span class="icon"></span>\n        ',(s=i.calsEaten)?s=s.call(t,{hash:{}}):(s=t.calsEaten,s=typeof s===o?s.apply(t):s),(s||0===s)&&(l+=s),l+='\n    </div>\n    <div class="details cals_diff">\n        <span class="icon"></span>\n        ',(s=i.calsDiff)?s=s.call(t,{hash:{}}):(s=t.calsDiff,s=typeof s===o?s.apply(t):s),(s||0===s)&&(l+=s),l+="\n     </div>\n</div>\n\n"});return e.registerPartial("galileo_graph_template_tooltipCalsInVsOut",t),t}),define("galileo/graph/configs/calories",["require","./activity","hbs!../template/tooltipCalsInVsOut","galileo/color/graph","galileo/model/calorieGoal"],function(e){var t=e("./activity"),i=e("hbs!../template/tooltipCalsInVsOut"),a=e("galileo/color/graph"),n=e("galileo/model/calorieGoal").goalStateHelper;return function(){return{getCalsClass:function(e,t){var i=n(e,t);return i>0?"cals-over":0>i?"cals-under":"cals-met"},getColumnGradient:function(e,i){var s=n(e.y,i);return"activity"===e.name?{linearGradient:t.chart_column_gradient,stops:a.columnGradients.gray}:s>0?{linearGradient:t.chart_column_gradient,stops:a.columnGradients.red}:0>s?{linearGradient:t.chart_column_gradient,stops:a.columnGradients.gold}:{linearGradient:t.chart_column_gradient,stops:a.columnGradients.lime}},colWidth:8,leftMargin:1,rightMargin:1,cutGoalLine:!0,tooltipTemplate:i}}}),define("galileo/tile/modal/calZone",["require","mootools","jquery","galileo/model/user","../classes/modal","hbs!../template/chartLegend","hbs!../template/calZoneModalContents","hbs!../template/calZoneModalGoal","galileo/tile/template/helpers/domPlaceholder","i18n/i18n","galileo/model/user","galileo/graph/caloriesBurnVsIntake","galileo/ajax/ajax","galileo/widget/metric","galileo/util/dateUtil","galileo/util/calZoneUtil","galileo/graph/configs/calories","galileo/model/calorieGoal","i18n-load!com/fitbit/app/ngd/calzone","i18n-load!com/fitbit/app/ngd/chart","i18n-load!com/fitbit/app/ngd/sleep","i18n-load!core/com/fitbit/util/dateformat","i18n-load!com/fitbit/app/unit"],function(e){e("mootools"),e("jquery");var t=e("galileo/model/user").viewer,i=e("../classes/modal"),a=e("hbs!../template/chartLegend"),n=e("hbs!../template/calZoneModalContents"),s=e("hbs!../template/calZoneModalGoal"),l=e("galileo/tile/template/helpers/domPlaceholder"),o=e("i18n/i18n")(),r=e("galileo/model/user").viewer.activities(),h=e("galileo/graph/caloriesBurnVsIntake"),c=e("galileo/ajax/ajax"),d=e("galileo/widget/metric"),u=e("galileo/util/dateUtil"),p=e("galileo/util/calZoneUtil"),g=e("galileo/graph/configs/calories")(),f=e("galileo/model/calorieGoal").getCalorieBuffer();return o.namespace(e("i18n-load!com/fitbit/app/ngd/calzone")),o.namespace(e("i18n-load!com/fitbit/app/ngd/chart")),o.namespace(e("i18n-load!com/fitbit/app/ngd/sleep")),o.namespace(e("i18n-load!core/com/fitbit/util/dateformat")),o.namespace(e("i18n-load!com/fitbit/app/unit")),new Class({Extends:i,title:o("cals_in_out"),tileName:"calZone",options:{tileClass:"calZone",legendList:{vs:[{"class":"goal_met",name:o("legend_goal_met")},{"class":"cals-under",name:o("legend_under")},{"class":"cals-over",name:o("legend_over")},{"class":"cals-out",name:o("legend_out")}]},metricFormats:{tooltipFormat:[{unitPlural:o.plural("calorie_reduced"),unitThreshold:1/0,format:"#,##0"}],weeklyDeficit:[{unitPlural:o.plural("calorie_reduced"),unitThreshold:1/0,format:"#,##0"}]}},load:function(){var e=this,i=this.getDate(),a=c.get.bind({},"getCaloriesInVsOutTileDataAt","activityTileData",{date:u.ajaxEncode(i)}),n=u.minusDays(i,(i.getDay()-t.startDayOfWeek).mod(7)),s=r.loadDays.bind(r,"caloriesBurnedVsIntake",u.minusWeeks(n,1),i,"DAILY");Function.join(a,s,function(t,i){var a=e.modal;e.body.find(".goalContainer");e.body.find(".goalContainer").empty(),e.body.find(".chartContainer").empty(),e.loadChart(i,t),e.loadSummary(i,t),a.position()})},renderTileTpl:function(e){return e.contents=n({legendList:this.options.legendList}),this.parent(e)},loadSummary:function(e,i){var a=this,n=e.dataSets.caloriesIntake.dataPoints,o=e.dataSets.activity.dataPoints,r=[],h=i.calDeficit,c=u.getShortWeekdayNames(),g=[],m=0;Number.times(7,function(e){var i,s,l=(t.startDayOfWeek+e).mod(7);if(a.getDate().getDay()===l&&(s=!0),e+7<n.length){var r=o[e+7].value;if(r>0){var d=n[e+7].value-r;m+=d;var u=p.calculateDynamicDeficitGoal(h);s||(i=-f>d+u?"UNDER":d+u>f?"OVER":"ONTRACK")}}g.push({day:c[l],status:i})});var v=($.map(c,function(e,t){var i=r[t]||"",a={day:e,status:i};return a}),this.getDate(),new d(this.options.metricFormats.weeklyDeficit));v.update(m);var y=this.body.find(".goalContainer"),b=l(s,{day_results:g,deficit:$(v.elements())});y.append(b)},loadChart:function(e,t){var i,n,s,l=this.options.legendList,o=this.body.find(".chartContainer"),r=this.modal;s=g,i=h(o.width(),o.height(),this.getDate(),null,!0,this.options.metricFormats.tooltipFormat,null,s),o.append(i),n=$(a({legendList:l.vs})),o.after(n),r.position()}})}),define("hbs!galileo/tile/template/foodPlanModalContents",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/chart","i18n-load!com/fitbit/app/ngd/goal","galileo/tile/template/helpers/i18n","galileo/tile/template/helpers/domPlaceholder","hbs!galileo/tile/template/chartLegend"],function(e){var t=e.template(function(e,t,i,a,n){function s(e,t){var n,s,l,o="";return o+='\n<div class="goalContainer">\n    <div class="goal">\n        <h3 class="dailyAverage">',l={hash:{}},n=i.i18n,s=n?n.call(e,"this_week_daily_avg",l):h.call(e,"i18n","this_week_daily_avg",l),(s||0===s)&&(o+=s),o+=" ",l={hash:{}},n=i.i18n,s=n?n.call(e,"daily_avg",l):h.call(e,"i18n","daily_avg",l),(s||0===s)&&(o+=s),o+='</h3>\n        <div class="data">\n            <div class="total">\n                <div class="metric burned">\n                    <span class="number">',(s=i.dailyAvgBurned)?s=s.call(e,{hash:{}}):(s=e.dailyAvgBurned,s=typeof s===c?s.apply(e):s),o+=d(s)+'</span>\n                    <span class="burnedLegend unit">',l={hash:{}},n=i.i18n,s=n?n.call(e,"legend_burned_short",l):h.call(e,"i18n","legend_burned_short",l),(s||0===s)&&(o+=s),o+='</span>\n                </div>\n            </div>\n            <div class="total">\n                <div class="metric eaten">\n                    <span class="number">',(s=i.dailyAvgEaten)?s=s.call(e,{hash:{}}):(s=e.dailyAvgEaten,s=typeof s===c?s.apply(e):s),o+=d(s)+'</span>\n                    <span class="eatenLegend unit">',l={hash:{}},n=i.i18n,s=n?n.call(e,"legend_eaten_short",l):h.call(e,"i18n","legend_eaten_short",l),(s||0===s)&&(o+=s),o+="</span>\n                </div>\n            </div>\n        </div>\n        ",l={hash:{}},o+=d((n=i.domPlaceholder,n?n.call(e,"week",l):h.call(e,"domPlaceholder","week",l)))+'\n    </div>\n</div>\n<div class="chart">\n    <div class="graphHeader">\n        <h3 class="graphTitle js_graphTitle">',l={hash:{}},n=i.i18n,s=n?n.call(e,"title_past_2_weeks",l):h.call(e,"i18n","title_past_2_weeks",l),(s||0===s)&&(o+=s),o+='</h3>\n    </div>\n    <div class="chartContainer">\n        ',l={hash:{}},o+=d((n=i.domPlaceholder,n?n.call(e,"chart",l):h.call(e,"domPlaceholder","chart",l)))+'\n    </div>\n    <div class="legendContainer">\n        ',s=u.invokePartial(a.galileo_tile_template_chartLegend,"galileo_tile_template_chartLegend",e,i,a),(s||0===s)&&(o+=s),o+="\n    </div>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||e.partials;var l,o,r,h=i.helperMissing,c="function",d=this.escapeExpression,u=this;return r={hash:{},inverse:u.noop,fn:u.program(1,s,n)},l=i["i18n-namespace"],o=l?l.call(t,"com.fitbit.app.ngd.chart","com.fitbit.app.ngd.goal",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.chart","com.fitbit.app.ngd.goal",r),o||0===o?o:""});return e.registerPartial("galileo_tile_template_foodPlanModalContents",t),t}),define("hbs!galileo/tile/template/foodPlanModalDay",["handlebars","galileo/tile/template/helpers/domPlaceholder"],function(e){var t=e.template(function(e,t,i,a,n){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var s,l,o,r="",h=i.helperMissing,c=this.escapeExpression,d="function";return r+='<li class="day">\n    <div class="plate">',o={hash:{}},r+=c((s=i.domPlaceholder,s?s.call(t,"plate",o):h.call(t,"domPlaceholder","plate",o)))+'</div>\n    <span class="dayOfWeek">',(l=i.day)?l=l.call(t,{hash:{}}):(l=t.day,l=typeof l===d?l.apply(t):l),r+=c(l)+'</span>\n    <span class="over">',(l=i.over)?l=l.call(t,{hash:{}}):(l=t.over,l=typeof l===d?l.apply(t):l),r+=c(l)+"</span>\n</li>"});return e.registerPartial("galileo_tile_template_foodPlanModalDay",t),t}),define("hbs!galileo/tile/template/foodPlanModalWeek",["handlebars"],function(e){var t=e.template(function(e,t,i,a,n){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<ul class="week plates"></ul>'});return e.registerPartial("galileo_tile_template_foodPlanModalWeek",t),t}),define("galileo/tile/modal/foodPlan",["require","mootools","jquery","shared/scripts/modal","../classes/modal","galileo/model/user","i18n/i18n","galileo/builder/text","galileo/ajax/ajax","galileo/graph/caloriesBurnVsIntake","galileo/model/user","galileo/graphic/foodPlanPlate","galileo/builder/util","galileo/util/dateUtil","hbs!galileo/tile/template/foodPlanModalContents","hbs!galileo/tile/template/foodPlanModalDay","hbs!galileo/tile/template/foodPlanModalWeek","galileo/tile/template/helpers/domPlaceholder","galileo/graph/configs/calories","i18n-load!com/fitbit/app/ngd/foodplan","i18n-load!com/fitbit/app/ngd/chart","i18n-load!com/fitbit/app/unit"],function(e){e("mootools"),e("jquery");var t=(e("shared/scripts/modal"),e("../classes/modal")),i=e("galileo/model/user"),a=e("i18n/i18n")(),n=(e("galileo/builder/text"),e("galileo/ajax/ajax")),s=e("galileo/graph/caloriesBurnVsIntake"),l=e("galileo/model/user").viewer.activities(),o=e("galileo/graphic/foodPlanPlate").small,r=e("galileo/builder/util"),h=e("galileo/util/dateUtil"),c=(r.hspace,r.vspace,r.legend,e("hbs!galileo/tile/template/foodPlanModalContents")),d=e("hbs!galileo/tile/template/foodPlanModalDay"),u=e("hbs!galileo/tile/template/foodPlanModalWeek"),p=e("galileo/tile/template/helpers/domPlaceholder"),g=e("galileo/graph/configs/calories")();a.namespace(e("i18n-load!com/fitbit/app/ngd/foodplan")),a.namespace(e("i18n-load!com/fitbit/app/ngd/chart")),a.namespace(e("i18n-load!com/fitbit/app/unit"));var f=!0,m=[{"class":"goal_met",name:a("legend_goal_met")},{"class":"cals-under",name:a("legend_under")},{"class":"cals-over",name:a("legend_over")},{"class":"cals-out",name:a("legend_out")}];return new Class({Extends:t,title:a("food_plan"),tileName:"foodPlan",options:{tileClass:"foodPlan",metricFormats:{tooltipFormat:[{unitPlural:a.plural("calorie_reduced"),unitThreshold:1/0,format:"#,##0"}]}},load:function(){var e=this.getDate(),t=h.minusDays(e,(e.getDay()-i.viewer.startDayOfWeek).mod(7)),r=function(e){return i.viewer.formatNumber(e,"#,###")},v=n.get.bind(n,"getCaloriesInVsOutTileDataAt","activityTileData",{date:h.ajaxEncode(e)}),y=l.loadDays.bind(l,"caloriesBurnedVsIntake",h.ajaxEncode(t),h.ajaxEncode(e),"DAILY");Function.join(v,y,function(i,n){for(var l=$(u()),v=0,y=0,b=0,w=0;7>w;w++){var _=n.dataSets.activity.dataPoints[w],x=n.dataSets.caloriesIntake.dataPoints[w],T=h.plusDays(t,w).getDay()==e.getDay(),k=!1;_&&(v+=T?_.value:i.calBurnedTodayFullDay,y+=x.value,b++,0==_.value&&(k=!0));var S,M;T?(M=o(i.calIntakeToday,i.calBurnedTodayFullDay-(i.calDeficit||0),k),S=i.calIntakeToday-i.calBurnedTodayFullDay+(i.calDeficit||0)):(M=o(x&&x.value,_&&_.value-i.calDeficit,k),S=_&&_.value&&x.value-_.value+i.calDeficit),l.append(p(d,{plate:M,day:h.localeFormat(h.plusDays(t,w),"EEE"),over:S&&S>0?r(S)+" "+a("cals"):""}))}v/=b,y/=b;var C=g;C.showGraphWeeksLabel=f;var D=s(560,200,e,null,!0,this.options.metricFormats.tooltipFormat,void 0,C),A=p(c,{dailyAvgBurned:r(v.toFixed(0))||"0",dailyAvgEaten:r(y.toFixed(0))||"0",week:l,chart:D,legendList:m});this.body.append(A),this.modal.position()}.bind(this))}})}),define("hbs!galileo/tile/template/badgesModalContents",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/badges","i18n-load!com/fitbit/app/ngd/weight","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,a,n){function s(e,t){var a,n="";return n+="\n",a=i["if"].call(e,e.activityBadges,{hash:{},inverse:T.noop,fn:T.program(2,l,t)}),(a||0===a)&&(n+=a),n+="\n\n\n    ",a=i["if"].call(e,e.weightBadges,{hash:{},inverse:T.noop,fn:T.program(6,h,t)}),(a||0===a)&&(n+=a),n+="\n\n    ",a=i["if"].call(e,e.emptyState,{hash:{},inverse:T.noop,fn:T.program(10,u,t)}),(a||0===a)&&(n+=a),n+="\n\n    ",a=i["if"].call(e,e.promoSlot,{hash:{},inverse:T.noop,fn:T.program(15,f,t)}),(a||0===a)&&(n+=a),n+="\n"}function l(e,t){var a,n,s,l="";return l+='\n    <div class="badgeRow activity">\n        <h3>',s={hash:{}},a=i.i18n,n=a?a.call(e,"activity_badgeRow_heading",s):x.call(e,"i18n","activity_badgeRow_heading",s),(n||0===n)&&(l+=n),l+='</h3>\n        <ul class="badge_exTile clearfix">\n            ',n=i.each.call(e,e.activityBadges,{hash:{},inverse:T.noop,fn:T.program(3,o,t)}),(n||0===n)&&(l+=n),l+="\n        </ul>\n    </div>\n"}function o(e,t){var a,n,s,l="";return l+="\n                ",s={hash:{},inverse:T.noop,fn:T.program(4,r,t)},a=i["i18n-namespace"],n=a?a.call(e,"com.fitbit.app.ngd.badges","com.fitbit.app.ngd.weight",s):x.call(e,"i18n-namespace","com.fitbit.app.ngd.badges","com.fitbit.app.ngd.weight",s),(n||0===n)&&(l+=n),l+="\n            "}function r(e,t){var a,n,s,l="";return l+='\n                <li class="',(a=i.className)?a=a.call(e,{hash:{}}):(a=e.className,a=typeof a===w?a.apply(e):a),l+=_(a)+'" data-date="',s={hash:{}},a=i.i18n,n=a?a.call(e,"earned",s):x.call(e,"i18n","earned",s),(n||0===n)&&(l+=n),l+=" ",(n=i.earnedDate)?n=n.call(e,{hash:{}}):(n=e.earnedDate,n=typeof n===w?n.apply(e):n),l+=_(n)+'" data-amount="',(n=i.quantityEarned)?n=n.call(e,{hash:{}}):(n=e.quantityEarned,n=typeof n===w?n.apply(e):n),l+=_(n)+" ",(n=i.quantityUnit)?n=n.call(e,{hash:{}}):(n=e.quantityUnit,n=typeof n===w?n.apply(e):n),l+=_(n)+'">\n                    <span>',(n=i.quantityEarned)?n=n.call(e,{hash:{}}):(n=e.quantityEarned,n=typeof n===w?n.apply(e):n),l+=_(n)+" ",(n=i.quantityUnit)?n=n.call(e,{hash:{}}):(n=e.quantityUnit,n=typeof n===w?n.apply(e):n),l+=_(n)+"</span>\n                    <span>",(n=i.label)?n=n.call(e,{hash:{}}):(n=e.label,n=typeof n===w?n.apply(e):n),l+=_(n)+"</span>\n                </li>\n                "}function h(e,t){var a,n,s,l="";return l+='\n        <div class="badgeRow weight">\n            <h3>',s={hash:{}},a=i.i18n,n=a?a.call(e,"weight_badgeRow_heading",s):x.call(e,"i18n","weight_badgeRow_heading",s),(n||0===n)&&(l+=n),l+='</h3>\n            <ul class="badge_exTile clearfix">\n                ',n=i.each.call(e,e.weightBadges,{hash:{},inverse:T.noop,fn:T.program(7,c,t)}),(n||0===n)&&(l+=n),l+="\n            </ul>\n        </div>\n    "}function c(e,t){var a,n,s,l="";return l+="\n                    ",s={hash:{},inverse:T.noop,fn:T.program(8,d,t)},a=i["i18n-namespace"],n=a?a.call(e,"com.fitbit.app.ngd.badges","com.fitbit.app.ngd.weight",s):x.call(e,"i18n-namespace","com.fitbit.app.ngd.badges","com.fitbit.app.ngd.weight",s),(n||0===n)&&(l+=n),l+="\n                "}function d(e,t){var a,n,s,l="";return l+='\n                    <li class="',(a=i.className)?a=a.call(e,{hash:{}}):(a=e.className,a=typeof a===w?a.apply(e):a),l+=_(a)+'" data-date="',s={hash:{}},a=i.i18n,n=a?a.call(e,"earned",s):x.call(e,"i18n","earned",s),(n||0===n)&&(l+=n),l+=" ",(n=i.earnedDate)?n=n.call(e,{hash:{}}):(n=e.earnedDate,n=typeof n===w?n.apply(e):n),l+=_(n)+'" data-amount="',(n=i.quantityEarned)?n=n.call(e,{hash:{}}):(n=e.quantityEarned,n=typeof n===w?n.apply(e):n),l+=_(n)+" ",(n=i.quantityUnit)?n=n.call(e,{hash:{}}):(n=e.quantityUnit,n=typeof n===w?n.apply(e):n),l+=_(n)+'">\n                        <span>',(n=i.quantityEarned)?n=n.call(e,{hash:{}}):(n=e.quantityEarned,n=typeof n===w?n.apply(e):n),l+=_(n)+" ",(n=i.quantityUnit)?n=n.call(e,{hash:{}}):(n=e.quantityUnit,n=typeof n===w?n.apply(e):n),l+=_(n)+"</span>\n                        <span>",(n=i.label)?n=n.call(e,{hash:{}}):(n=e.label,n=typeof n===w?n.apply(e):n),l+=_(n)+"</span>\n                    </li>\n                    "}function u(e,t){var a,n="";return n+="\n\n        ",a=i["if"].call(e,e.deviceWeight,{hash:{},inverse:T.program(13,g,t),fn:T.program(11,p,t)}),(a||0===a)&&(n+=a),n+="\n\n    "}function p(e,t){var a,n,s,l="";return l+='\n\n            <div class="emptyRow emptyWeight">\n                <h3>',s={hash:{}},a=i.i18n,n=a?a.call(e,"weight_badgeRow_heading",s):x.call(e,"i18n","weight_badgeRow_heading",s),(n||0===n)&&(l+=n),l+="</h3>\n                <p>",s={hash:{}},a=i.i18n,n=a?a.call(e,"get_started_badges",s):x.call(e,"i18n","get_started_badges",s),(n||0===n)&&(l+=n),l+="</p>\n                <p>",s={hash:{}},a=i.i18n,n=a?a.call(e,"set_weight_goal_start",s):x.call(e,"i18n","set_weight_goal_start",s),(n||0===n)&&(l+=n),l+="</p>\n            </div>\n        "}function g(e,t){var a,n,s,l="";return l+='\n            <div class="emptyRow">\n                <p>',s={hash:{}},a=i.i18n,n=a?a.call(e,"get_stepping_earn_badges",s):x.call(e,"i18n","get_stepping_earn_badges",s),(n||0===n)&&(l+=n),l+="</p>\n                <p>",s={hash:{}},a=i.i18n,n=a?a.call(e,"earn_first_badge",s):x.call(e,"i18n","earn_first_badge",s),(n||0===n)&&(l+=n),l+="</p>\n            </div>\n        "}function f(e,t){var a,n,s,l="";return l+='\n\n        <div class="promoRow">\n            <h4>',s={hash:{}},a=i.i18n,n=a?a.call(e,"want_more_badges",s):x.call(e,"i18n","want_more_badges",s),(n||0===n)&&(l+=n),l+="</h4>\n            <p>",s={hash:{}},a=i.i18n,n=a?a.call(e,"expanded_badge_tile_promo_content",s):x.call(e,"i18n","expanded_badge_tile_promo_content",s),(n||0===n)&&(l+=n),l+="</p>\n        </div>\n    "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var m,v,y,b="",w="function",_=this.escapeExpression,x=i.helperMissing,T=this;return y={hash:{},inverse:T.noop,fn:T.program(1,s,n)},m=i["i18n-namespace"],v=m?m.call(t,"com.fitbit.app.ngd.badges","com.fitbit.app.ngd.weight",y):x.call(t,"i18n-namespace","com.fitbit.app.ngd.badges","com.fitbit.app.ngd.weight",y),(v||0===v)&&(b+=v),b+="\n"});return e.registerPartial("galileo_tile_template_badgesModalContents",t),t}),define("hbs!galileo/tile/template/badgesModalTooltip",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/badges","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,a,n){function s(e,t){var a,n="";return n+='\n\n<div class="ttContainer ',(a=i.ttClass)?a=a.call(e,{hash:{}}):(a=e.ttClass,a=typeof a===f?a.apply(e):a),n+=m(a)+'">\n    <div class="upper ',a=i["if"].call(e,e.nextNotNeeded,{hash:{},inverse:y.noop,fn:y.program(2,l,t)}),(a||0===a)&&(n+=a),n+='">\n        ',a=i["if"].call(e,e.description,{hash:{},inverse:y.program(6,r,t),fn:y.program(4,o,t)}),(a||0===a)&&(n+=a),n+="\n        <span>\n            ",a=i.unless.call(e,e.isFriendlyDate,{hash:{},inverse:y.noop,fn:y.program(8,h,t)}),(a||0===a)&&(n+=a),n+="\n            ",(a=i.earnedDate)?a=a.call(e,{hash:{}}):(a=e.earnedDate,a=typeof a===f?a.apply(e):a),n+=m(a)+"\n        </span>\n    </div>\n\n    ",a=i.unless.call(e,e.nextNotNeeded,{hash:{},inverse:y.noop,fn:y.program(10,c,t)}),(a||0===a)&&(n+=a),n+="\n</div>\n"}function l(e,t){return"solo"}function o(e,t){var a,n="";return n+="\n            <span>",(a=i.description)?a=a.call(e,{hash:{}}):(a=e.description,a=typeof a===f?a.apply(e):a),n+=m(a)+" (",(a=i.quantityEarned)?a=a.call(e,{hash:{}}):(a=e.quantityEarned,a=typeof a===f?a.apply(e):a),n+=m(a)+" ",(a=i.quantityUnit)?a=a.call(e,{hash:{}}):(a=e.quantityUnit,a=typeof a===f?a.apply(e):a),n+=m(a)+")</span>\n        "}function r(e,t){var a,n="";return n+="\n            <span>",(a=i.quantityEarned)?a=a.call(e,{hash:{}}):(a=e.quantityEarned,a=typeof a===f?a.apply(e):a),n+=m(a)+" ",(a=i.quantityUnit)?a=a.call(e,{hash:{}}):(a=e.quantityUnit,a=typeof a===f?a.apply(e):a),n+=m(a)+"</span>\n        "}function h(e,t){var a,n,s,l="";return l+="\n                ",s={hash:{}},a=i.i18n,n=a?a.call(e,"earned",s):v.call(e,"i18n","earned",s),(n||0===n)&&(l+=n),l+="\n            "}function c(e,t){var a,n="";return n+='\n        <div class="lower">\n            <span>\n                ',a=i["if"].call(e,e.showNext,{hash:{},inverse:y.noop,fn:y.program(11,d,t)}),(a||0===a)&&(n+=a),n+="\n                &nbsp;\n            </span>\n            <span>",(a=i.nextQuantity)?a=a.call(e,{hash:{}}):(a=e.nextQuantity,a=typeof a===f?a.apply(e):a),n+=m(a)+" ",(a=i.quantityUnit)?a=a.call(e,{hash:{}}):(a=e.quantityUnit,a=typeof a===f?a.apply(e):a),n+=m(a)+"</span>\n            <span>",(a=i.leftToGo)?a=a.call(e,{hash:{}}):(a=e.leftToGo,a=typeof a===f?a.apply(e):a),n+=m(a)+" ",(a=i.toGoText)?a=a.call(e,{hash:{}}):(a=e.toGoText,a=typeof a===f?a.apply(e):a),n+=m(a)+"</span>\n        </div>\n    "}function d(e,t){var a,n,s,l="";return l+="\n                    ",s={hash:{}},a=i.i18n,n=a?a.call(e,"next",s):v.call(e,"i18n","next",s),(n||0===n)&&(l+=n),l+="\n                "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var u,p,g,f="function",m=this.escapeExpression,v=i.helperMissing,y=this;return g={hash:{},inverse:y.noop,fn:y.program(1,s,n)},u=i["i18n-namespace"],p=u?u.call(t,"com.fitbit.app.ngd.badges",g):v.call(t,"i18n-namespace","com.fitbit.app.ngd.badges",g),p||0===p?p:""});return e.registerPartial("galileo_tile_template_badgesModalTooltip",t),t}),define("galileo/tile/modal/badges",["require","mootools","jquery","../classes/modal","galileo/model/user","galileo/model/badges","hbs!../template/badgesModalContents","hbs!../template/badgesModalTooltip","i18n/i18n","galileo/util/dateUtil","galileo/graph/tooltip","i18n-load!com/fitbit/app/ngd/badges"],function(e){e("mootools"),e("jquery");var t=e("../classes/modal"),i=e("galileo/model/user"),a=e("galileo/model/badges"),n=e("hbs!../template/badgesModalContents"),s=e("hbs!../template/badgesModalTooltip"),l=e("i18n/i18n")(),o=e("galileo/util/dateUtil"),r=e("galileo/graph/tooltip");l.namespace(e("i18n-load!com/fitbit/app/ngd/badges"));var h={best_in_a_day:l("best_in_a_day"),lifetime_climb:l("lifetime_climb"),lifetime_distance:l("lifetime_distance"),weight_loss:l("weight_loss"),grams:l("grams"),pounds:l("pounds"),steps:l("steps"),floors:l("floors"),miles:l("miles"),kilometers:l("kilometers"),earned:l("earned")},c=function(e){return h[e]},d=function(e,t){return i.viewer.formatNumber(e,t)};return new Class({Extends:t,title:l("top_badges"),tileName:"badges",options:{tileClass:"badges"},renderToolTips:function(e){var t=[],i=$(".badge_exTile li"),a=e.activityBadges.append(e.weightBadges);$.each(a,function(e,t){this.ttClass="tt_"+t.className}),i.each(function(e){var i,n,l=$(this).offset(),o=Math.round($(this).outerWidth(!0)/2),h="tt_"+$(this).attr("class");t.push(h),r(38,l.top+19,function(){return s(a[e])}),i=$("."+h).parent(),n=Math.round(i.outerWidth(!0)/2),i.css("left",Math.round(l.left+o-n))}),this.attachTooltipEvents(i,t)},attachTooltipEvents:function(e,t){var i=function(){$(".ttContainer").parent().remove()};this.modal.onClose(function(){i()}),$.each(t,function(i){var a=$("."+t[i]),n=a.parent();n.hide(),e.eq(i).hover(function(){n.show()},function(){n.hide()})})},loadingState:function(e,t){$(t).css("min-height",120).addClass("loadingSpinner"),e.position()},getCurrentQuantity:function(e,t,i){switch(t){case"floors":return i?e.lifetimeFloors:e.currentFloors;case"steps":return e.currentSteps;case"miles":return e.lifetimeDistance;case"kilometers":return e.lifetimeDistance;default:return""}},load:function(){var e=this.modal,t=this.body,s=this,r=e.dialog,h=i.viewer.activities();r.find(".content").eq(0).css("padding","30px 15px"),this.loadingState(e,t),Function.join(h.loadSummary.bind(h,"steps",new Date),h.loadSummary.bind(h,"floors",new Date),h.loadWeightSummary.bind(h,new Date),h.loadSummary.bind(h,"distance",new Date),a.loadAchievements.bind(h),a.loadTopWithUpcomingBadges.bind(h),function(a,r,h,u,p,g){var f=Object.clone(g),m=p.lifetimeAchievements,v=($.grep(m,function(e,t){return/steps/.test(e.type)}),$.grep(m,function(e,t){return/floors/.test(e.type)})),y=$.grep(m,function(e,t){return/distance/.test(e.type)}),b={};b.currentSteps=a.dayTotal,b.currentFloors=r.dayTotal,b.lifetimeFloors=v[0].value,b.lifetimeDistance=y[0].value,s.serverData=f,f.deviceWeight=i.viewer.deviceFeatures.WEIGHT,f.activityBadges.length||f.weightBadges.length||(f.promoSlot=[],f.emptyState=!0);var w=function(e,t,i,a){return e&&i},_=function(e){var t=o.getDateFromISO8601(e,!0),i=o.diffInDays(t,new Date);switch(retVal="",i){case 0:retVal=l("today");break;case-1:retVal=l("yesterday");break;default:retVal=!1}return retVal},x=function(e){var t=new Date(o.getDateFromISO8601(e,!0)),i=o.localeFormat(t,"MMMM dd, yyyy");return i.toUpperCase().replace(/ 0+(?!$)/," ")},T=function(e,t){$.each(e,function(){var e=this.className.match(/weight/)?!0:!1,t=this.className.match(/finish/)?!0:!1,i=this.nextClassName.match(/finish/)?!0:!1,a=_(this.earnedDate)?!0:!1,n=this.nextQuantity&&this.nextQuantity>0?!1:!0,o=!(!e||!i)||n;1===this.quantityEarned?this.quantityEarned=l(t?"goal_met":"goal_set"):(this.quantityEarned="grams"===this.quantityUnit?Math.round(this.quantityEarned/1e3):this.quantityEarned,e?this.leftToGo=Math.abs(this.nextQuantity-(h.currentWeight.units-h.startWeight.units)):(this.currentQuantity=s.getCurrentQuantity(b,this.quantityUnit,this.lifetime),this.leftToGo=d(Math.round(this.nextQuantity-this.currentQuantity),"#,###"),this.currentQuantity=d(Math.round(Number(this.currentQuantity)),"#,###"),this.quantityEarned=d(Math.round(Number(this.quantityEarned)),"#,###"),this.nextQuantity=d(Math.round(Number(this.nextQuantity)),"#,###"))),this.label=c(this.label).toUpperCase(),this.toGoText=l(this.lifetime?"more_to_go":"more_to_earn_today"),this.description=this.description,this.quantityUnit=c(this.quantityUnit),this.earnedDate=a?_(this.earnedDate):x(this.earnedDate),this.showNext=w(e,this.lifetime,t,n)?"":!0,this.isFriendlyDate=a,this.nextNotNeeded=o}),f[t]=e};f.activityBadges.length&&T(f.activityBadges,"activityBadges"),f.weightBadges.length&&T(f.weightBadges,"weightBadges"),$(t).removeClass("loadingSpinner").append(n(f)),e.position(),s.renderToolTips(f)})}})}),define("galileo/graph/chartTopper",["require"],function(e){var t={};return t.drawBarToppers=function(e,t,i){for(var a=0;a<e.length;a++)for(var n=e[a],s=0;s<n.data.length;s++)if(n.data[s]){var l=n.data[s];if(l.x>=0&&l.y>0){var o=l.series.chart.plotSizeY-l.plotY,r=l.graphic.width,h=t(l),c=5>o?o:5;i.rect(l.graphic.x,l.plotY+10,r,c).attr("stroke",h).attr("fill",h).attr("zIndex",5).css({fill:h,stroke:h,position:"relative",zIndex:5}).add()}}},t}),define("hbs!galileo/tile/template/trainerGraph",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/premium","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,a,n){function s(e,t){var a,n,s,l="";return l+='\n<div class="chartSection">\n    <div class="graphContainer">\n        <header class="graphHeader">\n            <h3 class="period">\n                ',s={hash:{}},a=i.i18n,n=a?a.call(e,"twelve_week_plan",s):h.call(e,"i18n","twelve_week_plan",s),(n||0===n)&&(l+=n),l+='\n                <span class="range">',(n=i.range)?n=n.call(e,{hash:{}}):(n=e.range,n=typeof n===c?n.apply(e):n),l+=d(n)+'</span>\n            </h3>\n\n            <nav class="tabs">\n                <ul class="items">\n                    <li class="item"><a class="tab" href="#week">',s={hash:{}},a=i.i18n,n=a?a.call(e,"week",s):h.call(e,"i18n","week",s),(n||0===n)&&(l+=n),l+='</a></li>\n                    <li class="item"><a class="tab" href="#plan">',s={hash:{}},a=i.i18n,n=a?a.call(e,"plan",s):h.call(e,"i18n","plan",s),(n||0===n)&&(l+=n),l+='</a></li>\n                </ul>\n            </nav>\n        </header>\n\n        <div class="chart"></div>\n        <div class="legend">\n            <ul class="legendList">\n                <li class="legendItem goal_met">\n                    <span class="icon"></span> ',s={hash:{}},a=i.i18n,n=a?a.call(e,"goal_met",s):h.call(e,"i18n","goal_met",s),(n||0===n)&&(l+=n),l+="\n                </li>\n            </ul>\n        </div>\n    </div>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var l,o,r,h=i.helperMissing,c="function",d=this.escapeExpression,u=this;return r={hash:{},inverse:u.noop,fn:u.program(1,s,n)},l=i["i18n-namespace"],o=l?l.call(t,"com.fitbit.app.ngd.premium",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.premium",r),o||0===o?o:""});return e.registerPartial("galileo_tile_template_trainerGraph",t),t}),define("galileo/graph/trainer",["require","./base","./tooltip","galileo/ajax/ajax","galileo/model/user","i18n/i18n","../color/graph","galileo/graph/chartTopper","./graphUtil","galileo/util/dateUtil","hbs!../tile/template/trainerGraph","i18n-load!com/fitbit/app/ngd/premium"],function(e){function t(e,t){var i=0,u=0;t=t||new Date;var p=c(t,1,l.startDayOfWeek,i,u,"EEE");s.get("getTrainerPlan","activityTileData",{},function(i){var c=i.weeks.filter(function(e){return new Date(e.start[0],e.start[1]-1,e.start[2]).getTime()<=t.getTime()}).getLast(),u=p.getStartDate(),g=[0,1,2,3,4,5,6].map(function(e){return d.plusDays(u,e)}).filter(function(e){return e.getTime()<=t.getTime()}).map(function(e){return d.ajaxEncode(e)});s.get("getActivityCalories","activityTileData",{dates:JSON.encode(g)},function(t){function i(e){return e<c.target?r.goal_unmet_muted:r.goal_met_muted}function s(e){return e.y<c.target?r.goal_unmet:r.goal_met}for(;t.length<7;)t.push(0);var g=t.map(function(e,t){return{x:d.plusDays(u,t),y:e,low:-1e4,color:i(e)}});a(e,560,200,Object.merge({plotOptions:{column:{pointWidth:62}},chart:{marginLeft:0,marginRight:0,type:"column",events:{load:function(){var e=this.axes[1].getExtremes().max,t=this.plotSizeY,i=this.plotTop+t*(1-c.target/e);this.renderer.path(["M",this.plotLeft,i,"L",this.plotLeft+this.plotSizeX,i]).attr({stroke:r.goal_line,dashstyle:"2,1","stroke-width":2}).add(),h.drawBarToppers(this.series,function(e){return s(e)},this.renderer)}}},tooltip:{enabled:!1},xAxis:p.getXAxisOptions(),yAxis:{lineColor:r.yAxis,gridLineColor:r.yAxis,minorGridLineColor:r.yAxis,minRange:2*c.target,labels:{align:"left",x:25,y:14,formatter:function(){return this.value?l.formatNumber(this.value,"#,##0"):""}}},series:[{data:p.modifySeries(g)}]},n.chartMixin(function(){var e=this.date,t=$('<div class="graphTip">').append($('<div class="date">').text(d.localeFormat(e,"MMM dd")),$('<div class="details">').text([l.formatNumber(Math.round(this.y),"#,##0"),o("cals")].join(" ")));return this.y>=c.target&&t.addClass("goalMet"),t},function(e){return s(e)})))}.bind(this))}.bind(this))}function i(e,t){var i=2,c=1;t=t||new Date,s.get("getTrainerPlan","activityTileData",{},function(u){var p=u.weeks.map(function(e){return new Date(e.start[0],e.start[1]-1,e.start[2])}).filter(function(e){return e.getTime()<t.getTime()}).map(function(e){return d.ajaxEncode(e)}),g=new Date(u.weeks[0].start[0],u.weeks[0].start[1]-1,u.weeks[0].start[2]),f=u.weeks.map(Function.takeKey("target"));s.get("getAverageWeeklyCalories","activityTileData",{startDates:JSON.encode(p)},function(s){function m(e){
return e.y<e.weekGoal?r.goal_unmet:r.goal_met}for(;s.length<12;)s.push(0);for(var v=s.zipWith(f,function(e,t,i){return{x:d.plusWeeks(g,i).getTime(),y:e,low:-e,color:t>e?r.goal_unmet_muted:r.goal_met_muted,weekGoal:u.weeks[i].target,weekNumber:i+1}}),y=g,b=d.plusWeeks(g,11),w=1;i>=w;w++)v.unshift({x:d.minusWeeks(y,w).getTime(),y:0});for(var w=1;c>=w;w++)v.push({x:d.plusWeeks(b,w).getTime(),y:0});a(e,560,200,Object.merge({chart:{marginLeft:0,marginRight:0,type:"column",events:{load:function(){var e=this.axes[1].getExtremes().max,t=this.plotSizeY,i=this.plotTop+t*(1-u.weeks[0].target/e),a=this.plotTop+t*(1-u.weeks.getLast().target/e);this.renderer.path(["M",this.plotLeft,i,"L",this.plotLeft+this.plotSizeX,a]).attr({stroke:r.goal_line,dashstyle:"2,1","stroke-width":2}).add(),h.drawBarToppers(this.series,function(e){return m(e)},this.renderer)}}},tooltip:{enabled:!1},xAxis:{tickPositions:v.map(Function.takeKey("x")),lineColor:r.xAxis,tickLength:0,labels:{useHTML:!0,tickLength:0,style:{padding:"6px"},formatter:function(e){var a=v.map(Function.takeKey("x")).indexOf(this.value)-i;if(0>a||a>11)return"";var n;if(n=0==a?o("week_one_abbreviated"):""+(a+1),a==p.length-1&&(n='<div class="graphCurrentDay graphCurrentWeek">'+n+"</div>"),5==a){var s=d.minusDays(t,t.getDay()),l=d.plusDays(s,6);n+="<br/>",n+='<div class="weekLabel">',n+=d.localeFormat(s,"MMM dd"),n+=" - "+d.localeFormat(l,"MMM dd"),n+="</div>"}return'<div class="xAxisLabel weekAxisLabel">'+n+"</div>"}}},yAxis:{lineColor:r.yAxis,gridLineColor:r.yAxis,minorGridLineColor:r.yAxis,minRange:1.3*f.getLast(),labels:{align:"left",x:25,y:14,formatter:function(){return this.value?this.axis.defaultLabelFormatter.call(this):""}}},series:[{data:v,pointWidth:36.5}]},n.chartMixin(function(){if(!this.weekNumber)return!1;var e=$('<div class="graphTip">').append($('<div class="date">').text([o("week"),this.weekNumber,o("average")].join(" ")),$('<div class="details">').text([l.formatNumber(Math.round(this.y),"#,###"),o("cals")].join(" ")));return this.y>=this.weekGoal&&e.addClass("goalMet"),e},function(e){return m(e)})))}.bind(this))}.bind(this))}var a=e("./base"),n=e("./tooltip"),s=e("galileo/ajax/ajax"),l=e("galileo/model/user").viewer,o=e("i18n/i18n")(),r=e("../color/graph"),h=e("galileo/graph/chartTopper"),c=e("./graphUtil"),d=e("galileo/util/dateUtil"),u=e("hbs!../tile/template/trainerGraph");return o.namespace(e("i18n-load!com/fitbit/app/ngd/premium")),function(e,a){var n,s,l,r=this,h=[a.weeks[0].start,a.weeks.getLast().start].map(function(e,t){var i=d.plusDays(new Date(e[0],e[1]-1,e[2]),6*t);return d.localeFormat(i,"MMM dd")}),c=$(u({range:o("slash_range").substitute(h)})),p={week:t,plan:i};return n=c.find(".chart"),s=c.find(".tabs"),l=s.find(".tab").first(),s.on("click",".tab",function(t){t.preventDefault();var i=$(this),a=i.prop("hash").slice(1),s=p[a];l.removeClass("selected"),i.addClass("selected"),l=i,s.call(r,n,e)}),l.click(),c}}),define("hbs!galileo/tile/template/trainerModal",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/premium","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,a,n){function s(e,t){var a,n,s,r="";return r+='\n\n<h3 class="period">',s={hash:{}},a=i.i18n,n=a?a.call(e,"this_week",s):d.call(e,"i18n","this_week",s),(n||0===n)&&(r+=n),r+='</h3>\n\n<h3 class="goalStatus">\n',n=i["if"].call(e,e.goalMet,{hash:{},inverse:g.program(4,o,t),fn:g.program(2,l,t)}),(n||0===n)&&(r+=n),r+='\n</h3>\n\n\n<div class="graphContainer"></div>\n'}function l(e,t){var a,n,s,l="";return l+="\n    ",s={hash:{}},a=i.i18n,n=a?a.call(e,"congratulations_youve_reached_your_goal",s):d.call(e,"i18n","congratulations_youve_reached_your_goal",s),(n||0===n)&&(l+=n),l+="\n"}function o(e,t){var a,n,s,l="";return l+="\n    ",s={hash:{}},a=i.i18n,n=a?a.call(e,"youre_below_goal",s):d.call(e,"i18n","youre_below_goal",s),(n||0===n)&&(l+=n),l+='\n    <h4 class="moreCals">',(n=i.moreCals)?n=n.call(e,{hash:{}}):(n=e.moreCals,n=typeof n===u?n.apply(e):n),l+=p(n)+"</h4>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,h,c,d=i.helperMissing,u="function",p=this.escapeExpression,g=this;return c={hash:{},inverse:g.noop,fn:g.program(1,s,n)},r=i["i18n-namespace"],h=r?r.call(t,"com.fitbit.app.ngd.premium",c):d.call(t,"i18n-namespace","com.fitbit.app.ngd.premium",c),h||0===h?h:""});return e.registerPartial("galileo_tile_template_trainerModal",t),t}),define("galileo/tile/modal/trainer",["require","mootools","jquery","galileo/ajax/ajax","../classes/modal","i18n/i18n","galileo/builder/text","galileo/graph/trainer","galileo/model/user","galileo/util/dateUtil","hbs!../../tile/template/trainerModal","i18n-load!com/fitbit/app/ngd/premium"],function(e){e("mootools"),e("jquery");var t=e("galileo/ajax/ajax"),i=e("../classes/modal"),a=e("i18n/i18n")(),n=(e("galileo/builder/text"),e("galileo/graph/trainer")),s=e("galileo/model/user").viewer,l=e("galileo/util/dateUtil"),o=s.subscriptions.trainer,r=e("hbs!../../tile/template/trainerModal");return a.namespace(e("i18n-load!com/fitbit/app/ngd/premium")),new Class({Extends:i,title:a("trainer"),tileName:"trainer",options:{tileClass:"trainer"},load:function(){var e=this.getDate();Function.join(o.getPlan.bind(o,{}),t.get.bind(t,"getActivityCalories","activityTileData",{dates:JSON.encode([l.ajaxEncode(e)])}),function(t,i){var l=t.weeks.filter(function(t){return new Date(t.start[0],t.start[1]-1,t.start[2]).getTime()<=e.getTime()}).getLast(),o=this.body,h=i[0]>=l.target;o.append(r({goalMet:h,moreCals:a("burn_more_calories").substitute([s.formatNumber((l.target-i[0]).toFixed(0),"#,##0")])})),o.find(".graphContainer").append(n(this.getDate(),t)),this.modal.position()}.bind(this))}})}),define("galileo/graph/activeMinutes",["require","mootools","highcharts","./base","../color/graph","./configs/activity","./tooltip","i18n/i18n","galileo/model/user","galileo/widget/metric","./graphUtil","galileo/util/dateUtil","i18n-load!com/fitbit/app/unit"],function(e){e("mootools"),e("highcharts");var t=e("./base"),i=e("../color/graph"),a=e("./configs/activity"),n=e("./tooltip"),s=e("i18n/i18n")(),l=e("galileo/model/user").viewer,o=l.activities(),r=e("galileo/widget/metric"),h=e("./graphUtil"),c=e("galileo/util/dateUtil");s.namespace(e("i18n-load!com/fitbit/app/unit"));var d=[{unitPlural:s.plural("minute_short"),unitThreshold:1/0,format:"#,##0"}],u=[{unitPlural:s.plural("minute_reduced"),unitThreshold:1/0,format:"#,##0"}],p=function(e){var t=new r(u);return t.update(e),t.style("unit",{paddingRight:4}),t.style("number",{paddingRight:2}),t.elements()};return function(e,s,u,g,f){g=g||new Date;var m={leftPadding:4,rightPadding:1,weeks:4},v=Object.merge({},m,f),y=$("<div>").width(s).height(u),b=1===v.weeks,w=b?"EEE":"E",_=h(g,v.weeks,l.startDayOfWeek,v.leftPadding,v.rightPadding,w),x=_.getStartDate(!0),T=o.loadDays.bind(o,"minutesAll",x,g,"DAILY"),k=o.loadSummary.bind(o,e,g),S={linearGradient:a.chart_column_gradient,stops:i.columnGradients.gold},M={linearGradient:a.chart_column_gradient,stops:i.columnGradients.lime},C=[S,M],D=["minutesFairly","minutesVery"];return Function.join(T,k,function(e,l){var o=e.dataSets.activity.dataPoints,h=o[0].values.length;h!==D.length&&(o.each(function(e,t){e.values=e.values.slice(-D.length)}),h=o[0].values.length);var g=[];Number.times(h,function(e){g.push([])}),o.each(function(e,t){for(var i=e.values,a=i.length-1,n=0;a>=i.length-g.length;a--)i[a]>0&&(g[n].push({x:c.ajaxDecode(e.dateTime),y:Number(i[a]),dataType:D[a],color:C[a],sourceIndex:t}),n++);for(;n<g.length;n++)g[n].push({x:c.ajaxDecode(e.dateTime),y:0})}),g=g.map(function(e,t){return{data:_.modifySeries(e)}});var f=Number(l.dailyGoal)||void 0,m={chart:{animation:!1,marginLeft:0,marginRight:0,type:"column",events:{load:function(){if(f){var e=this.axes[1].getExtremes().max,t=this.plotSizeY,n=this.plotTop+t*(1-f/e),s=a.marginRect;this.renderer.path(["M",this.plotLeft,n,"L",this.plotLeft+this.plotSizeX,n]).attr({stroke:i.goal_line,dashstyle:a.goalLine.dashstyle,"stroke-width":a.goalLine.strokeWidth}).add(),this.renderer.rect(s.x,s.y,s.width,s.height,s.radius).attr({fill:i.graphBgFill,zIndex:s.zIndex}).add()}}}},plotOptions:{series:{grouping:!1,marker:{symbol:"square",radius:0}},column:{pointWidth:b?a.column.weekWidth:a.column.weeksWidth,animation:!1,stacking:"normal",stickyTracking:!1,colorByPoint:!1,pointPadding:0,groupPadding:.01,borderWidth:0,shadow:!1}},xAxis:_.getXAxisOptions(b),yAxis:{gridLineColor:i.xAxis,minorGridLineColor:i.xAxis,showFirstLabel:!1,labels:{align:a.yAxisLabel.alignment,x:a.yAxisLabel.yAxisLabels_x,y:a.yAxisLabel.yAxisLabels_y,formatter:function(){var e=new r(d);return e.update(this.value),'<span class="yAxisLabel">'+e.string()+"</span>"},useHTML:!0}},tooltip:{enabled:!1},series:g,legend:{enabled:!1,align:"left",floating:!0,borderWidth:0,borderRadius:0,padding:0,symbolWidth:12,symbolPadding:6}};t(y,s,u,Object.merge(m,n.chartMixin(function(){if(!this.date)return null;var e=$('<div class="graphTip activeMinutesTooltip">').append($('<div class="date">').text(c.localeFormat(this.date,"MMM dd"))),t=$('<div class="details"/>');if(t.append('<ul class="activityLevels"><li class="very"><span class="color" >Very active:</span></li><li class="moderate"><span class="color" >Moderately active:</span></li></ul>'),!o[this.sourceIndex])return null;var i=o[this.sourceIndex].values;return t.find(".very").append(p(i[1])),t.find(".moderate").append(p(i[0])),e.append(t),e})))}),y}}),define("galileo/graph/weeks",["require","mootools","./base","../color/graph","./tooltip","i18n/i18n","galileo/model/user","./graphUtil","galileo/util/dateUtil","galileo/model/sleep","galileo/widget/metric","galileo/graph/chartTopper"],function(e){e("mootools");var t=e("./base"),i=e("../color/graph"),a=e("./tooltip"),n=(e("i18n/i18n")(),e("galileo/model/user").viewer),s=e("./graphUtil"),l=e("galileo/util/dateUtil"),o=n.activities(),r=(e("galileo/model/sleep"),e("galileo/widget/metric")),h=e("galileo/graph/chartTopper"),c={series_name:"steps",width:0,height:0,date:new Date,precision:0,readyGraph:null,readySummary:null,weeks:4,borderRadius:0,hideDateString:!1,goalColor:i.goal_line,maxY:null,leftPadding:4,rightPadding:1};return function(e){function d(s,o){function c(e){return{x:l.ajaxDecode(e.dateTime),y:Number(e.value)}}function d(e){return e.y>=v?i.goal_met_muted:i.goal_unmet_muted}function g(e){return e.y>=v?i.goal_met:i.goal_unmet}var f=s.dataSets,m=[],v=Number(o.dailyGoal);Object.each(f,function(e,t){var i=p.modifySeries(e.dataPoints.map(c));i.each(function(e,t){e.low=-1e4,e.color=d(e)}),m.push({name:t,data:i})});var y={chart:{marginLeft:0,marginRight:0,type:"column",events:{load:function(){var t=this.axes[1].getExtremes().max,i=this.plotSizeY,a=this.plotTop+i*(1-v/t);o.dailyGoal&&(this.renderer.path(["M",this.plotLeft,a,"L",this.plotLeft+this.plotSizeX,a]).attr({stroke:e.goalColor,dashstyle:"2,1","stroke-width":2}).add(),h.drawBarToppers(this.series,function(e){return g(e)},this.renderer))}}},plotOptions:{column:{pointPadding:0,groupPadding:.01,borderWidth:0,shadow:!1}},xAxis:p.getXAxisOptions(e.hideDateString),yAxis:{max:e.maxY,gridLineColor:i.xAxis,minorGridLineColor:i.xAxis,labels:{align:"left",x:30,y:14,formatter:function(){return'<span class="yAxisLabel">'+(this.value?n.formatNumber(this.value,"#,##0.#"):"")+"</span>"}}},tooltip:{enabled:!1},series:m,legend:{enabled:!1}};t(u,e.width,e.height,Object.merge(y,a.chartMixin(function(){if(!this.date)return null;var t=new r(e.tooltipFormat);t.update(this.y);var i=$('<div class="graphTip">').append($('<div class="date">').text(l.localeFormat(this.date,"MMM dd")),$('<div class="details">').append(t.elements()));return this.y>=v&&i.addClass("goalMet"),i},function(e){return g(e)})))}var e=Object.merge({},c,e);e.date=e.date||new Date;var u=$("<div>").width(e.width).height(e.height),p=s(e.date,e.weeks,n.startDayOfWeek,e.leftPadding,e.rightPadding);p.getStartDate();return Function.join(o.loadDays.bind(o,e.series_name,p.getStartDate(),e.date,"DAILY"),o.loadSummary.bind(o,e.series_name,e.date),d),u}}),define("galileo/graph/week",["require","mootools","galileo/graph/weeks"],function(e){e("mootools");var t=e("galileo/graph/weeks");return function(e){var i={weeks:1,borderRadius:16,hideDateString:!0};return e=Object.merge({},i,e),t(e)}}),define("hbs!galileo/tile/template/weightGraph",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/weight","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,a,n){function s(e,t){var a,n,s,l="";return l+='\n<div class="graphContainer">\n    <header class="graphHeader">\n        <h3 class="period">',s={hash:{}},a=i.i18n,n=a?a.call(e,"past_month",s):h.call(e,"i18n","past_month",s),(n||0===n)&&(l+=n),l+='</h3>\n\n        <nav class="tabs">\n            <ul class="items">\n                <li class="item"><a class="tab" href="#weight">',s={hash:{}},a=i.i18n,n=a?a.call(e,"weight",s):h.call(e,"i18n","weight",s),(n||0===n)&&(l+=n),l+='</a></li>\n                <li class="item"><a class="tab" href="#bodyFat">',s={hash:{}},a=i.i18n,n=a?a.call(e,"lean_vs_fat",s):h.call(e,"i18n","lean_vs_fat",s),(n||0===n)&&(l+=n),l+='</a></li>\n                <li class="item"><a class="tab" href="#bmi">',s={hash:{}},a=i.i18n,n=a?a.call(e,"bmi",s):h.call(e,"i18n","bmi",s),(n||0===n)&&(l+=n),l+='</a></li>\n            </ul>\n        </nav>\n    </header>\n\n    <div class="chart"></div>\n    <div class="legendContainer"></div>\n</div>\n'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var l,o,r,h=i.helperMissing,c=this;return r={hash:{},inverse:c.noop,fn:c.program(1,s,n)},l=i["i18n-namespace"],o=l?l.call(t,"com.fitbit.app.ngd.weight",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.weight",r),o||0===o?o:""});return e.registerPartial("galileo_tile_template_weightGraph",t),t}),define("galileo/graph/weight",["require","./base","./tooltip","hbs!../tile/template/chartLegend","hbs!../tile/template/weightGraph","galileo/ajax/ajax","galileo/model/user","i18n/i18n","galileo/color/graph","./graphUtil","galileo/util/dateUtil","i18n-load!com/fitbit/app/ngd/weight"],function(e){function t(e){var t=e,i=x.fn.hex2rgba(e,C);return{type:"areaspline",color:t,fillColor:i,lineWidth:4,marker:{fillColor:x.weightGraph.marker,lineColor:null,lineWidth:3,radius:5,states:{hover:{lineColor:x.weightGraph.marker,fillColor:t,lineWidth:3,radius:10}}},shadow:!1}}function i(e){return $.extend(!0,{gridLineColor:"rgba(0, 0, 0, .05)",gridLineWidth:1,lineColor:"rgba(0, 0, 0, .10)",lineWidth:2,tickPositioner:function(){var e=this.min,t=this.max;return[Math.floor(e),Math.round((e+t)/2),Math.ceil(t)]},labels:{x:50,y:15,style:{color:x.labelText,fontSize:12,fontFamily:'"Proxima Nova Regular", sans-serif'},formatter:function(){return this.isFirst?null:w.formatNumber(this.value,"#,##0.##")}}},e)}function a(e){var a=T(new Date,4,w.startDayOfWeek);return Object.merge({chart:{type:"areaspline",marginBottom:50,spacingRight:0,spacingLeft:0},tooltip:{enabled:!1},plotOptions:{series:t(x.weightGraph.weight)},series:[{name:"weight",data:a.modifySeries(e,{useDateForOffset:!0})}],xAxis:a.getXAxisOptions(),yAxis:i()},m.chartMixin(function(){return $('<div class="graphTip">').append($('<div class="date">').text(k.localeFormat(this.date,"MMM dd")),$('<div class="details">').text(w.unitsString(this.y,!1,1)))}))}function n(e,a){var n=x.bmi[a.bodyCondition],s=T(new Date,4,w.startDayOfWeek),l=e.map(Function.takeKey("y"));l.sort(function(e,t){return e-t});var o=.9*l[0],r=1.05*l.getLast();return Object.merge({chart:{type:"areaspline",alignTicks:!1,marginBottom:50,spacingRight:0,spacingLeft:0},tooltip:{enabled:!1},plotOptions:{series:t(n)},series:[{name:"bmi",data:s.modifySeries(e,{useDateForOffset:!0})}],xAxis:s.getXAxisOptions(),yAxis:i({min:o,max:r})},m.chartMixin(function(){var e,t;return this.y<18.5?(e="under",t=_("under")):this.y<=25?(e="normal",t=_("normal")):this.y<=30?(e="over",t=_("over")):(e="obese",t=_("obese")),$('<div class="graphTip">').append($('<div class="date">').text(k.localeFormat(this.date,"MMM dd")),$('<div class="details">').append(w.formatNumber(this.y,"#,###.0")+" ",$('<span class="bmiZone"/>').addClass(e).text(t)))}))}function s(){var e,t,i,a=function(e){i=e},n=function(i){var a,n=m.chartEvents(i),s=!1,l=function(){if(s)return!1;if(this.x!==t){n.mouseOut.call(this),t=this.x;var i=this.x,l=e.filter(function(e){return e.x===i})[0];return a={plotX:l.plotX,plotY:l.plotY,series:this.points[0].series,date:this.points[0].point.date,x:this.x},n.mouseOver.call(a),!1}},o=function(){s=!0,n.mouseOut.call(this)},r=function(){s=!1,a&&n.mouseOver.call(a)};return{showTooltip:l,mouseOut:o,mouseOver:r}},s=function(t){e=t};return{setWeightSeries:s,tooltipFormatter:n,setContainer:a}}function l(e,a){var n=T(new Date,4,w.startDayOfWeek),l=n.modifySeries(e,{useDateForOffset:!0}),o=n.modifySeries(a,{useDateForOffset:!0}),r=s(l),h=r.tooltipFormatter(function(){var e=this.x,t=l.filter(function(t){return t.x===e})[0],i=o.filter(function(t){return t.x===e})[0],a=$('<div class="graphTip">').append($('<div class="date">').text(k.localeFormat(this.date,"MMM dd")),$('<div class="details">').text(w.unitsString(t.y,!1,1)));return i&&a.append($('<div class="details">').text(_("lean_mass")+" "+w.unitsString(i.y,!1,1))),a}),c={chart:{type:"areaspline",marginBottom:50,spacingRight:0,spacingLeft:0},plotOptions:{series:{events:{mouseOut:h.mouseOut,mouseOver:h.mouseOver}}},tooltip:{crosshairs:!0,enabled:!0,shared:!0,formatter:h.showTooltip},series:[Object.merge({name:"weight",data:l},t(x.weightGraph.weight)),Object.merge({name:"lean",data:o,marker:{enabled:!0,states:{hover:{enabled:!0}}}},t(x.weightGraph.lean))],xAxis:n.getXAxisOptions(),yAxis:i()};return{chartOpts:c,setWeightSeries:r.setWeightSeries}}function o(e,t,i){if(!(t.data.length<1)){var a=t.data[t.data.length-1];t.data.map(function(e){e.update({marker:{enabled:!1}},!0,!1)}),a.update({marker:{enabled:!0}},!0,!1),a.update({marker:{radius:8,fillColor:i}},!0,!0),e.hover(function(){t.data.map(function(e){e.update({marker:{enabled:!0}},!1,!1)});var e=t.data.getLast();e.update({marker:{radius:5}},!0,!0)},function(){t.data.map(function(e){e.update({marker:{enabled:!1}},!0,!1)});var e=t.data.getLast();e.update({marker:{enabled:!0}},!0,!1),e.update({marker:{radius:8,fillColor:i}},!0,!0)})}}function r(e,t,i){i=i||new Date,b.getRaw("/graph/getNewGraphData",{type:"weight",dateFrom:k.ajaxEncode(k.minusDays(i,30)),dateTo:k.ajaxEncode(i)},function(i){var n,s=[];i.graph.dataSets.weight.dataPoints&&(s=i.graph.dataSets.weight.dataPoints.map(u),n=i.graph.goal,d(s));var l=f(e,S,M,a(s)),r=s.map(Function.takeKey("y"));n&&r.push(Number(n)),r.sort(function(e,t){return e-t}),l.yAxis[0].setExtremes(.9*r[0],1.05*r.getLast(),!0),o(e,l.series[0],x.weightGraph.weight),n?(t.html(v({legendList:[{"class":"weightGoal",name:_("weight_goal")+": "+w.unitsString(n,!1,1)}]})),l.yAxis[0].addPlotLine({id:"weight-goal",label:{align:"left",style:{paddingTop:"10px",paddingBottom:"10px",font:"bold 12px helvetica, sans-serif",color:"rgb(153, 153, 153)"},x:10,y:20},color:x.goal_line,width:2,dashStyle:"ShortDot",value:n,zIndex:50})):t.empty()})}function h(e,t,i){i=i||new Date;var a=k.minusDays(i,1);a=k.minusDays(a,a.getDay()-1);var s=w.activities().loadWeightSummary.bind(null,i),l=b.getRaw.bind(null,"/graph/getNewGraphData",{type:"bmi",dateFrom:k.ajaxEncode(k.minusWeeks(a,3)),dateTo:k.ajaxEncode(i)});Function.join(l,s,function(i,a){var s=[];i.graph.dataSets.bmi.dataPoints&&(s=i.graph.dataSets.bmi.dataPoints.map(u),d(s));var l=f(e,S,M,n(s,a));o(e,l.series[0],x.bmi[a.bodyCondition]),t.html(v({legendList:[{"class":"under",name:_("under")},{"class":"normal",name:_("normal")},{"class":"over",name:_("over")},{"class":"obese",name:_("obese")}]})),i.graph.dataSets.bmi.dataPoints&&c(l,a.bmi)})}function c(e){var t=10,i=S-t,a=e.yAxis[0].getExtremes(),n=a.min,s=a.max,l=[n,18.5,25,30,s],o=l.map(function(t){return e.yAxis[0].translate(s)-e.yAxis[0].translate(t.limit(n,s))});o.group(2).zipWith([x.bmi.under,x.bmi.normal,x.bmi.over,x.bmi.obese],function(a,n){e.renderer.rect(i,e.plotTop+a[1],t,a[0]-a[1]).attr({fill:n,zIndex:3}).add()})}function d(e){var t=e[e.length-1],i=e[e.length-2];t.x.getTime()>(new Date).getTime()&&(i.x.getTime()<(new Date).getTime()?t.x=new Date:e.pop())}function u(e){return{x:k.ajaxDecode(e.dateTime),y:Number(e.value)}}function p(e,t,i){i=i||new Date,b.getRaw("/graph/getNewGraphData",{type:"bodyComp",dateFrom:k.ajaxEncode(k.minusDays(i,30)),dateTo:k.ajaxEncode(i)},function(i){var a=[],n=[];i.graph.dataSets.weight.dataPoints&&(a=i.graph.dataSets.weight.dataPoints.map(u),d(a)),i.graph.dataSets.leanMass.dataPoints&&(n=i.graph.dataSets.leanMass.dataPoints.map(u),d(n));var s=l(a,n),o=s.chartOpts,r=f(e,S,M,o);s.setWeightSeries(r.series[0].data);var h=a.concat(n).map(Function.takeKey("y"));h.sort(function(e,t){return e-t}),r.yAxis[0].setExtremes(.9*h[0],1.05*h.getLast(),!0),i.graph&&i.graph.bodyFatGoal&&i.graph.dataSets.weight.dataPoints&&g(r,i.graph.currentWeight,i.graph.currentBodyFat/100,i.graph.bodyFatGoal/100),t.html(v({legendList:[{"class":"bodyFat",name:_("body_fat")},{"class":"leanMass",name:_("lean_mass")}]}))})}function g(e,t,i,a){var n=t*(1-i),s=n/(1-a),l=10,o=S-l,r=e.yAxis[0].getExtremes(),h=r.min,c=r.max,d=[h,n,s,c].map(function(t){return e.yAxis[0].translate(c)-e.yAxis[0].translate(t.limit(h,c))});d.group(2).zipWith(["#4cbfbf","#9c3","#f7f7f7"],function(t,i){e.renderer.rect(o,e.plotTop+t[1],l,t[0]-t[1]).attr({fill:i,zIndex:3}).add()})}var f=e("./base"),m=e("./tooltip"),v=e("hbs!../tile/template/chartLegend"),y=e("hbs!../tile/template/weightGraph"),b=e("galileo/ajax/ajax"),w=e("galileo/model/user").viewer,_=e("i18n/i18n")(),x=e("galileo/color/graph"),T=e("./graphUtil"),k=e("galileo/util/dateUtil");_.namespace(e("i18n-load!com/fitbit/app/ngd/weight"));var S=560,M=230,C=.23;return function(e){var t,i,a,n,s=this,l=$(y()),o={weight:r,bodyFat:p,bmi:h};return t=l.find(".chart"),i=l.find(".legendContainer"),a=l.find(".tabs"),n=a.find(".tab").first(),a.on("click",".tab",function(a){a.preventDefault();var l=$(this),r=l.prop("hash").slice(1),h=o[r];n.removeClass("selected"),l.addClass("selected"),n=l,h.call(s,t,i,e)}),n.click(),l}}),define("hbs!galileo/tile/template/goalText",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/goal","galileo/tile/template/helpers/domPlaceholder","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,a,n){function s(e,t){var a,n,s,l="";return l+='\n<div class="metricContainer absoluteContainer">\n    ',s={hash:{}},l+=c((a=i.domPlaceholder,a?a.call(e,"dayTotal",s):h.call(e,"domPlaceholder","dayTotal",s)))+"\n    ",s={hash:{}},l+=c((a=i.domPlaceholder,a?a.call(e,"dailyGoal",s):h.call(e,"domPlaceholder","dailyGoal",s)))+'\n    <div class="praise"></div>\n</div>\n<div class="metricContainer percentContainer">\n    ',s={hash:{}},l+=c((a=i.domPlaceholder,a?a.call(e,"percentOfGoal",s):h.call(e,"domPlaceholder","percentOfGoal",s)))+'\n    <span class="goalTarget">',s={hash:{}},a=i.i18n,n=a?a.call(e,"of_goal_of",s):h.call(e,"i18n","of_goal_of",s),(n||0===n)&&(l+=n),l+="</span>\n    ",s={hash:{}},l+=c((a=i.domPlaceholder,a?a.call(e,"dailyGoal",s):h.call(e,"domPlaceholder","dailyGoal",s)))+"\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var l,o,r,h=i.helperMissing,c=this.escapeExpression,d=this;return r={hash:{},inverse:d.noop,fn:d.program(1,s,n)},l=i["i18n-namespace"],o=l?l.call(t,"com.fitbit.app.ngd.goal",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.goal",r),o||0===o?o:""});return e.registerPartial("galileo_tile_template_goalText",t),t}),define("hbs!galileo/tile/template/goal",["handlebars","hbs!galileo/tile/template/goalText"],function(e){var t=e.template(function(e,t,i,a,n){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||e.partials;var s,l="",o=this;return l+='<div class="goal">\n    <div class="meter"></div>\n    <div class="icon-glyph">\n        <i class="fitglyph size-c"></i>\n    </div>\n\n    <div class="metricText">\n        ',s=o.invokePartial(a.galileo_tile_template_goalText,"galileo_tile_template_goalText",t,i,a),(s||0===s)&&(l+=s),l+="\n    </div>\n</div>\n"});return e.registerPartial("galileo_tile_template_goal",t),t}),define("galileo/tile/element/goal/smiley",["require","jquery","mootools"],function(e){var t=e("jquery");e("mootools");var i=new Class({Implements:[Events,Options],options:{template:void 0},initialize:function(e,t){this.setup(e,t)},setup:function(e,i){return this.root=e=t(e),this.setOptions(i),this.setupElement(),this},setupElement:function(){var e=this.options.template;return this.element=t(e()),this}});return i.SpeechBalloon=new Class({Implements:[Events,Options],options:{template:void 0,offset:{left:0,top:0},appendTo:document.body,animationOpts:{duration:1e3}},running:!1,initialize:function(e,t){this.setup(e,t)},setup:function(e,i){return this.root=e=t(e),this.setOptions(i),this.setupElement(),this},setupElement:function(){var e=this.options.template;return this.element=t(e()),this},getPosition:function(e,t){var i=e.offset();return t=t||{left:0,top:0},Object.map(i,function(e,i){return e+t[i]})},animate:function(e,t,i){if(!this.running){this.running=!0;var a=this,n=this.getPosition(this.root,this.options.offset),s=this.element;t=Object.merge({},t,this.options.animationOpts);var l=t.complete;t.complete=function(){a.running=!1,l&&l(),i&&i(),a.fireEvent("animationComplete")},s.css(n),s.appendTo(this.options.appendTo),s.animate(e,t)}}}),i}),define("hbs!galileo/tile/template/goalSmiley",["handlebars"],function(e){var t=e.template(function(e,t,i,a,n){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="goalSmiley animate">\n    <div class="head">\n        <div class="eye_left"></div>\n        <div class="eye_right"></div>\n        <div class="mouth"></div>\n    </div>\n</div>'});return e.registerPartial("galileo_tile_template_goalSmiley",t),t}),define("hbs!galileo/tile/template/smileySpeechBalloon",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/goal","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,a,n){function s(e,t){var a,n,s,l="";return l+='\n<div class="smileySpeechBalloon animate">\n    <p class="speech">',s={hash:{}},a=i.i18n,n=a?a.call(e,"smiley_cheer",s):h.call(e,"i18n","smiley_cheer",s),(n||0===n)&&(l+=n),l+="</p>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var l,o,r,h=i.helperMissing,c=this;return r={hash:{},inverse:c.noop,fn:c.program(1,s,n)},l=i["i18n-namespace"],o=l?l.call(t,"com.fitbit.app.ngd.goal",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.goal",r),o||0===o?o:""});return e.registerPartial("galileo_tile_template_smileySpeechBalloon",t),t}),define("galileo/tile/element/goal/goal",["require","jquery","mootools","galileo/prototype/all","i18n/i18n","galileo/tile/element/goal/base","galileo/graphic/goalBar","galileo/widget/metric","hbs!galileo/tile/template/goal","galileo/tile/template/helpers/domPlaceholder","galileo/tile/element/goal/smiley","hbs!galileo/tile/template/goalSmiley","hbs!galileo/tile/template/smileySpeechBalloon","galileo/color/graph","i18n-load!com/fitbit/app/unit","i18n-load!com/fitbit/app/ngd/goal"],function(e){e("jquery"),e("mootools"),e("galileo/prototype/all");var t=e("i18n/i18n")(),i=e("galileo/tile/element/goal/base"),a=e("galileo/graphic/goalBar"),n=e("galileo/widget/metric"),s=e("hbs!galileo/tile/template/goal"),l=e("galileo/tile/template/helpers/domPlaceholder"),o=e("galileo/tile/element/goal/smiley"),r=e("hbs!galileo/tile/template/goalSmiley"),h=e("hbs!galileo/tile/template/smileySpeechBalloon"),c=e("galileo/color/graph");t.namespace(e("i18n-load!com/fitbit/app/unit")),t.namespace(e("i18n-load!com/fitbit/app/ngd/goal"));var d=new Class({Extends:i,options:{metricFormats:{percentOfGoal:[{unitKey:"",unitThreshold:1/0,format:"#,##0%"}],dayTotal:[{unitKey:"",unitThreshold:1/0,format:"#,##0"}],dailyGoal:[{unitKey:"",unitThreshold:1/0,format:"#,##0"}]},goalStates:[{range:[-(1/0),0],praiseText:"",goalColors:c.progresCircleColors.inactive},{range:[0,.33],praiseText:"",goalColors:c.progresCircleColors.levelOne},{range:[.33,.66],praiseText:"",goalColors:c.progresCircleColors.levelTwo},{range:[.66,1],praiseText:"",goalColors:c.progresCircleColors.levelThree},{range:[1,1/0],praiseText:t("champ"),goalColors:c.progresCircleColors.levelFour}]},initialize:function(e,t){this.parent(e,t),this.metricFormats=this.options.metricFormats,this.createElements().appendTo(this.element),this.attachEvents()},attachEvents:function(){return this.addEvent("animationProgress",this.render.bind(this)),this},createElements:function(){if(this.container)return this.container;var e=this;return this.dayTotal=new n(this.metricFormats.dayTotal),this.dayTotal.container.addClass("metricLarge"),this.dailyGoal=new n(this.metricFormats.dailyGoal),this.percentOfGoal=new n(this.metricFormats.percentOfGoal),this.percentOfGoal.container.addClass("metricLarge"),this.container=l(s,{dayTotal:this.dayTotal.elements(),dailyGoal:this.dailyGoal.elements(),percentOfGoal:this.percentOfGoal.elements()}),this.absoluteContainer=this.container.find(".absoluteContainer"),this.percentContainer=this.container.find(".percentContainer"),this.praise=this.container.find(".praise"),this.meter=this.container.find(".meter"),this.metricText=this.container.find(".metricText"),this.percentContainer.hide(),this.element.on("mouseover",function(){e.absoluteContainer.hide(),e.percentContainer.show()}),this.element.on("mouseout",function(){e.absoluteContainer.show(),e.percentContainer.hide()}),this.container},renderInit:function(e,t){e?this.animate():this.render(1)},render:function(e){this.updateProgressBar(e),this.updateIcon(e),this.updateText(e)},animate:function(){if(null!==this.goalData&&"undefined"!=typeof this.goalData.dailyGoal&&"undefined"!=typeof this.goalData.dayTotal){this.startProgressAnimation(500);var e=this.goalData.dayTotal/this.goalData.dailyGoal;e>=1&&this.showSmiley.bind(this).delay(500)}},showSmiley:function(){if(Array.some(this.container,function(e){return $.contains(document.body,e)})){var e=new o(this.container,{template:r});e.element.appendTo(this.container),function(){var t=new o.SpeechBalloon(e.element,{template:h,offset:{top:-61,left:156},onAnimationComplete:function(){this.element.remove()}}),i=t.getPosition(e.root,{top:-161,left:256});t.animate(i)}.delay(1200),function(){e.element.removeClass("animate").addClass("reverse"),function(){e.element.remove()}.delay(500)}.delay(2700)}},updateProgressBar:function(e){if(null!==this.goalData&&"undefined"!=typeof this.goalData.dailyGoal&&"undefined"!=typeof this.goalData.dayTotal){var t=this.goalData.dayTotal/this.goalData.dailyGoal||0;this.progressBar||(this.progressBar=this.renderGraphic(this.meter[0],this.meter.width())),this.progressBar.setProgress(t*e),this.progressBar.setColors(this.getGoalState(t).goalColors)}},updateText:function(e){if(null!==this.goalData&&"undefined"!=typeof this.goalData.dailyGoal&&"undefined"!=typeof this.goalData.dayTotal){var t=e*this.goalData.dayTotal;this.dayTotal.update(e*this.goalData.dayTotal),this.percentOfGoal.update(t/this.goalData.dailyGoal)}},updateIcon:function(e){if(null!==this.goalData&&"undefined"!=typeof this.goalData.dailyGoal&&"undefined"!=typeof this.goalData.dayTotal){var t=this.goalData.dayTotal/this.goalData.dailyGoal||0;this.praise.text(this.getGoalState(t).praiseText)}},setGoalData:function(e){this.goalData=e,null!==e&&this.dailyGoal.update(e.dailyGoal)},resetCustomText:function(e){this.metricText.empty(),this.metricText.append(this.absoluteContainer,this.percentContainer)},setCustomText:function(e){this.absoluteContainer.detach(),this.percentContainer.detach(),this.metricText.text(e)},renderGraphic:function(e,t){return new a.Arc(e,{width:t,height:t,radius:t/2-a.Arc.STROKE_WIDTH/2})}});return d}),define("galileo/graphic/waterCups",["require","jquery"],function(e){var t=e("jquery"),i={91:"cups",128:"fl_oz",209:"ml"},a={cups:1,fl_oz:8,
ml:236.588};return{valueAsCups:function(e,t){return"number"==typeof t&&(t=i[t]),e/a[t||"cups"]},getGoalPercentage:function(e,t){return Math.min(e/t*100,100)+"%"},getGoalMarkers:function(e,i,a,n,s){var l=this.valueAsCups(i,a),s=s||1,o=l/s,r=this.valueAsCups(e,a),h=o/(n.length-1);return t.map(new Array(s),function(){var e=Math.min(o,r),t=Math.floor(e/h);return 0===t&&e>0&&(t=1),r-=e,n[t]})}}}),define("galileo/graphic/point",["require","mootools"],function(e){e("mootools");var t=new Class({initialize:function(){this._x=null,this._y=null,this._theta=null,this._rho=null,this._center=null},_resetXY:function(){this._x=null,this._y=null},_resetPolar:function(){this._rho=null,this._theta=null},theta:function(e){return void 0!==e&&this.setTheta(e),this.getTheta()},rho:function(e){return void 0!==e&&this.setRho(e),this.getRho()},x:function(e){return void 0!==e&&this.setX(e),this.getX()},y:function(e){return void 0!==e&&this.setY(e),this.getY()},addXY:function(e,t){return this.setX(this.getX()+e),this.setY(this.getY()+t),this},addPol:function(e,t){return this.rho(this.rho()+e),this.theta(this.theta()+t),this},setXY:function(e,t){this.setX(e),this.setY(t)},setPolar:function(e,t){this.setRho(e),this.setTheta(t)},setX:function(e){this._x=e,this._y=this.getY(),this._resetPolar()},setY:function(e){this._y=e,this._x=this.getX(),this._resetPolar()},setRho:function(e){this._rho=e,this._theta=this.getTheta(),this._resetXY()},setTheta:function(e){this._theta=e,this._rho=this.getRho(),this._resetXY()},getX:function(){return null===this._x&&null!==this._rho&&null!==this._theta&&(this._x=this._rho*Math.cos(this._theta)),this._x},getY:function(){return null===this._y&&null!==this._rho&&null!==this._theta&&(this._y=this._rho*Math.sin(this._theta)),this._y},getRho:function(){return null===this._rho&&null!==this._x&&null!==this._y&&(this._rho=Math.sqrt(Math.pow(this._x,2)+Math.pow(this._y,2))),this._rho},getTheta:function(){return null===this._theta&&null!==this._x&&null!==this._y&&(this._theta=Math.atan2(this._y,this._x)),this._theta},move:function(e){return this.setX(this.getX()+e.getX()),this.setY(this.getY()+e.getY()),this},moveTo:function(e){return this.setX(e.getX()),this.setY(e.getY()),this}});return t.pol=function(e,i){var a=new t;return a.setPolar(e,i),a},t.xy=function(e,i){var a=new t;return a.setXY(e,i),a},t.addPol=function(e,i,a){var n=new t;return n.rho(e.rho()+i),n.theta(e.theta()+a),n},t.add=function(e,i){var a=new t;return a.setX(e.getX()+i.getX()),a.setY(e.getY()+i.getY()),a},t.subtract=function(e,i){var a=new t;return a.setX(e.getX()-i.getX()),a.setY(e.getY()-i.getY()),a},t}),define("galileo/graphic/path",["require","mootools","./point"],function(e){e("mootools");var t=e("./point"),i=new Class({paths:[],cursor:t.xy(0,0),initialize:function(){this.origin=t.xy(0,0)},_setCursor:function(e){this.cursor=t.xy(e.x(),e.y())},setOrigin:function(e){return this.origin=e,this},getOrigin:function(){return this.origin},addToPath:function(e){this.paths.push(e)},getPathArray:function(){var e=$.map(this.paths,function(e){return e});return e},arc:function(e,i,a){var n=t.subtract(this.cursor,i),s=t.subtract(e,i),l=s.theta()-n.theta();if(!a&&0>l?l+=2*Math.PI:a&&l>0&&(l-=2*Math.PI),Math.abs(l)-1e-6>Math.PI/2){var o=t.pol(n.rho(),n.theta()+l/2),r=t.pol(n.rho(),n.theta()+l);return this.arc(t.add(o,i),i,a),this.arc(t.add(r,i),i,a)}var h=Math.cos(l/2),c=Math.sin(l/2),d=h,u=-c,p=(4-h)/3,g=(1-h)*(3-h)/(3*c),f=p,m=-g,v=[t.xy(d,u),t.xy(f,m),t.xy(p,g),t.xy(h,c)];v=$.map(v,function(e){return t.xy(e.x()*n.rho(),e.y()*n.rho())}),v=$.map(v,function(e){return t.pol(e.rho(),e.theta()+n.theta()+l/2)}),v=$.map(v,function(e){return t.add(e,i)}),this._setCursor(v[3]);var y=this;return v=$.map(v,function(e){return t.add(e,y.getOrigin())}),this.addToPath(["C",v[1].x(),v[1].y(),v[2].x(),v[2].y(),v[3].x(),v[3].y()]),this},bezier:function(e,t,i){return this.addToPath(["C",e.x(),e.y(),t.x(),t.y(),i.x(),i.y()]),this},move:function(e){var i=(e.x(),e.y(),t.add(e,this.getOrigin()));return this.addToPath(["M",i.x(),i.y()]),this._setCursor(e),this},line:function(e){return this._setCursor(e),e=t.add(e,this.getOrigin()),this.addToPath(["L",e.x(),e.y()]),this},corner:function(e,i){var a=e.x()-this.cursor.x(),n=e.y()-this.cursor.y(),s=a>0^n>0;s^=i;var l=new t;return l.x(s?e.x():this.cursor.x()),l.y(s?this.cursor.y():e.y()),this.arc(e,l,i)}});return i}),define("galileo/graphic/calZoneArc",["require","mootools","highcharts","./path","./point","./base","galileo/color/graph"],function(e){e("mootools");var t=(e("highcharts"),e("./path")),i=e("./point"),a=e("./base"),n=e("galileo/color/graph").calZone,s={arcWidth:"3px",arcFocusWidth:"18px"},l={arc:[n.under,n.onTrack,n.over],needle:n.needle,needleCenter:n.needleCenter},o=new Class({Extends:a,initialize:function(e,t){this.parent(e,t),this.focusSegment=this.options.focusSegment||0,this.innerRadius=this.options.innerRadius||80,this.arcCenter=this.options.arcCenter||{x:125,y:100},this.startLabel=this.options.startLabel,this.endLabel=this.options.endLabel,this.segments=[];this.paths=[],$.merge(this.paths,this.getSegments()),this.needle=this.getNeedle(),$.merge(this.paths,this.needle),this.render()},getSegments:function(){var e,a,n,o=this.innerRadius,r=this.focusSegment,h=this.arcCenter.x,c=this.arcCenter.y,d=this;return e=function(e){return function(){var a=i,n=a.pol(o,e);return(new t).setOrigin(a.xy(h,c)).move(n).arc(n.addPol(0,Math.PI/3),a.xy(0,0))}},a=[e(-Math.PI),e(-2/3*Math.PI),e(-1/3*Math.PI)],a=a.map(function(e,t){return{fun:e,focus:t===r,color:l.arc[t]}}),n=a.splice(r,1),a=a.concat(n),$.map(a,function(e){return{attrs:function(){return{d:e.fun().getPathArray(),stroke:e.color,"stroke-width":e.focus?s.arcFocusWidth:s.arcWidth,"stroke-linecap":e.focus?"round":"butt"}},el:d.paper.path().add()}}.bind(this))},getNeedle:function(){var e=this,t=this.arcCenter.x,i=this.arcCenter.y,a=function(a,n,s){return{attrs:function(a){var s=180*(Math.PI*(e.position+1/6)-Math.PI/3*Math.pow(Math.E,-.0035*a*2e3)*Math.cos(.02*a*2e3))/Math.PI;return{transform:"rotate("+s+" "+t+" "+i+")",fill:n}},el:a}};return[a(this.paper.circle(t,i,5).add(),l.needleCenter),a(this.paper.arc(t,i,10,7,0,2*Math.PI).add(),l.needle),a(this.paper.rect(t-73-10,i,74,2).add(),l.needle),a(this.paper.rect(t+10,i-3,6,6).add(),l.needle)]},render:function(){var e=this;$.each(this.paths,function(t,i){if(i.attrs){var a=i.attrs(e.percent);i.el.attr(a)}i.css&&i.el.css(i.css(e.percent))})},setProgress:function(e){return this.parent(e),this.render(),this},setPosition:function(e){return this.position=e,this}});return o}),define("hbs!galileo/tile/template/calZoneGoal",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/calzone","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,a,n){function s(e,t){var a,n,s,l="";return l+='\n<div class="goal ',(a=i.displayType)?a=a.call(e,{hash:{}}):(a=e.displayType,a=typeof a===h?a.apply(e):a),l+=c(a)+'">\n    <div class="goalBar" >\n        <div class="meter"></div>\n        <div class="status js_status">\n            <div class="zoneUnder">\n                ',s={hash:{}},a=i.i18n,n=a?a.call(e,"zone_under",s):d.call(e,"i18n","zone_under",s),(n||0===n)&&(l+=n),l+='\n            </div>\n            <div class="zoneIn">\n                ',s={hash:{}},a=i.i18n,n=a?a.call(e,"zone_in",s):d.call(e,"i18n","zone_in",s),(n||0===n)&&(l+=n),l+='\n            </div>\n            <div class="zoneOver">\n                ',s={hash:{}},a=i.i18n,n=a?a.call(e,"zone_over",s):d.call(e,"i18n","zone_over",s),(n||0===n)&&(l+=n),l+='\n            </div>\n        </div>\n        <div class="inOutCaption">\n            <span class="inCals" >\n                <span class="js_inCalsValue">\n                </span>\n            </span>\n            <span class="vs" >\n                ',s={hash:{}},a=i.i18n,n=a?a.call(e,"vs",s):d.call(e,"i18n","vs",s),(n||0===n)&&(l+=n),l+='\n            </span>\n            <span class="outCals" >\n                <span class="js_outCalsValue">\n                </span>\n\n            </span>\n        </div>\n    </div>\n    <div class="goalSetup" >\n        <div class="heading">\n            ',s={hash:{}},a=i.i18n,n=a?a.call(e,"cals_in_out",s):d.call(e,"i18n","cals_in_out",s),(n||0===n)&&(l+=n),l+='\n        </div>\n        <div class="description">\n            <div class="title">\n                ',s={hash:{}},a=i.i18n,n=a?a.call(e,"are_you_in",s):d.call(e,"i18n","are_you_in",s),(n||0===n)&&(l+=n),l+='\n            </div>\n            <div class="desc">\n                ',s={hash:{}},a=i.i18n,n=a?a.call(e,"plan_desc",s):d.call(e,"i18n","plan_desc",s),(n||0===n)&&(l+=n),l+='\n            </div>\n        </div>\n    </div>\n</div>\n<ul class="choice">\n    <li><a class="js_startPlan" href="#">',s={hash:{}},a=i.i18n,n=a?a.call(e,"start_plan",s):d.call(e,"i18n","start_plan",s),(n||0===n)&&(l+=n),l+='</a></li>\n    <li><a class="removeEmptyTile" href="#">',s={hash:{}},a=i.i18n,n=a?a.call(e,"no_thanks",s):d.call(e,"i18n","no_thanks",s),(n||0===n)&&(l+=n),l+="</a></li>\n</ul>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var l,o,r,h="function",c=this.escapeExpression,d=i.helperMissing,u=this;return r={hash:{},inverse:u.noop,fn:u.program(1,s,n)},l=i["i18n-namespace"],o=l?l.call(t,"com.fitbit.app.ngd.calzone",r):d.call(t,"i18n-namespace","com.fitbit.app.ngd.calzone",r),o||0===o?o:""});return e.registerPartial("galileo_tile_template_calZoneGoal",t),t}),define("galileo/tile/element/goal/calZoneGoal",["require","galileo/tile/element/goal/base","galileo/model/user","galileo/graphic/calZoneArc","hbs!../../template/calZoneGoal"],function(e){var t=e("galileo/tile/element/goal/base"),i=e("galileo/model/user").viewer,a=e("galileo/graphic/calZoneArc"),n=new Class({Extends:t,initialize:function(e,t){this.parent(e),this.settingsCallback=t},renderInit:function(t,i,a){var n=this;this.goalContainer=$(e("hbs!../../template/calZoneGoal")({})),this.goalContainer.appendTo(this.element),this.inValue=this.goalContainer.find(".js_inCalsValue"),this.outValue=this.goalContainer.find(".js_outCalsValue"),this.startPlanLink=this.goalContainer.find(".js_startPlan"),this.goalContainer.find("a").on("mousedown",function(e){e.stopPropagation()}),this.startPlanLink.on("click",function(e){e.preventDefault(),n.settingsCallback()})},showGoalSetup:function(e){this.goalContainer.removeClass("showGoalBar"),this.goalContainer.addClass("showGoalSetup")},showGoalBar:function(e){this.goalContainer.addClass("showGoalBar"),this.goalContainer.removeClass("showGoalSetup"),e?this.animate():this._renderGoalBar(1)},_renderGoalBar:function(e){var t={UNDER:0,ONTRACK:1,OVER:2};this.progressBar||(this.progressBar=this.renderGraphic(this.goalContainer.find(".meter")[0],this.goalContainer.width(),t[this.goalData.status])),this.progressBar.setPosition(t[this.goalData.status]/3),this.progressBar.setProgress(e)},animate:function(){this.removeEvents("animationProgress"),this.addEvent("animationProgress",function(e){this._renderGoalBar(e)}.bind(this)),this.startProgressAnimation(2e3)},update:function(e,t){this.goalData=e,e.status?this.showGoalBar(t):this.showGoalSetup(),this.setStatus()},setStatus:function(){var e=this.goalContainer.find(".js_status");this.inValue.text(i.formatNumber(this.goalData.inValue,"#,##0")),this.outValue.text(i.formatNumber(this.goalData.outValue,"#,##0")),e.removeClass("UNDER ONTRACK OVER"),e.addClass(this.goalData.status)},renderGraphic:function(e,t,i){return new a(e,{width:t,height:t,focusSegment:i})}});return n}),define("galileo/graphic/sleepClock",["require","highcharts","./path","./point","galileo/color/graph","galileo/util/dateUtil"],function(e){var t=e("highcharts"),i=e("./path"),a=e("./point"),n=e("galileo/color/graph").sleep.clock,s=e("galileo/util/dateUtil"),l=2*Math.PI,o=160,r=160,h=432e5,c=80,d=80,u=78,p=74,g=0,f=40,m=78,v=68,y=4,b=new Class({initialize:function(e){var t,i,a=[];this.sleepArcs=[],e&&(a=e.entries.sortBy(function(e){return s.ajaxDecode(e.startDateTime).getTime()}),t=s.ajaxDecode(a[0].startDateTime),i=s.ajaxDecode(a[a.length-1].endDateTime),i.getTime()-t.getTime()>=h?this.sleepArcs.push({startAngle:0,endAngle:l}):a.forEach(function(e){var t=e.endTime.split(":"),i=60*t[0]+Number(t[1]),a=e.sleepDuration,n=-.5*Math.PI+i*l/720,s=n-Math.min(1,a/720)*l,o={startAngle:s,endAngle:n};this.sleepArcs.push(o)},this))},render:function(){var e=$("<div>");this.renderer=new t.Renderer(e[0],o,r),this.renderer.arc(c,d,u,p,g,2*Math.PI).attr({fill:n.outerRing}).add(),this.sleepArcs.forEach(function(e){this.renderer.arc(c,d,u,f,e.startAngle,e.endAngle).attr({fill:{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,n.startGradient],[1,n.endGradient]]}}).add()},this);for(var i=0;12>i;i++)i%3!=0&&this.renderTick(c,d,m,v,i).attr({}).add();var a=62,s={fontSize:"16px",fontFamily:"Proxima Nova Bold"};return this.renderer.text("3",c+a,d+y).attr("fill",this.onSleep(3,n.text)).css(s).attr("text-anchor","middle").add(),this.renderer.text("6",c,d+a+y).attr("fill",this.onSleep(6,n.text)).css(s).attr("text-anchor","middle").add(),this.renderer.text("9",c-a,d+y).attr("fill",this.onSleep(9,n.text)).css(s).attr("text-anchor","middle").add(),this.renderer.text("12",c,d-a+y).attr("fill",this.onSleep(0,n.text)).css(s).attr("text-anchor","middle").add(),e},renderTick:function(e,t,s,o,r){var h=a.pol(o,r/12*l-.5*Math.PI),c=a.pol(s,r/12*l-.5*Math.PI),d=(new i).setOrigin(a.xy(e,t)).move(h).line(c);return this.renderer.path(d.getPathArray()).attr({strokeWidth:2,stroke:this.onSleep(r,n.ticks)})},onSleep:function(e,t){var i=e/12*l-.5*Math.PI,a=i-l,n=a-l,s=!1;return this.sleepArcs.forEach(function(e){(e.startAngle<i&&i<e.endAngle||e.startAngle<a&&a<e.endAngle||e.startAngle<n&&n<e.endAngle)&&(s=!0)},this),s?t[1]:t[0]}});return b}),define("galileo/tile/loadDependencies",["require","galileo/model/user","galileo/tile/modal/activeMinutes","galileo/tile/modal/calories","galileo/tile/modal/distance","galileo/tile/modal/floors","galileo/tile/modal/sleep","galileo/tile/modal/steps","galileo/tile/modal/weight","galileo/tile/modal/calZone","galileo/tile/modal/foodPlan","galileo/tile/modal/badges","galileo/tile/modal/trainer","highcharts","galileo/graph/activeMinutes","galileo/graph/caloriesBurnVsIntake","galileo/graph/intraday","galileo/graph/week","galileo/graph/weekBeta","galileo/graph/weight","./element/goal/goal","./element/goal/modal","galileo/graphic/waterCups","./element/goal/calZoneGoal","galileo/widget/carousel","galileo/graphic/sleepClock","galileo/graphic/foodPlanPlate"],function(e){var t=e("galileo/model/user");return e("galileo/tile/modal/activeMinutes"),e("galileo/tile/modal/calories"),e("galileo/tile/modal/distance"),e("galileo/tile/modal/floors"),e("galileo/tile/modal/sleep"),e("galileo/tile/modal/steps"),e("galileo/tile/modal/weight"),e("galileo/tile/modal/calZone"),e("galileo/tile/modal/foodPlan"),e("galileo/tile/modal/badges"),e("galileo/tile/modal/trainer"),{Highcharts:e("highcharts"),User:t,ActiveMinutes:e("galileo/graph/activeMinutes"),CaloriesBurnVsIntake:e("galileo/graph/caloriesBurnVsIntake"),Intraday:e("galileo/graph/intraday"),Week:e("galileo/graph/week"),WeekBeta:e("galileo/graph/weekBeta"),Weight:e("galileo/graph/weight"),Goal:e("./element/goal/goal"),Modal:e("./element/goal/modal"),waterCups:e("galileo/graphic/waterCups"),CalZoneGoal:e("./element/goal/calZoneGoal"),Carousel:e("galileo/widget/carousel"),SleepClock:e("galileo/graphic/sleepClock"),FoodPlanPlate:e("galileo/graphic/foodPlanPlate")}})}).call(window)}]);
//# sourceMappingURL=loadDependencies.js.7a58f7c858de191ffe5c0e6204602c23.js.map