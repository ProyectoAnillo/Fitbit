!function(e){function t(n){if(i[n])return i[n].exports;var a=i[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){e.exports=i(1)},function(e,t,n){(function(){/**
	 * @license 
	 * jQuery Tools @VERSION Tooltip - UI essentials
	 * 
	 * NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.
	 * 
	 * http://flowplayer.org/tools/tooltip/
	 *
	 * Since: November 2008
	 * Date: @DATE 
	 */
!function(e){function t(t,i,n){var a=n.relative?t.position().top:t.offset().top,s=n.relative?t.position().left:t.offset().left,o=n.position[0];a-=i.outerHeight()-n.offset[0],s+=t.outerWidth()+n.offset[1],/iPad/i.test(navigator.userAgent)&&(a-=e(window).scrollTop());var l=i.outerHeight()+t.outerHeight();"center"==o&&(a+=l/2),"bottom"==o&&(a+=l),o=n.position[1];var r=i.outerWidth()+t.outerWidth();return"center"==o&&(s-=r/2),"left"==o&&(s-=r),{top:a,left:s}}function i(i,a){var s,o,l=this,r=i.add(l),h=0,c=0,d=i.attr("title"),u=i.attr("data-tooltip"),p=n[a.effect],g=i.is(":input"),f=g&&i.is(":checkbox, :radio, select, :button, :submit"),m=i.attr("type"),v=a.events[m]||a.events[g?f?"widget":"input":"def"];if(!p)throw'Nonexistent effect "'+a.effect+'"';if(v=v.split(/,\s*/),2!=v.length)throw"Tooltip: bad events configuration for "+m;i.bind(v[0],function(e){clearTimeout(h),a.predelay?c=setTimeout(function(){l.show(e)},a.predelay):l.show(e)}).bind(v[1],function(e){clearTimeout(c),a.delay?h=setTimeout(function(){l.hide(e)},a.delay):l.hide(e)}),d&&a.cancelDefault&&(i.removeAttr("title"),i.data("title",d)),e.extend(l,{show:function(n){if(!s&&(u?s=e(u):a.tip?s=e(a.tip).eq(0):d?s=e(a.layout).addClass(a.tipClass).appendTo(document.body).hide().append(d):(s=i.next(),s.length||(s=i.parent().next())),!s.length))throw"Cannot find tooltip for "+i;if(l.isShown())return l;s.stop(!0,!0);var g=t(i,s,a);if(a.tip&&s.html(i.data("title")),n=n||e.Event(),n.type="onBeforeShow",r.trigger(n,[g]),n.isDefaultPrevented())return l;g=t(i,s,a),s.css({position:"absolute",top:g.top,left:g.left}),o=!0,p[0].call(l,function(){n.type="onShow",o="full",r.trigger(n)});var f=a.events.tooltip.split(/,\s*/);return s.data("__set")||(s.bind(f[0],function(){clearTimeout(h),clearTimeout(c)}),f[1]&&!i.is("input:not(:checkbox, :radio), textarea")&&s.bind(f[1],function(e){e.relatedTarget!=i[0]&&i.trigger(v[1].split(" ")[0])}),s.data("__set",!0)),l},hide:function(t){return s&&l.isShown()?(t=t||e.Event(),t.type="onBeforeHide",r.trigger(t),t.isDefaultPrevented()?void 0:(o=!1,n[a.effect][1].call(l,function(){t.type="onHide",r.trigger(t)}),l)):l},isShown:function(e){return e?"full"==o:o},getConf:function(){return a},getTip:function(){return s},getTrigger:function(){return i}}),e.each("onHide,onBeforeShow,onShow,onBeforeHide".split(","),function(t,i){e.isFunction(a[i])&&e(l).bind(i,a[i]),l[i]=function(t){return t&&e(l).bind(i,t),l}})}e.tools=e.tools||{version:"@VERSION"},e.tools.tooltip={conf:{effect:"toggle",fadeOutSpeed:"fast",predelay:0,delay:30,opacity:1,tip:0,position:["top","center"],offset:[0,0],relative:!1,cancelDefault:!0,events:{def:"mouseenter,mouseleave",input:"focus,blur",widget:"focus mouseenter,blur mouseleave",tooltip:"mouseenter,mouseleave"},layout:"<div/>",tipClass:"tooltip"},addEffect:function(e,t,i){n[e]=[t,i]}};var n={toggle:[function(e){var t=this.getConf(),i=this.getTip(),n=t.opacity;1>n&&i.css({opacity:n}),i.show(),e.call()},function(e){this.getTip().hide(),e.call()}],fade:[function(e){var t=this.getConf();this.getTip().fadeTo(t.fadeInSpeed,t.opacity,e)},function(e){this.getTip().fadeOut(this.getConf().fadeOutSpeed,e)}]};e.fn.tooltip=function(t){var n=this.data("tooltip");return n?n:(t=e.extend(!0,{},e.tools.tooltip.conf,t),"string"==typeof t.position&&(t.position=t.position.split(/,?\s/)),this.each(function(){n=new i(e(this),t),e(this).data("tooltip",n)}),t.api?n:this)}}(jQuery),define("jqtools-tooltip",function(){}),function(e){var t={init:function(){this.footerClickHandler(),e("#ftr_picker").tooltip(this.ttConfigFtr)},footerClickHandler:function(){e("#ftr_i18n_country_list").on("click","li",function(){var i=e(this).attr("data-country");t.switchLocale(i)})},ttConfigHdr:{tipClass:"ttHdr",offset:[10,0],relative:!0,position:"bottom center",delay:100,predelay:200},ttConfigFtr:{tipClass:"ttFtr",offset:[-4,0],relative:!0,position:"top center",delay:100,predelay:200,onBeforeShow:function(t,i){this.getConf().offset=[/iPad/i.test(navigator.userAgent)?e(window).scrollTop():-4,0]}},switchLocale:function(t){e.post("/i18n/switch?locale="+t,function(){var e=window.location.pathname.match("^/(uk|fr|de|es|ru|au|nz|jp|cn|kr|sg|hk|za|ca|il|mx|co|cl|ec|ve|ar|pe|py|cr|pa|pr|gt)($|/[^?]*$)");null==e?window.location.reload():window.location.pathname=e[2]})}};e(e.proxy(t.init,t))}(jQuery),define("country-selector",function(){}),define("hbs!galileo/tile/template/dialog/container",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var s,o="",l="function";return o+='<div class="dialog">\n    <div class="content">\n        <a class="close">\n            <span class="icon">X</span>\n        </a>\n        ',(s=i.content)?s=s.call(t,{hash:{}}):(s=t.content,s=typeof s===l?s.apply(t):s),(s||0===s)&&(o+=s),o+="\n    </div>\n</div>"});return e.registerPartial("galileo_tile_template_dialog_container",t),t}),define("galileo/fma/modal",["require","mootools","jquery","shared/scripts/modal","hbs!galileo/tile/template/dialog/container"],function(e){e("mootools"),e("jquery");var t=e("shared/scripts/modal"),i=e("hbs!galileo/tile/template/dialog/container");return new Class({options:{},initialize:function(e){this.content=e,this.doc=$(document),this.setupModal()},setupModal:function(){var e=this.modal=t(this.setupDialog.bind(this));e.position(),this.unitId=$("#messagingSelectedModalId").val(),e.onClose(this.closeDialog.bind(this)),this.body=e.dialog.find(".main .content")},setupDialog:function(e){var t=$(this.renderDialogTpl()),i=t.find(".content");return $(this.content).appendTo(i),t},closeDialog:function(){var e=this.unitId;if(!e)return!1;var t={unitId:e,apiFormat:"json",closeMessageUnitModal:"on"};jQuery.ajax({type:"POST",url:"/cms/messagingModule",data:t,dataType:"text",success:function(e){var t=JSON.parse(e).result;console.log(t.success?"FMA dialog close has been registered on server.":"Error while FMA dialog close has been registered on server.")},error:function(e){console.log("Error while FMA dialog close has been registered on server.")}})},renderDialogTpl:function(e){return i(e||{})}})}),function(e,i){if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(t,n,a){e.Backbone=i(e,a,t,n)});else if("undefined"!=typeof t){var n=require("underscore");i(e,t,n)}else e.Backbone=i(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,i,n){var a=e.Backbone,s=[],o=(s.push,s.slice);s.splice;t.VERSION="1.1.2",t.$=n,t.noConflict=function(){return e.Backbone=a,this},t.emulateHTTP=!1,t.emulateJSON=!1;var l=t.Events={on:function(e,t,i){if(!h(this,"on",e,[t,i])||!t)return this;this._events||(this._events={});var n=this._events[e]||(this._events[e]=[]);return n.push({callback:t,context:i,ctx:i||this}),this},once:function(e,t,n){if(!h(this,"once",e,[t,n])||!t)return this;var a=this,s=i.once(function(){a.off(e,s),t.apply(this,arguments)});return s._callback=t,this.on(e,s,n)},off:function(e,t,n){var a,s,o,l,r,c,d,u;if(!this._events||!h(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events=void 0,this;for(l=e?[e]:i.keys(this._events),r=0,c=l.length;c>r;r++)if(e=l[r],o=this._events[e]){if(this._events[e]=a=[],t||n)for(d=0,u=o.length;u>d;d++)s=o[d],(t&&t!==s.callback&&t!==s.callback._callback||n&&n!==s.context)&&a.push(s);a.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=o.call(arguments,1);if(!h(this,"trigger",e,t))return this;var i=this._events[e],n=this._events.all;return i&&c(i,t),n&&c(n,arguments),this},stopListening:function(e,t,n){var a=this._listeningTo;if(!a)return this;var s=!t&&!n;n||"object"!=typeof t||(n=this),e&&((a={})[e._listenId]=e);for(var o in a)e=a[o],e.off(t,n,this),(s||i.isEmpty(e._events))&&delete this._listeningTo[o];return this}},r=/\s+/,h=function(e,t,i,n){if(!i)return!0;if("object"==typeof i){for(var a in i)e[t].apply(e,[a,i[a]].concat(n));return!1}if(r.test(i)){for(var s=i.split(r),o=0,l=s.length;l>o;o++)e[t].apply(e,[s[o]].concat(n));return!1}return!0},c=function(e,t){var i,n=-1,a=e.length,s=t[0],o=t[1],l=t[2];switch(t.length){case 0:for(;++n<a;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<a;)(i=e[n]).callback.call(i.ctx,s);return;case 2:for(;++n<a;)(i=e[n]).callback.call(i.ctx,s,o);return;case 3:for(;++n<a;)(i=e[n]).callback.call(i.ctx,s,o,l);return;default:for(;++n<a;)(i=e[n]).callback.apply(i.ctx,t);return}},d={listenTo:"on",listenToOnce:"once"};i.each(d,function(e,t){l[t]=function(t,n,a){var s=this._listeningTo||(this._listeningTo={}),o=t._listenId||(t._listenId=i.uniqueId("l"));return s[o]=t,a||"object"!=typeof n||(a=this),t[e](n,a,this),this}}),l.bind=l.on,l.unbind=l.off,i.extend(t,l);var u=t.Model=function(e,t){var n=e||{};t||(t={}),this.cid=i.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{}),n=i.defaults({},n,i.result(this,"defaults")),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};i.extend(u.prototype,l,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var a,s,o,l,r,h,c,d;if(null==e)return this;if("object"==typeof e?(s=e,n=t):(s={})[e]=t,n||(n={}),!this._validate(s,n))return!1;o=n.unset,r=n.silent,l=[],h=this._changing,this._changing=!0,h||(this._previousAttributes=i.clone(this.attributes),this.changed={}),d=this.attributes,c=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(a in s)t=s[a],i.isEqual(d[a],t)||l.push(a),i.isEqual(c[a],t)?delete this.changed[a]:this.changed[a]=t,o?delete d[a]:d[a]=t;if(!r){l.length&&(this._pending=n);for(var u=0,p=l.length;p>u;u++)this.trigger("change:"+l[u],this,d[l[u]],n)}if(h)return this;if(!r)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?i.clone(this.changed):!1;var t,n=!1,a=this._changing?this._previousAttributes:this.attributes;for(var s in e)i.isEqual(a[s],t=e[s])||((n||(n={}))[s]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,n=e.success;return e.success=function(i){return t.set(t.parse(i,e),e)?(n&&n(t,i,e),void t.trigger("sync",t,i,e)):!1},W(this,e),this.sync("read",this,e)},save:function(e,t,n){var a,s,o,l=this.attributes;if(null==e||"object"==typeof e?(a=e,n=t):(a={})[e]=t,n=i.extend({validate:!0},n),a&&!n.wait){if(!this.set(a,n))return!1}else if(!this._validate(a,n))return!1;a&&n.wait&&(this.attributes=i.extend({},l,a)),void 0===n.parse&&(n.parse=!0);var r=this,h=n.success;return n.success=function(e){r.attributes=l;var t=r.parse(e,n);return n.wait&&(t=i.extend(a||{},t)),i.isObject(t)&&!r.set(t,n)?!1:(h&&h(r,e,n),void r.trigger("sync",r,e,n))},W(this,n),s=this.isNew()?"create":n.patch?"patch":"update","patch"===s&&(n.attrs=a),o=this.sync(s,this,n),a&&n.wait&&(this.attributes=l),o},destroy:function(e){e=e?i.clone(e):{};var t=this,n=e.success,a=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(i){(e.wait||t.isNew())&&a(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)},this.isNew())return e.success(),!1;W(this,e);var s=this.sync("delete",this,e);return e.wait||a(),s},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||O();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},i.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,i.extend(t,{validationError:n})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];i.each(p,function(e){u.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.attributes),i[e].apply(i,t)}});var g=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))},f={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};i.extend(g.prototype,l,{model:u,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,i.extend({merge:!1},t,m))},remove:function(e,t){var n=!i.isArray(e);e=n?[e]:i.clone(e),t||(t={});var a,s,o,l;for(a=0,s=e.length;s>a;a++)l=e[a]=this.get(e[a]),l&&(delete this._byId[l.id],delete this._byId[l.cid],o=this.indexOf(l),this.models.splice(o,1),this.length--,t.silent||(t.index=o,l.trigger("remove",l,this,t)),this._removeReference(l,t));return n?e[0]:e},set:function(e,t){t=i.defaults({},t,f),t.parse&&(e=this.parse(e,t));var n=!i.isArray(e);e=n?e?[e]:[]:i.clone(e);var a,s,o,l,r,h,c,d=t.at,p=this.model,g=this.comparator&&null==d&&t.sort!==!1,m=i.isString(this.comparator)?this.comparator:null,v=[],y=[],b={},w=t.add,_=t.merge,x=t.remove,T=!g&&w&&x?[]:!1;for(a=0,s=e.length;s>a;a++){if(r=e[a]||{},o=r instanceof u?l=r:r[p.prototype.idAttribute||"id"],h=this.get(o))x&&(b[h.cid]=!0),_&&(r=r===l?l.attributes:r,t.parse&&(r=h.parse(r,t)),h.set(r,t),g&&!c&&h.hasChanged(m)&&(c=!0)),e[a]=h;else if(w){if(l=e[a]=this._prepareModel(r,t),!l)continue;v.push(l),this._addReference(l,t)}l=h||l,!T||!l.isNew()&&b[l.id]||T.push(l),b[l.id]=!0}if(x){for(a=0,s=this.length;s>a;++a)b[(l=this.models[a]).cid]||y.push(l);y.length&&this.remove(y,t)}if(v.length||T&&T.length)if(g&&(c=!0),this.length+=v.length,null!=d)for(a=0,s=v.length;s>a;a++)this.models.splice(d+a,0,v[a]);else{T&&(this.models.length=0);var k=T||v;for(a=0,s=k.length;s>a;a++)this.models.push(k[a])}if(c&&this.sort({silent:!0}),!t.silent){for(a=0,s=v.length;s>a;a++)(l=v[a]).trigger("add",l,this,t);(c||T&&T.length)&&this.trigger("sort",this,t)}return n?e[0]:e},reset:function(e,t){t||(t={});for(var n=0,a=this.models.length;a>n;n++)this._removeReference(this.models[n],t);return t.previousModels=this.models,this._reset(),e=this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,i.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,i.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return o.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return i.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return i.invoke(this.models,"get",e)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,n=this;return e.success=function(i){var a=e.reset?"reset":"set";n[a](i,e),t&&t(n,i,e),n.trigger("sync",n,i,e)},W(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?i.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,a=t.success;return t.success=function(e,i){t.wait&&n.add(e,t),a&&a(e,i,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof u)return e;t=t?i.clone(t):{},t.collection=this;var n=new this.model(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_addReference:function(e,t){this._byId[e.cid]=e,null!=e.id&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];i.each(v,function(e){g.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.models),i[e].apply(i,t)}});var y=["groupBy","countBy","sortBy","indexBy"];i.each(y,function(e){g.prototype[e]=function(t,n){var a=i.isFunction(t)?t:function(e){return e.get(t)};return i[e](this.models,a,n)}});var b=t.View=function(e){this.cid=i.uniqueId("view"),e||(e={}),i.extend(this,i.pick(e,_)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,_=["model","collection","el","id","attributes","className","tagName","events"];i.extend(b.prototype,l,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=i.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];if(i.isFunction(n)||(n=this[e[t]]),n){var a=t.match(w),s=a[1],o=a[2];n=i.bind(n,this),s+=".delegateEvents"+this.cid,""===o?this.$el.on(s,n):this.$el.on(s,o,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e["class"]=i.result(this,"className"));var n=t.$("<"+i.result(this,"tagName")+">").attr(e);this.setElement(n,!1)}}}),t.sync=function(e,n,a){var s=T[e];i.defaults(a||(a={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};if(a.url||(o.url=i.result(n,"url")||O()),null!=a.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(o.contentType="application/json",o.data=JSON.stringify(a.attrs||n.toJSON(a))),a.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),a.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){o.type="POST",a.emulateJSON&&(o.data._method=s);var l=a.beforeSend;a.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",s),l?l.apply(this,arguments):void 0}}"GET"===o.type||a.emulateJSON||(o.processData=!1),"PATCH"===o.type&&x&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var r=a.xhr=t.ajax(i.extend(o,a));return n.trigger("request",n,r,a),r};var x=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),T={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var k=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},S=/\((.*?)\)/g,M=/(\(\?)?:\w+/g,C=/\*\w+/g,D=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(k.prototype,l,{initialize:function(){},route:function(e,n,a){i.isRegExp(e)||(e=this._routeToRegExp(e)),i.isFunction(n)&&(a=n,n=""),a||(a=this[n]);var s=this;return t.history.route(e,function(i){var o=s._extractParameters(e,i);s.execute(a,o),s.trigger.apply(s,["route:"+n].concat(o)),s.trigger("route",n,o),t.history.trigger("route",s,n,o)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var e,t=i.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(D,"\\$&").replace(S,"(?:$1)?").replace(M,function(e,t){return t?e:"([^/?]+)"}).replace(C,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return i.map(n,function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null})}});var A=t.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},G=/^[#\/]|\s+$/g,E=/^\/+|\/+$/g,P=/msie [\w.]+/,I=/\/$/,L=/#.*$/;A.started=!1,i.extend(A.prototype,l,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var i=this.root.replace(I,"");e.indexOf(i)||(e=e.slice(i.length))}else e=this.getHash();return e.replace(G,"")},start:function(e){if(A.started)throw new Error("Backbone.history has already been started");A.started=!0,this.options=i.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),a=document.documentMode,s=P.exec(navigator.userAgent.toLowerCase())&&(!a||7>=a);if(this.root=("/"+this.root+"/").replace(E,"/"),s&&this._wantsHashChange){var o=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=o.hide().appendTo("body")[0].contentWindow,this.navigate(n)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var l=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&l.hash&&(this.fragment=this.getHash().replace(G,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),A.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(e){return e=this.fragment=this.getFragment(e),i.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(e,t){if(!A.started)return!1;t&&t!==!0||(t={trigger:!!t});var i=this.root+(e=this.getFragment(e||""));if(e=e.replace(L,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),t.history=new A;var F=function(e,t){var n,a=this;n=e&&i.has(e,"constructor")?e.constructor:function(){return a.apply(this,arguments)},i.extend(n,a,t);var s=function(){this.constructor=n};return s.prototype=a.prototype,n.prototype=new s,e&&i.extend(n.prototype,e),n.__super__=a.prototype,n};u.extend=g.extend=k.extend=b.extend=A.extend=F;var O=function(){throw new Error('A "url" property or function must be specified')},W=function(e,t){var i=t.error;t.error=function(n){i&&i(e,n,t),e.trigger("error",e,n,t)}};return t}),define("galileo/modal/VerificationEmailModal",["require","jquery","underscore","backbone","shared/scripts/modal"],function(e){var t=e("jquery"),i=e("underscore"),n=e("backbone"),a=e("shared/scripts/modal");return n.View.extend({initialize:function(e){i.extend(this,e)},events:{"click .closeModal":"close"},close:function(){this.closeFn&&this.closeFn()},renderContent:function(){return t(this.template(this))},render:function(){var e=this,t=this.renderContent();new a(function(i){return e.closeFn=i,t}),this.setElement(t)}})}),define("hbs!galileo/modal/template/resentVerificationEmail",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var s,o="",l="function",r=this.escapeExpression;return o+='<div class="verification-email-modal dialog">\n    <div class="content">\n        <div class="closeModal">\n            <i class="fitglyph fitglyph-close-settings size-f"></i>\n        </div>\n        <h3>',(s=i.title)?s=s.call(t,{hash:{}}):(s=t.title,s=typeof s===l?s.apply(t):s),o+=r(s)+"</h3>\n        <h4>",(s=i.subtitle)?s=s.call(t,{hash:{}}):(s=t.subtitle,s=typeof s===l?s.apply(t):s),o+=r(s)+"</h4>\n    </div>\n</div>"});return e.registerPartial("galileo_modal_template_resentVerificationEmail",t),t}),define("hbs!views/popup_tmpl",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/label","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,l="";return l+='\n<div class="overlay"></div>\n<div class="popup">\n	<header>\n		<button class="close" type="button">',s={hash:{}},n=i.i18n,a=n?n.call(e,"close",s):u.call(e,"i18n","close",s),(a||0===a)&&(l+=a),l+='</button>\n	</header>\n	<div class="content">\n		<div class="message">\n			',(a=i.message)?a=a.call(e,{hash:{}}):(a=e.message,a=typeof a===c?a.apply(e):a),l+=d(a)+"\n		</div>\n\n		",a=i["if"].call(e,e.details,{hash:{},inverse:p.noop,fn:p.program(2,o,t)}),(a||0===a)&&(l+=a),l+="\n	</div>\n</div>\n"}function o(e,t){var n,a="";return a+='\n			<pre class="details">',(n=i.details)?n=n.call(e,{hash:{}}):(n=e.details,n=typeof n===c?n.apply(e):n),a+=d(n)+"</pre>\n		"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var l,r,h,c="function",d=this.escapeExpression,u=i.helperMissing,p=this;return h={hash:{},inverse:p.noop,fn:p.program(1,s,a)},l=i["i18n-namespace"],r=l?l.call(t,"com.fitbit.app.label",h):u.call(t,"i18n-namespace","com.fitbit.app.label",h),r||0===r?r:""});return e.registerPartial("views_popup_tmpl",t),t}),define("popup",["require","jquery","underscore","backbone","hbs!views/popup_tmpl"],function(e){var t=e("jquery"),i=e("underscore"),n=e("backbone"),a=e("hbs!views/popup_tmpl"),s=t("body"),o=0,l=25,r=t(window),h=n.View.extend({events:{"click .close":"hide"},initialize:function(e){e||(e={}),e.renderCallback&&(this.renderCallback=e.renderCallback),e.closeOnClick&&(this.closeOnClick=!0),this.resizePopup=i.bind(this.positionPopup,this),this.$el.appendTo("body"),e.template&&(this.template=e.template),this.model=new n.Model,this.model.on("change",this.render,this)},template:a,show:function(e,t){return this.model.set({message:e,details:t}),this},setPosition:function(e,t){return t&&(this.$anchor=t),this.placement=e||"top",this.$el.removeClass("top right bottom left").addClass(e),this},showHTML:function(e,t,i){this.template=e,this.setPosition(i,t);var n=this;return clearTimeout(this.showTimer),this.showTimer=setTimeout(function(){n.render()},o),t.add(this.$el).on("mouseenter.popup",function(){clearTimeout(n.hideTimer)}).on("mouseleave.popup",function(){n.beginHide()}),this},beginHide:function(){var e=this;clearTimeout(this.hideTimer),this.hideTimer=setTimeout(function(){e.hide()},100)},hide:function(){return this.$anchor&&this.$anchor.off("mouseleave.popup"),this.$el.fadeTo(0,0).css("zIndex",-1),this.resizeReady=!1,r.off("resize",this.resizePopup),this},positionPopup:function(){var e=this.$anchor,t=this.$el;if(e){var i=e.offset(),n={};switch(this.placement){case"top":n={left:i.left+e[0].offsetWidth/2-t[0].offsetWidth/2+"px",top:i.top-t[0].offsetHeight-l+"px"};break;case"left":n={left:i.left-t[0].offsetWidth-l+"px",top:i.top+e[0].offsetHeight/2-t[0].offsetHeight/2+"px"};break;case"right":n={left:i.left+e[0].offsetWidth+l+"px",top:i.top+e[0].offsetHeight/2-t[0].offsetHeight/2+"px"};break;case"bottom":n={left:i.left+e[0].offsetWidth/2-t[0].offsetWidth/2+"px",top:i.top+e[0].offsetHeight+l+"px"}}parseInt(n.top)<0?"right"==this.placement||"left"==this.placement?this.setPosition("bottom",e).positionPopup():this.setPosition("right",e).positionPopup():(n.zIndex="",t.css(n))}return this},render:function(){var e=this,t=this.model.toJSON(),i=this.$el.html(this.template(t));if(this.positionPopup(),i.fadeTo(250,1),this.renderCallback&&this.renderCallback(),this.resizeReady||(this.resizeReady=!0,r.on("resize",this.resizePopup)),this.closeOnClick){var n=function(t){e.$el.is(t.target)||e.$(t.target).length||e.beginHide()};s.on("click",n),this.listenTo(this,"remove hide",function(){s.off("click",n)})}return this}});return h}),define("galileo/page/gearHelp",["require","galileo/builder/text","galileo/modal/flex101","galileo/modal/force101","galileo/modal/charge101","i18n/i18n","i18n-load!com/fitbit/app/ngd/flex101","i18n-load!com/fitbit/app/ngd/force101","i18n-load!com/fitbit/app/ngd/charge101","popup"],function(e){var t=e("galileo/builder/text"),i=e("galileo/modal/flex101"),n=e("galileo/modal/force101"),a=e("galileo/modal/charge101"),s=e("i18n/i18n")();s.namespace(e("i18n-load!com/fitbit/app/ngd/flex101")),s.namespace(e("i18n-load!com/fitbit/app/ngd/force101")),s.namespace(e("i18n-load!com/fitbit/app/ngd/charge101"));var o={QUARK:{launcher:i,deferred:!0,i18n:{access_101_text:s("access_flex101_and_settings")}},NEUTRINO:{launcher:n,deferred:!1,i18n:{access_101_text:s("access_force101_and_settings")}},TAU:{launcher:a,deferred:!1,i18n:{access_101_text:s("access_charge101_and_settings")}}},l=function(e){return o[e]};return function(i){var n=l(i);if(n){var a=n.launcher,o=n.i18n.access_101_text,r=function(){var i=$(".nav-item-settings"),n=i.offset(),a=$("<div>").css({position:"fixed",left:$("body").width()/2,top:$("body").height()/2,border:"2px solid #666",width:500,height:500,marginLeft:-250,marginTop:-250}).appendTo($("body")).animate({left:n.left,top:n.top,width:i.width(),height:i.height(),marginLeft:0,marginTop:0},500,function(){a.remove(),i.find(".icon").css({backgroundPosition:"0px -1398px"}),i.one("mouseover",function(){var n=e("popup"),a=new n({className:"tiles-tooltip top"});a.$el.width(130),a.showHTML(function(){return $("<div>").append(t("13px #00c4c1",s("settings_and_more")),$("<br>"),$("<br>"),t("13px #fff",o));
},i,"bottom"),i.find(".icon").css({backgroundPosition:"0px -1343px"})})})};n.deferred?a().done(function(e){e.onClose(r)}):a().onClose(r)}}});var n=function(){function e(t){var i;if("string"==typeof t)return t;if(typeof t.hashCode==c)return i=t.hashCode(),"string"==typeof i?i:e(i);if(typeof t.toString==c)return t.toString();try{return String(t)}catch(n){return Object.prototype.toString.call(t)}}function t(e,t){return e.equals(t)}function i(e,t){return typeof t.equals==c?t.equals(e):e===t}function n(e){return function(t){if(null===t)throw new Error("null is not a valid "+e);if("undefined"==typeof t)throw new Error(e+" must not be undefined")}}function a(e,t,i,n){this[0]=e,this.entries=[],this.addEntry(t,i),null!==n&&(this.getEqualityFunction=function(){return n})}function s(e){return function(t){for(var i,n=this.entries.length,a=this.getEqualityFunction(t);n--;)if(i=this.entries[n],a(t,i[0]))switch(e){case g:return!0;case f:return i;case m:return[n,i[1]]}return!1}}function o(e){return function(t){for(var i=t.length,n=0,a=this.entries.length;a>n;++n)t[i+n]=this.entries[n][e]}}function l(e,t){for(var i,n=e.length;n--;)if(i=e[n],t===i[0])return n;return null}function r(e,t){var i=e[t];return i&&i instanceof a?i:null}function h(t,i){var n=this,s=[],o={},g=typeof t==c?t:e,f=typeof i==c?i:null;this.put=function(e,t){u(e),p(t);var i,n,l=g(e),h=null;return i=r(o,l),i?(n=i.getEntryForKey(e),n?(h=n[1],n[1]=t):i.addEntry(e,t)):(i=new a(l,e,t,f),s[s.length]=i,o[l]=i),h},this.get=function(e){u(e);var t=g(e),i=r(o,t);if(i){var n=i.getEntryForKey(e);if(n)return n[1]}return null},this.containsKey=function(e){u(e);var t=g(e),i=r(o,t);return i?i.containsKey(e):!1},this.containsValue=function(e){p(e);for(var t=s.length;t--;)if(s[t].containsValue(e))return!0;return!1},this.clear=function(){s.length=0,o={}},this.isEmpty=function(){return!s.length};var m=function(e){return function(){for(var t=[],i=s.length;i--;)s[i][e](t);return t}};this.keys=m("keys"),this.values=m("values"),this.entries=m("getEntries"),this.remove=function(e){u(e);var t,i=g(e),n=null,a=r(o,i);return a&&(n=a.removeEntryForKey(e),null!==n&&(a.entries.length||(t=l(s,i),d(s,t),delete o[i]))),n},this.size=function(){for(var e=0,t=s.length;t--;)e+=s[t].entries.length;return e},this.each=function(e){for(var t,i=n.entries(),a=i.length;a--;)t=i[a],e(t[0],t[1])},this.putAll=function(e,t){for(var i,a,s,o,l=e.entries(),r=l.length,h=typeof t==c;r--;)i=l[r],a=i[0],s=i[1],h&&(o=n.get(a))&&(s=t(a,o,s)),n.put(a,s)},this.clone=function(){var e=new h(t,i);return e.putAll(n),e}}var c="function",d=typeof Array.prototype.splice==c?function(e,t){e.splice(t,1)}:function(e,t){var i,n,a;if(t===e.length-1)e.length=t;else for(i=e.slice(t+1),e.length=t,n=0,a=i.length;a>n;++n)e[t+n]=i[n]},u=n("key"),p=n("value"),g=0,f=1,m=2;return a.prototype={getEqualityFunction:function(e){return typeof e.equals==c?t:i},getEntryForKey:s(f),getEntryAndIndexForKey:s(m),removeEntryForKey:function(e){var t=this.getEntryAndIndexForKey(e);return t?(d(this.entries,t[0]),t[1]):null},addEntry:function(e,t){this.entries[this.entries.length]=[e,t]},keys:o(0),values:o(1),getEntries:function(e){for(var t=e.length,i=0,n=this.entries.length;n>i;++i)e[t+i]=this.entries[i].slice(0)},containsKey:s(g),containsValue:function(e){for(var t=this.entries.length;t--;)if(e===this.entries[t][1])return!0;return!1}},h}();define("jshashtable",function(e){return function(){var t;return t||e.Hashtable}}(this)),function(e){function t(e,t,i){this.dec=e,this.group=t,this.neg=i}function i(){for(var e=0;e<u.length;e++){localeGroup=u[e];for(var t=0;t<localeGroup.length;t++)s.put(localeGroup[t],e)}}function a(e,n){0==s.size()&&i();var a=".",o=",",l="-";e=e.toLowerCase(),n===!1&&-1===c.indexOf(e)&&/[_-]/.test(e)&&(e=e.split(/[_-]/)[1]);var r=s.get(e);if(r){var h=d[r];h&&(a=h[0],o=h[1])}return new t(a,o,l)}var s=new n,o=["ae","au","nz","ca","cn","eg","gb","hk","il","in","sg","jp","sk","ko","us","mx","pa","pr","gt","cr","tw","th","my","ph","id","ie"],l=["br","de","dk","es","gr","it","nl","co","pt","vn","tr","cl","ec","ve","ar","py","pe","be"],r=["fr_ca","at","cz","fi","fr","ru","se","za","pl"],h=["ch"],c=["fr_ca"],d=[[".",","],[",","."],[","," "],[".","'"]],u=[o,l,r,h];e.fn.formatNumber=function(t,i,n){return this.each(function(){null==i&&(i=!0),null==n&&(n=!0);var a;a=new String(e(this).is(":input")?e(this).val():e(this).text());var s=e.formatNumber(a,t);return i&&(e(this).is(":input")?e(this).val(s):e(this).text(s)),n?s:void 0})},e.formatNumber=function(t,i){for(var i=e.extend({},e.fn.formatNumber.defaults,i),n=a(i.locale.toLowerCase(),i.isFullLocale),s=(n.dec,n.group,n.neg,"0#-,."),o="",l=!1,r=0;r<i.format.length;r++){if(-1!=s.indexOf(i.format.charAt(r))){if(0==r&&"-"==i.format.charAt(r)){l=!0;continue}break}o+=i.format.charAt(r)}for(var h="",r=i.format.length-1;r>=0&&-1==s.indexOf(i.format.charAt(r));r--)h=i.format.charAt(r)+h;i.format=i.format.substring(o.length),i.format=i.format.substring(0,i.format.length-h.length);var c=new Number(t);return e._formatNumber(c,i,h,o,l)},e._formatNumber=function(t,i,n,s,o){var i=e.extend({},e.fn.formatNumber.defaults,i),l=a(i.locale.toLowerCase(),i.isFullLocale),r=l.dec,h=l.group,c=l.neg,d=!1;if(isNaN(t)){if(1!=i.nanForceZero)return null;t=0,d=!0}"%"==n&&(t=100*t);var u="";if(i.format.indexOf(".")>-1){var p=r,g=i.format.substring(i.format.lastIndexOf(".")+1);if(1==i.round)t=new Number(t.toFixed(g.length));else{var f=t.toString();f=f.substring(0,f.lastIndexOf(".")+g.length+1),t=new Number(f)}var m=t%1,v=new String(m.toFixed(g.length));v=v.substring(v.lastIndexOf(".")+1);for(var y=0;y<g.length;y++)if("#"!=g.charAt(y)||"0"==v.charAt(y)){if("#"==g.charAt(y)&&"0"==v.charAt(y)){var b=v.substring(y);if(b.match("[1-9]")){p+=v.charAt(y);continue}break}"0"==g.charAt(y)&&(p+=v.charAt(y))}else p+=v.charAt(y);u+=p}else t=Math.round(t);var w=Math.floor(t);0>t&&(w=Math.ceil(t));var _="";_=-1==i.format.indexOf(".")?i.format:i.format.substring(0,i.format.indexOf("."));var x="";if(0!=w||"#"!=_.substr(_.length-1)||d){var T=new String(Math.abs(w)),k=9999;-1!=_.lastIndexOf(",")&&(k=_.length-_.lastIndexOf(",")-1);for(var S=0,y=T.length-1;y>-1;y--)x=T.charAt(y)+x,S++,S==k&&0!=y&&(x=h+x,S=0);if(_.length>x.length){var M=_.indexOf("0");if(-1!=M)for(var C=_.length-M,D=_.length-x.length-1;x.length<C;){var A=_.charAt(D);","==A&&(A=h),x=A+x,D--}}}return x||-1===_.indexOf("0",_.length-1)||(x="0"),u=x+u,0>t&&o&&s.length>0?s=c+s:0>t&&(u=c+u),i.decimalSeparatorAlwaysShown||u.lastIndexOf(r)==u.length-1&&(u=u.substring(0,u.length-1)),u=s+u+n},e.fn.parseNumber=function(t,i,n){null==i&&(i=!0),null==n&&(n=!0);var a;a=new String(e(this).is(":input")?e(this).val():e(this).text());var s=e.parseNumber(a,t);return s&&(i&&(e(this).is(":input")?e(this).val(s.toString()):e(this).text(s.toString())),n)?s:void 0},e.parseNumber=function(t,i){for(var i=e.extend({},e.fn.parseNumber.defaults,i),n=a(i.locale.toLowerCase(),i.isFullLocale),s=n.dec,o=n.group,l=n.neg,r="1234567890.-";t.indexOf(o)>-1;)t=t.replace(o,"");t=t.replace(s,".").replace(l,"-");var h="",c=!1;("%"==t.charAt(t.length-1)||1==i.isPercentage)&&(c=!0);for(var d=0;d<t.length;d++)r.indexOf(t.charAt(d))>-1&&(h+=t.charAt(d));var u=new Number(h);if(c){u/=100;var p=h.indexOf(".");if(-1!=p){var g=h.length-p-1;u=u.toFixed(g+2)}else u=u.toFixed(h.length-1)}return u},e.parseNumber.formatCodes=a,e.fn.parseNumber.defaults={locale:"us",decimalSeparatorAlwaysShown:!1,isPercentage:!1,isFullLocale:!1},e.fn.formatNumber.defaults={format:"#,###.00",locale:"us",decimalSeparatorAlwaysShown:!1,nanForceZero:!0,round:!0,isFullLocale:!1},Number.prototype.toFixed=function(t){return e._roundNumber(this,t)},e._roundNumber=function(e,t){var i=Math.pow(10,t||0),n=String(Math.round(e*i)/i);if(t>0){var a=n.indexOf(".");for(-1==a?(n+=".",a=0):a=n.length-(a+1);t>a;)n+="0",a++}return n}}(jQuery),define("jquery.numberformatter",function(){}),define("galileo/model/activities",["require","galileo/prototype/all","galileo/util/dateUtil","galileo/ajax/ajax"],function(e){e("galileo/prototype/all");var t=e("galileo/util/dateUtil"),i=e("galileo/ajax/ajax"),n=function(e){this.userId=e};return n.prototype={loadWeightSummary:function(e,n){i.get("getWeightTileDataAt","activityTileData",{date:t.ajaxEncode(e)},function(e){n(e)})},loadSummary:function(e,n,a){i.get("getTileData","activityTileData",{dataTypes:e,date:t.ajaxEncode(n)},function(e){a(e[0])})},loadDays:function(e,n,a,s,o,l){"string"!=typeof s&&(l=s,s=""),"function"==typeof o&&(l=o,o=!1),n.getTime&&(n=t.ajaxEncode(n),a=t.ajaxEncode(a)),i.getRaw("/graph/getNewGraphData",{type:e,dateFrom:n,dateTo:a,granularity:s.toUpperCase(),hidePrecreationData:!!o},function(e){l(e.graph)})},loadIntraday:function(e,n,a){n.getTime?this.loadIntraday(e,t.ajaxEncode(n),a):i.get("getIntradayData","activityTileData",{date:n,dataTypes:e},function(e){a(e[0])})},loadOwnerGraphDataPoints:function(e,t,n,a,s){var o={type:e,dateFrom:t,dateTo:n,granularity:a},l={graphDataRequest:JSON.encode(o)};i.postOwner("getDataPoints","graph",l,function(e){s(e)})},loadViewerGraphDataPoints:function(e,t,n,a,s){var o={type:e,dateFrom:t,dateTo:n,granularity:a},l={graphDataRequest:JSON.encode(o)};i.post("getDataPoints","graph",l,function(e){s(e)})}},n}),define("galileo/model/subscription",["require","mootools","galileo/ajax/ajax"],function(e){e("mootools");var t=e("galileo/ajax/ajax"),i=new Class({type:void 0,properties:{},initialize:function(e,t){this.type=e,Object.merge(this.properties,t)},isActive:function(){return!!this.properties.active},isPremium:function(){return!!this.properties.premium},isTrial:function(){return!!this.properties.trial},isExpired:function(){return!this.properties.active},getPlan:function(e,i){"function"==typeof e&&(i=e,e={}),void 0===e&&(e={});var n=this.type;if(n)var a="get"+n.capitalize()+"Plan",s=t.get(a,"activityTileData",e,i);return i?void 0:s}});return i}),define("galileo/model/goals",["require","galileo/prototype/all","galileo/ajax/ajax","galileo/util/dateUtil"],function(e){e("galileo/prototype/all");var t=e("galileo/ajax/ajax"),i=e("galileo/util/dateUtil");return{update:function(e,n,a){a||(a=new Date),t.post("updateDailyGoal","activityTileData",{dataType:e,goalValue:n},function(){t.get("getGoalData","activityTileData",{dataTypes:e}).update(),t.get("getTileData","activityTileData",{date:i.ajaxEncode(a),dataTypes:e}).update()})},updateWeekly:function(e,n,a){a||(a=new Date),t.post("updateWeeklyGoal","activityTileData",{dataType:e,goalValue:n},function(){t.get("getGoalData","activityTileData",{dataTypes:e}).update(),t.get("getTileData","activityTileData",{date:i.ajaxEncode(a),dataTypes:e}).update()})},loadActivityType:function(e,i){t.get("getGoalData","activityTileData",{dataTypes:e},function(e){i(e[0])})},loadTileActivity:function(e,i,n){t.getOwner("getTileData","activityTileData",{date:i,dataTypes:e},function(e){n(e)})},load:function(e){t.getRaw("/lab/galileo/dash",{apiFormat:"json",goals:"on"},function(t){e(t.goals)})}}}),define("ajaxQueue",["require","jquery","underscore"],function(e){function t(e){i[e.method](e.url,e.value,function(){"function"==typeof e.callback&&e.callback.apply(e.callbackContext||window,arguments),a.queue=n.without(a.queue,e),a.queue.length&&t(a.queue[0])})}var i=e("jquery"),n=e("underscore"),a={};return a.queue=[],a.push=function(e){a.queue.push(e),1===a.queue.length&&t(e)},a}),define("galileo/model/user",["require","galileo/prototype/all","jquery.numberformatter","galileo/model/activities","galileo/model/subscription","galileo/model/goals","galileo/ajax/ajax","i18n/i18n","galileo/util/dateUtil","ajaxQueue","underscore","backbone","i18n-load!com/fitbit/app/unit","i18n-load!com/fitbit/app/ngd/betas"],function(e){e("galileo/prototype/all"),e("jquery.numberformatter");var t=e("galileo/model/activities"),i=e("galileo/model/subscription"),n=e("galileo/model/goals"),a=e("galileo/ajax/ajax"),s=e("i18n/i18n")(),o=e("galileo/util/dateUtil"),l=e("ajaxQueue"),r=e("underscore"),h=e("backbone");s.namespace(e("i18n-load!com/fitbit/app/unit")),s.namespace(e("i18n-load!com/fitbit/app/ngd/betas"));var c=new Date("2013/05/01"),d=2592e6,u=["it_IT"],p={GALILEO:"zip",HADRON:"one",QUARK:"flex",NEUTRINO:"force"},g=h.Model.extend({parse:function(e){try{return JSON.parse(e.settings["galileo user settings"])}catch(t){}},sync:function(){l.push({method:"post",url:"/userSettings/dh/save?apiFormat=json",value:{"settings['galileo user settings']":JSON.stringify(this.toJSON()),csrfToken:window.fitbitCsrfToken}})}}),f=new g,m=new Class({_activities:null,_water:null,_isFirstVisit:!1,deviceFeatures:{},goals:n,trainerPlan:!1,initialize:function(e){Object.merge(this,e),Object.forEach(this.subscriptions,function(e,t){this.subscriptions[t]=new i(t,e)},this)},activities:function(){return this._activities=this._activities||new t,this._activities},loadFriends:function(e){a.getOwner("data","leaderboardAjaxService",{},function(t){e(t)})},loadActivitiesLogsSummary:function(e){a.get("user","getActivitiesLogsSummary",{},function(t){e(t)})},loadFriendSuggestions:function(e){a.get("getSuggestions","friend",{},function(t){e(t)})},unitsString:function(e,t,i){var n="US"===this.weightSystem&&453.592||"UK"===this.weightSystem&&6350.288||1e3;return this.gramsString(e*n,t,i)},gramsString:function(e,t,i){i=void 0===i?1:i;var n=i>0?"#,###."+new Array(i+1).join("0"):"#,###",a=e/453.592,o=Math.floor(a/14),l=s.plural(t?"stone_full":"stone_short"),r=s.plural(t?"kilogram_full":"kilogram_short"),h=s.plural(t?"pound_full":"pound_short"),c="";return-1!==$.inArray(this.locale,u)&&(c=" "),"UK"===this.weightSystem?(a-=14*o,o+c+l(o)+" "+this.formatNumber(a,n)+c+h(a)):"US"===this.weightSystem?this.formatNumber(a,n)+c+h(a):this.formatNumber(e/1e3,n)+c+r(e/1e3)},formatNumber:function(e,t){return $.formatNumber(e,{format:t,locale:this.locale})},parseNumber:function(e,t){return $.parseNumber(e,{format:t,locale:this.locale})},thousands:function(e){return this.formatNumber(e,"#,###")||"0"},formatTime:function(e){return this.clock12?o.localeFormat(e,"hh:mm a"):o.localeFormat(e,"HH:mm")},isFirstVisit:function(){return this._isFirstVisit},isNewUser:function(){return new Date-new Date(f.get("firstVisitDate"))<=d},isLegacyUser:function(){return f.get("firstVisitDate")<c},hasTrainerPlan:function(){var e=this.subscriptions.trainer;return e&&e.isActive()},hasSeenTile:function(e){return!(!f.get("seenTiles")||!f.get("seenTiles")[e])},seeTile:function(e){var t=r.clone(f.get("seenTiles"))||{};t[e]=1,this.saveSetting("seenTiles",t)},initSettings:function(e){f.set(e),e.firstVisitDate||(this._isFirstVisit=!0,this.saveSetting("firstVisitDate",(new Date).getTime()))},saveSetting:function(e,t,i){f.save(e,t,i)},getDeviceFeatures:function(){return r.clone(this.deviceFeatures)||{}},getTrackerType:function(){return this.trackerType},getTrackerProductName:function(){return p[this.trackerType]},getSettingsModel:function(){return f},hasRole:function(e){return this.roles&&this.roles.contains(e)}});return m.viewer=new m(window.global_page_viewer),m}),define("galileo/jqueryPlugin/clickDrag",["require","jquery","underscore"],function(e){var t=e("jquery"),i=e("underscore"),n=t("body");t("<img>").attr("src","/images/dashboard/galileo/open.cur"),t("<img>").attr("src","/images/dashboard/galileo/closed.cur"),t.fn.clickDrag=function(e,a){var s=".clickDrag"+i.uniqueId("cd"),o=function(){n.off(s)},l=function(e){return i.reduce(e,function(e,t,i){return e[i+s]=t,e},{})};return this.each(function(){function i(){r.css("cursor",h)}function s(){r.css("cursor",'url("/images/dashboard/galileo/open.cur"), pointer')}function o(){r.css("cursor",'url("/images/dashboard/galileo/closed.cur"), pointer')}var r=t(this),h=r.css("cursor"),c=null,d=!1,u=!1,p=null;r.on("mousedown",function(t){1===t.which&&(s(),t.preventDefault(),c=setTimeout(function(){a.dragstart&&a.dragstart(p)&&(d=!0,o()),c=null},e))}),r.on("mouseleave",function(e){u=!1}),r.on("mouseenter",function(e){u=!0});var g=function(e){d?(d=!1,a.dragend&&a.dragend(e)):c&&(clearTimeout(c),c=null,u&&a.click&&a.click(e)),i()},f=function(e){p=e,d&&a.dragmove&&a.dragmove(e)},m=function(e){d&&a.dragabort&&a.dragabort(e),c&&clearTimeout(c),d=!1,i()},v={mouseup:g,mousemove:f,mouseleave:m};n.on(l(v))}),o}}),define("hbs!galileo/tile/template/help/activeMinutes",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/activeminutes","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+="\n<h3>",s={hash:{}},n=i.i18n,a=n?n.call(e,"activeminutes_header",s):h.call(e,"i18n","activeminutes_header",s),(a||0===a)&&(o+=a),o+="</h3>\n<p>\n    ",s={hash:{}},n=i.i18n,a=n?n.call(e,"activeminutes_msg",s):h.call(e,"i18n","activeminutes_msg",s),(a||0===a)&&(o+=a),o+='\n</p>\n<a href="',s={hash:{}},n=i.i18n,a=n?n.call(e,"activeminutes_href",s):h.call(e,"i18n","activeminutes_href",s),(a||0===a)&&(o+=a),o+='">',s={hash:{}},n=i.i18n,a=n?n.call(e,"activeminutes_learn_more",s):h.call(e,"i18n","activeminutes_learn_more",s),(a||0===a)&&(o+=a),o+="</a>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h=i.helperMissing,c=this;return r={hash:{},inverse:c.noop,fn:c.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.activeminutes",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.activeminutes",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_help_activeMinutes",t),t}),define("hbs!galileo/tile/template/help/calories",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/tooltips","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+="\r\n<h3>",s={hash:{}},n=i.i18n,a=n?n.call(e,"calories_header",s):h.call(e,"i18n","calories_header",s),(a||0===a)&&(o+=a),o+="</h3>\r\n<p>\r\n    ",s={hash:{}},n=i.i18n,a=n?n.call(e,"calories_msg",s):h.call(e,"i18n","calories_msg",s),(a||0===a)&&(o+=a),o+='\r\n	<a href="',s={hash:{}},n=i.i18n,a=n?n.call(e,"calories_learn_more_href",s):h.call(e,"i18n","calories_learn_more_href",s),(a||0===a)&&(o+=a),o+='">',s={hash:{}},n=i.i18n,a=n?n.call(e,"calories_learn_more",s):h.call(e,"i18n","calories_learn_more",s),(a||0===a)&&(o+=a),o+="</a>\r\n</p>\r\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h=i.helperMissing,c=this;return r={hash:{},inverse:c.noop,fn:c.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.tooltips",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.tooltips",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_help_calories",t),t}),define("hbs!galileo/tile/template/help/weight",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/tooltips","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+="\r\n<h3>",s={hash:{}},n=i.i18n,a=n?n.call(e,"weight_header",s):h.call(e,"i18n","weight_header",s),(a||0===a)&&(o+=a),o+="</h3>\r\n<p>",s={hash:{}},n=i.i18n,a=n?n.call(e,"weight_msg",s):h.call(e,"i18n","weight_msg",s),(a||0===a)&&(o+=a),o+="</p>\r\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h=i.helperMissing,c=this;return r={hash:{},inverse:c.noop,fn:c.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.tooltips",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.tooltips",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_help_weight",t),t}),define("hbs!galileo/tile/template/help/addTile",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/tooltips","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\r\n<div class="action-tip add-tile">\r\n	<h3>',s={hash:{}},n=i.i18n,a=n?n.call(e,"addTile_header",s):h.call(e,"i18n","addTile_header",s),(a||0===a)&&(o+=a),o+="</h3>\r\n	<p>",s={hash:{}},n=i.i18n,a=n?n.call(e,"addTile_msg",s):h.call(e,"i18n","addTile_msg",s),(a||0===a)&&(o+=a),o+="</p>\r\n</div>\r\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h=i.helperMissing,c=this;return r={hash:{},inverse:c.noop,fn:c.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.tooltips",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.tooltips",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_help_addTile",t),t}),define("hbs!galileo/tile/template/help/personalize",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/tooltips","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\r\n<div class="action-tip personalize">\r\n	<h3>',s={hash:{}},n=i.i18n,a=n?n.call(e,"personalize_header",s):h.call(e,"i18n","personalize_header",s),(a||0===a)&&(o+=a),o+="</h3>\r\n	<p>",s={hash:{}},n=i.i18n,a=n?n.call(e,"personalize_msg",s):h.call(e,"i18n","personalize_msg",s),(a||0===a)&&(o+=a),o+="</p>\r\n</div>\r\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h=i.helperMissing,c=this;return r={hash:{},inverse:c.noop,fn:c.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.tooltips",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.tooltips",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_help_personalize",t),t}),define("hbs!galileo/tile/template/help/settings",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/tooltips","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\r\n<div class="action-tip settings">\r\n	<h3>',s={hash:{}},n=i.i18n,a=n?n.call(e,"settings_header",s):h.call(e,"i18n","settings_header",s),(a||0===a)&&(o+=a),o+="</h3>\r\n	<p>",s={hash:{}},n=i.i18n,a=n?n.call(e,"settings_msg",s):h.call(e,"i18n","settings_msg",s),(a||0===a)&&(o+=a),o+="</p>\r\n</div>\r\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h=i.helperMissing,c=this;return r={hash:{},inverse:c.noop,fn:c.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.tooltips",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.tooltips",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_help_settings",t),t}),define("hbs!galileo/tile/template/help/expand",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/tooltips","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n<div class="action-tip expand">\n	<h3>',s={hash:{}},n=i.i18n,a=n?n.call(e,"expand_header",s):c.call(e,"i18n","expand_header",s),(a||0===a)&&(o+=a),o+="</h3>\n	<p>",s={hash:{}},n=i.i18n,a=n?n.call(e,"expand_msg",s):c.call(e,"i18n","expand_msg",s),(a||0===a)&&(o+=a),o+="</p>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h="",c=i.helperMissing,d=this;return r={hash:{},inverse:d.noop,fn:d.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.tooltips",r):c.call(t,"i18n-namespace","com.fitbit.app.ngd.tooltips",r),(l||0===l)&&(h+=l),h+="\n"});return e.registerPartial("galileo_tile_template_help_expand",t),t}),define("hbs!galileo/tile/template/help/sleepModal",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/tooltips","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+="\n<h3>",s={hash:{}},n=i.i18n,a=n?n.call(e,"sleep_modal_header",s):h.call(e,"i18n","sleep_modal_header",s),(a||0===a)&&(o+=a),o+="</h3>\n<p>\n    ",s={hash:{}},n=i.i18n,a=n?n.call(e,"sleep_modal_msg",s):h.call(e,"i18n","sleep_modal_msg",s),(a||0===a)&&(o+=a),o+='\n    <br>\n    <a href="',s={hash:{}},n=i.i18n,a=n?n.call(e,"sleep_modal_faq_href",s):h.call(e,"i18n","sleep_modal_faq_href",s),(a||0===a)&&(o+=a),o+='">',s={hash:{}},n=i.i18n,a=n?n.call(e,"sleep_modal_faq",s):h.call(e,"i18n","sleep_modal_faq",s),(a||0===a)&&(o+=a),o+="</a>\n</p>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h=i.helperMissing,c=this;return r={hash:{},inverse:c.noop,fn:c.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.tooltips",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.tooltips",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_help_sleepModal",t),t}),define("galileo/util/help",["jquery","popup","hbs!galileo/tile/template/help/activeMinutes","hbs!galileo/tile/template/help/calories","hbs!galileo/tile/template/help/weight","hbs!galileo/tile/template/help/addTile","hbs!galileo/tile/template/help/personalize","hbs!galileo/tile/template/help/settings","hbs!galileo/tile/template/help/expand","hbs!galileo/tile/template/help/sleepModal","ajaxQueue"],function(e,t,i,n,a,s,o,l,r,h,c){var d=26784e5,u=new t({className:"tiles-tooltip"}),p={activeMinutes:i,calories:n,weight:a},g={sleep:h},f=function(){this.state={newUser:!0},this.init=function(){this.$dash=e("#dash"),this.fetchState()},this.handle=function(t){var i=this,n=arguments[1],a=p[n.tileName];switch(t){case"setupModal":var o=g[n.options.tileClass];o&&n.body.on("mouseover",".tileInfo",function(t){var i=e(t.target);i[0]&&"mouseover"==t.type&&u.showHTML(o,i)});break;case"initTile":this.state.newUser&&a&&n.container.on("mouseover.ngd-info",function(t){var i=e(t.target).closest(".tileInfo");i[0]&&"mouseover"==t.type&&u.showHTML(a,i)}),this.state.hasClickedExpand||n.container.on("mouseover.ngd-expand-info",function(t){var a=e(t.target).closest(".js_expandButton");a[0]&&i.handle("tileExpandHover",n,a)}),this.state.hasClickedSettings||n.container.on("mouseover.ngd-settings-info",function(t){var a=e(t.target).closest(".settingsButton");a[0]&&i.handle("tileSettingsHover",n,a)});break;case"tileDrawerInit":if(!this.state.hasOpenedDrawer){var h=this.tileDrawer=arguments[1];h.$openTab.on("mouseenter.ngd-drawer-info",function(){u.showHTML(s,h.$openTab,"right")})}break;case"tileDrawerOpened":this.state.hasOpenedDrawer||(this.tileDrawer&&this.tileDrawer.$openTab.off("mouseenter.ngd-drawer-info"),this.saveState("hasOpenedDrawer",!0));break;case"tileHover":break;case"tileDrag":u.hide(),this.state.hasMovedTile||(this.$dash.removeClass("personalizing"),this.saveState("hasMovedTile",!0));break;case"tileSettingsHover":if(!this.state.hasClickedSettings){var c=arguments[2];u.showHTML(l,c)}break;case"tileExpandHover":if(!this.state.hasClickedExpand){var c=arguments[2];u.showHTML(r,c)}break;case"showExpanded":u.hide(),this.state.hasClickedExpand||this.saveState("hasClickedExpand",!0);break;case"showSettings":u.hide(),this.state.hasClickedSettings||this.saveState("hasClickedSettings",!0)}},this.saveState=function(e,t){this.state[e]=t,c.push({method:"post",url:"/userSettings/dh/save?apiFormat=json",value:{"settings['dashboard help state']":JSON.stringify(this.state),csrfToken:window.fitbitCsrfToken}})},this.fetchState=function(){var t=this;e.post("/userSettings/dh?apiFormat=json",{csrfToken:window.fitbitCsrfToken},function(i){if(i){if(i=i.result,i.success&&i.settings&&i.settings["dashboard help state"]){var n=JSON.parse(i.settings["dashboard help state"]);n.firstViewDate&&(t.state=n,n.newUser&&new Date-new Date(n.firstViewDate)>d&&t.saveState("newUser",!1))}t.state.firstViewDate?void 0===t.state.hasClickedExpand&&t.saveState("hasClickedExpand",!0):t.saveState("hasClickedExpand",!1),t.state.firstViewDate||t.saveState("firstViewDate",(new Date).getTime()),t.state.newUser&&e("#dash").addClass("newUser"),t.state.hasOpenedDrawer&&t.tileDrawer&&t.tileDrawer.$openTab.off("mouseenter.ngd-drawer-info")}},"json")},this.init()};return new f}),define("galileo/layout/tiles",["require","mootools","galileo/prototype/all","galileo/jqueryPlugin/clickDrag","galileo/model/user","galileo/util/help","underscore","jquery"],function(e){function t(e,t){var i=Math.floor(e.left/(p+g)).limit(0,t-1),n=Math.max(0,Math.floor(e.top/(p+g)));return t*n+i}function i(e,t){var i=e%t,n=Math.floor(e/t);return{left:i*(p+g),top:n*(p+g)}}function n(e,t,n){e.animatePositionTo(i(t,u),n)}function a(e,t){var n=t.length;e.css({height:i(n+u-1,u).top+30,width:u*(p+g)})}function s(e,t,n,s){for(var o=0,l=[],r=0;r<t.length;r++){var h=t[r];h!==s&&(o=f(e,o,h),h.animatePositionTo(i(o,u),200))}return a(n,e),c.each(e,function(e){e&&!c.contains(l,e)&&l.push(e)}),l}function o(e,n,a,o,l){function r(t,n){if(h!==n){var a=[];n=f(a,n,t),h=n,g.css(i(n,u)),e=s(a,e,o,t)}}var h,p=n.container||n.$el;e.indexOf(n);c.each(e,function(e){e.animateZTo(e===n?1:0)});var g=d('<div class="marker">').appendTo(o).css({position:"absolute",border:"2px dashed green",width:p.width(),height:p.height()});return r(n,t({top:a.clientY-o.offset().top,left:a.clientX-o.offset().left},u)),{dragmove:function(e){var i=o.offset(),a=e.pageX-i.left,s=e.pageY-i.top,l={left:a-p.width()/2,top:s-p.height()/2},h=t(l,u);n.animatePositionTo(l,0),r(n,h);var c=40;d(window).height()-e.clientY<=c&&window.scrollBy(0,d(window).height()-e.clientY),e.clientY<=c&&window.scrollBy(0,-e.clientY)},dragend:function(t){g.remove(),l(e)},dragabort:function(t){g.remove(),l(e)}}}function l(e){var t=e.map(function(e){return e.tileName});return d.post("/userSettings/dh/save?apiFormat=json",{"settings['galileo dashboard state']":JSON.stringify(t),csrfToken:window.fitbitCsrfToken},function(){})}e("mootools"),e("galileo/prototype/all"),e("galileo/jqueryPlugin/clickDrag");var r=e("galileo/model/user").viewer,h=e("galileo/util/help"),c=e("underscore"),d=e("jquery"),u=null,p=275,g=10,f=function(e,t,i){var n=function(t,i,n){for(var a=u>t%u+i-1;a&&n-->0;){var s=u*n,o=t+s,l=o+i,r=e.slice(o,l);a=a&&c.every(r,function(e){return void 0===e})}return a};if("small"===i.shape){for(;!n(t,1,1);)t++;e[t]=i}else if("wide"===i.shape){for(;!n(t,2,1);)t++;e[t]=e[t+1]=i}else if("responsive-triple-wide"===i.shape)if(u>2){for(;!n(t,3,1);)t++;e[t]=e[t+1]=e[t+2]=i}else{for(;!n(t,2,1);)t++;e[t]=e[t+1]=i}else{if("tall"!==i.shape)return!1;for(;!n(t,1,2);)t++;e[t]=e[t+u]=i}return t};return function(e,t,i){function p(i){var n=i.main||i.$el,a={dragstart:function(n){if(_)return!1;w=!0,h.handle("tileDrag",i);var r=o(e,i,n,t,function(n){e=n,l(n),c.map(n,function(e){e!=i&&e.animateZTo(0)}),s([],n,t),w=!1});return c.extend(a,r),!0},click:function(e){var t,a;i.hasModal&&"small"==i.shape&&i.container.hasClass("today")&&(h.handle("showExpanded",i),t=d(e.target),a=n.find(".content"),(a.has(t).length||a.is(t))&&i.openModal())}};i.dragElement=n,i._cleanupClickDrag=n.clickDrag(300,a)}function g(n){var a=n.container||n.$el;n instanceof Backbone.View||n.showLoading(),t.append(a),p(n),a.hover(function(){w||_||(h.handle("tileHover",n),n.animateZTo(1))},function(){w||_||n.animateZTo(0)}),n.on("remove",function(){if(!w&&!_){i.tileDrawer.tileRemoved(n.tileName);var a=e.indexOf(n);e.splice(a,1),l(e),s([],e,t)}}),n.on({showSettings:function(){b&&b.hideSettings(),b=this},hideSettings:function(){b==this&&(b=void 0)}})}function m(i,n,a){var o=new n({date:a,user:r});return e.push(o),g(o),s([],e,t),o.showTile&&o.showTile(),o}function v(i){u!==i&&(u=i,s([],e,t))}function y(){v(i.currentGridColumns())}var b,w=!1,_=!1;return c.map(e,g),y(),d(function(){d(window).on("resize",y)}),{addTile:m,saveTileState:l,setupTileDrag:p,positionTile:f,animateToIndex:n,setContainerSize:c.partial(a,t)}}}),define("hbs!galileo/page/template/tileDrawer",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/tiledrawer","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n\n<div class="tileDrawer">\n\n    <div class="panel">\n\n        <div class="addDialog">\n\n            <div class="title">',s={hash:{}},n=i.i18n,a=n?n.call(e,"add_tiles_dash",s):h.call(e,"i18n","add_tiles_dash",s),(a||0===a)&&(o+=a),o+='</div>\n\n            <ul class="tileList">\n\n            </ul>\n\n            <div class="addTiles">\n                <span class="addButton">',s={hash:{}},n=i.i18n,a=n?n.call(e,"add_tiles",s):h.call(e,"i18n","add_tiles",s),
(a||0===a)&&(o+=a),o+='</span>\n            </div>\n\n        </div>\n\n        <div class="noTiles invisible">\n            <h2>',s={hash:{}},n=i.i18n,a=n?n.call(e,"more_coming_soon",s):h.call(e,"i18n","more_coming_soon",s),(a||0===a)&&(o+=a),o+="</h2>\n            <p>",s={hash:{}},n=i.i18n,a=n?n.call(e,"all_tiles_added",s):h.call(e,"i18n","all_tiles_added",s),(a||0===a)&&(o+=a),o+='</p>\n            <span class="dismissDialog">',s={hash:{}},n=i.i18n,a=n?n.call(e,"add_tiles",s):h.call(e,"i18n","add_tiles",s),(a||0===a)&&(o+=a),o+='</span>\n        </div>\n\n    </div>\n\n    <span class="collapseDrawer"><i class="fitglyph fitglyph-arrow-left size-f"></i></span>\n    <span class="expandDrawer"><i class="fitglyph fitglyph-expand size-f"></i></span>\n\n</div>\n\n<div class="dashOverlay"></div>\n'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h=i.helperMissing,c=this;return r={hash:{},inverse:c.noop,fn:c.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.tiledrawer",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.tiledrawer",r),l||0===l?l:""});return e.registerPartial("galileo_page_template_tileDrawer",t),t}),define("hbs!galileo/page/template/tileDrawerTilesTemplate",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a="";return a+='\n<li class="availableTile ',(n=i.tileName)?n=n.call(e,{hash:{}}):(n=e.tileName,n=typeof n===r?n.apply(e):n),a+=h(n)+"\n                    ",n=i["if"].call(e,e.enabled,{hash:{},inverse:c.noop,fn:c.program(2,o,t)}),(n||0===n)&&(a+=n),a+='\n                ">\n    <i class="fitglyph fitglyph-',(n=i.tileName)?n=n.call(e,{hash:{}}):(n=e.tileName,n=typeof n===r?n.apply(e):n),a+=h(n)+' size-e"></i>\n    ',(n=i.title)?n=n.call(e,{hash:{}}):(n=e.title,n=typeof n===r?n.apply(e):n),a+=h(n)+'\n    <div class="checkbox">\n        <i class="fitglyph fitglyph-check size-g"></i>\n    </div>\n</li>\n'}function o(e,t){return"\n                        invisible\n                    "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var l,r="function",h=this.escapeExpression,c=this;return l=i.each.call(t,t.tiles,{hash:{},inverse:c.noop,fn:c.program(1,s,a)}),l||0===l?l:""});return e.registerPartial("galileo_page_template_tileDrawerTilesTemplate",t),t}),define("galileo/page/tileDrawer",["require","galileo/util/help","hbs!./template/tileDrawer","hbs!./template/tileDrawerTilesTemplate","jquery","underscore","galileo/model/user","mootools","galileo/prototype/array"],function(e){function t(){var e=o.filter(this.tiles,function(e){return e.selected&&e.tileName});this.addTiles(e)}var i=e("galileo/util/help"),n=e("hbs!./template/tileDrawer"),a=e("hbs!./template/tileDrawerTilesTemplate"),s=e("jquery"),o=e("underscore");e("galileo/model/user").viewer;return e("mootools"),e("galileo/prototype/array"),new Class({Implements:[Events,Options],options:{drawerWidth:360},initialize:function(e,t,i,n,a){this.setOptions(a),this.updateTiles(e,t),this.container=i,this.dash=n,this.open=!1},updateTiles:function(e,t){var i=o.filter(this.tiles,function(e){return e.enabled});this.tiles=o.chain(e).map(function(e,n){return{tileName:n,tileClass:e,selected:!1,enabled:!!o.findWhere(i,{tileName:n})||!!o.findWhere(t,{tileName:n}),selectionEl:null,title:e.prototype.title}}).sortBy("title").value()},renderTilesList:function(){this.$tiles&&this.$tiles.remove(),this.$tiles=s(a({tiles:this.tiles})),this.$drawerHtml.find(".tileList").append(this.$tiles)},createElements:function(){var e;this.$drawerHtml=e=s(n({tiles:this.tiles})),this.drawer=e.appendTo(this.container),this.renderTilesList(),this.$openTab=e.find(".expandDrawer"),this.$collapseDrawer=e.find(".collapseDrawer"),this.$addDialog=e.find(".addDialog"),this.$noTiles=e.find(".noTiles"),this.$addButton=e.find(".addButton"),this.$tileListEl=e.find(".tileList"),this.$drawerPanel=e.find(".panel"),this.$dashOverlay=e.filter(".dashOverlay"),this.$dismissDialog=e.find(".dismissDialog"),this.updateSelections()},updateSelections:function(){var e=this,t=0,i=this.$drawerHtml.find(".availableTile");o.each(this.tiles,function(n,a){n.selected=!1,n.selectionEl=i.eq(a),n.selectionEl.removeClass("selected"),n.enabled?n.selectionEl.addClass("invisible"):(t++,n.selectionEl.removeClass("invisible")),n.selectionEl.off("click"),n.selectionEl.on("click",function(){n.selected?e.deselectTile(n):e.selectTile(n)})}),0===t?(this.$addDialog.addClass("invisible"),this.$noTiles.removeClass("invisible")):(this.$addDialog.removeClass("invisible"),this.$noTiles.addClass("invisible")),this._setDimensions()},createEvents:function(){var e=this;i.handle("tileDrawerInit",this),this.$openTab.on("click",function(){e.toggleDrawer()}),this.$dashOverlay.on("click",this.closeDrawer.bind(this)),this.$dismissDialog.on("click",this.closeDrawer.bind(this)),s(document).on("keydown",function(t){27===t.keyCode&&e.closeDrawer()}),this.$collapseDrawer.add(this.$addButton).on("click",function(){t.call(e)}),s(window).on("resize",function(){e._setDimensions()})},tileRemoved:function(e){var t=o.findWhere(this.tiles,{tileName:e});t&&(t.enabled=!1,this.updateSelections())},addTiles:function(e){this.closeDrawer(),e.length&&(o.each(e,function(e){e.selected=!1,e.enabled=!0},this),this.updateSelections(),this.fireEvent("addTiles",[e]))},closeDrawer:function(){this.open=!1,this.drawer.removeClass("open"),this.dash.css("left",0),this.$dashOverlay.removeClass("open"),this.container.removeClass("drawerOpen"),this.dash.removeClass("drawerOpen")},openDrawer:function(){var e,t,n=this.options.drawerWidth,a=n,s=50;i.handle("tileDrawerOpened",this),this.open=!0,this.drawer.addClass("open"),this.$dashOverlay.addClass("open"),this.dash.addClass("drawerOpen"),this.container.addClass("drawerOpen"),e=this.dash.offset().left,a-e>-s&&(t=a-e,t+=s,this.dash.css("left",t)),this._setDimensions()},selectTile:function(e){return this._chooseTile(e,!0),this},deselectTile:function(e){return this._chooseTile(e,!1),this},_chooseTile:function(e,t){return e&&(e.selected=t,e.selectionEl[t?"addClass":"removeClass"]("selected")),this},_setDimensions:function(){var e=this.container.innerHeight(),t=e;this.$drawerPanel.find(".title").outerHeight(!0),this.$drawerPanel.find(".addTiles").outerHeight(!0);[this.$drawerPanel,this.$dashOverlay].invoke("height",t)},showDrawer:function(){this.drawer.show()},hideDrawer:function(){this.drawer.hide()},toggleDrawer:function(){this.open?this.closeDrawer():this.openDrawer()}})}),define("hbs!galileo/tile/template/dateNav",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/datenav","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,r="";return r+='\n<div id="dashDateNav" ',n=i["if"].call(e,e.isToday,{hash:{},inverse:d.noop,fn:d.program(2,o,t)}),(n||0===n)&&(r+=n),r+='>\n    <span class="block todayIcon"></span>\n    <section class="block buttons">\n        <a class="prev">\n            <span class="icon">',s={hash:{}},n=i.i18n,a=n?n.call(e,"previous",s):u.call(e,"i18n","previous",s),(a||0===a)&&(r+=a),r+='</span>\n        </a>\n        <a class="next',a=i["if"].call(e,e.isToday,{hash:{},inverse:d.noop,fn:d.program(4,l,t)}),(a||0===a)&&(r+=a),r+='">\n            <span class="icon">',s={hash:{}},n=i.i18n,a=n?n.call(e,"next",s):u.call(e,"i18n","next",s),(a||0===a)&&(r+=a),r+='</span>\n        </a>\n    </section>\n    <section class="block period">\n        <strong class="weekday">',(a=i.weekday)?a=a.call(e,{hash:{}}):(a=e.weekday,a=typeof a===p?a.apply(e):a),r+=g(a)+'</strong>\n        <p class="dateSet">',(a=i.date)?a=a.call(e,{hash:{}}):(a=e.date,a=typeof a===p?a.apply(e):a),r+=g(a)+"</p>\n    </section>\n</div>\n"}function o(e,t){return'class="today"'}function l(e,t){return" invisible"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,h,c,d=this,u=i.helperMissing,p="function",g=this.escapeExpression;return c={hash:{},inverse:d.noop,fn:d.program(1,s,a)},r=i["i18n-namespace"],h=r?r.call(t,"com.fitbit.app.ngd.datenav",c):u.call(t,"i18n-namespace","com.fitbit.app.ngd.datenav",c),h||0===h?h:""});return e.registerPartial("galileo_tile_template_dateNav",t),t}),define("galileo/page/dateNav",["require","jquery","mootools","i18n/i18n","galileo/util/dateUtil","i18n-load!com/fitbit/util/dateutil"],function(e){e("jquery"),e("mootools");var t=e("i18n/i18n")(),i=e("galileo/util/dateUtil");t.namespace(e("i18n-load!com/fitbit/util/dateutil"));var n=new Class({Implements:[Events,Options],options:{startDate:void 0,date:void 0,elements:{previous:".prev",next:".next",date:".dateSet",weekday:".weekday"},localeFormats:{date:"MMMM dd",weekday:"EEEE"}},initialize:function(e,t){this.setup(e,t)},setup:function(e,t){return this.element=$(e),this.setOptions(t),this.setupDate(),this.setupElements(),this.setupEvents(),this.attachEvents(),this},setupDate:function(){var e=this.options.startDate||this.options.date||new Date,t=this.options.date||new Date;return this.startDate=new Date(e),this.date=new Date(t),this},setupElements:function(){return this.elements=Object.map(this.options.elements,function(e){return this.element.find(e)},this),this},setupEvents:function(){this.bound={clickNext:this.clickNext.bind(this),clickPrev:this.clickPrev.bind(this)}},attachEvents:function(){var e=this.elements;e.next.on("click",this.bound.clickNext),e.previous.on("click",this.bound.clickPrev)},detachEvents:function(){var e=this.elements;e.next.off("click",this.bound.clickNext),e.previous.off("click",this.bound.clickPrev)},clickNext:function(e){e.preventDefault(),this.date=i.plusDays(this.date,1),this.update()},clickPrev:function(e){e.preventDefault(),this.date=i.minusDays(this.date,1),this.update()},update:function(){var e,t,n=this.options.localeFormats,a=this.elements;return e=this.getStrWeekday(this.date),t=i.localeFormat(this.date,n.date),a.weekday.html(e),a.date.html(t),this.fireEvent("update",[this.date]),this},getStrWeekday:function(e){var n,a=this.getDateDiffFromStart(e);return n=0===a?t("today"):1===a?t("yesterday"):i.localeFormat(e,this.options.localeFormats.weekday)},getDateDiffFromStart:function(e){return i.diffInDays(this.startDate,e)}});return n}),define("hbs!galileo/tile/template/help/TourPopup",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/label","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,l="";return l+='\n<div class="tour-popup">\n    ',n=i.each.call(e,e.states,{hash:{},inverse:v.noop,fn:v.program(2,o,t)}),(n||0===n)&&(l+=n),l+='\n    <div class="navigation">\n        <span class="arrow previous">',s={hash:{}},n=i.i18n,a=n?n.call(e,"prev",s):m.call(e,"i18n","prev",s),(a||0===a)&&(l+=a),l+='</span>\n        <span class="dots">\n            ',a=i.each.call(e,e.states,{hash:{},inverse:v.noop,fn:v.program(8,c,t)}),(a||0===a)&&(l+=a),l+='\n        </span>\n        <span class="arrow next">',s={hash:{}},n=i.i18n,a=n?n.call(e,"next",s):m.call(e,"i18n","next",s),(a||0===a)&&(l+=a),l+="</span>\n    </div>\n</div>\n"}function o(e,t){var n,a,s,o="";return o+="\n    ",s={hash:{},inverse:v.noop,fn:v.program(3,l,t)},n=i["i18n-namespace"],a=n?n.call(e,"com.fitbit.app.label",s):m.call(e,"i18n-namespace","com.fitbit.app.label",s),(a||0===a)&&(o+=a),o+="\n    "}function l(e,t){var n,a="";return a+='\n    <div class="tour-state">\n        <h3>',(n=i.header)?n=n.call(e,{hash:{}}):(n=e.header,n=typeof n===g?n.apply(e):n),a+=f(n)+"</h3>\n        ",n=i["if"].call(e,e.body,{hash:{},inverse:v.noop,fn:v.program(4,r,t)}),(n||0===n)&&(a+=n),a+="\n        ",n=i["if"].call(e,e.link,{hash:{},inverse:v.noop,fn:v.program(6,h,t)}),(n||0===n)&&(a+=n),a+="\n    </div>\n    "}function r(e,t){var n,a="";return a+="<p>",(n=i.body)?n=n.call(e,{hash:{}}):(n=e.body,n=typeof n===g?n.apply(e):n),a+=f(n)+"</p>"}function h(e,t){var n,a,s,o="";return o+='<a href="',(n=i.link)?n=n.call(e,{hash:{}}):(n=e.link,n=typeof n===g?n.apply(e):n),o+=f(n)+'">',s={hash:{}},n=i.i18n,a=n?n.call(e,"learn_more",s):m.call(e,"i18n","learn_more",s),(a||0===a)&&(o+=a),o+="</a>"}function c(e,t){return'\n            <span class="dot"></span>\n            '}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var d,u,p,g="function",f=this.escapeExpression,m=i.helperMissing,v=this;return p={hash:{},inverse:v.noop,fn:v.program(1,s,a)},d=i["i18n-namespace"],u=d?d.call(t,"com.fitbit.app.label",p):m.call(t,"i18n-namespace","com.fitbit.app.label",p),u||0===u?u:""});return e.registerPartial("galileo_tile_template_help_TourPopup",t),t}),define("galileo/widget/TourPopup",["require","popup","hbs!galileo/tile/template/help/TourPopup"],function(e){var t=e("popup"),i=e("hbs!galileo/tile/template/help/TourPopup");return t.extend({initialize:function(e){t.prototype.initialize.apply(this,arguments),this.model.set("states",e.states,{silent:!0})},template:i,events:{"click .continue":"nextMeter","click .previous":"previousMeter","click .next.close":"beginHide"},showAtIndex:function(e){var t=this.$(".dot"),i=t.length;e===i-1?this.$(".next").addClass("close").removeClass("continue"):this.$(".next").removeClass("close").addClass("continue"),0===e?this.$(".previous").css("visibility","hidden"):this.$(".previous").css("visibility","visible"),t.removeClass("active").eq(e).addClass("active"),this.$(".tour-state").hide().eq(e).show(),this.index=e;var n=this.model.get("states")[e].anchor();return this.setPosition("top",n).positionPopup(),this},nextMeter:function(){this.showAtIndex(++this.index)},previousMeter:function(){this.showAtIndex(--this.index)}})}),function(e){e.ajaxSettings.xdr=function(){return window.XDomainRequest?new window.XDomainRequest:null},function(t){e.extend(e.support,{iecors:!!t})}(e.ajaxSettings.xdr()),e.support.iecors&&e.ajaxTransport(function(e){var t=e.xdr();return{send:function(i,n){t.onload=function(){var e={"Content-Type":t.contentType};n(200,"OK",{text:t.responseText},e)},e.xhrFields&&(xhr.onerror=e.xhrFields.error,xhr.ontimeout=e.xhrFields.timeout),t.open(e.type,e.url),t.send(e.hasContent&&e.data||null)},abort:function(){t.abort()}}})}(jQuery),define("shared/scripts/libs/jquery/plugins/iecors/jquery.iecors",function(){}),define("Logger",[],function(){return function(){try{window.onerror.apply(window,arguments)}catch(e){}}}),function(){function e(e){this.message=e}var i="undefined"!=typeof t?t:this,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.prototype=new Error,e.prototype.name="InvalidCharacterError",i.btoa||(i.btoa=function(t){for(var i,a,s=String(t),o=0,l=n,r="";s.charAt(0|o)||(l="=",o%1);r+=l.charAt(63&i>>8-o%1*8)){if(a=s.charCodeAt(o+=.75),a>255)throw new e("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");i=i<<8|a}return r}),i.atob||(i.atob=function(t){var i=String(t).replace(/=+$/,"");if(i.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var a,s,o=0,l=0,r="";s=i.charAt(l++);~s&&(a=o%4?64*a+s:s,o++%4)?r+=String.fromCharCode(255&a>>(-2*o&6)):0)s=n.indexOf(s);return r})}(),define("shared/scripts/libs/polyfills/base64",function(){}),define("shared/scripts/modules/api-client",["require","../libs/jquery/plugins/iecors/jquery.iecors","jquery","underscore","Logger","galileo/model/user","../libs/polyfills/base64"],function(e){function t(e){var t=e.useDistanceUnitSystem?o.distanceUnit:o.weightSystem;return e.acceptsLanguageHeader?e.acceptsLanguageHeader:"US"===t?"en_US":"UK"===t?"en_GB":"METRIC"}e("../libs/jquery/plugins/iecors/jquery.iecors");var i,n=e("jquery"),a=e("underscore"),s=e("Logger"),o=e("galileo/model/user").viewer||{},l=o.apiUrl,r=o.oauth2Token,h=window.atob||e("../libs/polyfills/base64"),c=300,d="Accept-Language";r||s("no oauth2Token in config ajax requests will not work"),l||s("no apiUrl in config ajax requests will not work");var u=function(e){var t=e.split(".");if(3===t.length){var i;try{i=JSON.parse(h(t[1])),a.isNumber(i.exp)||s("expire time is not a number it is a "+typeof i.exp+" of value "+i.exp)}catch(n){s("could not get/parse OAuth token payload token is: "+e)}return 1e3*i.exp}s("incorrect number of segments in oauth token to decode, number: "+t.length+" token: ")},p={Authorization:"Bearer "+r};"US"===o.weightSystem?p[d]="en_US":"UK"===o.weightSystem?p[d]="en_GB":p[d]="METRIC";var g=function(e){return"https://"+l+("/"===e.charAt(0)?"":"/")+e},f=function(){return n.get("/dashOAuth/token").done(function(e){p.Authorization="Bearer "+e.oauthToken}).fail(function(e,t,i){s("cannot refresh oauth token: "+i)})},m=function(e){if(a.isObject(e)||window.onerror("settings must be an object not: "+e),Date.now()+c>=u(p.Authorization)){i&&"resolved"!==i.state()||(i=f());var s=new n.Deferred;return i.done(function(){var t=m(e);t.done(function(){s.resolve.apply(this,arguments)}),t.fail(function(){s.reject.apply(this,arguments)})}),s}return e.headers=a.defaults(e.headers||{},p),e.headers[d]=t(e),n.ajax(e)},v=function(e){e.ajax=m};return{ajax:m,refreshToken:f,makeFullUrl:g,updateBackbone:v}}),define("galileo/model/GlobalModelBroker",["require","underscore","backbone"],function(e){var t=e("underscore"),i=e("backbone");return t.extend({models:{}},i.Events)}),define("galileo/model/SharedModel",["require","backbone","underscore","galileo/model/GlobalModelBroker"],function(e){var t=e("backbone"),i=e("underscore"),n=e("galileo/model/GlobalModelBroker"),a=n.models,s=t.Model.extend({lookup:function(e){var t=e[this.idAttribute];return t&&i.result(this,"url")+":"+t},constructor:function(e,t){var o=e||{};if(t||(t={}),!t.noShare){var l;if(i.isFunction(this.lookup)){var r=i.extend({},this.defaults,o);l=this.lookup(r,t)}else l=this.lookup;var h=a[l];if(l){if(h)return t.collection&&(h.collection=t.collection),t.parse&&o&&(o=h.parse(o,t)||{}),h.set(o,t),h;n.listenTo(this,"destroy",function(){delete a[l]}),a[l]=this}}s.__super__.constructor.apply(this,arguments)}});return s}),define("galileo/model/ProfileModel",["require","exports","module","galileo/model/SharedModel","shared/scripts/modules/api-client","underscore"],function(e,t,i){var n=e("galileo/model/SharedModel"),a=e("shared/scripts/modules/api-client"),s=e("underscore"),o=1,l=n.extend({initialize:function(e,t){l.__super__.initialize.apply(this,arguments),this.user=t&&t.user},url:function(){return a.makeFullUrl("/"+o+"/user/"+this.user.encodedId+"/profile.json")},lookup:function(e,t){return i.uri+"_"+t.user.encodedId},parse:function(e){return e.user&&(e=e.user),e},validate:function(e){return this.user?s.isEmpty(e)?"no attributes":void 0:"the ProfileModel requires a User model to function properly."},sync:function(e,t,i){return"read"!==e&&(i.data=t.toJSON(),i.emulateJSON=!0),l.__super__.sync.call(this,e,t,i)}});return l}),define("galileo/util/loggedInSwitchLocale",["galileo/model/ProfileModel","shared/scripts/modules/api-client","backbone"],function(e,t,i){return function(n,a,s){t.updateBackbone(i);var o=new e(null,{user:a});o.save({locale:n},{success:s})}}),define("galileo/util/switchLocale",[],function(){return function(e,t){window.global_page_viewer&&window.global_page_viewer.encodedId?require(["galileo/util/loggedInSwitchLocale"],function(i){i(e,window.global_page_viewer,t)}):$.post("/i18n/switch",{locale:e,csrfToken:window.fitbitCsrfToken},t)}}),define("galileo/page/default_tiles",["require","underscore","galileo/model/user","galileo/page/dash","galileo/model/user"],function(e){var t=e("underscore");return{defaults:{STEPS:function(){var t=e("galileo/model/user").viewer,i=["badges","weeklyActivity","water","exercise"],n=[{type:"exercise",priority:170},{type:"badges",priority:90},{type:"water",priority:50}],a=[];if(t.getTrackerType()){i=i.concat(["goalTile","tripleWideActivity"]),a=["calories","steps","floors","distance","activeMinutes","intradayActivities"];var s=e("galileo/page/dash"),o=3===s.currentGridColumns();n=n.concat([{type:"goalTile",priority:o?300:400},{type:"tripleWideActivity",priority:o?400:300}])}else i=i.concat(["steps","intradayActivities","activeMinutes","distance"]),n=n.concat([{type:"steps",priority:200},{type:"intradayActivities",priority:190},{type:"activeMinutes",priority:120},{type:"distance",priority:110}]);return{available:i,disable:a,visible:n}},HEART_RATE:{available:["restingHeartRate"],visible:[{type:"restingHeartRate",priority:160}]},CALORIES:{available:["weight","calories","calZone","foodPlan"],visible:[{type:"weight",priority:140},{type:"calories",priority:130},{type:"foodPlan",priority:70},{type:"calZone",priority:60}]},ELEVATION:{available:["floors"],visible:[{type:"floors",priority:100}]},SLEEP:{available:["sleep"],visible:[{type:"sleep",priority:150}]},SED_TIME:function(){var t=e("galileo/model/user").viewer;return t.enableSTTile?{available:["sedentaryTime"],visible:[{type:"sedentaryTime",priority:210}]}:{disable:["sedentaryTime"]}},WEIGHT:{available:["weight","badges","foodPlan","calZone","calories","water"],visible:[{type:"weight",priority:0},{type:"calories",priority:0},{type:"badges",priority:0},{type:"foodPlan",priority:0},{type:"calZone",priority:0}]},LEGACY:{available:["weight","foodPlan","calZone"],visible:[{type:"weight",priority:1},{type:"foodPlan",priority:1},{type:"calZone",priority:1}]},TRAINER:{available:["trainer"],visible:[{type:"trainer",priority:-1}]},ONLYSOFTTRACK:{disable:["activeMinutes"]},NO_DEVICE:{available:["weight","foodPlan","calZone","calories","water","exercise"],visible:[{type:"exercise",priority:7},{type:"weight",priority:6},{type:"calories",priority:5},{type:"foodPlan",priority:4},{type:"calZone",priority:3},{type:"water",priority:2}]}},_getFeatureNames:function(e){return t.reduce(e,function(e,t,i){return t&&e.push(i),e},[])},_getCollection:function(e){var i=t.filter(this.defaults,function(i,n){return t.contains(e,n)});return t.map(i,function(e,n){return t.result(i,n)})},getAvailable:function(e){e=e||{};var i=this._getFeatureNames(e),n=this._getCollection(i),a=t.union.apply(t,t.pluck(n,"available")),s=t.union.apply(t,t.pluck(n,"disable"));return a=t.without.apply(t,[a].concat(s)),a.sort(),a},getVisible:function(e){var i=this._getFeatureNames(e),n=this._getCollection(i),a=t.pluck(n,"visible");if(!a||!a.length)return[];a=t.flatten(a),a=t.compact(a),a=t.pluck(a,"type"),a=t.uniq(a);var s=t.union.apply(t,t.pluck(n,"disable"));return a=t.without.apply(t,[a].concat(s)),a.sort(function(e,i){var a=0,s=0;return t.each(n,function(n){t.each(n.visible,function(t){t.type===e?a+=t.priority:t.type===i&&(s+=t.priority)})}),s>a?1:a>s?-1:0}),a}}}),define("galileo/tile/classes/animate",["underscore"],function(){var e=require("underscore");return function(t){return t=e.defaults({},t,{jumbo:!1,z:0,pos:{top:0,left:0}}),{animateZTo:function(e,i){t.z=e,this.animate(t,i)},animatePositionTo:function(e,i,n){t.pos=e,this.animate(t,i,n)},animate:function(e,i,n){var a=this,s=this.container||this.$el;return t=e,s.css("zIndex",e.z).stop(!0,!1).animate(e.pos,i,function(){n&&n(),a.trigger("positionComplete")})}}}}),define("hbs!galileo/tile/template/loading",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var s,o="",l="function",r=this.escapeExpression;return o+='<div class="main">\n    <div class="content" >\n        <h2 class="tileTitle"><span class="title">',(s=i.title)?s=s.call(t,{hash:{}}):(s=t.title,s=typeof s===l?s.apply(t):s),o+=r(s)+'</span></h2>\n        <span class="loadingSpinner">Loading...</span>\n        \n    </div>\n</div>\n'});return e.registerPartial("galileo_tile_template_loading",t),t}),define("hbs!galileo/tile/template/tile",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a="";return a+=" ",(n=i.tileClass)?n=n.call(e,{hash:{}}):(n=e.tileClass,n=typeof n===r?n.apply(e):n),a+=h(n)}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l="",r="function",h=this.escapeExpression,c=this;return l+='<div class="tile',o=i["if"].call(t,t.tileClass,{hash:{},inverse:c.noop,fn:c.program(1,s,a)}),(o||0===o)&&(l+=o),l+=' unflipped">\n    <div class="body"></div>\n</div>\n'});return e.registerPartial("galileo_tile_template_tile",t),t}),define("hbs!galileo/tile/template/dialog/dialogContainer",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var s,o="",l="function";return o+='<div class="dialog">\n    <div class="content">\n        ',(s=i.content)?s=s.call(t,{hash:{}}):(s=t.content,s=typeof s===l?s.apply(t):s),(s||0===s)&&(o+=s),o+="\n    </div>\n</div>"});return e.registerPartial("galileo_tile_template_dialog_dialogContainer",t),t}),define("galileo/tile/template/helpers/ifNotLang",["require","jquery","handlebars","galileo/model/user"],function(e){function t(){var e=!1;if(arguments.length>1){var t=arguments[arguments.length-1],n={};if(i.each(Array.prototype.slice.call(arguments,0,arguments.length-1),function(e,t){n[t]=!0,n[t.split("_")[0].toLowerCase()]=!0}),n[s]?e=!0:n[o]?e=!0:n.european&&-1!==i.inArray(o,l)?e=!0:n.asian&&-1!==i.inArray(o,r)&&(e=!0),!e)return t.fn(this)}}var i=e("jquery"),n=e("handlebars"),a=e("galileo/model/user"),s=a.viewer.locale||"en_US",o=s.split("_")[0],l=["de","es","fr","it"],r=["ja","ko","zh"];return n.registerHelper("ifNotLang",t),t}),define("hbs!galileo/tile/template/dialog/removeTile",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/tile","galileo/tile/template/helpers/i18n","galileo/tile/template/helpers/ifNotLang"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,l="";return l+='\n<div class="removeTile">\n    <p class="message" >\n        ',s={hash:{}},n=i.i18n,a=n?n.call(e,"Remove_confirm_0",s):c.call(e,"i18n","Remove_confirm_0",s),(a||0===a)&&(l+=a),s={hash:{},inverse:d.noop,fn:d.program(2,o,t)},n=i.ifNotLang,a=n?n.call(e,"ja_JP","zh_CN",s):c.call(e,"ifNotLang","ja_JP","zh_CN",s),(a||0===a)&&(l+=a),(a=i.tileName)?a=a.call(e,{hash:{}}):(a=e.tileName,a=typeof a===u?a.apply(e):a),l+=p(a),s={hash:{},inverse:d.noop,fn:d.program(2,o,t)},n=i.ifNotLang,a=n?n.call(e,"ja_JP","zh_CN",s):c.call(e,"ifNotLang","ja_JP","zh_CN",s),(a||0===a)&&(l+=a),s={hash:{}},n=i.i18n,a=n?n.call(e,"Remove_confirm_1",s):c.call(e,"i18n","Remove_confirm_1",s),(a||0===a)&&(l+=a),l+='\n    </p>\n    <div class="buttonContainer clearfix">\n        <span class="confirm" >',s={hash:{}},n=i.i18n,a=n?n.call(e,"remove",s):c.call(e,"i18n","remove",s),(a||0===a)&&(l+=a),l+='</span>\n        <span class="close cancelButton" >',s={hash:{}},n=i.i18n,a=n?n.call(e,"cancel",s):c.call(e,"i18n","cancel",s),(a||0===a)&&(l+=a),l+="</span>\n    </div>\n</div>\n"}function o(e,t){return" "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var l,r,h,c=i.helperMissing,d=this,u="function",p=this.escapeExpression;return h={hash:{},inverse:d.noop,fn:d.program(1,s,a)},l=i["i18n-namespace"],r=l?l.call(t,"com.fitbit.app.ngd.tile",h):c.call(t,"i18n-namespace","com.fitbit.app.ngd.tile",h),r||0===r?r:""});return e.registerPartial("galileo_tile_template_dialog_removeTile",t),t}),function(i,n){var a={regex:function(){var e,t,i,a,s,o,l=arguments;for(t=0;t<l.length;t+=2){var r=l[t],h=l[t+1];if("undefined"==typeof e){for(e={},a=0;a<h.length;a++)"object"==typeof h[a]?e[h[a][0]]=n:e[h[a]]=n;if(""===this.getUA().toString())return e}for(i=0;i<r.length;i++)if(s=r[i].exec(this.getUA())){for(a=0;a<h.length;a++)o=s[a+1],"object"==typeof h[a]&&2===h[a].length?e[h[a][0]]=h[a][1]:"object"==typeof h[a]&&3===h[a].length?"function"!=typeof h[a][1]||h[a][1].exec&&h[a][1].test?e[h[a][0]]=o?o.replace(h[a][1],h[a][2]):n:e[h[a][0]]=o?h[a][1].call(this,o,h[a][2]):n:e[h[a]]=o?o:n;break}if(s)break}return e},string:function(e,t){for(var i in t)if(t.hasOwnProperty(i))if("object"==typeof t[i]&&t[i].length>0){for(var a=0;a<t[i].length;a++)if(-1!==e.toLowerCase().indexOf(t[i][a].toLowerCase()))return"undefined"===i.toString()?n:i}else if(-1!==e.toLowerCase().indexOf(t[i].toLowerCase()))return"undefined"===i.toString()?n:i;return e}},s={browser:{oldsafari:{major:{1:["/85","/125","/312"],2:["/412","/416","/417","/419"],undefined:"/"},version:{"1.0":"/85",1.2:"/125",1.3:"/312","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419",undefined:"/"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",RT:"ARM"}}}},o={browser:[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i,/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\sbrowser|iemobile|slimbrowser|baidubrowser)[\/\s]?((\d+)?[\w\.]*)/i,/ms(ie)\s((\d+)?[\w\.]+)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt)\/((\d+)?[\w\.-]+)/i],["name","version","major"],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[["name","Yandex"],"version","major"],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],["name","version","major"],[/(dolfin)\/((\d+)?[\w\.]+)/i],[["name","Dolphin"],"version","major"],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[["name","Chrome"],"version","major"],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],["version","major",["name","Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],["version","major","name"],[/applewebkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],["name",["major",a.string,s.browser.oldsafari.major],["version",a.string,s.browser.oldsafari.version]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(applewebkit|khtml)\/((\d+)?[\w\.]+)/i],["name","version","major"],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[["name","Netscape"],"version","major"],[/(swiftfox)/i,/(iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris)[\/\s]?((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],["name","version","major"]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],["model","vendor",["type","Tablet"]],[/(hp).+(touchpad)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],["vendor","model",["type","Tablet"]],[/\((ip[honed]+);.+(apple)/i],["model","vendor",["type","Mobile"]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],["vendor","model",["type","Mobile"]],[/\((bb10);\s(\w+)/i],[["vendor","BlackBerry"],"model",["type","Mobile"]],[/android.+((transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+))/i],[["vendor","Asus"],"model",["type","Tablet"]],[/(sony)\s(tablet\s[ps])/i],["vendor","model",["type","Tablet"]],[/(nintendo|playstation)\s([wids3portablev]+)/i],["vendor","model",["type","Console"]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i],["vendor",["model",/_/g," "],["type","Mobile"]],[/\s((milestone|droid[2x]?))[globa\s]*\sbuild\//i,/(mot)[\s-]?(\w+)*/i],[["vendor","Motorola"],"model",["type","Mobile"]],[/android.+\s((mz60\d|xoom[\s2]{0,2}))\sbuild\//i],[["vendor","Motorola"],"model",["type","Tablet"]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n8000|sgh-t8[56]9))/i],[["vendor","Samsung"],"model",["type","Tablet"]],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[["vendor","Samsung"],"model",["type","Mobile"]],[/(sie)-(\w+)*/i],[["vendor","Siemens"],"model",["type","Mobile"]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[["vendor","Nokia"],"model",["type","Mobile"]],[/android\s3\.[\s\w-;]{10}((a\d{3}))/i],[["vendor","Acer"],"model",["type","Tablet"]],[/android\s3\.[\s\w-;]{10}(lg?)-([06cv9]{3,4})/i],[["vendor","LG"],"model",["type","Tablet"]],[/(lg)[e;\s-\/]+(\w+)*/i],[["vendor","LG"],"model",["type","Mobile"]],[/(mobile|tablet);.+rv\:.+gecko\//i],["type","vendor","model"]],engine:[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront)\/([\w\.]+)/i,/(khtml)\/([\w\.]+)/i,/(tasman)\s([\w\.]+)/i],["name","version"],[/rv\:([\w\.]+).*(gecko)/i],["version","name"]],
os:[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone\sos|windows\s?[mobile]*)[\s\/]?([ntce\d\.\s]+\w)/i],["name",["version",a.string,s.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[["name","Windows"],["version",a.string,s.os.windows.version]],[/\((bb)(10);/i],[["name","BlackBerry"],"version"],[/(blackberry).+version\/([\w\.]+)/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],["name","version"],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[["name","Symbian"],"version"],[/(nintendo|playstation)\s([wids3portablev]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],["name","version"],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[["name","Chromium OS"],"version"],[/(sunos)\s?([\w\.]+\d)*/i],[["name","Solaris"],"version"],[/\s(\w*bsd|dragonfly)\s?([\w\.]+)*/i],["name","version"],[/(ip[honead]+).*os\s*([\w]+)*\slike\smac/i],[["name","iOS"],["version",/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],["name",["version",/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|qnx|os\/2|amigaos|morphos)/i,/(unix)\s?([\w\.]+)*/i],["name","version"]]},l=function(e){var t=e||(i&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:"");this.getBrowser=function(){return a.regex.apply(this,o.browser)},this.getDevice=function(){return a.regex.apply(this,o.device)},this.getEngine=function(){return a.regex.apply(this,o.engine)},this.getOS=function(){return a.regex.apply(this,o.os)},this.getResult=function(){return{browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice()}},this.getUA=function(){return t},this.setUA=function(e){return t=e,this},this.setUA(t)};"undefined"==typeof t||/\[object\s[DOM]*Window\]/.test(i.toString())?i.UAParser=l:("undefined"!=typeof e&&e.exports&&(t=e.exports=l),t.UAParser=l)}(this),define("ua-parser",function(e){return function(){var t;return t||e.UAParser}}(this)),
//! moment.js
//! version : 2.8.3
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
function(t){function i(e,t,i){switch(arguments.length){case 2:return null!=e?e:t;case 3:return null!=e?e:null!=t?t:i;default:throw new Error("Implement me")}}function n(e,t){return Me.call(e,t)}function a(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function s(e){we.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function o(e,t){var i=!0;return p(function(){return i&&(s(e),i=!1),t.apply(this,arguments)},t)}function l(e,t){vt[e]||(s(t),vt[e]=!0)}function r(e,t){return function(i){return m(e.call(this,i),t)}}function h(e,t){return function(i){return this.localeData().ordinal(e.call(this,i),t)}}function c(){}function d(e,t){t!==!1&&P(e),g(this,e),this._d=new Date(+e._d)}function u(e){var t=S(e),i=t.year||0,n=t.quarter||0,a=t.month||0,s=t.week||0,o=t.day||0,l=t.hour||0,r=t.minute||0,h=t.second||0,c=t.millisecond||0;this._milliseconds=+c+1e3*h+6e4*r+36e5*l,this._days=+o+7*s,this._months=+a+3*n+12*i,this._data={},this._locale=we.localeData(),this._bubble()}function p(e,t){for(var i in t)n(t,i)&&(e[i]=t[i]);return n(t,"toString")&&(e.toString=t.toString),n(t,"valueOf")&&(e.valueOf=t.valueOf),e}function g(e,t){var i,n,a;if("undefined"!=typeof t._isAMomentObject&&(e._isAMomentObject=t._isAMomentObject),"undefined"!=typeof t._i&&(e._i=t._i),"undefined"!=typeof t._f&&(e._f=t._f),"undefined"!=typeof t._l&&(e._l=t._l),"undefined"!=typeof t._strict&&(e._strict=t._strict),"undefined"!=typeof t._tzm&&(e._tzm=t._tzm),"undefined"!=typeof t._isUTC&&(e._isUTC=t._isUTC),"undefined"!=typeof t._offset&&(e._offset=t._offset),"undefined"!=typeof t._pf&&(e._pf=t._pf),"undefined"!=typeof t._locale&&(e._locale=t._locale),Fe.length>0)for(i in Fe)n=Fe[i],a=t[n],"undefined"!=typeof a&&(e[n]=a);return e}function f(e){return 0>e?Math.ceil(e):Math.floor(e)}function m(e,t,i){for(var n=""+Math.abs(e),a=e>=0;n.length<t;)n="0"+n;return(a?i?"+":"":"-")+n}function v(e,t){var i={milliseconds:0,months:0};return i.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(i.months,"M").isAfter(t)&&--i.months,i.milliseconds=+t-+e.clone().add(i.months,"M"),i}function y(e,t){var i;return t=W(t,e),e.isBefore(t)?i=v(e,t):(i=v(t,e),i.milliseconds=-i.milliseconds,i.months=-i.months),i}function b(e,t){return function(i,n){var a,s;return null===n||isNaN(+n)||(l(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),s=i,i=n,n=s),i="string"==typeof i?+i:i,a=we.duration(i,n),w(this,a,e),this}}function w(e,t,i,n){var a=t._milliseconds,s=t._days,o=t._months;n=null==n?!0:n,a&&e._d.setTime(+e._d+a*i),s&&ge(e,"Date",pe(e,"Date")+s*i),o&&ue(e,pe(e,"Month")+o*i),n&&we.updateOffset(e,s||o)}function _(e){return"[object Array]"===Object.prototype.toString.call(e)}function x(e){return"[object Date]"===Object.prototype.toString.call(e)||e instanceof Date}function T(e,t,i){var n,a=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),o=0;for(n=0;a>n;n++)(i&&e[n]!==t[n]||!i&&C(e[n])!==C(t[n]))&&o++;return o+s}function k(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=ct[e]||dt[t]||t}return e}function S(e){var t,i,a={};for(i in e)n(e,i)&&(t=k(i),t&&(a[t]=e[i]));return a}function M(e){var i,n;if(0===e.indexOf("week"))i=7,n="day";else{if(0!==e.indexOf("month"))return;i=12,n="month"}we[e]=function(a,s){var o,l,r=we._locale[e],h=[];if("number"==typeof a&&(s=a,a=t),l=function(e){var t=we().utc().set(n,e);return r.call(we._locale,t,a||"")},null!=s)return l(s);for(o=0;i>o;o++)h.push(l(o));return h}}function C(e){var t=+e,i=0;return 0!==t&&isFinite(t)&&(i=t>=0?Math.floor(t):Math.ceil(t)),i}function D(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function A(e,t,i){return re(we([e,11,31+t-i]),t,i).week}function G(e){return E(e)?366:365}function E(e){return e%4===0&&e%100!==0||e%400===0}function P(e){var t;e._a&&-2===e._pf.overflow&&(t=e._a[De]<0||e._a[De]>11?De:e._a[Ae]<1||e._a[Ae]>D(e._a[Ce],e._a[De])?Ae:e._a[Ge]<0||e._a[Ge]>23?Ge:e._a[Ee]<0||e._a[Ee]>59?Ee:e._a[Pe]<0||e._a[Pe]>59?Pe:e._a[Ie]<0||e._a[Ie]>999?Ie:-1,e._pf._overflowDayOfYear&&(Ce>t||t>Ae)&&(t=Ae),e._pf.overflow=t)}function I(e){return null==e._isValid&&(e._isValid=!isNaN(e._d.getTime())&&e._pf.overflow<0&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated,e._strict&&(e._isValid=e._isValid&&0===e._pf.charsLeftOver&&0===e._pf.unusedTokens.length)),e._isValid}function L(e){return e?e.toLowerCase().replace("_","-"):e}function F(e){for(var t,i,n,a,s=0;s<e.length;){for(a=L(e[s]).split("-"),t=a.length,i=L(e[s+1]),i=i?i.split("-"):null;t>0;){if(n=O(a.slice(0,t).join("-")))return n;if(i&&i.length>=t&&T(a,i,!0)>=t-1)break;t--}s++}return null}function O(e){var t=null;if(!Le[e]&&Oe)try{t=we.locale(),require("./locale/"+e),we.locale(t)}catch(i){}return Le[e]}function W(e,t){return t._isUTC?we(e).zone(t._offset||0):we(e).local()}function N(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function B(e){var t,i,n=e.match(Ue);for(t=0,i=n.length;i>t;t++)n[t]=mt[n[t]]?mt[n[t]]:N(n[t]);return function(a){var s="";for(t=0;i>t;t++)s+=n[t]instanceof Function?n[t].call(a,e):n[t];return s}}function U(e,t){return e.isValid()?(t=R(t,e.localeData()),ut[t]||(ut[t]=B(t)),ut[t](e)):e.localeData().invalidDate()}function R(e,t){function i(e){return t.longDateFormat(e)||e}var n=5;for(Re.lastIndex=0;n>=0&&Re.test(e);)e=e.replace(Re,i),Re.lastIndex=0,n-=1;return e}function j(e,t){var i,n=t._strict;switch(e){case"Q":return Je;case"DDDD":return et;case"YYYY":case"GGGG":case"gggg":return n?tt:ze;case"Y":case"G":case"g":return nt;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return n?it:$e;case"S":if(n)return Je;case"SS":if(n)return Qe;case"SSS":if(n)return et;case"DDD":return He;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return qe;case"a":case"A":return t._locale._meridiemParse;case"X":return Ze;case"Z":case"ZZ":return Ye;case"T":return Xe;case"SSSS":return Ve;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return n?Qe:je;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return je;case"Do":return Ke;default:return i=new RegExp(K(Z(e.replace("\\","")),"i"))}}function H(e){e=e||"";var t=e.match(Ye)||[],i=t[t.length-1]||[],n=(i+"").match(rt)||["-",0,0],a=+(60*n[1])+C(n[2]);return"+"===n[0]?-a:a}function z(e,t,i){var n,a=i._a;switch(e){case"Q":null!=t&&(a[De]=3*(C(t)-1));break;case"M":case"MM":null!=t&&(a[De]=C(t)-1);break;case"MMM":case"MMMM":n=i._locale.monthsParse(t),null!=n?a[De]=n:i._pf.invalidMonth=t;break;case"D":case"DD":null!=t&&(a[Ae]=C(t));break;case"Do":null!=t&&(a[Ae]=C(parseInt(t,10)));break;case"DDD":case"DDDD":null!=t&&(i._dayOfYear=C(t));break;case"YY":a[Ce]=we.parseTwoDigitYear(t);break;case"YYYY":case"YYYYY":case"YYYYYY":a[Ce]=C(t);break;case"a":case"A":i._isPm=i._locale.isPM(t);break;case"H":case"HH":case"h":case"hh":a[Ge]=C(t);break;case"m":case"mm":a[Ee]=C(t);break;case"s":case"ss":a[Pe]=C(t);break;case"S":case"SS":case"SSS":case"SSSS":a[Ie]=C(1e3*("0."+t));break;case"X":i._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":i._useUTC=!0,i._tzm=H(t);break;case"dd":case"ddd":case"dddd":n=i._locale.weekdaysParse(t),null!=n?(i._w=i._w||{},i._w.d=n):i._pf.invalidWeekday=t;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":e=e.substr(0,1);case"gggg":case"GGGG":case"GGGGG":e=e.substr(0,2),t&&(i._w=i._w||{},i._w[e]=C(t));break;case"gg":case"GG":i._w=i._w||{},i._w[e]=we.parseTwoDigitYear(t)}}function $(e){var t,n,a,s,o,l,r;t=e._w,null!=t.GG||null!=t.W||null!=t.E?(o=1,l=4,n=i(t.GG,e._a[Ce],re(we(),1,4).year),a=i(t.W,1),s=i(t.E,1)):(o=e._locale._week.dow,l=e._locale._week.doy,n=i(t.gg,e._a[Ce],re(we(),o,l).year),a=i(t.w,1),null!=t.d?(s=t.d,o>s&&++a):s=null!=t.e?t.e+o:o),r=he(n,a,s,l,o),e._a[Ce]=r.year,e._dayOfYear=r.dayOfYear}function V(e){var t,n,a,s,o=[];if(!e._d){for(a=Y(e),e._w&&null==e._a[Ae]&&null==e._a[De]&&$(e),e._dayOfYear&&(s=i(e._a[Ce],a[Ce]),e._dayOfYear>G(s)&&(e._pf._overflowDayOfYear=!0),n=ae(s,0,e._dayOfYear),e._a[De]=n.getUTCMonth(),e._a[Ae]=n.getUTCDate()),t=0;3>t&&null==e._a[t];++t)e._a[t]=o[t]=a[t];for(;7>t;t++)e._a[t]=o[t]=null==e._a[t]?2===t?1:0:e._a[t];e._d=(e._useUTC?ae:ne).apply(null,o),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()+e._tzm)}}function q(e){var t;e._d||(t=S(e._i),e._a=[t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond],V(e))}function Y(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function X(e){if(e._f===we.ISO_8601)return void Q(e);e._a=[],e._pf.empty=!0;var t,i,n,a,s,o=""+e._i,l=o.length,r=0;for(n=R(e._f,e._locale).match(Ue)||[],t=0;t<n.length;t++)a=n[t],i=(o.match(j(a,e))||[])[0],i&&(s=o.substr(0,o.indexOf(i)),s.length>0&&e._pf.unusedInput.push(s),o=o.slice(o.indexOf(i)+i.length),r+=i.length),mt[a]?(i?e._pf.empty=!1:e._pf.unusedTokens.push(a),z(a,i,e)):e._strict&&!i&&e._pf.unusedTokens.push(a);e._pf.charsLeftOver=l-r,o.length>0&&e._pf.unusedInput.push(o),e._isPm&&e._a[Ge]<12&&(e._a[Ge]+=12),e._isPm===!1&&12===e._a[Ge]&&(e._a[Ge]=0),V(e),P(e)}function Z(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,i,n,a){return t||i||n||a})}function K(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function J(e){var t,i,n,s,o;if(0===e._f.length)return e._pf.invalidFormat=!0,void(e._d=new Date(NaN));for(s=0;s<e._f.length;s++)o=0,t=g({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._pf=a(),t._f=e._f[s],X(t),I(t)&&(o+=t._pf.charsLeftOver,o+=10*t._pf.unusedTokens.length,t._pf.score=o,(null==n||n>o)&&(n=o,i=t));p(e,i||t)}function Q(e){var t,i,n=e._i,a=at.exec(n);if(a){for(e._pf.iso=!0,t=0,i=ot.length;i>t;t++)if(ot[t][1].exec(n)){e._f=ot[t][0]+(a[6]||" ");break}for(t=0,i=lt.length;i>t;t++)if(lt[t][1].exec(n)){e._f+=lt[t][0];break}n.match(Ye)&&(e._f+="Z"),X(e)}else e._isValid=!1}function ee(e){Q(e),e._isValid===!1&&(delete e._isValid,we.createFromInputFallback(e))}function te(e,t){var i,n=[];for(i=0;i<e.length;++i)n.push(t(e[i],i));return n}function ie(e){var i,n=e._i;n===t?e._d=new Date:x(n)?e._d=new Date(+n):null!==(i=We.exec(n))?e._d=new Date(+i[1]):"string"==typeof n?ee(e):_(n)?(e._a=te(n.slice(0),function(e){return parseInt(e,10)}),V(e)):"object"==typeof n?q(e):"number"==typeof n?e._d=new Date(n):we.createFromInputFallback(e)}function ne(e,t,i,n,a,s,o){var l=new Date(e,t,i,n,a,s,o);return 1970>e&&l.setFullYear(e),l}function ae(e){var t=new Date(Date.UTC.apply(null,arguments));return 1970>e&&t.setUTCFullYear(e),t}function se(e,t){if("string"==typeof e)if(isNaN(e)){if(e=t.weekdaysParse(e),"number"!=typeof e)return null}else e=parseInt(e,10);return e}function oe(e,t,i,n,a){return a.relativeTime(t||1,!!i,e,n)}function le(e,t,i){var n=we.duration(e).abs(),a=Se(n.as("s")),s=Se(n.as("m")),o=Se(n.as("h")),l=Se(n.as("d")),r=Se(n.as("M")),h=Se(n.as("y")),c=a<pt.s&&["s",a]||1===s&&["m"]||s<pt.m&&["mm",s]||1===o&&["h"]||o<pt.h&&["hh",o]||1===l&&["d"]||l<pt.d&&["dd",l]||1===r&&["M"]||r<pt.M&&["MM",r]||1===h&&["y"]||["yy",h];return c[2]=t,c[3]=+e>0,c[4]=i,oe.apply({},c)}function re(e,t,i){var n,a=i-t,s=i-e.day();return s>a&&(s-=7),a-7>s&&(s+=7),n=we(e).add(s,"d"),{week:Math.ceil(n.dayOfYear()/7),year:n.year()}}function he(e,t,i,n,a){var s,o,l=ae(e,0,1).getUTCDay();return l=0===l?7:l,i=null!=i?i:a,s=a-l+(l>n?7:0)-(a>l?7:0),o=7*(t-1)+(i-a)+s+1,{year:o>0?e:e-1,dayOfYear:o>0?o:G(e-1)+o}}function ce(e){var i=e._i,n=e._f;return e._locale=e._locale||we.localeData(e._l),null===i||n===t&&""===i?we.invalid({nullInput:!0}):("string"==typeof i&&(e._i=i=e._locale.preparse(i)),we.isMoment(i)?new d(i,!0):(n?_(n)?J(e):X(e):ie(e),new d(e)))}function de(e,t){var i,n;if(1===t.length&&_(t[0])&&(t=t[0]),!t.length)return we();for(i=t[0],n=1;n<t.length;++n)t[n][e](i)&&(i=t[n]);return i}function ue(e,t){var i;return"string"==typeof t&&(t=e.localeData().monthsParse(t),"number"!=typeof t)?e:(i=Math.min(e.date(),D(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,i),e)}function pe(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function ge(e,t,i){return"Month"===t?ue(e,i):e._d["set"+(e._isUTC?"UTC":"")+t](i)}function fe(e,t){return function(i){return null!=i?(ge(this,e,i),we.updateOffset(this,t),this):pe(this,e)}}function me(e){return 400*e/146097}function ve(e){return 146097*e/400}function ye(e){we.duration.fn[e]=function(){return this._data[e]}}function be(e){"undefined"==typeof ender&&(_e=ke.moment,ke.moment=e?o("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",we):we)}for(var we,_e,xe,Te="2.8.3",ke="undefined"!=typeof global?global:this,Se=Math.round,Me=Object.prototype.hasOwnProperty,Ce=0,De=1,Ae=2,Ge=3,Ee=4,Pe=5,Ie=6,Le={},Fe=[],Oe="undefined"!=typeof e&&e.exports,We=/^\/?Date\((\-?\d+)/i,Ne=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Be=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,Ue=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,Re=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,je=/\d\d?/,He=/\d{1,3}/,ze=/\d{1,4}/,$e=/[+\-]?\d{1,6}/,Ve=/\d+/,qe=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Ye=/Z|[\+\-]\d\d:?\d\d/gi,Xe=/T/i,Ze=/[\+\-]?\d+(\.\d{1,3})?/,Ke=/\d{1,2}/,Je=/\d/,Qe=/\d\d/,et=/\d{3}/,tt=/\d{4}/,it=/[+-]?\d{6}/,nt=/[+-]?\d+/,at=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,st="YYYY-MM-DDTHH:mm:ssZ",ot=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],lt=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],rt=/([\+\-]|\d\d)/gi,ht=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),ct={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},dt={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},ut={},pt={s:45,m:45,h:22,d:26,M:11},gt="DDD w W M D d".split(" "),ft="M D H h m s w W".split(" "),mt={M:function(){return this.month()+1},MMM:function(e){return this.localeData().monthsShort(this,e)},MMMM:function(e){return this.localeData().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.localeData().weekdaysMin(this,e)},ddd:function(e){return this.localeData().weekdaysShort(this,e)},dddd:function(e){return this.localeData().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return m(this.year()%100,2)},YYYY:function(){return m(this.year(),4)},YYYYY:function(){return m(this.year(),5)},YYYYYY:function(){var e=this.year(),t=e>=0?"+":"-";return t+m(Math.abs(e),6)},gg:function(){return m(this.weekYear()%100,2)},gggg:function(){return m(this.weekYear(),4)},ggggg:function(){return m(this.weekYear(),5)},GG:function(){return m(this.isoWeekYear()%100,2)},GGGG:function(){return m(this.isoWeekYear(),4)},GGGGG:function(){return m(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return C(this.milliseconds()/100)},SS:function(){return m(C(this.milliseconds()/10),2)},SSS:function(){return m(this.milliseconds(),3)},SSSS:function(){return m(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+m(C(e/60),2)+":"+m(C(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+m(C(e/60),2)+m(C(e)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},vt={},yt=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];gt.length;)xe=gt.pop(),mt[xe+"o"]=h(mt[xe],xe);for(;ft.length;)xe=ft.pop(),mt[xe+xe]=r(mt[xe],2);mt.DDDD=r(mt.DDD,3),p(c.prototype,{set:function(e){var t,i;for(i in e)t=e[i],"function"==typeof t?this[i]=t:this["_"+i]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,i,n;for(this._monthsParse||(this._monthsParse=[]),t=0;12>t;t++)if(this._monthsParse[t]||(i=we.utc([2e3,t]),n="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[t]=new RegExp(n.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,i,n;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;7>t;t++)if(this._weekdaysParse[t]||(i=we([2e3,1]).day(t),n="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[t]=new RegExp(n.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,i){return e>11?i?"pm":"PM":i?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var i=this._calendar[e];return"function"==typeof i?i.apply(t):i},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,i,n){var a=this._relativeTime[i];return"function"==typeof a?a(e,t,i,n):a.replace(/%d/i,e)},pastFuture:function(e,t){var i=this._relativeTime[e>0?"future":"past"];return"function"==typeof i?i(t):i.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return re(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),we=function(e,i,n,s){var o;return"boolean"==typeof n&&(s=n,n=t),o={},o._isAMomentObject=!0,o._i=e,o._f=i,o._l=n,o._strict=s,o._isUTC=!1,o._pf=a(),ce(o)},we.suppressDeprecationWarnings=!1,we.createFromInputFallback=o("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i)}),we.min=function(){var e=[].slice.call(arguments,0);return de("isBefore",e)},we.max=function(){var e=[].slice.call(arguments,0);return de("isAfter",e)},we.utc=function(e,i,n,s){var o;return"boolean"==typeof n&&(s=n,n=t),o={},o._isAMomentObject=!0,o._useUTC=!0,o._isUTC=!0,o._l=n,o._i=e,o._f=i,o._strict=s,o._pf=a(),ce(o).utc()},we.unix=function(e){return we(1e3*e)},we.duration=function(e,t){var i,a,s,o,l=e,r=null;return we.isDuration(e)?l={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(l={},t?l[t]=e:l.milliseconds=e):(r=Ne.exec(e))?(i="-"===r[1]?-1:1,l={y:0,d:C(r[Ae])*i,h:C(r[Ge])*i,m:C(r[Ee])*i,s:C(r[Pe])*i,ms:C(r[Ie])*i}):(r=Be.exec(e))?(i="-"===r[1]?-1:1,s=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*i},l={y:s(r[2]),M:s(r[3]),d:s(r[4]),h:s(r[5]),m:s(r[6]),s:s(r[7]),w:s(r[8])}):"object"==typeof l&&("from"in l||"to"in l)&&(o=y(we(l.from),we(l.to)),l={},l.ms=o.milliseconds,l.M=o.months),a=new u(l),we.isDuration(e)&&n(e,"_locale")&&(a._locale=e._locale),a},we.version=Te,we.defaultFormat=st,we.ISO_8601=function(){},we.momentProperties=Fe,we.updateOffset=function(){},we.relativeTimeThreshold=function(e,i){return pt[e]===t?!1:i===t?pt[e]:(pt[e]=i,!0)},we.lang=o("moment.lang is deprecated. Use moment.locale instead.",function(e,t){return we.locale(e,t)}),we.locale=function(e,t){var i;return e&&(i="undefined"!=typeof t?we.defineLocale(e,t):we.localeData(e),i&&(we.duration._locale=we._locale=i)),we._locale._abbr},we.defineLocale=function(e,t){return null!==t?(t.abbr=e,Le[e]||(Le[e]=new c),Le[e].set(t),we.locale(e),Le[e]):(delete Le[e],null)},we.langData=o("moment.langData is deprecated. Use moment.localeData instead.",function(e){return we.localeData(e)}),we.localeData=function(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return we._locale;if(!_(e)){if(t=O(e))return t;e=[e]}return F(e)},we.isMoment=function(e){return e instanceof d||null!=e&&n(e,"_isAMomentObject")},we.isDuration=function(e){return e instanceof u};for(xe=yt.length-1;xe>=0;--xe)M(yt[xe]);we.normalizeUnits=function(e){return k(e)},we.invalid=function(e){var t=we.utc(NaN);return null!=e?p(t._pf,e):t._pf.userInvalidated=!0,t},we.parseZone=function(){return we.apply(null,arguments).parseZone()},we.parseTwoDigitYear=function(e){return C(e)+(C(e)>68?1900:2e3)},p(we.fn=d.prototype,{clone:function(){return we(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var e=we(this).utc();return 0<e.year()&&e.year()<=9999?U(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):U(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return I(this)},isDSTShifted:function(){return this._a?this.isValid()&&T(this._a,(this._isUTC?we.utc(this._a):we(this._a)).toArray())>0:!1},parsingFlags:function(){return p({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(e){return this.zone(0,e)},local:function(e){return this._isUTC&&(this.zone(0,e),this._isUTC=!1,e&&this.add(this._dateTzOffset(),"m")),this},format:function(e){var t=U(this,e||we.defaultFormat);return this.localeData().postformat(t)},add:b(1,"add"),subtract:b(-1,"subtract"),diff:function(e,t,i){var n,a,s,o=W(e,this),l=6e4*(this.zone()-o.zone());return t=k(t),"year"===t||"month"===t?(n=432e5*(this.daysInMonth()+o.daysInMonth()),a=12*(this.year()-o.year())+(this.month()-o.month()),s=this-we(this).startOf("month")-(o-we(o).startOf("month")),s-=6e4*(this.zone()-we(this).startOf("month").zone()-(o.zone()-we(o).startOf("month").zone())),a+=s/n,"year"===t&&(a/=12)):(n=this-o,a="second"===t?n/1e3:"minute"===t?n/6e4:"hour"===t?n/36e5:"day"===t?(n-l)/864e5:"week"===t?(n-l)/6048e5:n),i?a:f(a)},from:function(e,t){return we.duration({to:this,from:e}).locale(this.locale()).humanize(!t)},fromNow:function(e){return this.from(we(),e)},calendar:function(e){var t=e||we(),i=W(t,this).startOf("day"),n=this.diff(i,"days",!0),a=-6>n?"sameElse":-1>n?"lastWeek":0>n?"lastDay":1>n?"sameDay":2>n?"nextDay":7>n?"nextWeek":"sameElse";return this.format(this.localeData().calendar(a,this))},isLeapYear:function(){return E(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=se(e,this.localeData()),this.add(e-t,"d")):t},month:fe("Month",!0),startOf:function(e){switch(e=k(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e?this.weekday(0):"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(e){return e=k(e),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms")},isAfter:function(e,t){return t=k("undefined"!=typeof t?t:"millisecond"),"millisecond"===t?(e=we.isMoment(e)?e:we(e),+this>+e):+this.clone().startOf(t)>+we(e).startOf(t)},isBefore:function(e,t){return t=k("undefined"!=typeof t?t:"millisecond"),"millisecond"===t?(e=we.isMoment(e)?e:we(e),+e>+this):+this.clone().startOf(t)<+we(e).startOf(t)},isSame:function(e,t){return t=k(t||"millisecond"),"millisecond"===t?(e=we.isMoment(e)?e:we(e),+this===+e):+this.clone().startOf(t)===+W(e,this).startOf(t)},min:o("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(e){return e=we.apply(null,arguments),this>e?this:e}),max:o("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(e){return e=we.apply(null,arguments),e>this?this:e}),zone:function(e,t){var i,n=this._offset||0;return null==e?this._isUTC?n:this._dateTzOffset():("string"==typeof e&&(e=H(e)),Math.abs(e)<16&&(e=60*e),!this._isUTC&&t&&(i=this._dateTzOffset()),this._offset=e,this._isUTC=!0,null!=i&&this.subtract(i,"m"),n!==e&&(!t||this._changeInProgress?w(this,we.duration(n-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,we.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(e){return e=e?we(e).zone():0,(this.zone()-e)%60===0},daysInMonth:function(){return D(this.year(),this.month())},dayOfYear:function(e){var t=Se((we(this).startOf("day")-we(this).startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},quarter:function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},weekYear:function(e){var t=re(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==e?t:this.add(e-t,"y")},isoWeekYear:function(e){var t=re(this,1,4).year;return null==e?t:this.add(e-t,"y")},week:function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},isoWeek:function(e){var t=re(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},weekday:function(e){var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},isoWeeksInYear:function(){return A(this.year(),1,4)},weeksInYear:function(){var e=this.localeData()._week;return A(this.year(),e.dow,e.doy)},get:function(e){return e=k(e),this[e]()},set:function(e,t){return e=k(e),"function"==typeof this[e]&&this[e](t),this},locale:function(e){var i;return e===t?this._locale._abbr:(i=we.localeData(e),null!=i&&(this._locale=i),this)},lang:o("moment().lang() is deprecated. Use moment().localeData() instead.",function(e){return e===t?this.localeData():this.locale(e)}),localeData:function(){return this._locale},_dateTzOffset:function(){return 15*Math.round(this._d.getTimezoneOffset()/15)}}),we.fn.millisecond=we.fn.milliseconds=fe("Milliseconds",!1),we.fn.second=we.fn.seconds=fe("Seconds",!1),we.fn.minute=we.fn.minutes=fe("Minutes",!1),we.fn.hour=we.fn.hours=fe("Hours",!0),we.fn.date=fe("Date",!0),we.fn.dates=o("dates accessor is deprecated. Use date instead.",fe("Date",!0)),we.fn.year=fe("FullYear",!0),we.fn.years=o("years accessor is deprecated. Use year instead.",fe("FullYear",!0)),we.fn.days=we.fn.day,we.fn.months=we.fn.month,we.fn.weeks=we.fn.week,we.fn.isoWeeks=we.fn.isoWeek,we.fn.quarters=we.fn.quarter,we.fn.toJSON=we.fn.toISOString,p(we.duration.fn=u.prototype,{_bubble:function(){var e,t,i,n=this._milliseconds,a=this._days,s=this._months,o=this._data,l=0;o.milliseconds=n%1e3,e=f(n/1e3),o.seconds=e%60,t=f(e/60),o.minutes=t%60,i=f(t/60),o.hours=i%24,a+=f(i/24),l=f(me(a)),a-=f(ve(l)),s+=f(a/30),a%=30,l+=f(s/12),s%=12,o.days=a,o.months=s,o.years=l},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return f(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*C(this._months/12)},humanize:function(e){var t=le(this,!e,this.localeData());return e&&(t=this.localeData().pastFuture(+this,t)),this.localeData().postformat(t)},add:function(e,t){var i=we.duration(e,t);return this._milliseconds+=i._milliseconds,this._days+=i._days,this._months+=i._months,this._bubble(),this},subtract:function(e,t){var i=we.duration(e,t);return this._milliseconds-=i._milliseconds,this._days-=i._days,this._months-=i._months,this._bubble(),this},get:function(e){return e=k(e),this[e.toLowerCase()+"s"]()},as:function(e){var t,i;if(e=k(e),"month"===e||"year"===e)return t=this._days+this._milliseconds/864e5,i=this._months+12*me(t),"month"===e?i:i/12;switch(t=this._days+ve(this._months/12),e){case"week":return t/7+this._milliseconds/6048e5;case"day":return t+this._milliseconds/864e5;case"hour":return 24*t+this._milliseconds/36e5;case"minute":return 24*t*60+this._milliseconds/6e4;case"second":return 24*t*60*60+this._milliseconds/1e3;case"millisecond":return Math.floor(24*t*60*60*1e3)+this._milliseconds;default:throw new Error("Unknown unit "+e)}},lang:we.fn.lang,locale:we.fn.locale,toIsoString:o("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),i=Math.abs(this.days()),n=Math.abs(this.hours()),a=Math.abs(this.minutes()),s=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(i?i+"D":"")+(n||a||s?"T":"")+(n?n+"H":"")+(a?a+"M":"")+(s?s+"S":""):"P0D"},localeData:function(){return this._locale}}),we.duration.fn.toString=we.duration.fn.toISOString;for(xe in ht)n(ht,xe)&&ye(xe.toLowerCase());we.duration.fn.asMilliseconds=function(){return this.as("ms")},we.duration.fn.asSeconds=function(){return this.as("s")},we.duration.fn.asMinutes=function(){return this.as("m")},we.duration.fn.asHours=function(){return this.as("h")},we.duration.fn.asDays=function(){return this.as("d")},we.duration.fn.asWeeks=function(){return this.as("weeks")},we.duration.fn.asMonths=function(){return this.as("M")},we.duration.fn.asYears=function(){return this.as("y")},we.locale("en",{ordinal:function(e){var t=e%10,i=1===C(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";
return e+i}}),Oe?e.exports=we:"function"==typeof define&&define.amd?(define("moment",["require","exports","module"],function(e,t,i){return i.config&&i.config()&&i.config().noGlobal===!0&&(ke.moment=_e),we}),be(!0)):be()}.call(this),define("cdn-logger/cdnLogger",["require","jquery","ua-parser","moment"],function(e){function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t)}function i(){return window.global_page_viewer?window.global_page_viewer.encodedId:r("body").data("user-id")}function n(){var e=p.exec(window.location.hostname);return e?e[2]?e[2]:"prod":"local"}function a(){var e=/cdnses=([^;]*)/.exec(window.document.cookie);return e&&e[1]}function s(){var e=t();return window.document.cookie="cdnses="+e,e}function o(e,t){for(var i in t)t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=t[i]);return e}function l(e,t){if(("screen"===t.type||"event"===t.type)&&void 0!==t.id){var l=a();return l||(l=s()),r.ajax({url:e,dataType:"jsonp xml",jsonpCallback:!1,cache:!0,data:o(t,{cid:"007",uid:i(),os:h.getOS().name,osv:h.getOS().version,crv:h.getBrowser().name+" "+h.getBrowser().version,env:n(),ses:l,cdt:c().format()})})}}var r=e("jquery"),h=new(e("ua-parser")),c=e("moment"),d="https://iedc.fitbit.com/v2/trk",u="https://iedc.fitbit.com/v1/trk",p=/^(www|community|api|)(qa\d)?\.?fitbit\.com$/;return window.F=window.F||null,{logV2Event:function(e){return l(d,e)},logV1Event:function(e){return l(u,e)}}}),define("cdn-logger/interactionIds",[],function(){return{VIEW_DASHBOARD:1,VIEW_SELF_PROFILE:1e3,VIEW_USER_PROFILE:1001,VIEW_STEPS:1100,VIEW_HEART_RATE:1200,VIEW_DISTANCE:1400,VIEW_CALORIES_BURNED:1600,VIEW_FLOORS:1800,VIEW_ACTIVE_MINUTES:2e3,VIEW_EXERCISE_HISTORY:2200,VIEW_EXERCISE_DETAIL:2201,VIEW_WEIGHT:2400,VIEW_SLEEP:2600,VIEW_FOOD:2800,VIEW_WATER:3e3,VIEW_FRIENDS:3203,VIEW_SEDENTARY_TIME:3600,VIEW_SEDENTARY_TIME_SETTINGS:3630,VIEW_HELP:5200,VIEW_FOOD_GOAL:1040,VIEW_WATER_GOAL:1041,VIEW_WEIGHT_GOAL:1042,VIEW_BODY_FAT_GOAL:1043}}),define("cdn-logger/siteLogger",["cdn-logger/cdnLogger","cdn-logger/interactionIds","underscore"],function(e,t,i){return i.extend(e,{INTERACTION_IDS:t})}),define("galileo/tile/classes/base",["require","mootools","shared/scripts/modal","./animate","galileo/util/help","i18n/i18n","underscore","backbone","galileo/util/dateUtil","hbs!../template/loading","hbs!../template/tile","hbs!../template/dialog/dialogContainer","hbs!../template/dialog/removeTile","cdn-logger/siteLogger","i18n-load!com/fitbit/app/ngd/tile"],function(e){e("mootools");var t=e("shared/scripts/modal"),i=e("./animate"),n=e("galileo/util/help"),a=e("i18n/i18n")(),s=e("underscore"),o=e("backbone"),l=(e("galileo/util/dateUtil"),e("hbs!../template/loading")),r=e("hbs!../template/tile"),h=e("hbs!../template/dialog/dialogContainer"),c=e("hbs!../template/dialog/removeTile"),d=e("cdn-logger/siteLogger"),u=$.browser,p=!0,g={water:d.INTERACTION_IDS.VIEW_WATER_GOAL,calZone:d.INTERACTION_IDS.VIEW_FOOD_GOAL,foodPlan:d.INTERACTION_IDS.VIEW_FOOD_GOAL};return u&&u.msie&&u.version<=8&&(p=!1),a.namespace(e("i18n-load!com/fitbit/app/ngd/tile")),new Class({Implements:[Options,Events],flipped:!1,savable:!0,visible:void 0,date:void 0,today:void 0,options:{date:void 0,visible:!0,canAnimate:p,tileClass:void 0,controlsWithLogUrl:[a("See_More")],controlsList:[{name:a("Settings"),"class":"settingsButton leftSide showSettings js_settingsButton",glyphName:"show-settings"},{name:a("Expand"),"class":"zoom js_expandButton",glyphName:"expand-tile"},{name:a("See_More"),"class":"more rightSide",glyphName:"arrow-right"}]},initialize:function(e){this.setOptions(e),s.extend(this,o.Events),this.setVisible(this.options.visible),this.setCanAnimate(this.options.canAnimate),this.today=new Date,this.today.setHours(0,0,0,0),this.date=this.options.date||new Date(this.today.getTime());var t=this.container=$(r({tileClass:this.options.tileClass}));this.container.addClass(this.tileName),this.contents=t.find(".contents"),this.body=t.find(".body"),this.loading=$(l({title:this.title})),this.body.append(this.loading),s.extend(this,new i)},remove:function(){this.container.detach(),this._cleanupClickDrag(),this.trigger("remove")},getControlsList:function(){var e=this.options.controlsList,t=this.options.controlsWithLogUrl,i=this.logUrl;return i&&t&&t.each(function(t){e.each(function(e){e.name==t&&(e.href=this.logUrl)},this)},this),e},initializeSettings:function(){var e=this,i=this.settings;n.handle("initTile",this),this.main.find(".showSettings").on("click",this.showSettings.bind(this)),i.find(".removeTile").on("click",function(){var i=c({tileName:e.title||""});t(function(t){var n=$(h({content:i}));return n.find(".confirm").on("click",function(){t(),e.remove()}),n})}),this.settings.on("click",".saveSettings",function(){this.hideSettings()}.bind(this))},showSettings:function(){n.handle("showSettings",this);var e=this.container;e.on("animationend webkitAnimationEnd",function(){e.hasClass("flippedAnimation")&&(e.addClass("flipped"),e.removeClass("flippedAnimation"))}),e.removeClass("unflipped"),e.removeClass("unflippedAnimation"),e.addClass("flippedAnimation"),this.trigger("showSettings"),this.logGoalInteraction()},hideSettings:function(){var e=this.container;e.on("animationend webkitAnimationEnd",function(){e.hasClass("unflippedAnimation")&&(e.addClass("unflipped"),e.removeClass("unflippedAnimation"))}),e.removeClass("flipped"),e.removeClass("flippedAnimation"),e.addClass("unflippedAnimation"),this.trigger("hideSettings")},setVisible:function(e){return this.visible=e,this},isVisible:function(e){return!!this.visible==!!e},setCanAnimate:function(e){return this.canAnimate=e,this},isCanAnimate:function(e){return!!this.canAnimate==!!e},setDate:function(e){return this.date=e,this},getDate:function(){return this.date},isDateEqual:function(e){return this.getDate().getTime()==e.getTime()},showLoading:function(){this.mainContents.detach(),this.body.append(this.loading)},showMainContents:function(){this.loading.detach(),this.body.append(this.mainContents),this.setupEmptyRemoveLink()},setupEmptyRemoveLink:function(){var e=this;this.container.find(".removeEmptyTile").click(function(i){i.preventDefault();var n=c({tileName:e.title||""});t(function(t){var i=$(h({content:n}));return i.find(".confirm").on("click",function(){t(),e.remove()}),i})})},showTile:function(){this.load()},hideControls:function(){this.mainContents.find(".controls").css("display","none")},showControls:function(){this.mainContents.find(".controls").css("display","")},addSettingsButton:function(){this.addButton("li.settings",function(){this.remove()})},addExpandButton:function(){this.addButton("li.zoom",function(){n.handle("showExpanded",this),this.openModal()})},addButton:function(e,t){this.container.find(e).click(t.bind(this))},logGoalInteraction:function(){var e=this.tileName&&g[this.tileName];null!=e&&d.logV2Event({id:e,type:"screen"})}})}),define("hbs!galileo/tile/template/tileControls",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s="";return s+='\n<div class="controls">\n    <ul class="controlsList">\n        ',a={hash:{},inverse:d.noop,fn:d.program(2,o,t)},(n=i.controlsList)?n=n.call(e,a):(n=e.controlsList,n=typeof n===h?n.apply(e):n),i.controlsList||(n=u.call(e,n,a)),(n||0===n)&&(s+=n),s+="\n    </ul>\n</div>\n"}function o(e,t){var n,a="";return a+='\n        <li class="control ',(n=i["class"])?n=n.call(e,{hash:{}}):(n=e["class"],n=typeof n===h?n.apply(e):n),a+=c(n)+'">\n            <a',n=i["if"].call(e,e.href,{hash:{},inverse:d.noop,fn:d.program(3,l,t)}),(n||0===n)&&(a+=n),a+=' title="',(n=i.name)?n=n.call(e,{hash:{}}):(n=e.name,n=typeof n===h?n.apply(e):n),a+=c(n)+'">\n                <i class="fitglyph fitglyph-',(n=i.glyphName)?n=n.call(e,{hash:{}}):(n=e.glyphName,n=typeof n===h?n.apply(e):n),a+=c(n)+' size-f"></i>\n                <span class="controlsLabel ',(n=i.glyphName)?n=n.call(e,{hash:{}}):(n=e.glyphName,n=typeof n===h?n.apply(e):n),a+=c(n)+'">',(n=i.name)?n=n.call(e,{hash:{}}):(n=e.name,n=typeof n===h?n.apply(e):n),a+=c(n)+"</span>\n            </a>\n        </li>\n        "}function l(e,t){var n,a="";return a+=' href="',(n=i.href)?n=n.call(e,{hash:{}}):(n=e.href,n=typeof n===h?n.apply(e):n),a+=c(n)+'"'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,h="function",c=this.escapeExpression,d=this,u=i.blockHelperMissing;return r=i["if"].call(t,t.controlsList,{hash:{},inverse:d.noop,fn:d.program(1,s,a)}),r||0===r?r:""});return e.registerPartial("galileo_tile_template_tileControls",t),t}),define("hbs!galileo/tile/template/mainContents",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/tile","hbs!galileo/tile/template/tileControls","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var a,s,u,p="";return p+='\n<div class="main">\n    <div class="content">\n        <h2 class="tileTitle">\n            <span class="title">',(a=i.title)?a=a.call(e,{hash:{}}):(a=e.title,a=typeof a===m?a.apply(e):a),p+=v(a)+'</span>\n            <span class="afterTitle">',(a=i.afterTitle)?a=a.call(e,{hash:{}}):(a=e.afterTitle,a=typeof a===m?a.apply(e):a),p+=v(a)+'</span>\n            <span class="tileInfo">?</span>\n            <span class="contentInfo">?</span>\n        </h2>\n    </div>\n    ',a=y.invokePartial(n.galileo_tile_template_tileControls,"galileo_tile_template_tileControls",e,i,n),(a||0===a)&&(p+=a),p+='\n</div>\n<div class="settings">\n    <div class="settingsHeader">\n        <div class="settingsTitle" >\n            <h2 title="',(a=i.title)?a=a.call(e,{hash:{}}):(a=e.title,a=typeof a===m?a.apply(e):a),p+=v(a)+'">',(a=i.title)?a=a.call(e,{hash:{}}):(a=e.title,a=typeof a===m?a.apply(e):a),p+=v(a)+"</h2>\n        </div>\n        ",a=i["if"].call(e,e.savable,{hash:{},inverse:y.noop,fn:y.program(2,o,t)}),(a||0===a)&&(p+=a),p+='\n    </div>\n    <div class="content" >\n        <div',a=i["if"].call(e,e.savable,{hash:{},inverse:y.noop,fn:y.program(4,l,t)}),(a||0===a)&&(p+=a),p+=">\n            ",a=i["if"].call(e,e.savable,{hash:{},inverse:y.noop,fn:y.program(6,r,t)}),(a||0===a)&&(p+=a),p+="\n            ",a=i.unless.call(e,e.savable,{hash:{},inverse:y.noop,fn:y.program(8,h,t)}),(a||0===a)&&(p+=a),p+="\n        </div>\n    </div>\n    ",a=i["if"].call(e,e.savable,{hash:{},inverse:y.noop,fn:y.program(10,c,t)}),(a||0===a)&&(p+=a),p+="\n    ",a=i.unless.call(e,e.savable,{hash:{},inverse:y.noop,fn:y.program(12,d,t)}),(a||0===a)&&(p+=a),p+='\n        <a class="dashButton saveSettings saveButton">',u={hash:{}},a=i.i18n,s=a?a.call(e,"done",u):f.call(e,"i18n","done",u),(s||0===s)&&(p+=s),p+="</a>\n    </div>\n</div>\n"}function o(e,t){return'\n        <div class="removeTile removeButton">\n            <i class="fitglyph fitglyph-remove size-g"></i>\n        </div>\n        '}function l(e,t){return' class="savable"'}function r(e,t){return'\n            <div class="settingsContainer fancyinputs"></div>\n            '}function h(e,t){var n,a,s,o="";return o+='\n            <a class="removeTile removeButton">\n                <i class="fitglyph fitglyph-remove size-b"></i>\n            </a>\n            <span class="controlsLabel largeRemove">',s={hash:{}},n=i.i18n,a=n?n.call(e,"Remove_tile",s):f.call(e,"i18n","Remove_tile",s),(a||0===a)&&(o+=a),o+="</span>\n            "}function c(e,t){return'\n    <div class="settingsFooter savable">\n    '}function d(e,t){return'\n    <div class="settingsFooter">\n    '}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,n=n||e.partials;var u,p,g,f=i.helperMissing,m="function",v=this.escapeExpression,y=this;return g={hash:{},inverse:y.noop,fn:y.program(1,s,a)},u=i["i18n-namespace"],p=u?u.call(t,"com.fitbit.app.ngd.tile",g):f.call(t,"i18n-namespace","com.fitbit.app.ngd.tile",g),p||0===p?p:""});return e.registerPartial("galileo_tile_template_mainContents",t),t}),define("galileo/tile/classes/small",["require","mootools","jquery","galileo/prototype/all","./base","galileo/ajax/ajax","i18n/i18n","i18n-load!com/fitbit/app/ngd/tile","hbs!../template/mainContents"],function(e){e("mootools"),e("jquery"),e("galileo/prototype/all");var t=e("./base"),i=(e("galileo/ajax/ajax"),e("i18n/i18n")());return i.namespace(e("i18n-load!com/fitbit/app/ngd/tile")),new Class({Extends:t,shape:"small",options:{tileClass:"small"},initialize:function(e){if(this.parent(e),!this.title||!this.tileName||!this.load)throw"missing required option in small tile builder";this.renderMainContents(),this.showLoading()},renderMainContents:function(){var t=e("hbs!../template/mainContents");return this.mainContents=$(t({title:this.title,afterTitle:this.afterTitle,controlsList:this.getControlsList(),savable:this.savable})),this.main=this.mainContents.closest(".main"),this.settings=this.mainContents.closest(".settings"),this.body.append(this.mainContents),this.addSettingsButton(),this.addExpandButton(),this.initializeSettings(),this},openModal:function(){var t={date:this.getDate()};this.logUrl?t.controlsList=[{name:"empty","class":"empty largeLeft"},{name:i("See_More"),"class":"more secondRight",href:this.logUrl,glyphName:"arrow-right"},{name:"close","class":"close rightSide",glyphName:"close-settings"}]:t.controlsList=[{name:"empty","class":"empty largerLeft"},{name:"close","class":"close rightSide",glyphName:"close-settings"}],this.hasModal&&e(["galileo/tile/modal/"+this.tileName],function(e){var i=this.large;i?(i.setDate(this.getDate()),i.setupModal()):i=this.large=new e(t),i.load()}.bind(this))},setDate:function(e){return this.parent(e),this.showLoading(),this.load(),this.trigger("dateChange",e),this}})}),define("hbs!galileo/tile/template/smallSettings",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/goal","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n<label class="settingLabel" >Daily goal</label>\n<div class="goalSetting">\n    <input class="settingInput goalTarget" type="text" />\n    <span class="settingUnit">',(n=i.unit)?n=n.call(e,{hash:{}}):(n=e.unit,n=typeof n===h?n.apply(e):n),o+=c(n)+'</span>\n</div>\n<div class="weeklyGoal" >',s={hash:{}},n=i.i18n,a=n?n.call(e,"your_weekly_goal_is",s):d.call(e,"i18n","your_weekly_goal_is",s),(a||0===a)&&(o+=a),o+=' <strong class="weeklyGoalTarget"></strong> <strong class="weeklyGoalUnit">',(a=i.unit)?a=a.call(e,{hash:{}}):(a=e.unit,a=typeof a===h?a.apply(e):a),o+=c(a)+"</strong></div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h="function",c=this.escapeExpression,d=i.helperMissing,u=this;return r={hash:{},inverse:u.noop,fn:u.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.goal",r):d.call(t,"i18n-namespace","com.fitbit.app.ngd.goal",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_smallSettings",t),t}),define("galileo/widget/metric/metricView",["require","mootools","jquery"],function(e){e("mootools"),e("jquery");var t=function(){return $("<span>")},i=new Class({Implements:Events,initialize:function(e){this.els={unit:[],number:[],container:[]},this.container=t().addClass("metric"),this.unitsLen=e||0,this._generateElements()},element:function(){return this.container},setUnitsLen:function(e){this._deleteElements(),this.unitsLen=e,this._generateElements()},getUnitsLen:function(e){return this.unitsLen},_generateElements:function(){for(var e=0;e<this.unitsLen;e++){var i=t();i.addClass("number");var n=t();n.addClass("unit"),this.els.number.push(i),this.els.unit.push(n),this.container.prepend(i,n)}},_deleteElements:function(){for(var e=0;e<this.unitsLen;e++){var t=this.els.number.pop();t.remove(),delete t,t=this.els.unit.pop(),t.remove(),delete t}},update:function(e){for(var t=0;t<this.unitsLen;t++){var i=e[t];if(!this.els.number[t])return;this.els.unit[t].text(i.unit),this.els.number[t].text(i.value),i.showValue?(this.els.number[t].css("display",""),this.els.unit[t].css("display","")):(this.els.number[t].css("display","none"),this.els.unit[t].css("display","none"))}},getValue:function(e){return this.els.number[e]?this.els.number[e].text():null}});return i}),define("galileo/widget/metric/editableMetricView",["require","mootools","jquery","galileo/widget/metric/metricView"],function(e){e("mootools"),e("jquery");var t=function(){return $("<span>")},i=function(e){return e=e||"text",$('<input type="'+e+'">')},n=e("galileo/widget/metric/metricView"),a=new Class({Extends:n,initialize:function(e,t){this.format=t,this.parent(e)},_generateElements:function(){for(var e=this,n=0;n<this.unitsLen;n++){var a=i(this.format[n].inputType);a.bind("keydown",function(t){setTimeout(function(){e.fireEvent("edit",{})},4)}),a.addClass("number");var s=t();s.addClass("unit"),this.els.number.push(a),this.els.unit.push(s),this.container.prepend(a,s)}},update:function(e){for(var t=0;t<this.unitsLen;t++){var i=e[t];if(!this.els.number[t])return;this.els.unit[t].text(i.unit),this.els.number[t].val(i.value),i.showValue?(this.els.number[t].css("display",""),this.els.unit[t].css("display","")):(this.els.number[t].css("display","none"),this.els.unit[t].css("display","none"))}},getValue:function(e){return this.els.number[e]?this.els.number[e].val():null},disable:function(){this.els.number.forEach(function(e){e.attr("disabled","disabled")}),this.container.addClass("disabled")}});return a}),define("galileo/widget/metric",["require","jquery","mootools","galileo/model/user","galileo/widget/metric/metricView","galileo/widget/metric/editableMetricView"],function(e){e("jquery");e("mootools");var t=e("galileo/model/user").viewer,i=e("galileo/widget/metric/metricView"),n=e("galileo/widget/metric/editableMetricView"),a=new Class({Implements:Events,initialize:function(e,t,a,s){var o=this;this.format=e||[],this.editable=t,this.showZeros=a,this.hasBeenChanged=!1,s?this.view=s:t?this.view=new n(this.format.length,this.format):this.view=new i(this.format.length),this.view.addEvent("edit",function(e){o.hasBeenChanged=!0,o.fireEvent("edit",o._getValueFromView())}),this.container=this.view.container},elements:function(){return this.view.element()},setFormat:function(e){this.view.setUnitsLen(e.length),this.format=e},string:function(e,i){i=void 0!==i?i:"",e=void 0!==e?e:"";for(var n="",a=this.value,s=1,o=0;o<this.format.length;o++){var l;if(this.useThresholdConversion?(l=a/s%this.format[o].unitThreshold,a-=l,s*=this.format[o].unitThreshold):l=this.values[o],0!==l&&0!==a||this.showZeros||0===o){var r=t.formatNumber(l,this.format[o].format);n=this.format[o].unitPlural?r+i+this.format[o].unitPlural(l)+n:this.format[o].unitKey?r+i+this.format[o].unitKey+n:r+n}o<this.format.length-1&&(n=e+n)}return n},update:function(e){if(arguments.length==this.format.length){var t=Array.prototype.slice.call(arguments,0);t.reverse(),this.values=t,this.useThresholdConversion=!1}else this.value=e,this.useThresholdConversion=!0;var i=this.getUnitValues();return this.view.update(i),this},getUnitValues:function(){for(var e=[],i=this.value,n=1,a=0;a<this.format.length;a++){var s,o;this.useThresholdConversion?(s=i/n%this.format[a].unitThreshold,i-=s,n*=this.format[a].unitThreshold):s=this.values[a],o=0!==s||0!==i||0===a||this.showZeros?!0:!1;var l=t.formatNumber(s,this.format[a].format);if(this.format[a].unitPlural){var r=t.parseNumber(l,this.format[a].format);s=this.format[a].unitPlural(r)}else s=this.format[a].unitKey;e.push({value:l,unit:s,showValue:o})}return e},getUnitValue:function(){return 1===this.format.length?this.getUnitValues()[0]:this.getUnitValues()[1]},getSubUnitValue:function(){return this.format.length>1?this.getUnitValues()[0]:null},disable:function(){this.view.disable()},getValue:function(){return this._getValueFromView()},validate:function(){for(var e=!0,t=0;t<this.format.length;t++){var i=this.format[t];i.validate&&"function"==typeof i.validate&&(i.validate(this.view.getValue(t))||(e=!1))}return e},_getValueFromView:function(){for(var e=0,i=1,n=0;n<this.format.length;n++)e+=t.parseNumber(this.view.getValue(n),this.format[n].format)*i,i*=this.format[n].unitThreshold;return e},style:function(e,t){}.overloadSetter()});return a}),define("galileo/tile/classes/smallBasic",["require","mootools","galileo/model/user","galileo/util/channel","./small","hbs!../template/smallSettings","galileo/model/goals","i18n/i18n","galileo/widget/metric","i18n-load!com/fitbit/app/ngd/goal"],function(e){e("mootools");var t=e("galileo/model/user").viewer,i=e("galileo/util/channel"),n=e("./small"),a=(e("hbs!../template/smallSettings"),e("galileo/model/goals")),s=e("i18n/i18n")(),o=e("galileo/widget/metric");return s.namespace(e("i18n-load!com/fitbit/app/ngd/goal")),new Class({Extends:n,title:"SmallSimple",tileName:"SmallSimple",options:{tileClass:"smallBasic"},tileType:null,unitType:null,options:{metricFormats:{result:[{unitKey:"",unitThreshold:1/0,format:"#,##0"}],goal:[{unitKey:"",unitThreshold:1/0,format:"#,##0"}],setting:[{unitKey:"",unitThreshold:1/0,format:"###0"}]}},initialize:function(e){this.parent(e),this.metricFormats=this.options.metricFormats,this.style=this.options.style,this.goalElement=null,this.goalElementChan=i(!0),this.loadSettings()},load:function(){var e=this.getDate(),i=this.main.eq(0).find(".content"),n=t.activities().loadSummary.bind(this,this.tileType,e),s=a.loadActivityType.bind(this,this.tileType);return Function.join(n,s,function(t,n){this.isDateEqual(e)&&(this.tileData=t,this.goalData=n,this.displayGoal(i),this.goalElementChan.take(function(e){e.setGoalData(Object.merge(this.tileData,this.goalData)),e.render(1)}.bind(this)),this.showMainContents(!1),this.updateSettings())}.bind(this)),this},updateSettings:function(){a.loadActivityType(this.tileType,function(e){this.goalSetting.update(e.dailyGoal),this.weeklyGoal.update(e.weeklyGoal)}.bind(this))},loadSettings:function(){if(!this.settingsElement){var e=this.goalSetting=new o(this.metricFormats.setting,!0,!0),t=this.weeklyGoal=new o(this.metricFormats.setting,!1);e.addEvent("edit",this.updateWeeklyGoal.bind(this)),this.settingsElement=this.getSettingsView(t,e),this.settings.find(".settingsContainer").append(this.settingsElement)}},getSettingsView:function(e,t){var i=function(){return $("<div>")},n=this.weeklyGoalMsg=i().append($("<span>").text(s("your_weekly_goal_is")),e.elements()),a=this.settingsElement=i().append(i().addClass("goal_title").text(s("daily_goal")),i().append(t.elements()).addClass("setting"),n.addClass("weeklyGoal"));return this.settings.find(".saveSettings").on("click",this.saveSettings.bind(this)),a},updateWeeklyGoal:function(e){this.weeklyGoal.update(7*e)},saveSettings:function(){var e=this.goalSetting.getValue(),t=this.tileType,i=this.getDate();this.updateGoals(t,e,i),this.weeklyGoal&&a.updateWeekly(t,this.weeklyGoal.getValue(),i),this.goalData.dailyGoal=e,this.goalElementChan.take(function(e){e.setGoalData(Object.merge(this.tileData,this.goalData)),e.render(1)}.bind(this)),this.trigger("saveSettings",t,e)},updateGoals:function(e,t,i){return a.update(e,t,i),this},displayGoal:function(t){this.goalElement?this.goalElementChan.give(this.goalElement):e(["galileo/tile/loadDependencies"],function(e){var i=this.renderGoal(t,Object.merge(this.tileData,this.goalData),e.Goal);i.renderInit(this.isCanAnimate(!0),!0),this.goalElementChan.give(i),this.goalElement=i}.bind(this))},renderGoal:function(e,t,i){var n=new i(e,{metricFormats:{dayTotal:this.metricFormats.result,dailyGoal:this.metricFormats.goal}});return n.setGoalData(t),n}})}),define("galileo/tile/template/helpers/domPlaceholder",["require","handlebars","jquery"],function(e){var t=e("handlebars"),i=e("jquery"),n=function(e,i){return new t.SafeString("<span data-placeholder-key='"+e+"'/>")};return t.registerHelper("domPlaceholder",n),function(e,t){var n=i(e(t));return n.find("[data-placeholder-key]").each(function(){var e=i(this),n=e.attr("data-placeholder-key"),a=t[n];a?e.replaceWith(a):e.remove()}),n}}),define("hbs!galileo/tile/template/dailyWeeklyGoal",["handlebars","galileo/tile/template/helpers/domPlaceholder"],function(e){var t=e.template(function(e,t,i,n,a){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var s,o,l="",r=i.helperMissing,h=this.escapeExpression;return l+='<div>\n    <div class="metricTitle"></div>\n    ',o={hash:{}},l+=h((s=i.domPlaceholder,s?s.call(t,"daily",o):r.call(t,"domPlaceholder","daily",o)))+'\n    <div class="metricTitle"></div>\n    ',o={hash:{}},l+=h((s=i.domPlaceholder,s?s.call(t,"weekly",o):r.call(t,"domPlaceholder","weekly",o)))+"\n</div>"});return e.registerPartial("galileo_tile_template_dailyWeeklyGoal",t),t}),define("galileo/tile/element/goal/dailyWeeklyGoalSetting",["require","galileo/model/goals","galileo/widget/metric","i18n/i18n","i18n-load!com/fitbit/app/goal/message","jquery","hbs!galileo/tile/template/dailyWeeklyGoal","galileo/tile/template/helpers/domPlaceholder"],function(e){var t=e("galileo/model/goals"),i=e("galileo/widget/metric"),n=e("i18n/i18n")();n.namespace(e("i18n-load!com/fitbit/app/goal/message"));var a=e("jquery"),s=e("hbs!galileo/tile/template/dailyWeeklyGoal"),o=e("galileo/tile/template/helpers/domPlaceholder"),l=function(){return a("<div>")};return new Class({initialize:function(e,a,o){this.tileType=e,this.template=o||s,a=Object.merge({editable:!0},a);var r=this.dailyGoalSetting=new i([Object.merge({},a,{unitKey:n("frequency_DAILY")})],a.editable,!0),h=this.weeklyGoalSetting=new i([Object.merge({},a,{unitKey:n("frequency_WEEKLY")})],a.editable);this.settingsElement=[l().append(r.elements()).addClass("setting daily"),l().append(h.elements()).addClass("setting weekly")],a.editable||(this.settingsElement[0].find(".number").attr("disabled","disabled").css("color","#ddd"),this.settingsElement[1].find(".number").attr("disabled","disabled").css("color","#ddd")),t.loadActivityType(this.tileType,function(e){r.update(e.dailyGoal),h.update(e.weeklyGoal)})},render:function(){return o(this.template,{daily:this.settingsElement[0],weekly:this.settingsElement[1]})},saveSettings:function(e,i){var n=this.dailyGoalSetting.getValue(),s=this.weeklyGoalSetting.getValue();return this.dailyGoalSetting.hasBeenChanged&&t.update(e,n,i),this.weeklyGoalSetting.hasBeenChanged&&t.updateWeekly(e,s,i),a.Deferred().resolve(e,n,s)},disable:function(){this.dailyGoalSetting.disable(),this.weeklyGoalSetting.disable()}})}),define("galileo/tile/classes/configurableWeeklyGoalSmallTile",["require","mootools","./smallBasic","galileo/model/goals","galileo/tile/element/goal/dailyWeeklyGoalSetting","i18n/i18n","galileo/model/user","i18n-load!com/fitbit/app/ngd/goal"],function(e){e("mootools");var t=e("./smallBasic"),i=e("galileo/model/goals"),n=e("galileo/tile/element/goal/dailyWeeklyGoalSetting"),a=e("i18n/i18n")(),s=e("galileo/model/user").viewer.isAdmin;return a.namespace(e("i18n-load!com/fitbit/app/ngd/goal")),new Class({Extends:t,loadSettings:function(){if(s&&!this.showOnlyDaily()){if(!this.goalSetting){this.goalSetting=new n(this.tileType,this.metricFormats.setting[0]);var e=this.settings;e.find(".settingsContainer").append(this.goalSetting.render()),e.find(".saveSettings").on("click",this.saveSettings.bind(this))}}else this.parent()},saveSettings:function(){s?this.goalSetting.saveSettings(this.tileType,this.getDate()).done(function(e,t,i){this.goalData.dailyGoal=t,this.goalElementChan.take(function(e){e.setGoalData(Object.merge(this.tileData,this.goalData)),e.render(1)}.bind(this)),this.trigger("saveSettings",e,t,i)}.bind(this)):this.parent()},updateSettings:function(){s?i.loadActivityType(this.tileType,function(e){this.goalSetting.dailyGoalSetting.update(e.dailyGoal),this.goalSetting.weeklyGoalSetting.update(e.weeklyGoal)}.bind(this)):this.parent()},showOnlyDaily:function(){return!1}})}),define("galileo/tile/steps",["require","./classes/configurableWeeklyGoalSmallTile","i18n/i18n","i18n-load!com/fitbit/app/ngd/steps","i18n-load!com/fitbit/app/ngd/goal","i18n-load!com/fitbit/app/unit"],function(e){var t=e("./classes/configurableWeeklyGoalSmallTile"),i=e("i18n/i18n")();i.namespace(e("i18n-load!com/fitbit/app/ngd/steps")),i.namespace(e("i18n-load!com/fitbit/app/ngd/goal")),i.namespace(e("i18n-load!com/fitbit/app/unit"));var n=[{unitKey:i("unit_steps_counter"),unitPlural:i.plural("step"),unitThreshold:1/0,format:"#,##0"}];return new Class({Extends:t,title:i("steps"),tileName:"steps",hasModal:!0,tileType:"steps",unitType:i("unit_steps_counter"),logUrl:"/activities",options:{metricFormats:{setting:n,goal:n,result:n}}})}),define("galileo/tile/distance",["require","galileo/model/user","./classes/configurableWeeklyGoalSmallTile","i18n/i18n","i18n-load!com/fitbit/app/ngd/distance","i18n-load!com/fitbit/app/ngd/goal","i18n-load!com/fitbit/app/unit"],function(e){var t=e("galileo/model/user"),i=e("./classes/configurableWeeklyGoalSmallTile"),n=e("i18n/i18n")();n.namespace(e("i18n-load!com/fitbit/app/ngd/distance")),n.namespace(e("i18n-load!com/fitbit/app/ngd/goal")),n.namespace(e("i18n-load!com/fitbit/app/unit"));var a=n("US"==t.viewer.heightSystem?"unit_miles":"unit_kilometers"),s=n.plural("US"==t.viewer.heightSystem?"mile":"km"),o=[{unitPlural:s,unitThreshold:1/0,format:"#,##0.00"}];return new Class({Extends:i,title:n("distance"),afterTitle:"/ "+a,tileName:"distance",hasModal:!0,tileType:"distance",unitType:a,precision:2,logUrl:"/activities",options:{metricFormats:{setting:o,goal:o,result:o}}})}),define("galileo/tile/floors",["require","./classes/configurableWeeklyGoalSmallTile","i18n/i18n","i18n-load!com/fitbit/app/ngd/goal","i18n-load!com/fitbit/app/ngd/floors","i18n-load!com/fitbit/app/unit"],function(e){var t=e("./classes/configurableWeeklyGoalSmallTile"),i=e("i18n/i18n")();i.namespace(e("i18n-load!com/fitbit/app/ngd/goal")),i.namespace(e("i18n-load!com/fitbit/app/ngd/floors")),i.namespace(e("i18n-load!com/fitbit/app/unit"));var n=[{unitKey:i("unit_floors_counter"),unitPlural:i.plural("floor"),unitThreshold:1/0,precision:0,format:"#,##0"}];return new Class({Extends:t,title:i("floors"),tileName:"floors",hasModal:!0,tileType:"floors",unitType:i("unit_floors_counter"),precision:0,logUrl:"/activities",options:{metricFormats:{setting:n,goal:n,result:n}}})}),define("galileo/model/sleep",["require","galileo/prototype/all","galileo/ajax/ajax","galileo/util/dateUtil"],function(e){e("galileo/prototype/all");var t=e("galileo/ajax/ajax"),i=e("galileo/util/dateUtil");return{loadDays:function(e,n,a){t.get("getSleepTileData","activityTileData",{dateFrom:e.getTime?i.ajaxEncode(e):e,dateTo:n.getTime?i.ajaxEncode(n):n},function(e){a(e)})},updateDays:function(e,n){t.get("getSleepTileData","activityTileData",{dateFrom:e.getTime?i.ajaxEncode(e):e,dateTo:n.getTime?i.ajaxEncode(n):n}).update()},loadDaysforGraph:function(e,t,i,n){this.loadDays(e,t,function(e){e.dataSets={},e.dataSets[i]={dataPoints:e.entries.map(function(e,t){return{dateTime:e.date+" 00:00:00",value:e[i]}})},n(e)})},loadSummary:function(e,t,i,n){this.loadDays(e,t,function(e){n({dailyGoal:e.avgSleepScore})})},timeToMinutesSinceNoon:function(e){var t=i.forTime(e),n=i.forTime("12:00"),a=i.diffInMinutes(t,n);return 0>a&&(a+=1440),a},clusters:function(e){var t=[],i=null,n=null,a=null;return e.breaks.map(function(e){var s=this.timeToMinutesSinceNoon(e.startTime),o=s+e.duration,l=e.magnitude>=3?"awake":"restless";s===a&&i===l?a=o:(n&&t.push({start:n,end:a,level:i}),n=s,a=o,i=l)}.bind(this)),n&&t.push({start:n,end:a,level:i}),t},timesAwake:function(e){return{awake:e.awakeCount,minsAwake:e.awakeDuration,restless:e.restlessCount,minsRestless:e.restlessDuration}},calculateRange:function(e,t){var n,a,s=Array.from(e).map(function(e){return{start:i.forTime(e.startTime),end:i.forTime(e.endTime)}});return s.length&&(n=s.sortBy(Function.takeKey("start"))[0].start,a=s.sortBy(Function.takeKey("end")).getLast().end),void 0!=t&&(n&&(n=i.localeFormat(n,t)),a&&(a=i.localeFormat(a,t))),{start:n,end:a}},calculateTotal:function(e){var t=0,i=0;return Array.from(e).each(function(e){t+=e.sleepDuration,i+=e.awakeCount}),{duration:t,awoken:i}}}}),define("hbs!galileo/tile/template/sleep",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/unit","i18n-load!com/fitbit/app/ngd/sleep","galileo/tile/template/helpers/domPlaceholder","galileo/tile/template/helpers/i18n"],function(e){
var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n<div class="clock">\n    ',s={hash:{}},o+=d((n=i.domPlaceholder,n?n.call(e,"clock",s):c.call(e,"domPlaceholder","clock",s)))+'\n</div>\n\n<div class="interruptCount show-on-hover sleepMetric">\n\n    <span class="label"> ',s={hash:{}},n=i.i18n,a=n?n.call(e,"awake",s):c.call(e,"i18n","awake",s),(a||0===a)&&(o+=a),o+=' </span>\n    <span class="number">',(a=i.awake)?a=a.call(e,{hash:{}}):(a=e.awake,a=typeof a===u?a.apply(e):a),o+=d(a)+'</span><span class="x">',s={hash:{}},n=i.i18n,a=n?n.call(e,"suffix_x",s):c.call(e,"i18n","suffix_x",s),(a||0===a)&&(o+=a),o+='</span>\n    <span>&nbsp;</span>\n    <span class="label" > ',s={hash:{}},n=i.i18n,a=n?n.call(e,"restless",s):c.call(e,"i18n","restless",s),(a||0===a)&&(o+=a),o+=' </span>\n    <span class="number">',(a=i.restless)?a=a.call(e,{hash:{}}):(a=e.restless,a=typeof a===u?a.apply(e):a),o+=d(a)+'</span><span class="x">',s={hash:{}},n=i.i18n,a=n?n.call(e,"suffix_x",s):c.call(e,"i18n","suffix_x",s),(a||0===a)&&(o+=a),o+='</span>\n</div>\n<div class="metric metricLarge timeAsleep hide-on-hover sleepMetric">\n    <span class="number">',(a=i.hours)?a=a.call(e,{hash:{}}):(a=e.hours,a=typeof a===u?a.apply(e):a),o+=d(a)+'</span>\n    <span class="unit"> ',(a=i.hoursUnit)?a=a.call(e,{hash:{}}):(a=e.hoursUnit,a=typeof a===u?a.apply(e):a),o+=d(a)+'</span>\n    <span class="number">',(a=i.minutes)?a=a.call(e,{hash:{}}):(a=e.minutes,a=typeof a===u?a.apply(e):a),o+=d(a)+'</span>\n    <span class="unit"> ',(a=i.minutesUnit)?a=a.call(e,{hash:{}}):(a=e.minutesUnit,a=typeof a===u?a.apply(e):a),o+=d(a)+"</span>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h="",c=i.helperMissing,d=this.escapeExpression,u="function",p=this;return r={hash:{},inverse:p.noop,fn:p.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.unit","com.fitbit.app.ngd.sleep",r):c.call(t,"i18n-namespace","com.fitbit.app.unit","com.fitbit.app.ngd.sleep",r),(l||0===l)&&(h+=l),h+="\n"});return e.registerPartial("galileo_tile_template_sleep",t),t}),define("hbs!galileo/tile/template/sleepNoneTodayLegacy",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/sleep","galileo/tile/template/helpers/domPlaceholder","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n<div class="noSleepToday">\n\n    <div class="clock">\n        ',s={hash:{}},o+=d((n=i.domPlaceholder,n?n.call(e,"clock",s):c.call(e,"domPlaceholder","clock",s)))+'\n    </div>\n    <div>\n        <a href="/sleep" class="cancelButton">\n            ',s={hash:{}},n=i.i18n,a=n?n.call(e,"forgot_to_log",s):c.call(e,"i18n","forgot_to_log",s),(a||0===a)&&(o+=a),o+="\n        </a>\n    </div>\n\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h="",c=i.helperMissing,d=this.escapeExpression,u=this;return r={hash:{},inverse:u.noop,fn:u.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.sleep",r):c.call(t,"i18n-namespace","com.fitbit.app.ngd.sleep",r),(l||0===l)&&(h+=l),h+="\n"});return e.registerPartial("galileo_tile_template_sleepNoneTodayLegacy",t),t}),define("hbs!galileo/tile/template/sleepNoneYet",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/sleep","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n<div class="onboarding">\n    <div class="icon"></div>\n    <div class="title">\n        ',s={hash:{}},n=i.i18n,a=n?n.call(e,"sleep_title_empty",s):c.call(e,"i18n","sleep_title_empty",s),(a||0===a)&&(o+=a),o+='\n    </div>\n    <div class="text">\n        <p class="info">',s={hash:{}},n=i.i18n,a=n?n.call(e,"how_well",s):c.call(e,"i18n","how_well",s),(a||0===a)&&(o+=a),o+='</p>\n        <p class="info">',s={hash:{}},n=i.i18n,a=n?n.call(e,"see_how_long",s):c.call(e,"i18n","see_how_long",s),(a||0===a)&&(o+=a),o+='</p>\n    </div>\n    <div class="btn-cont clearfix">\n        <span class="buttonContainer">\n            <a class="confirmButton" href="',s={hash:{}},n=i.i18n,a=n?n.call(e,"learn_how_log_href",s):c.call(e,"i18n","learn_how_log_href",s),(a||0===a)&&(o+=a),o+='">',s={hash:{}},n=i.i18n,a=n?n.call(e,"learn_more",s):c.call(e,"i18n","learn_more",s),(a||0===a)&&(o+=a),o+='</a>\n        </span>\n        <span class="buttonContainer">\n            <a class="cancelButton removeEmptyTile" href="">',s={hash:{}},n=i.i18n,a=n?n.call(e,"no_thanks",s):c.call(e,"i18n","no_thanks",s),(a||0===a)&&(o+=a),o+="</a>\n        </span>\n    </div>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h="",c=i.helperMissing,d=this;return r={hash:{},inverse:d.noop,fn:d.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.sleep",r):c.call(t,"i18n-namespace","com.fitbit.app.ngd.sleep",r),(l||0===l)&&(h+=l),h+="\n"});return e.registerPartial("galileo_tile_template_sleepNoneYet",t),t}),/*!
	 * @overview RSVP - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/tildeio/rsvp.js/master/LICENSE
	 * @version   3.0.13
	 */
function(){function t(e,t){for(var i=0,n=e.length;n>i;i++)if(e[i]===t)return i;return-1}function i(e){var t=e._promiseCallbacks;return t||(t=e._promiseCallbacks={}),t}function n(e,t){return"onerror"===e?void Z.on("error",t):2!==arguments.length?Z[e]:void(Z[e]=t)}function a(e){return"function"==typeof e||"object"==typeof e&&null!==e}function s(e){return"function"==typeof e}function o(e){return"object"==typeof e&&null!==e}function l(){}function r(){}function h(e){try{return e.then}catch(t){return oe.error=t,oe}}function c(e,t,i,n){try{e.call(t,i,n)}catch(a){return a}}function d(e,t,i){Z.async(function(e){var n=!1,a=c(i,t,function(i){n||(n=!0,t!==i?g(e,i):m(e,i))},function(t){n||(n=!0,v(e,t))},"Settle: "+(e._label||" unknown promise"));!n&&a&&(n=!0,v(e,a))},e)}function u(e,t){t._state===ae?m(e,t._result):e._state===se?v(e,t._result):y(t,void 0,function(i){t!==i?g(e,i):m(e,i)},function(t){v(e,t)})}function p(e,t){if(t.constructor===e.constructor)u(e,t);else{var i=h(t);i===oe?v(e,oe.error):void 0===i?m(e,t):s(i)?d(e,t,i):m(e,t)}}function g(e,t){e===t?m(e,t):a(t)?p(e,t):m(e,t)}function f(e){e._onerror&&e._onerror(e._result),b(e)}function m(e,t){e._state===ne&&(e._result=t,e._state=ae,0===e._subscribers.length?Z.instrument&&ie("fulfilled",e):Z.async(b,e))}function v(e,t){e._state===ne&&(e._state=se,e._result=t,Z.async(f,e))}function y(e,t,i,n){var a=e._subscribers,s=a.length;e._onerror=null,a[s]=t,a[s+ae]=i,a[s+se]=n,0===s&&e._state&&Z.async(b,e)}function b(e){var t=e._subscribers,i=e._state;if(Z.instrument&&ie(i===ae?"fulfilled":"rejected",e),0!==t.length){for(var n,a,s=e._result,o=0;o<t.length;o+=3)n=t[o],a=t[o+i],n?x(i,n,a,s):a(s);e._subscribers.length=0}}function w(){this.error=null}function _(e,t){try{return e(t)}catch(i){return le.error=i,le}}function x(e,t,i,n){var a,o,l,r,h=s(i);if(h){if(a=_(i,n),a===le?(r=!0,o=a.error,a=null):l=!0,t===a)return void v(t,new TypeError("A promises callback cannot return that same promise."))}else a=n,l=!0;t._state!==ne||(h&&l?g(t,a):r?v(t,o):e===ae?m(t,a):e===se&&v(t,a))}function T(e,t){try{t(function(t){g(e,t)},function(t){v(e,t)})}catch(i){v(e,i)}}function k(e,t,i){return e===ae?{state:"fulfilled",value:i}:{state:"rejected",reason:i}}function S(e,t,i,n){this._instanceConstructor=e,this.promise=new e(r,n),this._abortOnReject=i,this._validateInput(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._init(),0===this.length?m(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&m(this.promise,this._result))):v(this.promise,this._validationError())}function M(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function C(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function D(e,t){this._id=ge++,this._label=t,this._state=void 0,this._result=void 0,this._subscribers=[],Z.instrument&&ie("created",this),r!==e&&(s(e)||M(),this instanceof D||C(),T(this,e))}function A(){this.value=void 0}function G(e){try{return e.then}catch(t){return me.value=t,me}}function E(e,t,i){try{e.apply(t,i)}catch(n){return me.value=n,me}}function P(e,t){for(var i,n,a={},s=e.length,o=new Array(s),l=0;s>l;l++)o[l]=e[l];for(n=0;n<t.length;n++)i=t[n],a[i]=o[n+1];return a}function I(e){for(var t=e.length,i=new Array(t-1),n=1;t>n;n++)i[n-1]=e[n];return i}function L(e,t){return{then:function(i,n){return e.call(t,i,n)}}}function F(e,t,i,n){var a=E(i,n,t);return a===me&&v(e,a.value),e}function O(e,t,i,n){return fe.all(t).then(function(t){var a=E(i,n,t);return a===me&&v(e,a.value),e})}function W(e){return e&&"object"==typeof e?e.constructor===fe?!0:G(e):!1}function N(e,t,i){this._superConstructor(e,t,!1,i)}function B(e,t,i){this._superConstructor(e,t,!0,i)}function U(e,t,i){this._superConstructor(e,t,!1,i)}function R(){return function(){process.nextTick($)}}function j(){var e=0,t=new Fe($),i=document.createTextNode("");return t.observe(i,{characterData:!0}),function(){i.data=e=++e%2}}function H(){var e=new MessageChannel;return e.port1.onmessage=$,function(){e.port2.postMessage(0)}}function z(){return function(){setTimeout($,1)}}function $(){for(var e=0;Pe>e;e+=2){var t=We[e],i=We[e+1];t(i),We[e]=void 0,We[e+1]=void 0}Pe=0}function V(e,t){Z.async(e,t)}function q(){Z.on.apply(Z,arguments)}function Y(){Z.off.apply(Z,arguments)}var X={mixin:function(e){return e.on=this.on,e.off=this.off,e.trigger=this.trigger,e._promiseCallbacks=void 0,e},on:function(e,n){var a,s=i(this);a=s[e],a||(a=s[e]=[]),-1===t(a,n)&&a.push(n)},off:function(e,n){var a,s,o=i(this);return n?(a=o[e],s=t(a,n),void(-1!==s&&a.splice(s,1))):void(o[e]=[])},trigger:function(e,t){var n,a,s=i(this);if(n=s[e])for(var o=0;o<n.length;o++)(a=n[o])(t)}},Z={instrument:!1};X.mixin(Z);var K;K=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var J=K,Q=Date.now||function(){return(new Date).getTime()},ee=Object.create||function(e){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof e)throw new TypeError("Argument must be an object");return l.prototype=e,new l},te=[],ie=function(e,t,i){1===te.push({name:e,payload:{guid:t._guidKey+t._id,eventName:e,detail:t._result,childGuid:i&&t._guidKey+i._id,label:t._label,timeStamp:Q(),stack:new Error(t._label).stack}})&&setTimeout(function(){for(var e,t=0;t<te.length;t++)e=te[t],Z.trigger(e.name,e.payload);te.length=0},50)},ne=void 0,ae=1,se=2,oe=new w,le=new w;S.prototype._validateInput=function(e){return J(e)},S.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},S.prototype._init=function(){this._result=new Array(this.length)};var re=S;S.prototype._enumerate=function(){for(var e=this.length,t=this.promise,i=this._input,n=0;t._state===ne&&e>n;n++)this._eachEntry(i[n],n)},S.prototype._eachEntry=function(e,t){var i=this._instanceConstructor;o(e)?e.constructor===i&&e._state!==ne?(e._onerror=null,this._settledAt(e._state,t,e._result)):this._willSettleAt(i.resolve(e),t):(this._remaining--,this._result[t]=this._makeResult(ae,t,e))},S.prototype._settledAt=function(e,t,i){var n=this.promise;n._state===ne&&(this._remaining--,this._abortOnReject&&e===se?v(n,i):this._result[t]=this._makeResult(e,t,i)),0===this._remaining&&m(n,this._result)},S.prototype._makeResult=function(e,t,i){return i},S.prototype._willSettleAt=function(e,t){var i=this;y(e,void 0,function(e){i._settledAt(ae,t,e)},function(e){i._settledAt(se,t,e)})};var he=function(e,t){return new re(this,e,!0,t).promise},ce=function(e,t){function i(e){g(s,e)}function n(e){v(s,e)}var a=this,s=new a(r,t);if(!J(e))return v(s,new TypeError("You must pass an array to race.")),s;for(var o=e.length,l=0;s._state===ne&&o>l;l++)y(a.resolve(e[l]),void 0,i,n);return s},de=function(e,t){var i=this;if(e&&"object"==typeof e&&e.constructor===i)return e;var n=new i(r,t);return g(n,e),n},ue=function(e,t){var i=this,n=new i(r,t);return v(n,e),n},pe="rsvp_"+Q()+"-",ge=0,fe=D;D.cast=de,D.all=he,D.race=ce,D.resolve=de,D.reject=ue,D.prototype={constructor:D,_guidKey:pe,_onerror:function(e){Z.trigger("error",e)},then:function(e,t,i){var n=this,a=n._state;if(a===ae&&!e||a===se&&!t)return Z.instrument&&ie("chained",this,this),this;n._onerror=null;var s=new this.constructor(r,i),o=n._result;if(Z.instrument&&ie("chained",n,s),a){var l=arguments[a-1];Z.async(function(){x(a,s,l,o)})}else y(n,s,e,t);return s},"catch":function(e,t){return this.then(null,e,t)},"finally":function(e,t){var i=this.constructor;return this.then(function(t){return i.resolve(e()).then(function(){return t})},function(t){return i.resolve(e()).then(function(){throw t})},t)}};var me=new A,ve=new A,ye=function(e,t){var i=function(){for(var i,n=this,a=arguments.length,s=new Array(a+1),o=!1,l=0;a>l;++l){if(i=arguments[l],!o){if(o=W(i),o===ve){var h=new fe(r);return v(h,ve.value),h}o&&o!==!0&&(i=L(o,i))}s[l]=i}var c=new fe(r);return s[a]=function(e,i){e?v(c,e):void 0===t?g(c,i):t===!0?g(c,I(arguments)):J(t)?g(c,P(arguments,t)):g(c,i)},o?O(c,s,e,n):F(c,s,e,n)};return i.__proto__=e,i},be=function(e,t){return fe.all(e,t)};N.prototype=ee(re.prototype),N.prototype._superConstructor=re,N.prototype._makeResult=k,N.prototype._validationError=function(){return new Error("allSettled must be called with an array")};var we=function(e,t){return new N(fe,e,t).promise},_e=function(e,t){return fe.race(e,t)},xe=B;B.prototype=ee(re.prototype),B.prototype._superConstructor=re,B.prototype._init=function(){this._result={}},B.prototype._validateInput=function(e){return e&&"object"==typeof e},B.prototype._validationError=function(){return new Error("Promise.hash must be called with an object")},B.prototype._enumerate=function(){var e=this.promise,t=this._input,i=[];for(var n in t)e._state===ne&&t.hasOwnProperty(n)&&i.push({position:n,entry:t[n]});var a=i.length;this._remaining=a;for(var s,o=0;e._state===ne&&a>o;o++)s=i[o],this._eachEntry(s.entry,s.position)};var Te=function(e,t){return new xe(fe,e,t).promise};U.prototype=ee(xe.prototype),U.prototype._superConstructor=re,U.prototype._makeResult=k,U.prototype._validationError=function(){return new Error("hashSettled must be called with an object")};var ke,Se=function(e,t){return new U(fe,e,t).promise},Me=function(e){throw setTimeout(function(){throw e}),e},Ce=function(e){var t={};return t.promise=new fe(function(e,i){t.resolve=e,t.reject=i},e),t},De=function(e,t,i){return fe.all(e,i).then(function(e){if(!s(t))throw new TypeError("You must pass a function as map's second argument.");for(var n=e.length,a=new Array(n),o=0;n>o;o++)a[o]=t(e[o]);return fe.all(a,i)})},Ae=function(e,t){return fe.resolve(e,t)},Ge=function(e,t){return fe.reject(e,t)},Ee=function(e,t,i){return fe.all(e,i).then(function(e){if(!s(t))throw new TypeError("You must pass a function as filter's second argument.");for(var n=e.length,a=new Array(n),o=0;n>o;o++)a[o]=t(e[o]);return fe.all(a,i).then(function(t){for(var i=new Array(n),a=0,s=0;n>s;s++)t[s]&&(i[a]=e[s],a++);return i.length=a,i})})},Pe=0,Ie=function(e,t){We[Pe]=e,We[Pe+1]=t,Pe+=2,2===Pe&&ke()},Le="undefined"!=typeof window?window:{},Fe=Le.MutationObserver||Le.WebKitMutationObserver,Oe="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,We=new Array(1e3);ke="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?R():Fe?j():Oe?H():z(),Z.async=Ie;if("undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var Ne=window.__PROMISE_INSTRUMENTATION__;n("instrument",!0);for(var Be in Ne)Ne.hasOwnProperty(Be)&&q(Be,Ne[Be])}var Ue={race:_e,Promise:fe,allSettled:we,hash:Te,hashSettled:Se,denodeify:ye,on:q,off:Y,map:De,filter:Ee,resolve:Ae,reject:Ge,all:be,rethrow:Me,defer:Ce,EventTarget:X,configure:n,async:V};"function"==typeof define&&define.amd?define("rsvp",[],function(){return Ue}):"undefined"!=typeof e&&e.exports?e.exports=Ue:"undefined"!=typeof this&&(this.RSVP=Ue)}.call(this),define("galileo/model/SharedGoalModel",["require","exports","module","underscore","galileo/model/SharedModel","rsvp"],function(e,t,i){var n=e("underscore"),a=e("galileo/model/SharedModel"),s=e("rsvp").Promise,o=a.extend({numRequestsInFlight:0,validate:function(e){if(n.isEmpty(e))return"no attributes";if(!("userHasGoal"in e&&"boolean"==typeof e.userHasGoal))return"no userHasGoal property found on attributes"},parse:function(e){return e.goal?(this.clear(),n.isEmpty(e.goal)?{userHasGoal:!1}:n.extend({userHasGoal:!0},e.goal)):e},toServerJSON:function(){var e=o.__super__.toJSON.apply(this,arguments);return delete e.userHasGoal,e},sync:function(e,t,i){var a,s,l=i.success,r=i.error;return s=function(){this.numRequestsInFlight--,0===this.numRequestsInFlight&&this.trigger("syncsComplete")}.bind(this),i.success=function(){var e=n.toArray(arguments);a&&(e[0]=a),l&&l.apply(null,e),s()},i.error=function(){r&&r.apply(null,arguments),s()},this.numRequestsInFlight++,("create"===e||"update"===e||"patch"===e)&&(t.attributes.userHasGoal?(i.emulateJSON=!0,i.data=t.toServerJSON()):(e="delete",a={goal:{}})),o.__super__.sync.call(this,e,t,i)},isSyncing:function(){return this.numRequestsInFlight>0},afterSync:function(e){var t;this.isSyncing()?(t=function(){e()}.bind(this),this.once("syncsComplete",t)):e()},deleteGoal:function(){return new s(function(e,t){this.set("userHasGoal",!1),this.save(null,{success:e,error:t})}.bind(this))},userHasGoal:function(){return!!this.get("userHasGoal")}});return o}),define("galileo/model/SleepGoalModel",["require","exports","module","underscore","shared/scripts/modules/api-client","galileo/model/SharedGoalModel"],function(e,t,i){var n=(e("underscore"),1.1),a=e("shared/scripts/modules/api-client"),s=e("galileo/model/SharedGoalModel"),o=s.extend({initialize:function(e,t){o.__super__.initialize.apply(this,arguments),this.user=t&&t.user},url:function(){return a.makeFullUrl("/"+n+"/user/-/sleep/goal.json")},lookup:function(e,t){return i.uri+"_"+t.user.encodedId},validate:function(e){var t=o.__super__.validate.call(this,e);if(t)return t;if(e.userHasGoal)return!e.minDuration||isNaN(e.minDuration)?"minDuration is invalid":void 0}});return o}),define("galileo/model/SleepModel",["require","exports","module","backbone","underscore"],function(e,t,i){var n=e("backbone"),a=e("underscore"),s={asleep:"1",restless:"2",awake:"3"},o=n.Model.extend({initialize:function(e,t){o.__super__.initialize.apply(this,arguments),this.user=t&&t.user,this.date=t&&t.date||new Date,this.sleepStateValues=o.sleepStateValues},validate:function(e){return a.isEmpty(e)?"no attributes":void 0},getSleepSegments:function(){var e=[],t=this.get("levels").data;return this.isStagesSleep="stages"===this.get("type"),this.isStagesSleep?void 0:(a.each(t,function(t){var i=Math.round(t.seconds/60),n=t.level;i&&e.push({value:s[n],minutes:i})}),e)}});return o.sleepStateValues=s,o}),define("galileo/model/SleepCollection",["require","./SleepModel"],function(e){var t=e("./SleepModel"),i=Backbone.Collection.extend({model:t,getConsolidatedSleepSegments:function(){return this.reduce(function(e,t){return e.concat(t.getSleepSegments())},[])},comparator:function(e){return Date.parse(e.get("startTime"))}});return i}),define("galileo/model/SleepOverviewModel",["require","exports","module","underscore","galileo/model/SharedModel","galileo/util/dateUtil","galileo/model/SleepCollection","shared/scripts/modules/api-client"],function(e,t,i){var n=e("underscore"),a=e("galileo/model/SharedModel"),s=e("galileo/util/dateUtil"),o=e("galileo/model/SleepCollection"),l=e("shared/scripts/modules/api-client"),r=1.2,h=a.extend({initialize:function(e,t){h.__super__.initialize.apply(this,arguments),this.user=t&&t.user,this.date=e&&e.date||new Date},url:function(){return l.makeFullUrl("/"+r+"/user/-/sleep/date/"+s.ajaxEncode(n.result(this,"date"))+".json")},lookup:function(e,t){return t.user&&i.uri+"_"+t.user.encodedId+"_"+s.ajaxEncode(n.result(e,"date"))},validate:function(){return n.has(this,"sleep")?n.has(this.attributes,"summary")?void 0:"no sleep summary present!":"no sleep collection present!"},parse:function(e){return n.has(e,"sleep")&&(this.sleep?this.sleep.reset(e.sleep):this.sleep=new o(e.sleep),delete e.sleep),e}});return h}),define("galileo/util/color",[],function(){var e={rgb2hex:function(e,t,i){var n=e<<16|t<<8|i;return"#"+(16777216+n).toString(16).slice(1)},hex2rgb:function(e){var t;return e.length<=4&&(e=e.replace(/[a-f\d]/gi,"$&$&")),t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}},computeTargetColor:function(t,i){var n;return t=e.hex2rgb(t),n=[Math.round(t.r),Math.round(t.g),Math.round(t.b),i],"rgba("+n.join(", ")+")"}};return e}),define("galileo/color/graph",["require","../util/color"],function(e){function t(e,t){var i=[parseInt(e.slice(1,3),16),parseInt(e.slice(3,5),16),parseInt(e.slice(5,7),16),void 0===t?1:t];return"rgba("+i+")"}function i(e,i){return t(C[e],i||o)}function n(e,t){return e>=t?C.progressClasses[C.progressClasses.length-1]:a(e,t,C.progressClasses.slice(0,-1))}function a(e,t,i){var n;return i=i instanceof Array&&i.length>0?i:C.progressColors.slice(0,-1),n=0>=t?i.length-1:Math.min(Math.floor(i.length*(e/t)),i.length-1),i[n]}var s=e("../util/color"),o=1,l="#FAD60A",r="#F6952D",h="#FF8C19",c="#FFB319",d="#B0E52C",u="#F4FBE3",p="#FE951B",g="#E60013",f="#4DBFBF",m="#EE3D6E",v="#3C3C3C",y="#585858",b="#F0F0F0",w="#FFFFFF",_=["#65D8D8","#5BC2C1"],x=["#FED76E","#FDBF2D"],T=["#FD8F49","#FC772E"],k=["#B0E52C","#A2D425"],S=["#E84C4D","#F45455"],M=["#D4DDE1","#D8E0E4"],C={sedentary:l,lightly_active:l,moderately_active:r,graphBgFill:w,very_active:"#8DDA3C",goal_line:d,goal_met:d,goal_unmet:f,xAxis:"#F2F2F2",xAxisBaseLine:"#E5E5E5",hrLine:"#FF7373",hrFill:"#FFF2F2",calsLine:"#FF9100",calsFill:"#FFF4E5",fatBurn:c,cardio:h,peak:g,fatBurnMuted:"#FFF9DB",cardioMuted:"#FBE8D0",peakMuted:"#FDE5E0",heartRateLine:{noZone:"#FFF04C",fatBurn:c,cardio:h,peak:g},yAxis:b,activityColumn:{SEDENTARY:[[0,x[1]],[1,x[0]]],LIGHTLY_ACTIVE:[[0,x[1]],[1,x[0]]],MODERATELY_ACTIVE:[[0,T[1]],[1,T[0]]],VERY_ACTIVE:[[0,k[1]],[1,k[0]]]},goalTile:{INACTIVE:[_[0],_[1]],SEDENTARY:[x[0],x[1]],LIGHTLY_ACTIVE:[x[0],x[1]],MODERATELY_ACTIVE:[T[0],T[1]],VERY_ACTIVE:[k[0],k[1]]},columnGradients:{gold:[[0,x[1]],[1,x[0]]],orange:[[0,T[1]],[1,T[0]]],lime:[[0,k[1]],[1,k[0]]],teal:[[0,_[1]],[1,_[0]]],red:[[0,S[1]],[1,S[0]]],gray:[[0,M[1]],[1,M[0]]]},bmi:{under:f,normal:d,over:l,obese:p},calZone:{under:l,onTrack:d,over:p,needle:y,needleCenter:b},weightMeter:{bgArc:b,arc:k,progressLabel:m,goalLabel:y},sleepMeter:{bgArc:b,arc:["#2B4873","#2C5E90"],goalArc:k,sleepChevron:"#FFF",goalChevron:"#000",progressLabel:m,goalLabel:y,overviewLabel:"#FF4588",awakeSegment:"#F13C6E",restlessSegment:f},weightGraph:{weight:d,lean:f,marker:w},weightGraphView:{weight:f,markerFill:f,markerLine:w},calories:{burned:d,intake:f},minutesLightly:r,minutesFairly:l,minutesVery:d,progressColors:["rgb(101,216,216)","rgb(250,214,10)","rgb(246,149,45)","rgb(177,227,64)"],progressColorsMuted:["rgb(236,250,250)","rgb(255,249,219)","rgb(254,241,233)","rgb(236,250,250)"],progressClasses:["start","less","more","finish"],sleep:{line:"#F0F0F0",asleep:{legend:"#2C5E90",startGradient:"#2C5E90",endGradient:"#2B4873"},awake:{legend:"#FE4588",startGradient:"#FE4588",endGradient:"#FE4588"},restless:{legend:"#54C2C3",startGradient:"#54C2C3",endGradient:"#54C2C3"},clock:{startGradient:"#2B3357",endGradient:"#2C699F",ticks:["#F0F0F0","#FFF"],text:["#AEAEAE","#FFF"],outerRing:"#F0F0F0"}},progresCircleColors:{inactive:_,levelOne:_,levelTwo:x,levelThree:T,levelFour:k},foodPlan:{fullPlateFill:{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,"#65D8D7"],[1,"#5AC2C1"]]},emptyPlateFill:"#FFFFFF",emptyPlateStroke:"#F0F0F0"},fn:{hex2rgba:t,alpha:i,progress:a,progressClass:n},labelText:v};return C.goal_unmet_muted=b,C.goal_met_muted=u,C.minutesLightlyMuted=s.computeTargetColor(C.minutesLightly,.2),C.minutesFairlyMuted=s.computeTargetColor(C.minutesFairly,.2),C.minutesVeryMuted=s.computeTargetColor(C.minutesVery,.2),C.caloriesMuted={burned:s.computeTargetColor(C.calories.burned,.2),intake:s.computeTargetColor(C.calories.intake,.2)},C}),define("galileo/graphic/sleepMeterConfig",["require","galileo/color/graph"],function(e){var t=e("galileo/color/graph");return{meterWidth:164,meterHeight:144,centerX:82,centerY:82,arcThickness:18,padding:0,progressLabelSpacing:20,endpointLabelSpacing:30,markerDiameter:8,bgArcSegments:5,bgArcPadding:.025,bgArcStyles:{stroke:t.sleepMeter.bgArc,"stroke-width":4,"stroke-linecap":"round","stroke-linejoin":"round"},fgArcStyles:{stroke:{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,t.sleepMeter.arc[0]],[1,t.sleepMeter.arc[1]],[2,t.sleepMeter.arc[0]]]},"stroke-width":18,"stroke-linecap":"butt","stroke-linejoin":"round"},awakeArcStyles:{fill:t.sleepMeter.awakeSegment,"stroke-width":0,"stroke-linecap":"butt","stroke-linejoin":"miter"},restlessArcStyles:{fill:t.sleepMeter.restlessSegment,"stroke-width":0,"stroke-linecap":"butt","stroke-linejoin":"miter"},atBeginningStyles:{color:t.sleepMeter.arc[0]},chevrons:{goalHit:{color:"#000",opacity:.17},noGoalHit:{color:"#5F84AD",opacity:1}},overviewLabelStyles:{color:t.sleepMeter.overviewLabel,fontSize:"18px",fontFamily:'"Proxima Nova SemiBold", sans-serif'},goalLabelStyles:{color:t.sleepMeter.goalLabel,fontSize:"18px",fontFamily:'"Proxima Nova Light", sans-serif'}}}),function(){function e(e,t){var i;e||(e={});for(i in t)e[i]=t[i];return e}function t(){for(var e=0,t=arguments,i=t.length,n={};i>e;e++)n[t[e++]]=t[e];return n}function i(e,t){return parseInt(e,t||10)}function n(e){return"string"==typeof e}function a(e){return"object"==typeof e}function s(e){return"[object Array]"===Object.prototype.toString.call(e)}function o(e){return"number"==typeof e}function l(e){return he.log(e)/he.LN10}function r(e){return he.pow(10,e)}function h(e,t){for(var i=e.length;i--;)if(e[i]===t){e.splice(i,1);break}}function c(e){return e!==R&&null!==e}function d(e,t,i){var s,o;if(n(t))c(i)?e.setAttribute(t,i):e&&e.getAttribute&&(o=e.getAttribute(t));else if(c(t)&&a(t))for(s in t)e.setAttribute(s,t[s]);return o}function u(e){return s(e)?e:[e]}function p(){var e,t,i=arguments,n=i.length;for(e=0;n>e;e++)if(t=i[e],"undefined"!=typeof t&&null!==t)return t}function g(t,i){xe&&i&&i.opacity!==R&&(i.filter="alpha(opacity="+100*i.opacity+")"),e(t.style,i)}function f(t,i,n,a,s){return t=le.createElement(t),i&&e(t,i),s&&g(t,{padding:0,border:Fe,margin:0}),n&&g(t,n),a&&a.appendChild(t),t}function m(t,i){var n=function(){};return n.prototype=new t,e(n.prototype,i),n}function v(e,t,n,a){var s=z.lang,o=e;-1===t?(t=(e||0).toString(),e=t.indexOf(".")>-1?t.split(".")[1].length:0):e=isNaN(t=fe(t))?2:t;var t=e,n=void 0===n?s.decimalPoint:n,a=void 0===a?s.thousandsSep:a,s=0>o?"-":"",e=String(i(o=fe(+o||0).toFixed(t))),l=e.length>3?e.length%3:0;return s+(l?e.substr(0,l)+a:"")+e.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+a)+(t?n+fe(o-e).toFixed(t).slice(2):"")}function y(e,t){return Array((t||2)+1-String(e).length).join(0)+e}function b(e,t,i,n){var a,i=p(i,1);for(a=e/i,t||(t=[1,2,2.5,5,10],n&&n.allowDecimals===!1&&(1===i?t=[1,2,5,10]:.1>=i&&(t=[1/i]))),n=0;n<t.length&&(e=t[n],!(a<=(t[n]+(t[n+1]||t[n]))/2));n++);return e*=i}function w(e,t){var i,n=t||[[We,[1,2,5,10,20,25,50,100,200,500]],[Ne,[1,2,5,10,15,30]],[Be,[1,2,5,10,15,30]],[Ue,[1,2,3,4,6,8,12]],[Re,[1,2]],[je,[1,2]],[He,[1,2,3,4,6]],[ze,null]],a=n[n.length-1],s=Y[a[0]],o=a[1];for(i=0;i<n.length&&(a=n[i],s=Y[a[0]],o=a[1],!(n[i+1]&&e<=(s*o[o.length-1]+Y[n[i+1][0]])/2));i++);return s===Y[ze]&&5*s>e&&(o=[1,2,5]),s===Y[ze]&&5*s>e&&(o=[1,2,5]),n=b(e/s,o),{unitRange:s,count:n,unitName:a[0]}}function _(t,i,n,a){var s,o=[],l={},r=z.global.useUTC,h=new Date(i),i=t.unitRange,c=t.count;i>=Y[Ne]&&(h.setMilliseconds(0),h.setSeconds(i>=Y[Be]?0:c*de(h.getSeconds()/c))),i>=Y[Be]&&h[ie](i>=Y[Ue]?0:c*de(h[Z]()/c)),i>=Y[Ue]&&h[ne](i>=Y[Re]?0:c*de(h[K]()/c)),i>=Y[Re]&&h[ae](i>=Y[He]?1:c*de(h[Q]()/c)),i>=Y[He]&&(h[se](i>=Y[ze]?0:c*de(h[ee]()/c)),s=h[te]()),i>=Y[ze]&&(s-=s%c,h[oe](s)),i===Y[je]&&h[ae](h[Q]()-h[J]()+p(a,1)),a=1,s=h[te]();for(var d=h.getTime(),u=h[ee](),g=h[Q](),h=r?0:(864e5+6e4*h.getTimezoneOffset())%864e5;n>d;)o.push(d),i===Y[ze]?d=X(s+a*c,0):i===Y[He]?d=X(s,u+a*c):r||i!==Y[Re]&&i!==Y[je]?(d+=i*c,i<=Y[Ue]&&d%Y[Re]===h&&(l[d]=Re)):d=X(s,u,g+a*c*(i===Y[Re]?1:7)),a++;return o.push(d),o.info=e(t,{higherRanks:l,totalRange:i*c}),o}function x(){this.symbol=this.color=0}function T(e,t){var i,n,a=e.length;for(n=0;a>n;n++)e[n].ss_i=n;for(e.sort(function(e,n){return i=t(e,n),0===i?e.ss_i-n.ss_i:i}),n=0;a>n;n++)delete e[n].ss_i}function k(e){for(var t=e.length,i=e[0];t--;)e[t]<i&&(i=e[t]);return i}function S(e){for(var t=e.length,i=e[0];t--;)e[t]>i&&(i=e[t]);return i}function M(e,t){for(var i in e)e[i]&&e[i]!==t&&e[i].destroy&&e[i].destroy(),delete e[i]}function C(e){H||(H=f(Le)),e&&H.appendChild(e),H.innerHTML=""}function D(e,t){var i="Highcharts error #"+e+": www.highcharts.com/errors/"+e;if(t)throw i;re.console&&console.log(i)}function A(e){return parseFloat(e.toPrecision(14))}function G(e,t){V=p(e,t.animation)}function E(){var e=z.global.useUTC,t=e?"getUTC":"get",i=e?"setUTC":"set";X=e?Date.UTC:function(e,t,i,n,a,s){return new Date(e,t,p(i,1),p(n,0),p(a,0),p(s,0)).getTime()},Z=t+"Minutes",K=t+"Hours",J=t+"Day",Q=t+"Date",ee=t+"Month",te=t+"FullYear",ie=i+"Minutes",ne=i+"Hours",ae=i+"Date",se=i+"Month",oe=i+"FullYear"}function P(){}function I(e,t,i){this.axis=e,this.pos=t,this.type=i||"",this.isNew=!0,i||this.addLabel()}function L(e,t){return this.axis=e,t&&(this.options=t,this.id=t.id),this}function F(e,t,i,n,a,s){var o=e.chart.inverted;this.axis=e,this.isNegative=i,this.options=t,this.x=n,this.stack=a,this.percent="percent"===s,this.alignOptions={align:t.align||(o?i?"left":"right":"center"),verticalAlign:t.verticalAlign||(o?"middle":i?"bottom":"top"),y:p(t.y,o?4:i?14:-6),x:p(t.x,o?i?-6:6:0)},this.textAlign=t.textAlign||(o?i?"right":"left":"center")}function O(){this.init.apply(this,arguments)}function W(e,t){var n=t.borderWidth,a=t.style,s=i(a.padding);this.chart=e,this.options=t,this.crosshairs=[],this.now={x:0,y:0},this.isHidden=!0,this.label=e.renderer.label("",0,0,t.shape,null,null,t.useHTML,null,"tooltip").attr({padding:s,fill:t.backgroundColor,"stroke-width":n,r:t.borderRadius,zIndex:8}).css(a).css({padding:0}).hide().add(),Ae||this.label.shadow(t.shadow),this.shared=t.shared}function N(e,t){var i=Ae?"":t.chart.zoomType;this.zoomX=/x/.test(i),this.zoomY=/y/.test(i),this.options=t,this.chart=e,this.init(e,t.tooltip)}function B(e){this.init(e)}function U(e,t){var i,n=e.series;e.series=null,i=tt(z,e),i.series=e.series=n;var n=i.chart,s=n.margin,s=a(s)?s:[s,s,s,s];this.optionsMarginTop=p(n.marginTop,s[0]),this.optionsMarginRight=p(n.marginRight,s[1]),this.optionsMarginBottom=p(n.marginBottom,s[2]),this.optionsMarginLeft=p(n.marginLeft,s[3]),this.runChartClick=(s=n.events)&&!!s.click,this.callback=t,this.isResizing=0,this.options=i,this.axes=[],this.series=[],this.hasCartesianSeries=n.showAxes,this.init(s)}var R,j,H,z,$,V,q,Y,X,Z,K,J,Q,ee,te,ie,ne,ae,se,oe,le=document,re=window,he=Math,ce=he.round,de=he.floor,ue=he.ceil,pe=he.max,ge=he.min,fe=he.abs,me=he.cos,ve=he.sin,ye=he.PI,be=2*ye/360,we=navigator.userAgent,_e=re.opera,xe=/msie/i.test(we)&&!_e,Te=8===le.documentMode,ke=/AppleWebKit/.test(we),Se=/Firefox/.test(we),Me="http://www.w3.org/2000/svg",Ce=!!le.createElementNS&&!!le.createElementNS(Me,"svg").createSVGRect,De=Se&&parseInt(we.split("Firefox/")[1],10)<4,Ae=!Ce&&!xe&&!!le.createElement("canvas").getContext,Ge=le.documentElement.ontouchstart!==R,Ee={},Pe=0,Ie=function(){},Le="div",Fe="none",Oe="rgba(192,192,192,"+(Ce?1e-6:.002)+")",We="millisecond",Ne="second",Be="minute",Ue="hour",Re="day",je="week",He="month",ze="year",$e={};re.Highcharts={},$=function(e,t,i){if(!c(t)||isNaN(t))return"Invalid date";var n,e=p(e,"%Y-%m-%d %H:%M:%S"),a=new Date(t),s=a[K](),o=a[J](),l=a[Q](),r=a[ee](),h=a[te](),d=z.lang,u=d.weekdays,t={a:u[o].substr(0,3),A:u[o],d:y(l),e:l,b:d.shortMonths[r],B:d.months[r],m:y(r+1),y:h.toString().substr(2,2),Y:h,H:y(s),I:y(s%12||12),l:s%12||12,M:y(a[Z]()),p:12>s?"AM":"PM",P:12>s?"am":"pm",S:y(a.getSeconds()),L:y(ce(t%1e3),3)};for(n in t)e=e.replace("%"+n,t[n]);return i?e.substr(0,1).toUpperCase()+e.substr(1):e},x.prototype={wrapColor:function(e){this.color>=e&&(this.color=0)},wrapSymbol:function(e){this.symbol>=e&&(this.symbol=0)}},Y=t(We,1,Ne,1e3,Be,6e4,Ue,36e5,Re,864e5,je,6048e5,He,2592e6,ze,31556952e3),q={init:function(e,t,i){var n,a,s,t=t||"",o=e.shift,l=t.indexOf("C")>-1,r=l?7:3,t=t.split(" "),i=[].concat(i),h=function(e){for(n=e.length;n--;)"M"===e[n]&&e.splice(n+1,0,e[n+1],e[n+2],e[n+1],e[n+2])};if(l&&(h(t),h(i)),e.isArea&&(a=t.splice(t.length-6,6),s=i.splice(i.length-6,6)),o<=i.length/r)for(;o--;)i=[].concat(i).splice(0,r).concat(i);if(e.shift=0,t.length)for(e=i.length;t.length<e;)o=[].concat(t).splice(t.length-r,r),l&&(o[r-6]=o[r-2],o[r-5]=o[r-1]),t=t.concat(o);return a&&(t=t.concat(a),i=i.concat(s)),[t,i]},step:function(e,t,i,n){var a=[],s=e.length;if(1===i)a=n;else if(s===t.length&&1>i)for(;s--;)n=parseFloat(e[s]),a[s]=isNaN(n)?e[s]:i*parseFloat(t[s]-n)+n;else a=t;return a}},function(t){re.HighchartsAdapter=re.HighchartsAdapter||t&&{init:function(e){var i,n=t.fx,a=n.step,s=t.Tween,o=s&&s.propHooks;t.extend(t.easing,{easeOutQuad:function(e,t,i,n,a){return-n*(t/=a)*(t-2)+i}}),t.each(["cur","_default","width","height"],function(e,t){var i,l,r=a;"cur"===t?r=n.prototype:"_default"===t&&s&&(r=o[t],t="set"),(i=r[t])&&(r[t]=function(n){return n=e?n:this,l=n.elem,l.attr?l.attr(n.prop,"cur"===t?R:n.now):i.apply(this,arguments)})}),i=function(t){var i,n=t.elem;t.started||(i=e.init(n,n.d,n.toD),t.start=i[0],t.end=i[1],t.started=!0),n.attr("d",e.step(t.start,t.end,t.pos,n.toD))},s?o.d={set:i}:a.d=i,this.each=Array.prototype.forEach?function(e,t){return Array.prototype.forEach.call(e,t)}:function(e,t){for(var i=0,n=e.length;n>i;i++)if(t.call(e[i],e[i],i,e)===!1)return i}},getScript:t.getScript,inArray:t.inArray,adapterRun:function(e,i){return t(e)[i]()},grep:t.grep,map:function(e,t){for(var i=[],n=0,a=e.length;a>n;n++)i[n]=t.call(e[n],e[n],n,e);return i},merge:function(){var e=arguments;return t.extend(!0,null,e[0],e[1],e[2],e[3])},offset:function(e){return t(e).offset()},addEvent:function(e,i,n){t(e).bind(i,n)},removeEvent:function(e,i,n){var a=le.removeEventListener?"removeEventListener":"detachEvent";le[a]&&!e[a]&&(e[a]=function(){}),t(e).unbind(i,n)},fireEvent:function(i,n,a,s){var o,l=t.Event(n),r="detached"+n;!xe&&a&&(delete a.layerX,delete a.layerY),e(l,a),i[n]&&(i[r]=i[n],i[n]=null),t.each(["preventDefault","stopPropagation"],function(e,t){var i=l[t];l[t]=function(){try{i.call(l)}catch(e){"preventDefault"===t&&(o=!0)}}}),t(i).trigger(l),i[r]&&(i[n]=i[r],i[r]=null),s&&!l.isDefaultPrevented()&&!o&&s(l)},washMouseEvent:function(e){var t=e.originalEvent||e;return t.pageX===R&&(t.pageX=e.pageX,t.pageY=e.pageY),t},animate:function(e,i,n){var a=t(e);i.d&&(e.toD=i.d,i.d=1),a.stop(),a.animate(i,n)},stop:function(e){t(e).stop()}}}(re.jQuery);var Ve=re.HighchartsAdapter,qe=Ve||{};Ve&&Ve.init.call(Ve,q);var Ye=qe.adapterRun,Xe=qe.getScript,Ze=qe.inArray,Ke=qe.each,Je=qe.grep,Qe=qe.offset,et=qe.map,tt=qe.merge,it=qe.addEvent,nt=qe.removeEvent,at=qe.fireEvent,st=qe.washMouseEvent,ot=qe.animate,lt=qe.stop,qe={enabled:!0,align:"center",x:0,y:15,style:{color:"#666",fontSize:"11px",lineHeight:"14px"}};z={colors:"#4572A7,#AA4643,#89A54E,#80699B,#3D96AE,#DB843D,#92A8CD,#A47D7C,#B5CA92".split(","),symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),weekdays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),decimalPoint:".",numericSymbols:"k,M,G,T,P,E".split(","),resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:","},global:{useUTC:!0,canvasToolsURL:"http://code.highcharts.com/2.3.3/modules/canvas-tools.js",VMLRadialGradientURL:"http://code.highcharts.com/2.3.3/gfx/vml-radial-gradient.png"},chart:{borderColor:"#4572A7",borderRadius:5,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacingTop:10,spacingRight:10,spacingBottom:15,spacingLeft:10,style:{fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Verdana, Arial, Helvetica, sans-serif',fontSize:"12px"},backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0",resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}}},title:{text:"Chart title",align:"center",y:15,style:{color:"#3E576F",fontSize:"16px"}},subtitle:{text:"",align:"center",y:30,style:{color:"#6D869F"}},plotOptions:{line:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:2,shadow:!0,marker:{enabled:!0,lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0},select:{fillColor:"#FFFFFF",
lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:tt(qe,{enabled:!1,formatter:function(){return this.y},verticalAlign:"bottom",y:0}),cropThreshold:300,pointRange:0,showInLegend:!0,states:{hover:{marker:{}},select:{marker:{}}},stickyTracking:!0}},labels:{style:{position:"absolute",color:"#3E576F"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderWidth:1,borderColor:"#909090",borderRadius:5,navigation:{activeColor:"#3E576F",inactiveColor:"#CCC"},shadow:!1,itemStyle:{cursor:"pointer",color:"#3E576F",fontSize:"12px"},itemHoverStyle:{color:"#000"},itemHiddenStyle:{color:"#CCC"},itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},symbolWidth:16,symbolPadding:5,verticalAlign:"bottom",x:0,y:0},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"1em"},style:{position:"absolute",backgroundColor:"white",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,backgroundColor:"rgba(255, 255, 255, .85)",borderWidth:2,borderRadius:5,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b><br/>',shadow:!0,shared:Ae,snap:Ge?25:10,style:{color:"#333333",fontSize:"12px",padding:"5px",whiteSpace:"nowrap"}},credits:{enabled:!0,text:"Highcharts.com",href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"10px"}}};var rt=z.plotOptions,Ve=rt.line;E();var ht=function(e){var t,n=[];return function(e){(t=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/.exec(e))?n=[i(t[1]),i(t[2]),i(t[3]),parseFloat(t[4],10)]:(t=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(e))&&(n=[i(t[1],16),i(t[2],16),i(t[3],16),1])}(e),{get:function(t){return n&&!isNaN(n[0])?"rgb"===t?"rgb("+n[0]+","+n[1]+","+n[2]+")":"a"===t?n[3]:"rgba("+n.join(",")+")":e},brighten:function(e){if(o(e)&&0!==e){var t;for(t=0;3>t;t++)n[t]+=i(255*e),n[t]<0&&(n[t]=0),n[t]>255&&(n[t]=255)}return this},setOpacity:function(e){return n[3]=e,this}}};P.prototype={init:function(e,t){this.element="span"===t?f(t):le.createElementNS(Me,t),this.renderer=e,this.attrSetters={}},animate:function(e,t,i){t=p(t,V,!0),lt(this),t?(t=tt(t),i&&(t.complete=i),ot(this,e,t)):(this.attr(e),i&&i())},attr:function(e,t){var a,s,o,l,r,h,u,p=this.element,g=p.nodeName.toLowerCase(),f=this.renderer,m=this.attrSetters,v=this.shadows,y=this;if(n(e)&&c(t)&&(a=e,e={},e[a]=t),n(e))a=e,"circle"===g?a={x:"cx",y:"cy"}[a]||a:"strokeWidth"===a&&(a="stroke-width"),y=d(p,a)||this[a]||0,"d"!==a&&"visibility"!==a&&(y=parseFloat(y));else for(a in e)if(r=!1,s=e[a],o=m[a]&&m[a].call(this,s,a),o!==!1){if(o!==R&&(s=o),"d"===a)s&&s.join&&(s=s.join(" ")),/(NaN| {2}|^$)/.test(s)&&(s="M 0 0");else if("x"===a&&"text"===g){for(o=0;o<p.childNodes.length;o++)l=p.childNodes[o],d(l,"x")===d(p,"x")&&d(l,"x",s);this.rotation&&d(p,"transform","rotate("+this.rotation+" "+s+" "+i(e.y||d(p,"y"))+")")}else if("fill"===a)s=f.color(s,p,a);else if("circle"!==g||"x"!==a&&"y"!==a)if("rect"===g&&"r"===a)d(p,{rx:s,ry:s}),r=!0;else if("translateX"===a||"translateY"===a||"rotation"===a||"verticalAlign"===a)r=u=!0;else if("stroke"===a)s=f.color(s,p,a);else if("dashstyle"===a){if(a="stroke-dasharray",s=s&&s.toLowerCase(),"solid"===s)s=Fe;else if(s){for(s=s.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(","),o=s.length;o--;)s[o]=i(s[o])*e["stroke-width"];s=s.join(",")}}else"isTracker"===a?this[a]=s:"width"===a?s=i(s):"align"===a?(a="text-anchor",s={left:"start",center:"middle",right:"end"}[s]):"title"===a&&(o=p.getElementsByTagName("title")[0],o||(o=le.createElementNS(Me,"title"),p.appendChild(o)),o.textContent=s);else a={x:"cx",y:"cy"}[a]||a;if("strokeWidth"===a&&(a="stroke-width"),ke&&"stroke-width"===a&&0===s&&(s=1e-6),this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)/.test(a)&&(h||(this.symbolAttr(e),h=!0),r=!0),v&&/^(width|height|visibility|x|y|d|transform)$/.test(a))for(o=v.length;o--;)d(v[o],a,"height"===a?pe(s-(v[o].cutHeight||0),0):s);("width"===a||"height"===a)&&"rect"===g&&0>s&&(s=0),this[a]=s,u&&this.updateTransform(),"text"===a?(s!==this.textStr&&delete this.bBox,this.textStr=s,this.added&&f.buildText(this)):r||d(p,a,s)}return y},symbolAttr:function(e){var t=this;Ke("x,y,r,start,end,width,height,innerR,anchorX,anchorY".split(","),function(i){t[i]=p(e[i],t[i])}),t.attr({d:t.renderer.symbols[t.symbolName](t.x,t.y,t.width,t.height,t)})},clip:function(e){return this.attr("clip-path",e?"url("+this.renderer.url+"#"+e.id+")":Fe)},crisp:function(e,t,i,n,a){var s,o,l={},r={},e=e||this.strokeWidth||this.attr&&this.attr("stroke-width")||0;o=ce(e)%2/2,r.x=de(t||this.x||0)+o,r.y=de(i||this.y||0)+o,r.width=de((n||this.width||0)-2*o),r.height=de((a||this.height||0)-2*o),r.strokeWidth=e;for(s in r)this[s]!==r[s]&&(this[s]=l[s]=r[s]);return l},css:function(t){var i,n=this.element,n=t&&t.width&&"text"===n.nodeName.toLowerCase(),a="",s=function(e,t){return"-"+t.toLowerCase()};if(t&&t.color&&(t.fill=t.color),this.styles=t=e(this.styles,t),Ae&&n&&delete t.width,xe&&!Ce)n&&delete t.width,g(this.element,t);else{for(i in t)a+=i.replace(/([A-Z])/g,s)+":"+t[i]+";";this.attr({style:a})}return n&&this.added&&this.renderer.buildText(this),this},on:function(e,t){var i=t;return Ge&&"click"===e&&(e="touchstart",i=function(e){e.preventDefault(),t()}),this.element["on"+e]=i,this},setRadialReference:function(e){return this.element.radialReference=e,this},translate:function(e,t){return this.attr({translateX:e,translateY:t})},invert:function(){return this.inverted=!0,this.updateTransform(),this},htmlCss:function(t){var i=this.element;return(i=t&&"SPAN"===i.tagName&&t.width)&&(delete t.width,this.textWidth=i,this.updateTransform()),this.styles=e(this.styles,t),g(this.element,t),this},htmlGetBBox:function(){var e=this.element,t=this.bBox;return t||("text"===e.nodeName&&(e.style.position="absolute"),t=this.bBox={x:e.offsetLeft,y:e.offsetTop,width:e.offsetWidth,height:e.offsetHeight}),t},htmlUpdateTransform:function(){if(this.added){var e=this.renderer,t=this.element,n=this.translateX||0,a=this.translateY||0,s=this.x||0,o=this.y||0,l=this.textAlign||"left",r={left:0,center:.5,right:1}[l],h=l&&"left"!==l,d=this.shadows;if((n||a)&&(g(t,{marginLeft:n,marginTop:a}),d&&Ke(d,function(e){g(e,{marginLeft:n+1,marginTop:a+1})})),this.inverted&&Ke(t.childNodes,function(i){e.invertChild(i,t)}),"SPAN"===t.tagName){var u,f,m,v,d=this.rotation,y=0,b=1,y=0;m=i(this.textWidth);var w=this.xCorr||0,_=this.yCorr||0,x=[d,l,t.innerHTML,this.textWidth].join(",");u={},x!==this.cTT&&(c(d)&&(e.isSVG?(w=xe?"-ms-transform":ke?"-webkit-transform":Se?"MozTransform":_e?"-o-transform":"",u[w]=u.transform="rotate("+d+"deg)"):(y=d*be,b=me(y),y=ve(y),u.filter=d?["progid:DXImageTransform.Microsoft.Matrix(M11=",b,", M12=",-y,", M21=",y,", M22=",b,", sizingMethod='auto expand')"].join(""):Fe),g(t,u)),u=p(this.elemWidth,t.offsetWidth),f=p(this.elemHeight,t.offsetHeight),u>m&&/[ \-]/.test(t.innerText)&&(g(t,{width:m+"px",display:"block",whiteSpace:"normal"}),u=m),m=e.fontMetrics(t.style.fontSize).b,w=0>b&&-u,_=0>y&&-f,v=0>b*y,w+=y*m*(v?1-r:r),_-=b*m*(d?v?r:1-r:1),h&&(w-=u*r*(0>b?-1:1),d&&(_-=f*r*(0>y?-1:1)),g(t,{textAlign:l})),this.xCorr=w,this.yCorr=_),g(t,{left:s+w+"px",top:o+_+"px"}),this.cTT=x}}else this.alignOnAdd=!0},updateTransform:function(){var e=this.translateX||0,t=this.translateY||0,i=this.inverted,n=this.rotation,a=[];i&&(e+=this.attr("width"),t+=this.attr("height")),(e||t)&&a.push("translate("+e+","+t+")"),i?a.push("rotate(90) scale(-1,1)"):n&&a.push("rotate("+n+" "+(this.x||0)+" "+(this.y||0)+")"),a.length&&d(this.element,"transform",a.join(" "))},toFront:function(){var e=this.element;return e.parentNode.appendChild(e),this},align:function(e,t,i){e?(this.alignOptions=e,this.alignByTranslate=t,i||this.renderer.alignedObjects.push(this)):(e=this.alignOptions,t=this.alignByTranslate);var i=p(i,this.renderer),n=e.align,a=e.verticalAlign,s=(i.x||0)+(e.x||0),o=(i.y||0)+(e.y||0),l={};return("right"===n||"center"===n)&&(s+=(i.width-(e.width||0))/{right:1,center:2}[n]),l[t?"translateX":"x"]=ce(s),("bottom"===a||"middle"===a)&&(o+=(i.height-(e.height||0))/({bottom:1,middle:2}[a]||1)),l[t?"translateY":"y"]=ce(o),this[this.placed?"animate":"attr"](l),this.placed=!0,this.alignAttr=l,this},getBBox:function(){var t,i=this.bBox,n=this.renderer,a=this.rotation,s=this.element,o=this.styles,l=a*be;if(!i){if(s.namespaceURI===Me||n.forExport){try{i=s.getBBox?e({},s.getBBox()):{width:s.offsetWidth,height:s.offsetHeight}}catch(r){}(!i||i.width<0)&&(i={width:0,height:0})}else i=this.htmlGetBBox();n.isSVG&&(n=i.width,t=i.height,a)&&(i.width=fe(t*ve(l))+fe(n*me(l)),i.height=fe(t*me(l))+fe(n*ve(l))),xe&&o&&"11px"===o.fontSize&&22.700000762939453===t&&(i.height=14),this.bBox=i}return i},show:function(){return this.attr({visibility:"visible"})},hide:function(){return this.attr({visibility:"hidden"})},add:function(e){var t,n=this.renderer,a=e||n,s=a.element||n.box,o=s.childNodes,l=this.element,r=d(l,"zIndex");if(e&&(this.parentGroup=e),this.parentInverted=e&&e.inverted,void 0!==this.textStr&&n.buildText(this),r&&(a.handleZ=!0,r=i(r)),a.handleZ)for(a=0;a<o.length;a++)if(e=o[a],n=d(e,"zIndex"),e!==l&&(i(n)>r||!c(r)&&c(n))){s.insertBefore(l,e),t=!0;break}return t||s.appendChild(l),this.added=!0,at(this,"add"),this},safeRemoveChild:function(e){var t=e.parentNode;t&&t.removeChild(e)},destroy:function(){var e,t,i=this,n=i.element||{},a=i.shadows;if(n.onclick=n.onmouseout=n.onmouseover=n.onmousemove=null,lt(i),i.clipPath&&(i.clipPath=i.clipPath.destroy()),i.stops){for(t=0;t<i.stops.length;t++)i.stops[t]=i.stops[t].destroy();i.stops=null}i.safeRemoveChild(n),a&&Ke(a,function(e){i.safeRemoveChild(e)}),h(i.renderer.alignedObjects,i);for(e in i)delete i[e];return null},empty:function(){for(var e=this.element,t=e.childNodes,i=t.length;i--;)e.removeChild(t[i])},shadow:function(e,t,i){var n,a,s,o,l,r,h=[],c=this.element;if(e){for(o=p(e.width,3),l=(e.opacity||.15)/o,r=this.parentInverted?"(-1,-1)":"("+p(e.offsetX,1)+", "+p(e.offsetY,1)+")",n=1;o>=n;n++)a=c.cloneNode(0),s=2*o+1-2*n,d(a,{isShadow:"true",stroke:e.color||"black","stroke-opacity":l*n,"stroke-width":s,transform:"translate"+r,fill:Fe}),i&&(d(a,"height",pe(d(a,"height")-s,0)),a.cutHeight=s),t?t.element.appendChild(a):c.parentNode.insertBefore(a,c),h.push(a);this.shadows=h}return this}};var ct=function(){this.init.apply(this,arguments)};ct.prototype={Element:P,init:function(e,t,i,n){var a,s=location;a=this.createElement("svg").attr({xmlns:Me,version:"1.1"}),e.appendChild(a.element),this.isSVG=!0,this.box=a.element,this.boxWrapper=a,this.alignedObjects=[],this.url=(Se||ke)&&le.getElementsByTagName("base").length?s.href.replace(/#.*?$/,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"",this.defs=this.createElement("defs").add(),this.forExport=n,this.gradients={},this.setSize(t,i,!1);var o;Se&&e.getBoundingClientRect&&(this.subPixelFix=t=function(){g(e,{left:0,top:0}),o=e.getBoundingClientRect(),g(e,{left:ue(o.left)-o.left+"px",top:ue(o.top)-o.top+"px"})},t(),it(re,"resize",t))},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var e=this.defs;return this.box=null,this.boxWrapper=this.boxWrapper.destroy(),M(this.gradients||{}),this.gradients=null,e&&(this.defs=e.destroy()),this.subPixelFix&&nt(re,"resize",this.subPixelFix),this.alignedObjects=null},createElement:function(e){var t=new this.Element;return t.init(this,e),t},draw:function(){},buildText:function(e){for(var t,n=e.element,a=p(e.textStr,"").toString().replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g),s=n.childNodes,o=/style="([^"]+)"/,l=/href="([^"]+)"/,r=d(n,"x"),h=e.styles,c=h&&h.width&&i(h.width),u=h&&h.lineHeight,h=s.length,f=[];h--;)n.removeChild(s[h]);c&&!e.added&&this.box.appendChild(n),""===a[a.length-1]&&a.pop(),Ke(a,function(a,s){var h,p,m=0,a=a.replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||");h=a.split("|||"),Ke(h,function(a){if(""!==a||1===h.length){var v,y={},b=le.createElementNS(Me,"tspan");if(o.test(a)&&(v=a.match(o)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),d(b,"style",v)),l.test(a)&&(d(b,"onclick",'location.href="'+a.match(l)[1]+'"'),g(b,{cursor:"pointer"})),a=(a.replace(/<(.|\n)*?>/g,"")||" ").replace(/&lt;/g,"<").replace(/&gt;/g,">"),b.appendChild(le.createTextNode(a)),m?y.dx=3:y.x=r,!m){if(s){if(!Ce&&e.renderer.forExport&&g(b,{display:"block"}),p=re.getComputedStyle&&i(re.getComputedStyle(t,null).getPropertyValue("line-height")),!p||isNaN(p)){var w;(w=u)||(w=t.offsetHeight)||(f[s]=n.getBBox?n.getBBox().height:e.renderer.fontMetrics(n.style.fontSize).h,w=ce(f[s]-(f[s-1]||0))||18),p=w}d(b,"dy",p)}t=b}if(d(b,y),n.appendChild(b),m++,c)for(var a=a.replace(/([^\^])-/g,"$1- ").split(" "),_=[];a.length||_.length;)delete e.bBox,w=e.getBBox().width,y=w>c,y&&1!==a.length?(b.removeChild(b.firstChild),_.unshift(a.pop())):(a=_,_=[],a.length&&(b=le.createElementNS(Me,"tspan"),d(b,{dy:u||16,x:r}),v&&d(b,"style",v),n.appendChild(b),w>c&&(c=w))),a.length&&b.appendChild(le.createTextNode(a.join(" ").replace(/- /g,"-")))}})})},button:function(i,n,a,s,o,l,r){var h,c,d,u,p,g=this.label(i,n,a),f=0,i={x1:0,y1:0,x2:0,y2:1},o=tt(t("stroke-width",1,"stroke","#999","fill",t("linearGradient",i,"stops",[[0,"#FFF"],[1,"#DDD"]]),"r",3,"padding",3,"style",t("color","black")),o);return d=o.style,delete o.style,l=tt(o,t("stroke","#68A","fill",t("linearGradient",i,"stops",[[0,"#FFF"],[1,"#ACF"]])),l),u=l.style,delete l.style,r=tt(o,t("stroke","#68A","fill",t("linearGradient",i,"stops",[[0,"#9BD"],[1,"#CDF"]])),r),p=r.style,delete r.style,it(g.element,"mouseenter",function(){g.attr(l).css(u)}),it(g.element,"mouseleave",function(){h=[o,l,r][f],c=[d,u,p][f],g.attr(h).css(c)}),g.setState=function(e){(f=e)?2===e&&g.attr(r).css(p):g.attr(o).css(d)},g.on("click",function(){s.call(g)}).attr(o).css(e({cursor:"default"},d))},crispLine:function(e,t){return e[1]===e[4]&&(e[1]=e[4]=ce(e[1])-t%2/2),e[2]===e[5]&&(e[2]=e[5]=ce(e[2])+t%2/2),e},path:function(t){var i={fill:Fe};return s(t)?i.d=t:a(t)&&e(i,t),this.createElement("path").attr(i)},circle:function(e,t,i){return e=a(e)?e:{x:e,y:t,r:i},this.createElement("circle").attr(e)},arc:function(e,t,i,n,s,o){return a(e)&&(t=e.y,i=e.r,n=e.innerR,s=e.start,o=e.end,e=e.x),this.symbol("arc",e||0,t||0,i||0,i||0,{innerR:n||0,start:s||0,end:o||0})},rect:function(e,t,i,n,s,o){return s=a(e)?e.r:s,s=this.createElement("rect").attr({rx:s,ry:s,fill:Fe}),s.attr(a(e)?e:s.crisp(o,e,t,pe(i,0),pe(n,0)))},setSize:function(e,t,i){var n=this.alignedObjects,a=n.length;for(this.width=e,this.height=t,this.boxWrapper[p(i,!0)?"animate":"attr"]({width:e,height:t});a--;)n[a].align()},g:function(e){var t=this.createElement("g");return c(e)?t.attr({"class":"highcharts-"+e}):t},image:function(t,i,n,a,s){var o={preserveAspectRatio:Fe};return arguments.length>1&&e(o,{x:i,y:n,width:a,height:s}),o=this.createElement("image").attr(o),o.element.setAttributeNS?o.element.setAttributeNS("http://www.w3.org/1999/xlink","href",t):o.element.setAttribute("hc-svg-href",t),o},symbol:function(t,i,n,a,s,o){var l,r,h,c=this.symbols[t],c=c&&c(ce(i),ce(n),a,s,o),d=/^url\((.*?)\)$/;return c?(l=this.path(c),e(l,{symbolName:t,x:i,y:n,width:a,height:s}),o&&e(l,o)):d.test(t)&&(h=function(e,t){e.attr({width:t[0],height:t[1]}),e.alignByTranslate||e.translate(-ce(t[0]/2),-ce(t[1]/2))},r=t.match(d)[1],t=Ee[r],l=this.image(r).attr({x:i,y:n}),t?h(l,t):(l.attr({width:0,height:0}),f("img",{onload:function(){h(l,Ee[r]=[this.width,this.height])},src:r}))),l},symbols:{circle:function(e,t,i,n){var a=.166*i;return["M",e+i/2,t,"C",e+i+a,t,e+i+a,t+n,e+i/2,t+n,"C",e-a,t+n,e-a,t,e+i/2,t,"Z"]},square:function(e,t,i,n){return["M",e,t,"L",e+i,t,e+i,t+n,e,t+n,"Z"]},triangle:function(e,t,i,n){return["M",e+i/2,t,"L",e+i,t+n,e,t+n,"Z"]},"triangle-down":function(e,t,i,n){return["M",e,t,"L",e+i,t,e+i/2,t+n,"Z"]},diamond:function(e,t,i,n){return["M",e+i/2,t,"L",e+i,t+n/2,e+i/2,t+n,e,t+n/2,"Z"]},arc:function(e,t,i,n,a){var s=a.start,i=a.r||i||n,o=a.end-1e-6,n=a.innerR,l=a.open,r=me(s),h=ve(s),c=me(o),o=ve(o),a=a.end-s<ye?0:1;return["M",e+i*r,t+i*h,"A",i,i,0,a,1,e+i*c,t+i*o,l?"M":"L",e+n*c,t+n*o,"A",n,n,0,a,0,e+n*r,t+n*h,l?"":"Z"]}},clipRect:function(e,t,i,n){var a="highcharts-"+Pe++,s=this.createElement("clipPath").attr({id:a}).add(this.defs),e=this.rect(e,t,i,n,0).add(s);return e.id=a,e.clipPath=s,e},color:function(t,i,n){var a,o,l=this,r=/^rgba/;if(t&&t.linearGradient?o="linearGradient":t&&t.radialGradient&&(o="radialGradient"),o){var h,u,p,n=t[o],g=l.gradients,i=i.radialReference;return n.id&&g[n.id]||(s(n)&&(t[o]=n={x1:n[0],y1:n[1],x2:n[2],y2:n[3],gradientUnits:"userSpaceOnUse"}),"radialGradient"===o&&i&&!c(n.gradientUnits)&&e(n,{cx:i[0]-i[2]/2+n.cx*i[2],cy:i[1]-i[2]/2+n.cy*i[2],r:n.r*i[2],gradientUnits:"userSpaceOnUse"}),n.id="highcharts-"+Pe++,g[n.id]=h=l.createElement(o).attr(n).add(l.defs),h.stops=[],Ke(t.stops,function(e){r.test(e[1])?(a=ht(e[1]),u=a.get("rgb"),p=a.get("a")):(u=e[1],p=1),e=l.createElement("stop").attr({offset:e[0],"stop-color":u,"stop-opacity":p}).add(h),h.stops.push(e)})),"url("+l.url+"#"+n.id+")"}return r.test(t)?(a=ht(t),d(i,n+"-opacity",a.get("a")),a.get("rgb")):(i.removeAttribute(n+"-opacity"),t)},text:function(e,t,i,n){var a=z.chart.style,s=Ae||!Ce&&this.forExport;return n&&!this.forExport?this.html(e,t,i):(t=ce(p(t,0)),i=ce(p(i,0)),e=this.createElement("text").attr({x:t,y:i,text:e}).css({fontFamily:a.fontFamily,fontSize:a.fontSize}),s&&e.css({position:"absolute"}),e.x=t,e.y=i,e)},html:function(t,i,n){var a=z.chart.style,s=this.createElement("span"),o=s.attrSetters,l=s.element,r=s.renderer;return o.text=function(e){return e!==l.innerHTML&&delete this.bBox,l.innerHTML=e,!1},o.x=o.y=o.align=function(e,t){return"align"===t&&(t="textAlign"),s[t]=e,s.htmlUpdateTransform(),!1},s.attr({text:t,x:ce(i),y:ce(n)}).css({position:"absolute",whiteSpace:"nowrap",fontFamily:a.fontFamily,fontSize:a.fontSize}),s.css=s.htmlCss,r.isSVG&&(s.add=function(t){var i,n=r.box.parentNode,a=[];if(t){if(i=t.div,!i){for(;t;)a.push(t),t=t.parentGroup;Ke(a.reverse(),function(t){var a;i=t.div=t.div||f(Le,{className:d(t.element,"class")},{position:"absolute",left:(t.translateX||0)+"px",top:(t.translateY||0)+"px"},i||n),a=i.style,e(t.attrSetters,{translateX:function(e){a.left=e+"px"},translateY:function(e){a.top=e+"px"},visibility:function(e,t){a[t]=e}})})}}else i=n;return i.appendChild(l),s.added=!0,s.alignOnAdd&&s.htmlUpdateTransform(),s}),s},fontMetrics:function(e){var e=i(e||11),e=24>e?e+4:ce(1.2*e),t=ce(.8*e);return{h:e,b:t}},label:function(t,i,n,a,s,o,l,r,h){function d(){var e,t=x.styles,t=t&&t.textAlign,i=S*(1-k);e=r?0:w,!c(m)||"center"!==t&&"right"!==t||(i+={center:.5,right:1}[t]*(m-f.width)),(i!==T.x||e!==T.y)&&T.attr({x:i,y:e}),T.x=i,T.y=e}function u(e,t){g?g.attr(e,t):C[e]=t}function p(){T.add(x),x.attr({text:t,x:i,y:n}),c(s)&&x.attr({anchorX:s,anchorY:o})}var g,f,m,v,y,b,w,_=this,x=_.g(h),T=_.text("",0,0,l).attr({zIndex:1}),k=0,S=3,M=0,C={},l=x.attrSetters;it(x,"add",p),l.width=function(e){return m=e,!1},l.height=function(e){return v=e,!1},l.padding=function(e){return c(e)&&e!==S&&(S=e,d()),!1},l.align=function(e){return k={left:0,center:.5,right:1}[e],!1},l.text=function(e,t){T.attr(t,e);var i;return i=T.element.style,f=(void 0===m||void 0===v||x.styles.textAlign)&&T.getBBox(),x.width=(m||f.width||0)+2*S,x.height=(v||f.height||0)+2*S,w=S+_.fontMetrics(i&&i.fontSize).b,g||(i=r?-w:0,x.box=g=a?_.symbol(a,-k*S,i,x.width,x.height):_.rect(-k*S,i,x.width,x.height,0,C["stroke-width"]),g.add(x)),g.attr(tt({width:x.width,height:x.height},C)),C=null,d(),!1},l["stroke-width"]=function(e,t){return M=e%2/2,u(t,e),!1},l.stroke=l.fill=l.r=function(e,t){return u(t,e),!1},l.anchorX=function(e,t){return s=e,u(t,e+M-y),!1},l.anchorY=function(e,t){return o=e,u(t,e-b),!1},l.x=function(e){return x.x=e,e-=k*((m||f.width)+S),y=ce(e),x.attr("translateX",y),!1},l.y=function(e){return b=x.y=ce(e),x.attr("translateY",e),!1};var D=x.css;return e(x,{css:function(e){if(e){var t={},e=tt({},e);Ke("fontSize,fontWeight,fontFamily,color,lineHeight,width".split(","),function(i){e[i]!==R&&(t[i]=e[i],delete e[i])}),T.css(t)}return D.call(x,e)},getBBox:function(){return g.getBBox()},shadow:function(e){return g.shadow(e),x},destroy:function(){nt(x,"add",p),nt(x.element,"mouseenter"),nt(x.element,"mouseleave"),T&&(T=T.destroy()),g&&(g=g.destroy()),P.prototype.destroy.call(x)}})}},j=ct;var dt;if(!Ce&&!Ae){dt={init:function(e,t){var i=["<",t,' filled="f" stroked="f"'],n=["position: ","absolute",";"];("shape"===t||t===Le)&&n.push("left:0;top:0;width:1px;height:1px;"),Te&&n.push("visibility: ",t===Le?"hidden":"visible"),i.push(' style="',n.join(""),'"/>'),t&&(i=t===Le||"span"===t||"img"===t?i.join(""):e.prepVML(i),this.element=f(i)),this.renderer=e,this.attrSetters={}},add:function(e){var t=this.renderer,i=this.element,n=t.box,n=e?e.element||e:n;return e&&e.inverted&&t.invertChild(i,n),n.appendChild(i),this.added=!0,this.alignOnAdd&&!this.deferUpdateTransform&&this.updateTransform(),at(this,"add"),this},updateTransform:P.prototype.htmlUpdateTransform,attr:function(e,t){var i,a,s,l,r,h=this.element||{},u=h.style,p=h.nodeName,g=this.renderer,m=this.symbolName,v=this.shadows,y=this.attrSetters,b=this;if(n(e)&&c(t)&&(i=e,e={},e[i]=t),n(e))i=e,b="strokeWidth"===i||"stroke-width"===i?this.strokeweight:this[i];else for(i in e)if(a=e[i],r=!1,s=y[i]&&y[i].call(this,a,i),s!==!1&&null!==a){if(s!==R&&(a=s),m&&/^(x|y|r|start|end|width|height|innerR|anchorX|anchorY)/.test(i))l||(this.symbolAttr(e),l=!0),r=!0;else if("d"===i){for(a=a||[],this.d=a.join(" "),s=a.length,r=[];s--;)r[s]=o(a[s])?ce(10*a[s])-5:"Z"===a[s]?"x":a[s];if(a=r.join(" ")||"x",h.path=a,v)for(s=v.length;s--;)v[s].path=v[s].cutOff?this.cutOffPath(a,v[s].cutOff):a;r=!0}else if("visibility"===i){if(v)for(s=v.length;s--;)v[s].style[i]=a;"DIV"===p&&(a="hidden"===a?"-999em":0,i="top"),u[i]=a,r=!0}else"zIndex"===i?(a&&(u[i]=a),r=!0):"width"===i||"height"===i?(a=pe(0,a),this[i]=a,this.updateClipping?(this[i]=a,this.updateClipping()):u[i]=a,r=!0):"x"===i||"y"===i?(this[i]=a,u[{x:"left",y:"top"}[i]]=a):"class"===i?h.className=a:"stroke"===i?(a=g.color(a,h,i),i="strokecolor"):"stroke-width"===i||"strokeWidth"===i?(h.stroked=a?!0:!1,i="strokeweight",this[i]=a,o(a)&&(a+="px")):"dashstyle"===i?((h.getElementsByTagName("stroke")[0]||f(g.prepVML(["<stroke/>"]),null,null,h))[i]=a||"solid",this.dashstyle=a,r=!0):"fill"===i?"SPAN"===p?u.color=a:(h.filled=a!==Fe?!0:!1,a=g.color(a,h,i,this),i="fillcolor"):"shape"===p&&"rotation"===i?(this[i]=a,h.style.left=-ce(ve(a*be)+1)+"px",h.style.top=ce(me(a*be))+"px"):"translateX"===i||"translateY"===i||"rotation"===i?(this[i]=a,this.updateTransform(),r=!0):"text"===i&&(this.bBox=null,h.innerHTML=a,r=!0);r||(Te?h[i]=a:d(h,i,a))}return b},clip:function(e){var t,i=this,n=i.element,a=n.parentNode;return e?(t=e.members,t.push(i),i.destroyClip=function(){h(t,i)},a&&"highcharts-tracker"===a.className&&!Te&&g(n,{visibility:"hidden"}),e=e.getCSS(i)):(i.destroyClip&&i.destroyClip(),e={clip:Te?"inherit":"rect(auto)"}),i.css(e)},css:P.prototype.htmlCss,safeRemoveChild:function(e){e.parentNode&&C(e)},destroy:function(){return this.destroyClip&&this.destroyClip(),P.prototype.destroy.apply(this)},empty:function(){for(var e,t=this.element.childNodes,i=t.length;i--;)e=t[i],e.parentNode.removeChild(e)},on:function(e,t){return this.element["on"+e]=function(){var e=re.event;e.target=e.srcElement,t(e)},this},cutOffPath:function(e,t){var n,e=e.split(/[ ,]/);return n=e.length,(9===n||11===n)&&(e[n-4]=e[n-2]=i(e[n-2])-10*t),e.join(" ")},shadow:function(e,t,n){var a,s,o,l,r,h,c,d=[],u=this.element,g=this.renderer,m=u.style,v=u.path;if(v&&"string"!=typeof v.value&&(v="x"),r=v,e){for(h=p(e.width,3),c=(e.opacity||.15)/h,a=1;3>=a;a++)l=2*h+1-2*a,n&&(r=this.cutOffPath(v.value,l+.5)),o=['<shape isShadow="true" strokeweight="',l,'" filled="false" path="',r,'" coordsize="10 10" style="',u.style.cssText,'" />'],s=f(g.prepVML(o),null,{left:i(m.left)+p(e.offsetX,1),top:i(m.top)+p(e.offsetY,1)}),n&&(s.cutOff=l+1),o=['<stroke color="',e.color||"black",'" opacity="',c*a,'"/>'],f(g.prepVML(o),null,null,s),t?t.element.appendChild(s):u.parentNode.insertBefore(s,u),d.push(s);this.shadows=d}return this}},dt=m(P,dt);var ut={Element:dt,isIE8:we.indexOf("MSIE 8.0")>-1,init:function(e,t,i){var n,a;this.alignedObjects=[],n=this.createElement(Le),a=n.element,a.style.position="relative",e.appendChild(n.element),this.box=a,this.boxWrapper=n,this.setSize(t,i,!1),le.namespaces.hcv||(le.namespaces.add("hcv","urn:schemas-microsoft-com:vml"),le.createStyleSheet().cssText="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } ")},isHidden:function(){return!this.box.offsetWidth},clipRect:function(t,i,n,s){var o=this.createElement(),l=a(t);return e(o,{members:[],left:l?t.x:t,top:l?t.y:i,width:l?t.width:n,height:l?t.height:s,getCSS:function(t){var i=t.inverted,n=this.top,a=this.left,s=a+this.width,o=n+this.height,n={clip:"rect("+ce(i?a:n)+"px,"+ce(i?o:s)+"px,"+ce(i?s:o)+"px,"+ce(i?n:a)+"px)"};return!i&&Te&&"IMG"!==t.element.nodeName&&e(n,{width:s+"px",height:o+"px"}),n},updateClipping:function(){Ke(o.members,function(e){e.css(o.getCSS(e))})}})},color:function(e,t,i,n){var a,s,o,l=this,r=/^rgba/,h=Fe;if(e&&e.linearGradient?o="gradient":e&&e.radialGradient&&(o="pattern"),o){var c,d,u,p,g,m,v,y,b=e.linearGradient||e.radialGradient,w="",e=e.stops,_=[],x=function(){s=['<fill colors="'+_.join(",")+'" opacity="',g,'" o:opacity2="',p,'" type="',o,'" ',w,'focus="100%" method="any" />'],f(l.prepVML(s),null,null,t)};if(u=e[0],y=e[e.length-1],u[0]>0&&e.unshift([0,u[1]]),y[0]<1&&e.push([1,y[1]]),Ke(e,function(e,t){r.test(e[1])?(a=ht(e[1]),c=a.get("rgb"),d=a.get("a")):(c=e[1],d=1),_.push(100*e[0]+"% "+c),t?(g=d,m=c):(p=d,v=c)}),"fill"===i)if("gradient"===o)i=b.x1||b[0]||0,e=b.y1||b[1]||0,u=b.x2||b[2]||0,b=b.y2||b[3]||0,w='angle="'+(90-180*he.atan((b-e)/(u-i))/ye)+'"',x();else{var T,h=b.r,k=2*h,S=2*h,M=b.cx,C=b.cy,D=t.radialReference,h=function(){D&&(T=n.getBBox(),M+=(D[0]-T.x)/T.width-.5,C+=(D[1]-T.y)/T.height-.5,k*=D[2]/T.width,S*=D[2]/T.height),w='src="'+z.global.VMLRadialGradientURL+'" size="'+k+","+S+'" origin="0.5,0.5" position="'+M+","+C+'" color2="'+v+'" ',x()};n.added?h():it(n,"add",h),h=m}else h=c}else r.test(e)&&"IMG"!==t.tagName?(a=ht(e),s=["<",i,' opacity="',a.get("a"),'"/>'],f(this.prepVML(s),null,null,t),h=a.get("rgb")):(h=t.getElementsByTagName(i),h.length&&(h[0].opacity=1),h=e);return h},prepVML:function(e){var t=this.isIE8,e=e.join("");return t?(e=e.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),e=-1===e.indexOf('style="')?e.replace("/>",' style="display:inline-block;behavior:url(#default#VML);" />'):e.replace('style="','style="display:inline-block;behavior:url(#default#VML);')):e=e.replace("<","<hcv:"),e},text:ct.prototype.html,path:function(t){var i={coordsize:"10 10"};return s(t)?i.d=t:a(t)&&e(i,t),this.createElement("shape").attr(i)},circle:function(e,t,i){return this.symbol("circle").attr({x:e-i,y:t-i,width:2*i,height:2*i})},g:function(e){var t;return e&&(t={className:"highcharts-"+e,"class":"highcharts-"+e}),this.createElement(Le).attr(t)},image:function(e,t,i,n,a){var s=this.createElement("img").attr({src:e});return arguments.length>1&&s.attr({x:t,y:i,width:n,height:a}),s},rect:function(e,t,i,n,s,o){a(e)&&(t=e.y,i=e.width,n=e.height,o=e.strokeWidth,e=e.x);var l=this.symbol("rect");return l.r=s,l.attr(l.crisp(o,e,t,pe(i,0),pe(n,0)))},invertChild:function(e,t){var n=t.style;g(e,{flip:"x",left:i(n.width)-1,top:i(n.height)-1,rotation:-90})},symbols:{arc:function(e,t,i,n,a){var s=a.start,o=a.end,l=a.r||i||n,i=me(s),n=ve(s),r=me(o),h=ve(o),c=a.innerR,d=.08/l,u=c&&.1/c||0;return o-s===0?["x"]:(d>2*ye-o+s?r=-d:u>o-s&&(r=me(s+u)),s=["wa",e-l,t-l,e+l,t+l,e+l*i,t+l*n,e+l*r,t+l*h],a.open&&!c&&s.push("e","M",e,t),s.push("at",e-c,t-c,e+c,t+c,e+c*r,t+c*h,e+c*i,t+c*n,"x","e"),s)},circle:function(e,t,i,n){return["wa",e,t,e+i,t+n,e+i,t+n/2,e+i,t+n/2,"e"]},rect:function(e,t,i,n,a){var s,o=e+i,l=t+n;return c(a)&&a.r?(s=ge(a.r,i,n),o=["M",e+s,t,"L",o-s,t,"wa",o-2*s,t,o,t+2*s,o-s,t,o,t+s,"L",o,l-s,"wa",o-2*s,l-2*s,o,l,o,l-s,o-s,l,"L",e+s,l,"wa",e,l-2*s,e+2*s,l,e+s,l,e,l-s,"L",e,t+s,"wa",e,t,e+2*s,t+2*s,e,t+s,e+s,t,"x","e"]):o=ct.prototype.symbols.square.apply(0,arguments),o}}};dt=function(){this.init.apply(this,arguments)},dt.prototype=tt(ct.prototype,ut),j=dt}var pt,gt;Ae&&(pt=function(){Me="http://www.w3.org/1999/xhtml"},pt.prototype.symbols={},gt=function(){function e(){var e,i=t.length;for(e=0;i>e;e++)t[e]();t=[]}var t=[];return{push:function(i,n){0===t.length&&Xe(n,e),t.push(i)}}}()),j=dt||pt||ct,I.prototype={addLabel:function(){var t,i=this.axis,n=i.options,a=i.chart,s=i.horiz,l=i.categories,h=this.pos,d=n.labels,u=i.tickPositions,s=l&&s&&l.length&&!d.step&&!d.staggerLines&&!d.rotation&&a.plotWidth/u.length||!s&&a.plotWidth/2,p=h===u[0],g=h===u[u.length-1],f=l&&c(l[h])?l[h]:h,l=this.label,u=u.info;i.isDatetimeAxis&&u&&(t=n.dateTimeLabelFormats[u.higherRanks[h]||u.unitName]),this.isFirst=p,this.isLast=g,n=i.labelFormatter.call({axis:i,chart:a,isFirst:p,isLast:g,dateTimeLabelFormat:t,value:i.isLog?A(r(f)):f}),h=s&&{width:pe(1,ce(s-2*(d.padding||10)))+"px"},h=e(h,d.style),c(l)?l&&l.attr({text:n}).css(h):(s={align:d.align},o(d.rotation)&&(s.rotation=d.rotation),this.label=c(n)&&d.enabled?a.renderer.text(n,0,0,d.useHTML).attr(s).css(h).add(i.labelGroup):null)},getLabelSize:function(){var e=this.label,t=this.axis;return e?(this.labelBBox=e.getBBox())[t.horiz?"height":"width"]:0},getLabelSides:function(){var e=this.axis.options.labels,t=this.labelBBox.width,e=t*{left:0,center:.5,right:1}[e.align]-e.x;return[-e,t-e]},handleOverflow:function(e,t){var i=!0,n=this.axis,a=n.chart,s=this.isFirst,o=this.isLast,l=t.x,r=n.reversed,h=n.tickPositions;if(s||o){var c=this.getLabelSides(),d=c[0],c=c[1],a=a.plotLeft,u=a+n.len,h=(n=n.ticks[h[e+(s?1:-1)]])&&n.label.xy&&n.label.xy.x+n.getLabelSides()[s?0:1];s&&!r||o&&r?a>l+d&&(l=a-d,n&&l+c>h&&(i=!1)):l+c>u&&(l=u-c,n&&h>l+d&&(i=!1)),t.x=l}return i},getPosition:function(e,t,i,n){var a=this.axis,s=a.chart,o=n&&s.oldChartHeight||s.chartHeight;return{x:e?a.translate(t+i,null,null,n)+a.transB:a.left+a.offset+(a.opposite?(n&&s.oldChartWidth||s.chartWidth)-a.right-a.left:0),y:e?o-a.bottom+a.offset-(a.opposite?a.height:0):o-a.translate(t+i,null,null,n)-a.transB}},getLabelPosition:function(e,t,n,a,s,o,l,r){var h=this.axis,d=h.transA,u=h.reversed,h=h.staggerLines,e=e+s.x-(o&&a?o*d*(u?-1:1):0),t=t+s.y-(o&&!a?o*d*(u?1:-1):0);return c(s.y)||(t+=.9*i(n.styles.lineHeight)-n.getBBox().height/2),h&&(t+=l/(r||1)%h*16),{x:e,y:t}},getMarkPath:function(e,t,i,n,a,s){return s.crispLine(["M",e,t,"L",e+(a?0:-i),t+(a?i:0)],n)},render:function(e,t){var i=this.axis,n=i.options,a=i.chart.renderer,s=i.horiz,o=this.type,l=this.label,r=this.pos,h=n.labels,c=this.gridLine,d=o?o+"Grid":"grid",u=o?o+"Tick":"tick",g=n[d+"LineWidth"],f=n[d+"LineColor"],m=n[d+"LineDashStyle"],v=n[u+"Length"],d=n[u+"Width"]||0,y=n[u+"Color"],b=n[u+"Position"],u=this.mark,w=h.step,_=!0,x=i.tickmarkOffset,T=this.getPosition(s,r,x,t),k=T.x,T=T.y,S=i.staggerLines;g&&(r=i.getPlotLinePath(r+x,g,t),c===R&&(c={stroke:f,"stroke-width":g},m&&(c.dashstyle=m),o||(c.zIndex=1),this.gridLine=c=g?a.path(r).attr(c).add(i.gridGroup):null),!t&&c&&r&&c[this.isNew?"attr":"animate"]({d:r})),d&&v&&("inside"===b&&(v=-v),i.opposite&&(v=-v),o=this.getMarkPath(k,T,v,d,s,a),u?u.animate({
d:o}):this.mark=a.path(o).attr({stroke:y,"stroke-width":d}).add(i.axisGroup)),l&&!isNaN(k)&&(l.xy=T=this.getLabelPosition(k,T,l,s,h,x,e,w),this.isFirst&&!p(n.showFirstLabel,1)||this.isLast&&!p(n.showLastLabel,1)?_=!1:!S&&s&&"justify"===h.overflow&&!this.handleOverflow(e,T)&&(_=!1),w&&e%w&&(_=!1),_?(l[this.isNew?"attr":"animate"](T),l.show(),this.isNew=!1):l.hide())},destroy:function(){M(this,this.axis)}},L.prototype={render:function(){var e,t=this,i=t.axis,n=i.horiz,a=(i.pointRange||0)/2,s=t.options,o=s.label,r=t.label,h=s.width,d=s.to,u=s.from,g=c(u)&&c(d),f=s.value,m=s.dashStyle,v=t.svgElem,y=[],b=s.color,w=s.zIndex,_=s.events,x=i.chart.renderer;if(i.isLog&&(u=l(u),d=l(d),f=l(f)),h)y=i.getPlotLinePath(f,h),a={stroke:b,"stroke-width":h},m&&(a.dashstyle=m);else{if(!g)return;u=pe(u,i.min-a),d=ge(d,i.max+a),y=i.getPlotBandPath(u,d,s),a={fill:b},s.borderWidth&&(a.stroke=s.borderColor,a["stroke-width"]=s.borderWidth)}if(c(w)&&(a.zIndex=w),v)y?v.animate({d:y},null,v.onGetPath):(v.hide(),v.onGetPath=function(){v.show()});else if(y&&y.length&&(t.svgElem=v=x.path(y).attr(a).add(),_))for(e in s=function(e){v.on(e,function(i){_[e].apply(t,[i])})},_)s(e);return o&&c(o.text)&&y&&y.length&&i.width>0&&i.height>0?(o=tt({align:n&&g&&"center",x:n?!g&&4:10,verticalAlign:!n&&g&&"middle",y:n?g?16:10:g?6:-4,rotation:n&&!g&&90},o),r||(t.label=r=x.text(o.text,0,0).attr({align:o.textAlign||o.align,rotation:o.rotation,zIndex:w}).css(o.style).add()),i=[y[1],y[4],p(y[6],y[1])],y=[y[2],y[5],p(y[7],y[2])],n=k(i),g=k(y),r.align(o,!1,{x:n,y:g,width:S(i)-n,height:S(y)-g}),r.show()):r&&r.hide(),t},destroy:function(){h(this.axis.plotLinesAndBands,this),M(this,this.axis)}},F.prototype={destroy:function(){M(this,this.axis)},setTotal:function(e){this.cum=this.total=e},render:function(e){var t=this.options.formatter.call(this);this.label?this.label.attr({text:t,visibility:"hidden"}):this.label=this.axis.chart.renderer.text(t,0,0).css(this.options.style).attr({align:this.textAlign,rotation:this.options.rotation,visibility:"hidden"}).add(e)},setOffset:function(e,t){var i=this.axis,n=i.chart,a=n.inverted,s=this.isNegative,o=i.translate(this.percent?100:this.total,0,0,0,1),i=i.translate(0),i=fe(o-i),l=n.xAxis[0].translate(this.x)+e,r=n.plotHeight,s={x:a?s?o:o-i:l,y:a?r-l-t:s?r-o-i:r-o,width:a?i:t,height:a?t:i};(a=this.label)&&(a.align(this.alignOptions,null,s),s=a.alignAttr,a.attr({visibility:this.options.crop===!1||n.isInsidePlot(s.x,s.y)?Ce?"inherit":"visible":"hidden"}))}},O.prototype={defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,gridLineColor:"#C0C0C0",labels:qe,lineColor:"#C0D0E0",lineWidth:1,minPadding:.01,maxPadding:.01,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:!1,tickColor:"#C0D0E0",tickLength:5,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",tickWidth:1,title:{align:"middle",style:{color:"#6D869F",fontWeight:"bold"}},type:"linear"},defaultYAxisOptions:{endOnTick:!0,gridLineWidth:1,tickPixelInterval:72,showLastLabel:!0,labels:{align:"right",x:-8,y:3},lineWidth:0,maxPadding:.05,minPadding:.05,startOnTick:!0,tickWidth:0,title:{rotation:270,text:"Y-values"},stackLabels:{enabled:!1,formatter:function(){return this.total},style:qe.style}},defaultLeftAxisOptions:{labels:{align:"right",x:-8,y:null},title:{rotation:270}},defaultRightAxisOptions:{labels:{align:"left",x:8,y:null},title:{rotation:90}},defaultBottomAxisOptions:{labels:{align:"center",x:0,y:14},title:{rotation:0}},defaultTopAxisOptions:{labels:{align:"center",x:0,y:-5},title:{rotation:0}},init:function(e,t){var i=t.isX;this.horiz=e.inverted?!i:i,this.xOrY=(this.isXAxis=i)?"x":"y",this.opposite=t.opposite,this.side=this.horiz?this.opposite?0:2:this.opposite?1:3,this.setOptions(t);var n=this.options,a=n.type,s="datetime"===a;this.labelFormatter=n.labels.formatter||this.defaultLabelFormatter,this.staggerLines=this.horiz&&n.labels.staggerLines,this.userOptions=t,this.minPixelPadding=0,this.chart=e,this.reversed=n.reversed,this.categories=n.categories,this.isLog="logarithmic"===a,this.isLinked=c(n.linkedTo),this.isDatetimeAxis=s,this.tickmarkOffset=n.categories&&"between"===n.tickmarkPlacement?.5:0,this.ticks={},this.minorTicks={},this.plotLinesAndBands=[],this.alternateBands={},this.len=0,this.minRange=this.userMinRange=n.minRange||n.maxZoom,this.range=n.range,this.offset=n.offset||0,this.stacks={},this.min=this.max=null;var o,n=this.options.events;e.axes.push(this),e[i?"xAxis":"yAxis"].push(this),this.series=[],e.inverted&&i&&this.reversed===R&&(this.reversed=!0),this.removePlotLine=this.removePlotBand=this.removePlotBandOrLine,this.addPlotLine=this.addPlotBand=this.addPlotBandOrLine;for(o in n)it(this,o,n[o]);this.isLog&&(this.val2lin=l,this.lin2val=r)},setOptions:function(e){this.options=tt(this.defaultOptions,this.isXAxis?{}:this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],tt(z[this.isXAxis?"xAxis":"yAxis"],e))},defaultLabelFormatter:function(){var e,t=this.axis,i=this.value,n=this.dateTimeLabelFormat,a=z.lang.numericSymbols,s=a&&a.length,o=t.isLog?i:t.tickInterval;if(t.categories)e=i;else if(n)e=$(n,i);else if(s&&o>=1e3)for(;s--&&e===R;)t=Math.pow(1e3,s+1),o>=t&&null!==a[s]&&(e=v(i/t,-1)+a[s]);return e===R&&(e=i>=1e3?v(i,0):v(i,-1)),e},getSeriesExtremes:function(){var e,t=this,i=t.chart,n=t.stacks,a=[],s=[];t.hasVisibleSeries=!1,t.dataMin=t.dataMax=null,Ke(t.series,function(o){if(o.visible||!i.options.chart.ignoreHiddenSeries){var l,r,h,d,u,g,f,m,v,y,b=o.options,w=b.threshold,_=[],x=0;if(t.hasVisibleSeries=!0,t.isLog&&0>=w&&(w=b.threshold=null),t.isXAxis)b=o.xData,b.length&&(t.dataMin=ge(p(t.dataMin,b[0]),k(b)),t.dataMax=pe(p(t.dataMax,b[0]),S(b)));else{var T,M,C,D=o.cropped,G=o.xAxis.getExtremes(),E=!!o.modifyValue;for(l=b.stacking,t.usePercentage="percent"===l,l&&(u=b.stack,d=o.type+p(u,""),g="-"+d,o.stackKey=d,r=a[d]||[],a[d]=r,h=s[g]||[],s[g]=h),t.usePercentage&&(t.dataMin=0,t.dataMax=99),b=o.processedXData,f=o.processedYData,y=f.length,e=0;y>e;e++)if(m=b[e],v=f[e],l&&(M=(T=w>v)?h:r,C=T?g:d,v=M[m]=c(M[m])?A(M[m]+v):v,n[C]||(n[C]={}),n[C][m]||(n[C][m]=new F(t,t.options.stackLabels,T,m,u,l)),n[C][m].setTotal(v)),null!==v&&v!==R&&(E&&(v=o.modifyValue(v)),D||(b[e+1]||m)>=G.min&&(b[e-1]||m)<=G.max))if(m=v.length)for(;m--;)null!==v[m]&&(_[x++]=v[m]);else _[x++]=v;!t.usePercentage&&_.length&&(t.dataMin=ge(p(t.dataMin,_[0]),k(_)),t.dataMax=pe(p(t.dataMax,_[0]),S(_))),c(w)&&(t.dataMin>=w?(t.dataMin=w,t.ignoreMinPadding=!0):t.dataMax<w&&(t.dataMax=w,t.ignoreMaxPadding=!0))}}})},translate:function(e,t,i,n,a,s){var o=this.len,l=1,r=0,h=n?this.oldTransA:this.transA,n=n?this.oldMin:this.min,a=this.options.ordinal||this.isLog&&a;return h||(h=this.transA),i&&(l*=-1,r=o),this.reversed&&(l*=-1,r-=l*o),t?(this.reversed&&(e=o-e),e=e/h+n,a&&(e=this.lin2val(e))):(a&&(e=this.val2lin(e)),e=l*(e-n)*h+r+l*this.minPixelPadding+(s?h*this.pointRange/2:0)),e},getPlotLinePath:function(e,t,i){var n,a,s,o,l=this.chart,r=this.left,h=this.top,e=this.translate(e,null,null,i),c=i&&l.oldChartHeight||l.chartHeight,d=i&&l.oldChartWidth||l.chartWidth;return n=this.transB,i=a=ce(e+n),n=s=ce(c-e-n),isNaN(e)?o=!0:this.horiz?(n=h,s=c-this.bottom,(r>i||i>r+this.width)&&(o=!0)):(i=r,a=d-this.right,(h>n||n>h+this.height)&&(o=!0)),o?null:l.renderer.crispLine(["M",i,n,"L",a,s],t||0)},getPlotBandPath:function(e,t){var i=this.getPlotLinePath(t),n=this.getPlotLinePath(e);return n&&i?n.push(i[4],i[5],i[1],i[2]):n=null,n},getLinearTickPositions:function(e,t,i){for(var n,t=A(de(t/e)*e),i=A(ue(i/e)*e),a=[];i>=t&&(a.push(t),t=A(t+e),t!==n);)n=t;return a},getLogTickPositions:function(e,t,i,n){var a=this.options,s=this.len,o=[];if(n||(this._minorAutoInterval=null),e>=.5)e=ce(e),o=this.getLinearTickPositions(e,t,i);else if(e>=.08)for(var h,c,d,u,g,s=de(t),a=e>.3?[1,2,4]:e>.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9];i+1>s&&!g;s++)for(c=a.length,h=0;c>h&&!g;h++)d=l(r(s)*a[h]),d>t&&o.push(u),u>i&&(g=!0),u=d;else t=r(t),i=r(i),e=a[n?"minorTickInterval":"tickInterval"],e=p("auto"===e?null:e,this._minorAutoInterval,(i-t)*(a.tickPixelInterval/(n?5:1))/((n?s/this.tickPositions.length:s)||1)),e=b(e,null,he.pow(10,de(he.log(e)/he.LN10))),o=et(this.getLinearTickPositions(e,t,i),l),n||(this._minorAutoInterval=e/5);return n||(this.tickInterval=e),o},getMinorTickPositions:function(){var e,t,i=this.tickPositions,n=this.minorTickInterval,a=[];if(this.isLog)for(t=i.length,e=1;t>e;e++)a=a.concat(this.getLogTickPositions(n,i[e-1],i[e],!0));else for(i=this.min+(i[0]-this.min)%n;i<=this.max;i+=n)a.push(i);return a},adjustForMinRange:function(){var e,t,i,n,a,s,o=this.options,l=this.min,r=this.max,h=this.dataMax-this.dataMin>=this.minRange;if(this.isXAxis&&this.minRange===R&&!this.isLog&&(c(o.min)||c(o.max)?this.minRange=null:(Ke(this.series,function(e){for(a=e.xData,i=s=e.xIncrement?1:a.length-1;i>0;i--)n=a[i]-a[i-1],(t===R||t>n)&&(t=n)}),this.minRange=ge(5*t,this.dataMax-this.dataMin))),r-l<this.minRange){var d=this.minRange;e=(d-r+l)/2,e=[l-e,p(o.min,l-e)],h&&(e[2]=this.dataMin),l=S(e),r=[l+d,p(o.max,l+d)],h&&(r[2]=this.dataMax),r=k(r),d>r-l&&(e[0]=r-d,e[1]=p(o.min,r-d),l=S(e))}this.min=l,this.max=r},setAxisTranslation:function(){var e,t=this.max-this.min,i=0,n=0,a=0,s=this.linkedParent,o=this.transA;this.isXAxis&&(s?(n=s.minPointOffset,a=s.pointRangePadding):Ke(this.series,function(t){var s=t.pointRange,o=t.options.pointPlacement,l=t.closestPointRange;i=pe(i,s),n=pe(n,o?0:s/2),a=pe(a,"on"===o?0:s),!t.noSharedTooltip&&c(l)&&(e=c(e)?ge(e,l):l)}),this.minPointOffset=n,this.pointRangePadding=a,this.pointRange=i,this.closestPointRange=e),this.oldTransA=o,this.translationSlope=this.transA=o=this.len/(t+a||1),this.transB=this.horiz?this.left:this.bottom,this.minPixelPadding=o*n},setTickPositions:function(e){var t=this,i=t.chart,n=t.options,a=t.isLog,s=t.isDatetimeAxis,o=t.isXAxis,r=t.isLinked,h=t.options.tickPositioner,d=n.maxPadding,u=n.minPadding,g=n.tickInterval,f=n.minTickInterval,m=n.tickPixelInterval,v=t.categories;r?(t.linkedParent=i[o?"xAxis":"yAxis"][n.linkedTo],i=t.linkedParent.getExtremes(),t.min=p(i.min,i.dataMin),t.max=p(i.max,i.dataMax),n.type!==t.linkedParent.options.type&&D(11,1)):(t.min=p(t.userMin,n.min,t.dataMin),t.max=p(t.userMax,n.max,t.dataMax)),a&&(!e&&ge(t.min,p(t.dataMin,t.min))<=0&&D(10,1),t.min=A(l(t.min)),t.max=A(l(t.max))),t.range&&(t.userMin=t.min=pe(t.min,t.max-t.range),t.userMax=t.max,e)&&(t.range=null),t.adjustForMinRange(),v||t.usePercentage||r||!c(t.min)||!c(t.max)||(i=t.max-t.min||1,c(n.min)||c(t.userMin)||!u||!(t.dataMin<0)&&t.ignoreMinPadding||(t.min-=i*u),c(n.max)||c(t.userMax)||!d||!(t.dataMax>0)&&t.ignoreMaxPadding||(t.max+=i*d)),t.tickInterval=t.min===t.max||void 0===t.min||void 0===t.max?1:r&&!g&&m===t.linkedParent.options.tickPixelInterval?t.linkedParent.tickInterval:p(g,v?1:(t.max-t.min)*m/(t.len||1)),o&&!e&&Ke(t.series,function(e){e.processData(t.min!==t.oldMin||t.max!==t.oldMax)}),t.setAxisTranslation(e),t.beforeSetTickPositions&&t.beforeSetTickPositions(),t.postProcessTickInterval&&(t.tickInterval=t.postProcessTickInterval(t.tickInterval)),!g&&t.tickInterval<f&&(t.tickInterval=f),s||a||(e=he.pow(10,de(he.log(t.tickInterval)/he.LN10)),g)||(t.tickInterval=b(t.tickInterval,null,e,n)),t.minorTickInterval="auto"===n.minorTickInterval&&t.tickInterval?t.tickInterval/5:n.minorTickInterval,t.tickPositions=h=n.tickPositions||h&&h.apply(t,[t.min,t.max]),h||(h=s?(t.getNonLinearTimeTicks||_)(w(t.tickInterval,n.units),t.min,t.max,n.startOfWeek,t.ordinalPositions,t.closestPointRange,!0):a?t.getLogTickPositions(t.tickInterval,t.min,t.max):t.getLinearTickPositions(t.tickInterval,t.min,t.max),t.tickPositions=h),r||(a=h[0],s=h[h.length-1],r=t.minPointOffset||0,n.startOnTick?t.min=a:t.min-r>a&&h.shift(),n.endOnTick?t.max=s:t.max+r<s&&h.pop())},setMaxTicks:function(){var e=this.chart,t=e.maxTicks,i=this.tickPositions,n=this.xOrY;t||(t={x:0,y:0}),!this.isLinked&&!this.isDatetimeAxis&&i.length>t[n]&&this.options.alignTicks!==!1&&(t[n]=i.length),e.maxTicks=t},adjustTickAmount:function(){var e=this.xOrY,t=this.tickPositions,i=this.chart.maxTicks;if(i&&i[e]&&!this.isDatetimeAxis&&!this.categories&&!this.isLinked&&this.options.alignTicks!==!1){var n=this.tickAmount,a=t.length;if(this.tickAmount=e=i[e],e>a){for(;t.length<e;)t.push(A(t[t.length-1]+this.tickInterval));this.transA*=(a-1)/(e-1),this.max=t[t.length-1]}c(n)&&e!==n&&(this.isDirty=!0)}},setScale:function(){var e,t,i,n,a=this.stacks;if(this.oldMin=this.min,this.oldMax=this.max,this.oldAxisLength=this.len,this.setAxisSize(),n=this.len!==this.oldAxisLength,Ke(this.series,function(e){(e.isDirtyData||e.isDirty||e.xAxis.isDirty)&&(i=!0)}),(n||i||this.isLinked||this.userMin!==this.oldUserMin||this.userMax!==this.oldUserMax)&&(this.getSeriesExtremes(),this.setTickPositions(),this.oldUserMin=this.userMin,this.oldUserMax=this.userMax,this.isDirty||(this.isDirty=n||this.min!==this.oldMin||this.max!==this.oldMax)),!this.isXAxis)for(e in a)for(t in a[e])a[e][t].cum=a[e][t].total;this.setMaxTicks()},setExtremes:function(t,i,n,a,s){var o=this,l=o.chart,n=p(n,!0),s=e(s,{min:t,max:i});at(o,"setExtremes",s,function(){o.userMin=t,o.userMax=i,o.isDirtyExtremes=!0,n&&l.redraw(a)})},zoom:function(e,t){return this.setExtremes(e,t,!1,R,{trigger:"zoom"}),!0},setAxisSize:function(){var e=this.chart,t=this.options,i=t.offsetLeft||0,n=t.offsetRight||0;this.left=p(t.left,e.plotLeft+i),this.top=p(t.top,e.plotTop),this.width=p(t.width,e.plotWidth-i+n),this.height=p(t.height,e.plotHeight),this.bottom=e.chartHeight-this.height-this.top,this.right=e.chartWidth-this.width-this.left,this.len=pe(this.horiz?this.width:this.height,0)},getExtremes:function(){var e=this.isLog;return{min:e?A(r(this.min)):this.min,max:e?A(r(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}},getThreshold:function(e){var t=this.isLog,i=t?r(this.min):this.min,t=t?r(this.max):this.max;return i>e||null===e?e=i:e>t&&(e=t),this.translate(e,0,1,0,1)},addPlotBandOrLine:function(e){return e=new L(this,e).render(),this.plotLinesAndBands.push(e),e},getOffset:function(){var e,t,i,n=this,a=n.chart,s=a.renderer,o=n.options,l=n.tickPositions,r=n.ticks,h=n.horiz,d=n.side,u=0,g=0,f=o.title,m=o.labels,v=0,y=a.axisOffset,b=[-1,1,1,-1][d];if(n.hasData=a=n.hasVisibleSeries||c(n.min)&&c(n.max)&&!!l,n.showAxis=e=a||p(o.showEmpty,!0),n.axisGroup||(n.gridGroup=s.g("grid").attr({zIndex:o.gridZIndex||1}).add(),n.axisGroup=s.g("axis").attr({zIndex:o.zIndex||2}).add(),n.labelGroup=s.g("axis-labels").attr({zIndex:m.zIndex||7}).add()),a||n.isLinked)Ke(l,function(e){r[e]?r[e].addLabel():r[e]=new I(n,e)}),Ke(l,function(e){(0===d||2===d||{1:"left",3:"right"}[d]===m.align)&&(v=pe(r[e].getLabelSize(),v))}),n.staggerLines&&(v+=16*(n.staggerLines-1));else for(i in r)r[i].destroy(),delete r[i];f&&f.text&&(n.axisTitle||(n.axisTitle=s.text(f.text,0,0,f.useHTML).attr({zIndex:7,rotation:f.rotation||0,align:f.textAlign||{low:"left",middle:"center",high:"right"}[f.align]}).css(f.style).add(n.axisGroup),n.axisTitle.isNew=!0),e&&(u=n.axisTitle.getBBox()[h?"height":"width"],g=p(f.margin,h?5:10),t=f.offset),n.axisTitle[e?"show":"hide"]()),n.offset=b*p(o.offset,y[d]),n.axisTitleMargin=p(t,v+g+(2!==d&&v&&b*o.labels[h?"y":"x"])),y[d]=pe(y[d],n.axisTitleMargin+u+b*n.offset)},getLinePath:function(e){var t=this.chart,i=this.opposite,n=this.offset,a=this.horiz,s=this.left+(i?this.width:0)+n;return this.lineTop=i=t.chartHeight-this.bottom-(i?this.height:0)+n,t.renderer.crispLine(["M",a?this.left:s,a?i:this.top,"L",a?t.chartWidth-this.right:s,a?i:t.chartHeight-this.bottom],e)},getTitlePosition:function(){var e=this.horiz,t=this.left,n=this.top,a=this.len,s=this.options.title,o=e?t:n,l=this.opposite,r=this.offset,h=i(s.style.fontSize||12),a={low:o+(e?0:a),middle:o+a/2,high:o+(e?a:0)}[s.align],t=(e?n+this.height:t)+(e?1:-1)*(l?-1:1)*this.axisTitleMargin+(2===this.side?h:0);return{x:e?a:t+(l?this.width:0)+r+(s.x||0),y:e?t-(l?this.height:0)+r:a+(s.y||0)}},render:function(){var e,t,i,n=this,a=n.chart,s=a.renderer,o=n.options,l=n.isLog,h=n.isLinked,d=n.tickPositions,u=n.axisTitle,p=n.stacks,g=n.ticks,f=n.minorTicks,m=n.alternateBands,v=o.stackLabels,y=o.alternateGridColor,b=n.tickmarkOffset,w=o.lineWidth,_=a.hasRendered&&c(n.oldMin)&&!isNaN(n.oldMin),x=n.showAxis;if((n.hasData||h)&&(n.minorTickInterval&&!n.categories&&Ke(n.getMinorTickPositions(),function(e){f[e]||(f[e]=new I(n,e,"minor")),_&&f[e].isNew&&f[e].render(null,!0),f[e].isActive=!0,f[e].render()}),Ke(d.slice(1).concat([d[0]]),function(e,t){t=t===d.length-1?0:t+1,(!h||e>=n.min&&e<=n.max)&&(g[e]||(g[e]=new I(n,e)),_&&g[e].isNew&&g[e].render(t,!0),g[e].isActive=!0,g[e].render(t))}),y&&Ke(d,function(e,a){a%2===0&&e<n.max&&(m[e]||(m[e]=new L(n)),t=e+b,i=d[a+1]!==R?d[a+1]+b:n.max,m[e].options={from:l?r(t):t,to:l?r(i):i,color:y},m[e].render(),m[e].isActive=!0)}),n._addedPlotLB||(Ke((o.plotLines||[]).concat(o.plotBands||[]),function(e){n.addPlotBandOrLine(e)}),n._addedPlotLB=!0)),Ke([g,f,m],function(e){for(var t in e)e[t].isActive?e[t].isActive=!1:(e[t].destroy(),delete e[t])}),w&&(e=n.getLinePath(w),n.axisLine?n.axisLine.animate({d:e}):n.axisLine=s.path(e).attr({stroke:o.lineColor,"stroke-width":w,zIndex:7}).add(n.axisGroup),n.axisLine[x?"show":"hide"]()),u&&x&&(u[u.isNew?"attr":"animate"](n.getTitlePosition()),u.isNew=!1),v&&v.enabled){var T,k,o=n.stackTotalGroup;o||(n.stackTotalGroup=o=s.g("stack-labels").attr({visibility:"visible",zIndex:6}).add()),o.translate(a.plotLeft,a.plotTop);for(T in p)for(k in a=p[T])a[k].render(o)}n.isDirty=!1},removePlotBandOrLine:function(e){for(var t=this.plotLinesAndBands,i=t.length;i--;)t[i].id===e&&t[i].destroy()},setTitle:function(e,t){var i=this.chart,n=this.options,a=this.axisTitle;n.title=tt(n.title,e),this.axisTitle=a&&a.destroy(),this.isDirty=!0,p(t,!0)&&i.redraw()},redraw:function(){var e=this.chart;e.tracker.resetTracker&&e.tracker.resetTracker(!0),this.render(),Ke(this.plotLinesAndBands,function(e){e.render()}),Ke(this.series,function(e){e.isDirty=!0})},setCategories:function(e,t){var i=this.chart;this.categories=this.userOptions.categories=e,Ke(this.series,function(e){e.translate(),e.setTooltipPoints(!0)}),this.isDirty=!0,p(t,!0)&&i.redraw()},destroy:function(){var e,t=this,i=t.stacks;nt(t);for(e in i)M(i[e]),i[e]=null;Ke([t.ticks,t.minorTicks,t.alternateBands,t.plotLinesAndBands],function(e){M(e)}),Ke("stackTotalGroup,axisLine,axisGroup,gridGroup,labelGroup,axisTitle".split(","),function(e){t[e]&&(t[e]=t[e].destroy())})}},W.prototype={destroy:function(){Ke(this.crosshairs,function(e){e&&e.destroy()}),this.label&&(this.label=this.label.destroy())},move:function(t,i,n,a){var s=this,o=s.now,l=s.options.animation!==!1&&!s.isHidden;e(o,{x:l?(2*o.x+t)/3:t,y:l?(o.y+i)/2:i,anchorX:l?(2*o.anchorX+n)/3:n,anchorY:l?(o.anchorY+a)/2:a}),s.label.attr(o),l&&(fe(t-o.x)>1||fe(i-o.y)>1)&&(clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){s&&s.move(t,i,n,a)},32))},hide:function(){if(!this.isHidden){var e=this.chart.hoverPoints;this.label.hide(),e&&Ke(e,function(e){e.setState()}),this.chart.hoverPoints=null,this.isHidden=!0}},hideCrosshairs:function(){Ke(this.crosshairs,function(e){e&&e.hide()})},getAnchor:function(e,t){var i,n,a=this.chart,s=a.inverted,o=0,l=0,e=u(e);return i=e[0].tooltipPos,i||(Ke(e,function(e){n=e.series.yAxis,o+=e.plotX,l+=(e.plotLow?(e.plotLow+e.plotHigh)/2:e.plotY)+(!s&&n?n.top-a.plotTop:0)}),o/=e.length,l/=e.length,i=[s?a.plotWidth-l:o,this.shared&&!s&&e.length>1&&t?t.chartY-a.plotTop:s?a.plotHeight-o:l]),et(i,ce)},getPosition:function(e,t,i){var n,a=this.chart,s=a.plotLeft,o=a.plotTop,l=a.plotWidth,r=a.plotHeight,h=p(this.options.distance,12),c=i.plotX,i=i.plotY,a=c+s+(a.inverted?h:-e-h),d=i-t+o+15;return 7>a&&(a=s+pe(c,0)+h),a+e>s+l&&(a-=a+e-(s+l),d=i-t+o-h,n=!0),o+5>d&&(d=o+5,n&&i>=d&&d+t>=i&&(d=i+o+h)),d+t>o+r&&(d=pe(o,o+r-t-h)),{x:a,y:d}},refresh:function(e,t){function i(){var e,t=this.points||u(this),i=t[0].series;return e=[i.tooltipHeaderFormatter(t[0].key)],Ke(t,function(t){i=t.series,e.push(i.tooltipFormatter&&i.tooltipFormatter(t)||t.point.tooltipFormatter(i.tooltipOptions.pointFormat))}),e.push(h.footerFormat||""),e.join("")}var n,a,s,o,l=this.chart,r=this.label,h=this.options,c={},d=[];o=h.formatter||i;var g,c=l.hoverPoints,f=h.crosshairs;if(s=this.shared,a=this.getAnchor(e,t),n=a[0],a=a[1],!s||e.series&&e.series.noSharedTooltip?c=e.getLabelConfig():(l.hoverPoints=e,c&&Ke(c,function(e){e.setState()}),Ke(e,function(e){e.setState("hover"),d.push(e.getLabelConfig())}),c={x:e[0].category,y:e[0].y},c.points=d,e=e[0]),o=o.call(c),c=e.series,s=s||!c.isCartesian||c.tooltipOutsidePlot||l.isInsidePlot(n,a),o!==!1&&s?(this.isHidden&&r.show(),r.attr({text:o}),g=h.borderColor||e.color||c.color||"#606060",r.attr({stroke:g}),r=(h.positioner||this.getPosition).call(this,r.width,r.height,{plotX:n,plotY:a}),this.move(ce(r.x),ce(r.y),n+l.plotLeft,a+l.plotTop),this.isHidden=!1):this.hide(),f)for(f=u(f),r=f.length;r--;)s=e.series[r?"yAxis":"xAxis"],f[r]&&s&&(s=s.getPlotLinePath(r?p(e.stackY,e.y):e.x,1),this.crosshairs[r]?this.crosshairs[r].attr({d:s,visibility:"visible"}):(c={"stroke-width":f[r].width||1,stroke:f[r].color||"#C0C0C0",zIndex:f[r].zIndex||2},f[r].dashStyle&&(c.dashstyle=f[r].dashStyle),this.crosshairs[r]=l.renderer.path(s).attr(c).add()));at(l,"tooltipRefresh",{text:o,x:n+l.plotLeft,y:a+l.plotTop,borderColor:g})}},N.prototype={normalizeMouseEvent:function(t){var i,n,a,t=t||re.event;return t.target||(t.target=t.srcElement),t=st(t),a=t.touches?t.touches.item(0):t,this.chartPosition=i=Qe(this.chart.container),a.pageX===R?(n=t.x,i=t.y):(n=a.pageX-i.left,i=a.pageY-i.top),e(t,{chartX:ce(n),chartY:ce(i)})},getMouseCoordinates:function(e){var t={xAxis:[],yAxis:[]},i=this.chart;return Ke(i.axes,function(n){var a=n.isXAxis;t[a?"xAxis":"yAxis"].push({axis:n,value:n.translate(((i.inverted?!a:a)?e.chartX-i.plotLeft:n.top+n.len-e.chartY)-n.minPixelPadding,!0)})}),t},getIndex:function(e){var t=this.chart;return t.inverted?t.plotHeight+t.plotTop-e.chartY:e.chartX-t.plotLeft},onmousemove:function(e){var t,i,n,a=this.chart,s=a.series,o=a.tooltip,l=a.hoverPoint,r=a.hoverSeries,h=a.chartWidth,c=this.getIndex(e);if(o&&this.options.tooltip.shared&&(!r||!r.noSharedTooltip)){for(t=[],i=s.length,n=0;i>n;n++)s[n].visible&&s[n].options.enableMouseTracking!==!1&&!s[n].noSharedTooltip&&s[n].tooltipPoints.length&&(a=s[n].tooltipPoints[c],a._dist=fe(c-a[s[n].xAxis.tooltipPosName||"plotX"]),h=ge(h,a._dist),t.push(a));for(i=t.length;i--;)t[i]._dist>h&&t.splice(i,1);t.length&&t[0].plotX!==this.hoverX&&(o.refresh(t,e),this.hoverX=t[0].plotX)}r&&r.tracker&&(a=r.tooltipPoints[c])&&a!==l&&a.onMouseOver()},resetTracker:function(e){var t=this.chart,i=t.hoverSeries,n=t.hoverPoint,a=t.tooltip,t=a&&a.shared?t.hoverPoints:n;(e=e&&a&&t)&&u(t)[0].plotX===R&&(e=!1),e?a.refresh(t):(n&&n.onMouseOut(),i&&i.onMouseOut(),a&&(a.hide(),a.hideCrosshairs()),this.hoverX=null)},setDOMEvents:function(){function t(){if(n.selectionMarker){var e,o={xAxis:[],yAxis:[]},l=n.selectionMarker.getBBox(),r=l.x-a.plotLeft,h=l.y-a.plotTop;i&&(Ke(a.axes,function(t){if(t.options.zoomEnabled!==!1){var i=t.isXAxis,n=a.inverted?!i:i,s=t.translate(n?r:a.plotHeight-h-l.height,!0,0,0,1),n=t.translate((n?r+l.width:a.plotHeight-h)-2*t.minPixelPadding,!0,0,0,1);!isNaN(s)&&!isNaN(n)&&(o[i?"xAxis":"yAxis"].push({axis:t,min:ge(s,n),max:pe(s,n)}),e=!0)}}),e&&at(a,"selection",o,function(e){a.zoom(e)})),n.selectionMarker=n.selectionMarker.destroy()}a&&(g(s,{cursor:"auto"}),a.cancelClick=i,a.mouseIsDown=i=!1),nt(le,Ge?"touchend":"mouseup",t)}var i,n=this,a=n.chart,s=a.container,o=n.zoomX&&!a.inverted||n.zoomY&&a.inverted,l=n.zoomY&&!a.inverted||n.zoomX&&a.inverted;n.hideTooltipOnMouseMove=function(e){e=st(e),n.chartPosition&&a.hoverSeries&&a.hoverSeries.isCartesian&&!a.isInsidePlot(e.pageX-n.chartPosition.left-a.plotLeft,e.pageY-n.chartPosition.top-a.plotTop)&&n.resetTracker()},n.hideTooltipOnMouseLeave=function(){n.resetTracker(),n.chartPosition=null},s.onmousedown=function(e){e=n.normalizeMouseEvent(e),!Ge&&e.preventDefault&&e.preventDefault(),a.mouseIsDown=!0,a.cancelClick=!1,a.mouseDownX=n.mouseDownX=e.chartX,n.mouseDownY=e.chartY,it(le,Ge?"touchend":"mouseup",t)};var r=function(e){if(!e||!(e.touches&&e.touches.length>1)){e=n.normalizeMouseEvent(e),Ge||(e.returnValue=!1);var t=e.chartX,s=e.chartY,r=!a.isInsidePlot(t-a.plotLeft,s-a.plotTop);if(Ge&&"touchstart"===e.type&&(d(e.target,"isTracker")?a.runTrackerClick||e.preventDefault():!a.runChartClick&&!r&&e.preventDefault()),r&&(t<a.plotLeft?t=a.plotLeft:t>a.plotLeft+a.plotWidth&&(t=a.plotLeft+a.plotWidth),s<a.plotTop?s=a.plotTop:s>a.plotTop+a.plotHeight&&(s=a.plotTop+a.plotHeight)),a.mouseIsDown&&"touchstart"!==e.type&&(i=Math.sqrt(Math.pow(n.mouseDownX-t,2)+Math.pow(n.mouseDownY-s,2)),i>10)){var h=a.isInsidePlot(n.mouseDownX-a.plotLeft,n.mouseDownY-a.plotTop);if(a.hasCartesianSeries&&(n.zoomX||n.zoomY)&&h&&!n.selectionMarker&&(n.selectionMarker=a.renderer.rect(a.plotLeft,a.plotTop,o?1:a.plotWidth,l?1:a.plotHeight,0).attr({fill:n.options.chart.selectionMarkerFill||"rgba(69,114,167,0.25)",zIndex:7}).add()),n.selectionMarker&&o){var c=t-n.mouseDownX;n.selectionMarker.attr({width:fe(c),x:(c>0?0:c)+n.mouseDownX})}n.selectionMarker&&l&&(s-=n.mouseDownY,n.selectionMarker.attr({height:fe(s),y:(s>0?0:s)+n.mouseDownY})),h&&!n.selectionMarker&&n.options.chart.panning&&a.pan(t)}return r||n.onmousemove(e),r||!a.hasCartesianSeries}};s.onmousemove=r,it(s,"mouseleave",n.hideTooltipOnMouseLeave),it(le,"mousemove",n.hideTooltipOnMouseMove),s.ontouchstart=function(e){(n.zoomX||n.zoomY)&&s.onmousedown(e),r(e)},s.ontouchmove=r,s.ontouchend=function(){i&&n.resetTracker()},s.onclick=function(t){var i,s,o=a.hoverPoint,t=n.normalizeMouseEvent(t);t.cancelBubble=!0,a.cancelClick||(o&&(d(t.target,"isTracker")||d(t.target.parentNode,"isTracker"))?(i=o.plotX,s=o.plotY,e(o,{pageX:n.chartPosition.left+a.plotLeft+(a.inverted?a.plotWidth-s:i),pageY:n.chartPosition.top+a.plotTop+(a.inverted?a.plotHeight-i:s)}),at(o.series,"click",e(t,{point:o})),o.firePointEvent("click",t)):(e(t,n.getMouseCoordinates(t)),a.isInsidePlot(t.chartX-a.plotLeft,t.chartY-a.plotTop)&&at(a,"click",t)))}},destroy:function(){var e=this.chart,t=e.container;e.trackerGroup&&(e.trackerGroup=e.trackerGroup.destroy()),nt(t,"mouseleave",this.hideTooltipOnMouseLeave),nt(le,"mousemove",this.hideTooltipOnMouseMove),t.onclick=t.onmousedown=t.onmousemove=t.ontouchstart=t.ontouchend=t.ontouchmove=null,clearInterval(this.tooltipTimeout)},init:function(e,t){e.trackerGroup||(e.trackerGroup=e.renderer.g("tracker").attr({zIndex:9}).add()),t.enabled&&(e.tooltip=new W(e,t)),this.setDOMEvents()}},B.prototype={init:function(e){var t=this,n=t.options=e.options.legend;if(n.enabled){var a=n.itemStyle,s=p(n.padding,8),o=n.itemMarginTop||0;t.baseline=i(a.fontSize)+3+o,t.itemStyle=a,t.itemHiddenStyle=tt(a,n.itemHiddenStyle),t.itemMarginTop=o,t.padding=s,t.initialItemX=s,t.initialItemY=s-5,t.maxItemWidth=0,t.chart=e,t.itemHeight=0,t.lastLineHeight=0,t.render(),it(t.chart,"endResize",function(){t.positionCheckboxes()})}},colorizeItem:function(e,t){var i,n=this.options,a=e.legendItem,s=e.legendLine,o=e.legendSymbol,l=this.itemHiddenStyle.color,n=t?n.itemStyle.color:l,r=t?e.color:l,l=e.options&&e.options.marker,h={stroke:r,fill:r};if(a&&a.css({fill:n}),s&&s.attr({stroke:r}),o){if(l)for(i in l=e.convertAttribs(l))a=l[i],a!==R&&(h[i]=a);o.attr(h)}},positionItem:function(e){var t=this.options,i=t.symbolPadding,t=!t.rtl,n=e._legendItemPos,a=n[0],n=n[1],s=e.checkbox;e.legendGroup&&e.legendGroup.translate(t?a:this.legendWidth-a-2*i-4,n),s&&(s.x=a,s.y=n)},destroyItem:function(e){var t=e.checkbox;Ke(["legendItem","legendLine","legendSymbol","legendGroup"],function(t){e[t]&&e[t].destroy()}),t&&C(e.checkbox)},destroy:function(){var e=this.group,t=this.box;t&&(this.box=t.destroy()),e&&(this.group=e.destroy())},positionCheckboxes:function(){var e=this;Ke(e.allItems,function(t){var i=t.checkbox,n=e.group.alignAttr;i&&g(i,{left:n.translateX+t.legendItemWidth+i.x-20+"px",top:n.translateY+i.y+3+"px"})})},renderItem:function(e){var t,i=this,n=i.chart,a=n.renderer,s=i.options,o="horizontal"===s.layout,l=s.symbolWidth,r=s.symbolPadding,h=i.itemStyle,c=i.itemHiddenStyle,d=i.padding,u=!s.rtl,p=s.width,g=s.itemMarginBottom||0,m=i.itemMarginTop,v=i.initialItemX,y=e.legendItem,b=e.series||e,w=b.options,_=w.showCheckbox;!y&&(e.legendGroup=a.g("legend-item").attr({zIndex:1}).add(i.scrollGroup),b.drawLegendSymbol(i,e),e.legendItem=y=a.text(s.labelFormatter.call(e),u?l+r:-r,i.baseline,s.useHTML).css(tt(e.visible?h:c)).attr({align:u?"left":"right",zIndex:2}).add(e.legendGroup),e.legendGroup.on("mouseover",function(){e.setState("hover"),y.css(i.options.itemHoverStyle)}).on("mouseout",function(){y.css(e.visible?h:c),e.setState()}).on("click",function(t){var i=function(){e.setVisible()},t={browserEvent:t};e.firePointEvent?e.firePointEvent("legendItemClick",t,i):at(e,"legendItemClick",t,i)}),i.colorizeItem(e,e.visible),w&&_)&&(e.checkbox=f("input",{type:"checkbox",checked:e.selected,defaultChecked:e.selected},s.itemCheckboxStyle,n.container),it(e.checkbox,"click",function(t){at(e,"checkboxClick",{checked:t.target.checked},function(){e.select()})})),a=y.getBBox(),t=e.legendItemWidth=s.itemWidth||l+r+a.width+d+(_?20:0),s=t,i.itemHeight=l=a.height,o&&i.itemX-v+s>(p||n.chartWidth-2*d-v)&&(i.itemX=v,i.itemY+=m+i.lastLineHeight+g,i.lastLineHeight=0),i.maxItemWidth=pe(i.maxItemWidth,s),i.lastItemY=m+i.itemY+g,i.lastLineHeight=pe(l,i.lastLineHeight),e._legendItemPos=[i.itemX,i.itemY],o?i.itemX+=s:(i.itemY+=m+l+g,i.lastLineHeight=l),i.offsetWidth=p||pe(o?i.itemX-v:s,i.offsetWidth)},render:function(){var t,i,n,a,s=this,o=s.chart,l=o.renderer,r=s.group,h=s.box,c=s.options,d=s.padding,u=c.borderWidth,p=c.backgroundColor;s.itemX=s.initialItemX,s.itemY=s.initialItemY,s.offsetWidth=0,s.lastItemY=0,r||(s.group=r=l.g("legend").attr({zIndex:7}).add(),s.contentGroup=l.g().attr({zIndex:1}).add(r),s.scrollGroup=l.g().add(s.contentGroup),s.clipRect=l.clipRect(0,0,9999,o.chartHeight),s.contentGroup.clip(s.clipRect)),t=[],Ke(o.series,function(e){var i=e.options;i.showInLegend&&(t=t.concat(e.legendItems||("point"===i.legendType?e.data:e)))}),T(t,function(e,t){return(e.options&&e.options.legendIndex||0)-(t.options&&t.options.legendIndex||0)}),c.reversed&&t.reverse(),s.allItems=t,s.display=i=!!t.length,Ke(t,function(e){s.renderItem(e)}),n=c.width||s.offsetWidth,a=s.lastItemY+s.lastLineHeight,a=s.handleOverflow(a),(u||p)&&(n+=d,a+=d,h?n>0&&a>0&&(h[h.isNew?"attr":"animate"](h.crisp(null,null,null,n,a)),h.isNew=!1):(s.box=h=l.rect(0,0,n,a,c.borderRadius,u||0).attr({stroke:c.borderColor,"stroke-width":u||0,fill:p||Fe}).add(r).shadow(c.shadow),h.isNew=!0),h[i?"show":"hide"]()),s.legendWidth=n,s.legendHeight=a,Ke(t,function(e){s.positionItem(e)}),i&&r.align(e({width:n,height:a},c),!0,o.spacingBox),o.isResizing||this.positionCheckboxes()},handleOverflow:function(e){var t=this,i=this.chart,n=i.renderer,a=this.options,s=a.y,s=i.spacingBox.height+("top"===a.verticalAlign?-s:s)-this.padding,o=a.maxHeight,l=this.clipRect,r=a.navigation,h=p(r.animation,!0),c=r.arrowSize||12,d=this.nav;return"horizontal"===a.layout&&(s/=2),o&&(s=ge(s,o)),e>s?(this.clipHeight=i=s-20,this.pageCount=ue(e/i),this.currentPage=p(this.currentPage,1),this.fullHeight=e,l.attr({height:i}),d||(this.nav=d=n.g().attr({zIndex:1}).add(this.group),this.up=n.symbol("triangle",0,0,c,c).on("click",function(){t.scroll(-1,h)}).add(d),this.pager=n.text("",15,10).css(r.style).add(d),this.down=n.symbol("triangle-down",0,0,c,c).on("click",function(){t.scroll(1,h)}).add(d)),t.scroll(0),e=s):d&&(l.attr({height:i.chartHeight}),d.hide(),this.scrollGroup.attr({translateY:1})),e},scroll:function(e,t){var i=this.pageCount,n=this.currentPage+e,a=this.clipHeight,s=this.options.navigation,o=s.activeColor,s=s.inactiveColor,l=this.pager,r=this.padding;
n>i&&(n=i),n>0&&(t!==R&&G(t,this.chart),this.nav.attr({translateX:r,translateY:a+7,visibility:"visible"}),this.up.attr({fill:1===n?s:o}).css({cursor:1===n?"default":"pointer"}),l.attr({text:n+"/"+this.pageCount}),this.down.attr({x:18+this.pager.getBBox().width,fill:n===i?s:o}).css({cursor:n===i?"default":"pointer"}),this.scrollGroup.animate({translateY:-ge(a*(n-1),this.fullHeight-a+r)+1}),l.attr({text:n+"/"+i}),this.currentPage=n)}},U.prototype={initSeries:function(e){var t=this.options.chart,t=new $e[e.type||t.type||t.defaultSeriesType];return t.init(this,e),t},addSeries:function(e,t,i){var n,a=this;return e&&(G(i,a),t=p(t,!0),at(a,"addSeries",{options:e},function(){n=a.initSeries(e),a.isDirtyLegend=!0,t&&a.redraw()})),n},isInsidePlot:function(e,t,i){var n=i?t:e,e=i?e:t;return n>=0&&n<=this.plotWidth&&e>=0&&e<=this.plotHeight},adjustTickAmounts:function(){this.options.chart.alignTicks!==!1&&Ke(this.axes,function(e){e.adjustTickAmount()}),this.maxTicks=null},redraw:function(e){var t,i=this.axes,n=this.series,a=this.tracker,s=this.legend,o=this.isDirtyLegend,l=this.isDirtyBox,r=n.length,h=r,c=this.renderer,d=c.isHidden(),u=[];for(G(e,this),d&&this.cloneRenderTo();h--;)if(e=n[h],e.isDirty&&e.options.stacking){t=!0;break}if(t)for(h=r;h--;)e=n[h],e.options.stacking&&(e.isDirty=!0);Ke(n,function(e){e.isDirty&&"point"===e.options.legendType&&(o=!0)}),o&&s.options.enabled&&(s.render(),this.isDirtyLegend=!1),this.hasCartesianSeries&&(this.isResizing||(this.maxTicks=null,Ke(i,function(e){e.setScale()})),this.adjustTickAmounts(),this.getMargins(),Ke(i,function(e){e.isDirtyExtremes&&(e.isDirtyExtremes=!1,u.push(function(){at(e,"afterSetExtremes",e.getExtremes())})),(e.isDirty||l||t)&&(e.redraw(),l=!0)})),l&&this.drawChartBox(),Ke(n,function(e){e.isDirty&&e.visible&&(!e.isCartesian||e.xAxis)&&e.redraw()}),a&&a.resetTracker&&a.resetTracker(!0),c.draw(),at(this,"redraw"),d&&this.cloneRenderTo(!0),Ke(u,function(e){e.call()})},showLoading:function(t){var i=this.options,n=this.loadingDiv,a=i.loading;n||(this.loadingDiv=n=f(Le,{className:"highcharts-loading"},e(a.style,{left:this.plotLeft+"px",top:this.plotTop+"px",width:this.plotWidth+"px",height:this.plotHeight+"px",zIndex:10,display:Fe}),this.container),this.loadingSpan=f("span",null,a.labelStyle,n)),this.loadingSpan.innerHTML=t||i.lang.loading,this.loadingShown||(g(n,{opacity:0,display:""}),ot(n,{opacity:a.style.opacity},{duration:a.showDuration||0}),this.loadingShown=!0)},hideLoading:function(){var e=this.options,t=this.loadingDiv;t&&ot(t,{opacity:0},{duration:e.loading.hideDuration||100,complete:function(){g(t,{display:Fe})}}),this.loadingShown=!1},get:function(e){var t,i,n=this.axes,a=this.series;for(t=0;t<n.length;t++)if(n[t].options.id===e)return n[t];for(t=0;t<a.length;t++)if(a[t].options.id===e)return a[t];for(t=0;t<a.length;t++)for(i=a[t].points||[],n=0;n<i.length;n++)if(i[n].id===e)return i[n];return null},getAxes:function(){var e=this,t=this.options,i=t.xAxis||{},t=t.yAxis||{},i=u(i);Ke(i,function(e,t){e.index=t,e.isX=!0}),t=u(t),Ke(t,function(e,t){e.index=t}),i=i.concat(t),Ke(i,function(t){new O(e,t)}),e.adjustTickAmounts()},getSelectedPoints:function(){var e=[];return Ke(this.series,function(t){e=e.concat(Je(t.points,function(e){return e.selected}))}),e},getSelectedSeries:function(){return Je(this.series,function(e){return e.selected})},showResetZoom:function(){var e=this,t=z.lang,i=e.options.chart.resetZoomButton,n=i.theme,a=n.states,s="chart"===i.relativeTo?null:"plotBox";this.resetZoomButton=e.renderer.button(t.resetZoom,null,null,function(){e.zoomOut()},n,a&&a.hover).attr({align:i.position.align,title:t.resetZoomTitle}).add().align(i.position,!1,e[s]),this.resetZoomButton.alignTo=s},zoomOut:function(){var e=this,t=e.resetZoomButton;at(e,"selection",{resetSelection:!0},function(){e.zoom()}),t&&(e.resetZoomButton=t.destroy())},zoom:function(e){var t,i=this;!e||e.resetSelection?Ke(i.axes,function(e){t=e.zoom()}):Ke(e.xAxis.concat(e.yAxis),function(e){var n=e.axis;i.tracker[n.isXAxis?"zoomX":"zoomY"]&&(t=n.zoom(e.min,e.max))}),i.resetZoomButton||i.showResetZoom(),t&&i.redraw(p(i.options.chart.animation,i.pointCount<100))},pan:function(e){var t=this.xAxis[0],i=this.mouseDownX,n=t.pointRange/2,a=t.getExtremes(),s=t.translate(i-e,!0)+n,i=t.translate(i+this.plotWidth-e,!0)-n;(n=this.hoverPoints)&&Ke(n,function(e){e.setState()}),t.series.length&&s>ge(a.dataMin,a.min)&&i<pe(a.dataMax,a.max)&&t.setExtremes(s,i,!0,!1,{trigger:"pan"}),this.mouseDownX=e,g(this.container,{cursor:"move"})},setTitle:function(e,t){var i,n=this,a=n.options;n.chartTitleOptions=i=tt(a.title,e),n.chartSubtitleOptions=a=tt(a.subtitle,t),Ke([["title",e,i],["subtitle",t,a]],function(e){var t=e[0],i=n[t],a=e[1],e=e[2];i&&a&&(n[t]=i=i.destroy()),e&&e.text&&!i&&(n[t]=n.renderer.text(e.text,0,0,e.useHTML).attr({align:e.align,"class":"highcharts-"+t,zIndex:e.zIndex||4}).css(e.style).add().align(e,!1,n.spacingBox))})},getChartSize:function(){var e=this.options.chart,t=this.renderToClone||this.renderTo;this.containerWidth=Ye(t,"width"),this.containerHeight=Ye(t,"height"),this.chartWidth=e.width||this.containerWidth||600,this.chartHeight=e.height||(this.containerHeight>19?this.containerHeight:400)},cloneRenderTo:function(e){var t=this.renderToClone,i=this.container;e?t&&(this.renderTo.appendChild(i),C(t),delete this.renderToClone):(i&&this.renderTo.removeChild(i),this.renderToClone=t=this.renderTo.cloneNode(0),g(t,{position:"absolute",top:"-9999px",display:"block"}),le.body.appendChild(t),i&&t.appendChild(i))},getContainer:function(){var t,i,a,s,o=this.options.chart;this.renderTo=t=o.renderTo,s="highcharts-"+Pe++,n(t)&&(this.renderTo=t=le.getElementById(t)),t||D(13,!0),t.innerHTML="",t.offsetWidth||this.cloneRenderTo(),this.getChartSize(),i=this.chartWidth,a=this.chartHeight,this.container=t=f(Le,{className:"highcharts-container"+(o.className?" "+o.className:""),id:s},e({position:"relative",overflow:"hidden",width:i+"px",height:a+"px",textAlign:"left",lineHeight:"normal",zIndex:0},o.style),this.renderToClone||t),this.renderer=o.forExport?new ct(t,i,a,!0):new j(t,i,a),Ae&&this.renderer.create(this,t,i,a)},getMargins:function(){var e,t=this.options.chart,i=t.spacingTop,n=t.spacingRight,a=t.spacingBottom,t=t.spacingLeft,s=this.legend,o=this.optionsMarginTop,l=this.optionsMarginLeft,r=this.optionsMarginRight,h=this.optionsMarginBottom,d=this.chartTitleOptions,u=this.chartSubtitleOptions,g=this.options.legend,f=p(g.margin,10),m=g.x,v=g.y,y=g.align,b=g.verticalAlign;this.resetMargins(),e=this.axisOffset,!this.title&&!this.subtitle||c(this.optionsMarginTop)||(u=pe(this.title&&!d.floating&&!d.verticalAlign&&d.y||0,this.subtitle&&!u.floating&&!u.verticalAlign&&u.y||0))&&(this.plotTop=pe(this.plotTop,u+p(d.margin,15)+i)),s.display&&!g.floating&&("right"===y?c(r)||(this.marginRight=pe(this.marginRight,s.legendWidth-m+f+n)):"left"===y?c(l)||(this.plotLeft=pe(this.plotLeft,s.legendWidth+m+f+t)):"top"===b?c(o)||(this.plotTop=pe(this.plotTop,s.legendHeight+v+f+i)):"bottom"!==b||c(h)||(this.marginBottom=pe(this.marginBottom,s.legendHeight-v+f+a))),this.extraBottomMargin&&(this.marginBottom+=this.extraBottomMargin),this.extraTopMargin&&(this.plotTop+=this.extraTopMargin),this.hasCartesianSeries&&Ke(this.axes,function(e){e.getOffset()}),c(l)||(this.plotLeft+=e[3]),c(o)||(this.plotTop+=e[0]),c(h)||(this.marginBottom+=e[2]),c(r)||(this.marginRight+=e[1]),this.setChartSize()},initReflow:function(){function e(e){var s=n.width||Ye(a,"width"),o=n.height||Ye(a,"height"),e=e?e.target:re;s&&o&&(e===re||e===le)&&((s!==i.containerWidth||o!==i.containerHeight)&&(clearTimeout(t),i.reflowTimeout=t=setTimeout(function(){i.container&&i.resize(s,o,!1)},100)),i.containerWidth=s,i.containerHeight=o)}var t,i=this,n=i.options.chart,a=i.renderTo;it(re,"resize",e),it(i,"destroy",function(){nt(re,"resize",e)})},resize:function(e,t,i){var n,a,s,o=this,l=o.resetZoomButton,r=o.title,h=o.subtitle;o.isResizing+=1,s=function(){o&&at(o,"endResize",null,function(){o.isResizing-=1})},G(i,o),o.oldChartHeight=o.chartHeight,o.oldChartWidth=o.chartWidth,c(e)&&(o.chartWidth=n=ce(e)),c(t)&&(o.chartHeight=a=ce(t)),g(o.container,{width:n+"px",height:a+"px"}),o.renderer.setSize(n,a,i),o.plotWidth=n-o.plotLeft-o.marginRight,o.plotHeight=a-o.plotTop-o.marginBottom,o.maxTicks=null,Ke(o.axes,function(e){e.isDirty=!0,e.setScale()}),Ke(o.series,function(e){e.isDirty=!0}),o.isDirtyLegend=!0,o.isDirtyBox=!0,o.getMargins(),e=o.spacingBox,r&&r.align(null,null,e),h&&h.align(null,null,e),l&&l.align&&l.align(null,null,o[l.alignTo]),o.redraw(i),o.oldChartHeight=null,at(o,"resize"),V===!1?s():setTimeout(s,V&&V.duration||500)},setChartSize:function(){var e,t,i,n,a=this.inverted,s=this.chartWidth,o=this.chartHeight,l=this.options.chart,r=l.spacingTop,h=l.spacingRight,c=l.spacingBottom,d=l.spacingLeft;this.plotLeft=e=ce(this.plotLeft),this.plotTop=t=ce(this.plotTop),this.plotWidth=i=ce(s-e-this.marginRight),this.plotHeight=n=ce(o-t-this.marginBottom),this.plotSizeX=a?n:i,this.plotSizeY=a?i:n,this.plotBorderWidth=a=l.plotBorderWidth||0,this.spacingBox={x:d,y:r,width:s-d-h,height:o-r-c},this.plotBox={x:e,y:t,width:i,height:n},this.clipBox={x:a/2,y:a/2,width:this.plotSizeX-a,height:this.plotSizeY-a},Ke(this.axes,function(e){e.setAxisSize(),e.setAxisTranslation()})},resetMargins:function(){var e=this.options.chart,t=e.spacingRight,i=e.spacingBottom,n=e.spacingLeft;this.plotTop=p(this.optionsMarginTop,e.spacingTop),this.marginRight=p(this.optionsMarginRight,t),this.marginBottom=p(this.optionsMarginBottom,i),this.plotLeft=p(this.optionsMarginLeft,n),this.axisOffset=[0,0,0,0]},drawChartBox:function(){var e,t=this.options.chart,i=this.renderer,n=this.chartWidth,a=this.chartHeight,s=this.chartBackground,o=this.plotBackground,l=this.plotBorder,r=this.plotBGImage,h=t.borderWidth||0,c=t.backgroundColor,d=t.plotBackgroundColor,u=t.plotBackgroundImage,p=t.plotBorderWidth||0,g=this.plotLeft,f=this.plotTop,m=this.plotWidth,v=this.plotHeight,y=this.plotBox,b=this.clipRect,w=this.clipBox;e=h+(t.shadow?8:0),(h||c)&&(s?s.animate(s.crisp(null,null,null,n-e,a-e)):(s={fill:c||Fe},h&&(s.stroke=t.borderColor,s["stroke-width"]=h),this.chartBackground=i.rect(e/2,e/2,n-e,a-e,t.borderRadius,h).attr(s).add().shadow(t.shadow))),d&&(o?o.animate(y):this.plotBackground=i.rect(g,f,m,v,0).attr({fill:d}).add().shadow(t.plotShadow)),u&&(r?r.animate(y):this.plotBGImage=i.image(u,g,f,m,v).add()),b?b.animate({width:w.width,height:w.height}):this.clipRect=i.clipRect(w),p&&(l?l.animate(l.crisp(null,g,f,m,v)):this.plotBorder=i.rect(g,f,m,v,0,p).attr({stroke:t.plotBorderColor,"stroke-width":p,zIndex:1}).add()),this.isDirtyBox=!1},propFromSeries:function(){var e,t,i,n=this,a=n.options.chart,s=n.options.series;Ke(["inverted","angular","polar"],function(o){for(e=$e[a.type||a.defaultSeriesType],i=n[o]||a[o]||e&&e.prototype[o],t=s&&s.length;!i&&t--;)(e=$e[s[t].type])&&e.prototype[o]&&(i=!0);n[o]=i})},render:function(){var t,n=this,a=n.axes,s=n.renderer,o=n.options,l=o.labels,o=o.credits;n.setTitle(),n.legend=new B(n),Ke(a,function(e){e.setScale()}),n.getMargins(),n.maxTicks=null,Ke(a,function(e){e.setTickPositions(!0),e.setMaxTicks()}),n.adjustTickAmounts(),n.getMargins(),n.drawChartBox(),n.hasCartesianSeries&&Ke(a,function(e){e.render()}),n.seriesGroup||(n.seriesGroup=s.g("series-group").attr({zIndex:3}).add()),Ke(n.series,function(e){e.translate(),e.setTooltipPoints(),e.render()}),l.items&&Ke(l.items,function(t){var a=e(l.style,t.style),o=i(a.left)+n.plotLeft,r=i(a.top)+n.plotTop+12;delete a.left,delete a.top,s.text(t.html,o,r).attr({zIndex:2}).css(a).add()}),o.enabled&&!n.credits&&(t=o.href,n.credits=s.text(o.text,0,0).on("click",function(){t&&(location.href=t)}).attr({align:o.position.align,zIndex:8}).css(o.style).add().align(o.position)),n.hasRendered=!0},destroy:function(){var e,t=this,i=t.axes,n=t.series,a=t.container,s=a&&a.parentNode;for(at(t,"destroy"),nt(t),e=i.length;e--;)i[e]=i[e].destroy();for(e=n.length;e--;)n[e]=n[e].destroy();Ke("title,subtitle,chartBackground,plotBackground,plotBGImage,plotBorder,seriesGroup,clipRect,credits,tracker,scroller,rangeSelector,legend,resetZoomButton,tooltip,renderer".split(","),function(e){var i=t[e];i&&i.destroy&&(t[e]=i.destroy())}),a&&(a.innerHTML="",nt(a),s&&C(a));for(e in t)delete t[e]},firstRender:function(){var e=this,t=e.options,i=e.callback;!Ce&&re==re.top&&"complete"!==le.readyState||Ae&&!re.canvg?Ae?gt.push(function(){e.firstRender()},t.global.canvasToolsURL):le.attachEvent("onreadystatechange",function(){le.detachEvent("onreadystatechange",e.firstRender),"complete"===le.readyState&&e.firstRender()}):(e.getContainer(),at(e,"init"),Highcharts.RangeSelector&&t.rangeSelector.enabled&&(e.rangeSelector=new Highcharts.RangeSelector(e)),e.resetMargins(),e.setChartSize(),e.propFromSeries(),e.getAxes(),Ke(t.series||[],function(t){e.initSeries(t)}),Highcharts.Scroller&&(t.navigator.enabled||t.scrollbar.enabled)&&(e.scroller=new Highcharts.Scroller(e)),e.tracker=new N(e,t),e.render(),e.renderer.draw(),i&&i.apply(e,[e]),Ke(e.callbacks,function(t){t.apply(e,[e])}),e.cloneRenderTo(!0),at(e,"load"))},init:function(e){var t,i=this.options.chart;if(i.reflow!==!1&&it(this,"load",this.initReflow),e)for(t in e)it(this,t,e[t]);this.xAxis=[],this.yAxis=[],this.animation=Ae?!1:p(i.animation,!0),this.setSize=this.resize,this.pointCount=0,this.counters=new x,this.firstRender()}},U.prototype.callbacks=[];var ft=function(){};ft.prototype={init:function(e,t,i){var n=e.chart.counters;return this.series=e,this.applyOptions(t,i),this.pointAttr={},e.options.colorByPoint&&(t=e.chart.options.colors,this.color=this.color||t[n.color++],n.wrapColor(t.length)),e.chart.pointCount++,this},applyOptions:function(t,i){var n=this.series,a=typeof t;this.config=t,"number"===a||null===t?this.y=t:"number"==typeof t[0]?(this.x=t[0],this.y=t[1]):"object"===a&&"number"!=typeof t.length?(e(this,t),this.options=t,t.dataLabels&&(n._hasPointLabels=!0),t.marker&&(n._hasPointMarkers=!0)):"string"==typeof t[0]&&(this.name=t[0],this.y=t[1]),this.x===R&&(this.x=i===R?n.autoIncrement():i)},destroy:function(){var e,t=this.series.chart,i=t.hoverPoints;t.pointCount--,i&&(this.setState(),h(i,this),!i.length)&&(t.hoverPoints=null),this===t.hoverPoint&&this.onMouseOut(),(this.graphic||this.dataLabel)&&(nt(this),this.destroyElements()),this.legendItem&&t.legend.destroyItem(this);for(e in this)this[e]=null},destroyElements:function(){for(var e,t="graphic,tracker,dataLabel,group,connector,shadowGroup".split(","),i=6;i--;)e=t[i],this[e]&&(this[e]=this[e].destroy())},getLabelConfig:function(){return{x:this.category,y:this.y,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},select:function(e,t){var i=this,n=i.series.chart,e=p(e,!i.selected);i.firePointEvent(e?"select":"unselect",{accumulate:t},function(){i.selected=e,i.setState(e&&"select"),t||Ke(n.getSelectedPoints(),function(e){e.selected&&e!==i&&(e.selected=!1,e.setState(""),e.firePointEvent("unselect"))})})},onMouseOver:function(){var e=this.series,t=e.chart,i=t.tooltip,n=t.hoverPoint;n&&n!==this&&n.onMouseOut(),this.firePointEvent("mouseOver"),i&&(!i.shared||e.noSharedTooltip)&&i.refresh(this),this.setState("hover"),t.hoverPoint=this},onMouseOut:function(){var e=this.series.chart,t=e.hoverPoints;t&&-1!==Ze(this,t)||(this.firePointEvent("mouseOut"),this.setState(),e.hoverPoint=null)},tooltipFormatter:function(e){var t,i,a,s,o=this.series,l=o.tooltipOptions,r=e.match(/\{(series|point)\.[a-zA-Z]+\}/g),h=/[{\.}]/,c={y:0,open:0,high:0,low:0,close:0,percentage:1,total:1};l.valuePrefix=l.valuePrefix||l.yPrefix,l.valueDecimals=l.valueDecimals||l.yDecimals,l.valueSuffix=l.valueSuffix||l.ySuffix;for(s in r)i=r[s],n(i)&&i!==e&&(a=(" "+i).split(h),t={point:this,series:o}[a[1]],a=a[2],t===this&&c.hasOwnProperty(a)?(t=c[a]?a:"value",t=(l[t+"Prefix"]||"")+v(this[a],p(l[t+"Decimals"],-1))+(l[t+"Suffix"]||"")):t=t[a],e=e.replace(i,t));return e},update:function(e,t,i){var n,s=this,o=s.series,l=s.graphic,r=o.data,h=r.length,c=o.chart,t=p(t,!0);s.firePointEvent("update",{options:e},function(){for(s.applyOptions(e),a(e)&&(o.getAttribs(),l&&l.attr(s.pointAttr[o.state])),n=0;h>n;n++)if(r[n]===s){o.xData[n]=s.x,o.yData[n]=s.y,o.options.data[n]=e;break}o.isDirty=!0,o.isDirtyData=!0,t&&c.redraw(i)})},remove:function(e,t){var i,n=this,a=n.series,s=a.chart,o=a.data,l=o.length;G(t,s),e=p(e,!0),n.firePointEvent("remove",null,function(){for(i=0;l>i;i++)if(o[i]===n){o.splice(i,1),a.options.data.splice(i,1),a.xData.splice(i,1),a.yData.splice(i,1);break}n.destroy(),a.isDirty=!0,a.isDirtyData=!0,e&&s.redraw()})},firePointEvent:function(e,t,i){var n=this,a=this.series.options;(a.point.events[e]||n.options&&n.options.events&&n.options.events[e])&&this.importEvents(),"click"===e&&a.allowPointSelect&&(i=function(e){n.select(null,e.ctrlKey||e.metaKey||e.shiftKey)}),at(this,e,t,i)},importEvents:function(){if(!this.hasImportedEvents){var e,t=tt(this.series.options.point,this.options).events;this.events=t;for(e in t)it(this,e,t[e]);this.hasImportedEvents=!0}},setState:function(e){var t=this.plotX,i=this.plotY,n=this.series,a=n.options.states,s=rt[n.type].marker&&n.options.marker,o=s&&!s.enabled,l=s&&s.states[e],r=l&&l.enabled===!1,h=n.stateMarkerGraphic,c=n.chart,d=this.pointAttr,e=e||"";e===this.state||this.selected&&"select"!==e||a[e]&&a[e].enabled===!1||e&&(r||o&&!l.enabled)||(this.graphic?(a=s&&this.graphic.symbolName&&d[e].r,this.graphic.attr(tt(d[e],a?{x:t-a,y:i-a,width:2*a,height:2*a}:{}))):(e&&l&&(a=l.radius,h?h.attr({x:t-a,y:i-a}):n.stateMarkerGraphic=h=c.renderer.symbol(n.symbol,t-a,i-a,2*a,2*a).attr(d[e]).add(n.markerGroup)),h&&h[e&&c.isInsidePlot(t,i)?"show":"hide"]()),this.state=e)}};var mt=function(){};mt.prototype={isCartesian:!0,type:"line",pointClass:ft,sorted:!0,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},init:function(t,i){var n,a;this.chart=t,this.options=i=this.setOptions(i),this.bindAxes(),e(this,{name:i.name,state:"",pointAttr:{},visible:i.visible!==!1,selected:i.selected===!0}),Ae&&(i.animation=!1),a=i.events;for(n in a)it(this,n,a[n]);(a&&a.click||i.point&&i.point.events&&i.point.events.click||i.allowPointSelect)&&(t.runTrackerClick=!0),this.getColor(),this.getSymbol(),this.setData(i.data,!1),this.isCartesian&&(t.hasCartesianSeries=!0),t.series.push(this),T(t.series,function(e,t){return(e.options.index||0)-(t.options.index||0)}),Ke(t.series,function(e,t){e.index=t,e.name=e.name||"Series "+(t+1)})},bindAxes:function(){var e,t=this,i=t.options,n=t.chart;t.isCartesian&&Ke(["xAxis","yAxis"],function(a){Ke(n[a],function(n){e=n.options,(i[a]===e.index||i[a]===R&&0===e.index)&&(n.series.push(t),t[a]=n,n.isDirty=!0)})})},autoIncrement:function(){var e=this.options,t=this.xIncrement,t=p(t,e.pointStart,0);return this.pointInterval=p(this.pointInterval,e.pointInterval,1),this.xIncrement=t+this.pointInterval,t},getSegments:function(){var e,t=-1,i=[],n=this.points,a=n.length;if(a)if(this.options.connectNulls){for(e=a;e--;)null===n[e].y&&n.splice(e,1);n.length&&(i=[n])}else Ke(n,function(e,s){null===e.y?(s>t+1&&i.push(n.slice(t+1,s)),t=s):s===a-1&&i.push(n.slice(t+1,s+1))});this.segments=i},setOptions:function(e){var t=this.chart.options,i=t.plotOptions,n=i[this.type],a=e.data;return e.data=null,i=tt(n,i.series,e),i.data=e.data=a,this.tooltipOptions=tt(t.tooltip,i.tooltip),null===n.marker&&delete i.marker,i},getColor:function(){var e=this.options,t=this.chart.options.colors,i=this.chart.counters;this.color=e.color||!e.colorByPoint&&t[i.color++]||"gray",i.wrapColor(t.length)},getSymbol:function(){var e=this.options.marker,t=this.chart,i=t.options.symbols,t=t.counters;this.symbol=e.symbol||i[t.symbol++],/^url/.test(this.symbol)&&(e.radius=0),t.wrapSymbol(i.length)},drawLegendSymbol:function(e){var t,i=this.options,n=i.marker,a=e.options.symbolWidth,s=this.chart.renderer,o=this.legendGroup,e=e.baseline;i.lineWidth&&(t={"stroke-width":i.lineWidth},i.dashStyle&&(t.dashstyle=i.dashStyle),this.legendLine=s.path(["M",0,e-4,"L",a,e-4]).attr(t).add(o)),n&&n.enabled&&(i=n.radius,this.legendSymbol=s.symbol(this.symbol,a/2-i,e-4-i,2*i,2*i).add(o))},addPoint:function(e,t,i,n){var a=this.data,s=this.graph,o=this.area,l=this.chart,r=this.xData,h=this.yData,c=s&&s.shift||0,d=this.options.data,u=this.pointClass.prototype;G(n,l),s&&i&&(s.shift=c+1),o&&(i&&(o.shift=c+1),o.isArea=!0),t=p(t,!0),n={series:this},u.applyOptions.apply(n,[e]),r.push(n.x),h.push(u.toYData?u.toYData.call(n):n.y),d.push(e),i&&(a[0]&&a[0].remove?a[0].remove(!1):(a.shift(),r.shift(),h.shift(),d.shift())),this.getAttribs(),this.isDirtyData=this.isDirty=!0,t&&l.redraw()},setData:function(e,t){var i,a=this.points,l=this.options,r=this.initialColor,h=this.chart,d=null,u=this.xAxis,g=this.pointClass.prototype;this.xIncrement=null,this.pointRange=u&&u.categories?1:l.pointRange,c(r)&&(h.counters.color=r);var r=[],f=[],m=e?e.length:[],v=(i=this.pointArrayMap)&&i.length;if(m>(l.turboThreshold||1e3)){for(i=0;null===d&&m>i;)d=e[i],i++;if(o(d)){for(g=p(l.pointStart,0),l=p(l.pointInterval,1),i=0;m>i;i++)r[i]=g,f[i]=e[i],g+=l;this.xIncrement=g}else if(s(d))if(v)for(i=0;m>i;i++)l=e[i],r[i]=l[0],f[i]=l.slice(1,v+1);else for(i=0;m>i;i++)l=e[i],r[i]=l[0],f[i]=l[1]}else for(i=0;m>i;i++)l={series:this},g.applyOptions.apply(l,[e[i]]),r[i]=l.x,f[i]=g.toYData?g.toYData.call(l):l.y;for(n(f[0])&&D(14,!0),this.data=[],this.options.data=e,this.xData=r,this.yData=f,i=a&&a.length||0;i--;)a[i]&&a[i].destroy&&a[i].destroy();u&&(u.minRange=u.userMinRange),this.isDirty=this.isDirtyData=h.isDirtyBox=!0,p(t,!0)&&h.redraw(!1)},remove:function(e,t){var i=this,n=i.chart,e=p(e,!0);i.isRemoving||(i.isRemoving=!0,at(i,"remove",null,function(){i.destroy(),n.isDirtyLegend=n.isDirtyBox=!0,e&&n.redraw(t)})),i.isRemoving=!1},processData:function(e){var t,i,n=this.xData,a=this.yData,s=n.length,o=0,l=s,r=this.xAxis,h=this.options,c=h.cropThreshold,d=this.isCartesian;if(d&&!this.isDirty&&!r.isDirty&&!this.yAxis.isDirty&&!e)return!1;if(d&&this.sorted&&(!c||s>c||this.forceCrop))if(e=r.getExtremes(),r=e.min,c=e.max,n[s-1]<r||n[0]>c)n=[],a=[];else if(n[0]<r||n[s-1]>c){for(e=0;s>e;e++)if(n[e]>=r){o=pe(0,e-1);break}for(;s>e;e++)if(n[e]>c){l=e+1;break}n=n.slice(o,l),a=a.slice(o,l),t=!0}for(e=n.length-1;e>0;e--)s=n[e]-n[e-1],s>0&&(i===R||i>s)&&(i=s);this.cropped=t,this.cropStart=o,this.processedXData=n,this.processedYData=a,null===h.pointRange&&(this.pointRange=i||1),this.closestPointRange=i},generatePoints:function(){var e,t,i,n,a=this.options.data,s=this.data,o=this.processedXData,l=this.processedYData,r=this.pointClass,h=o.length,c=this.cropStart||0,d=this.hasGroupedData,p=[];for(s||d||(s=[],s.length=a.length,s=this.data=s),n=0;h>n;n++)t=c+n,d?p[n]=(new r).init(this,[o[n]].concat(u(l[n]))):(s[t]?i=s[t]:a[t]!==R&&(s[t]=i=(new r).init(this,a[t],o[n])),p[n]=i);if(s&&(h!==(e=s.length)||d))for(n=0;e>n;n++)n===c&&!d&&(n+=h),s[n]&&(s[n].destroyElements(),s[n].plotX=R);this.data=s,this.points=p},translate:function(){this.processedXData||this.processData(),this.generatePoints();for(var e,t=this.chart,i=this.options,n=i.stacking,a=this.xAxis,s=a.categories,o=this.yAxis,l=this.points,r=l.length,h=!!this.modifyValue,d=o.series,u=d.length,g="between"===i.pointPlacement;u--;)if(d[u].visible){d[u]===this&&(e=!0);break}for(u=0;r>u;u++){var d=l[u],f=d.x,m=d.y,v=d.low,y=o.stacks[(m<i.threshold?"-":"")+this.stackKey];d.plotX=a.translate(f,0,0,0,1,g),n&&this.visible&&y&&y[f]&&(v=y[f],f=v.total,v.cum=v=v.cum-m,m=v+m,e&&(v=p(i.threshold,o.min)),o.isLog&&0>=v&&(v=null),"percent"===n&&(v=f?100*v/f:0,m=f?100*m/f:0),d.percentage=f?100*d.y/f:0,d.total=d.stackTotal=f,d.stackY=m),d.yBottom=c(v)?o.translate(v,0,1,0,1):null,h&&(m=this.modifyValue(m,d)),d.plotY="number"==typeof m?ce(10*o.translate(m,0,1,0,1))/10:R,d.clientX=t.inverted?t.plotHeight-d.plotX:d.plotX,d.category=s&&s[d.x]!==R?s[d.x]:d.x}this.getSegments()},setTooltipPoints:function(e){var t,i,n,a,s=[],o=(t=this.xAxis)?t.tooltipLen||t.len:this.chart.plotSizeX,l=t&&t.tooltipPosName||"plotX",r=[];if(this.options.enableMouseTracking!==!1){for(e&&(this.tooltipPoints=null),Ke(this.segments||this.points,function(e){s=s.concat(e)}),t&&t.reversed&&(s=s.reverse()),e=s.length,a=0;e>a;a++)for(n=s[a],t=s[a-1]?i+1:0,i=s[a+1]?pe(0,de((n[l]+(s[a+1]?s[a+1][l]:o))/2)):o;t>=0&&i>=t;)r[t++]=n;this.tooltipPoints=r}},tooltipHeaderFormatter:function(e){var t,i=this.tooltipOptions,n=i.xDateFormat,a=this.xAxis,s=a&&"datetime"===a.options.type;if(s&&!n)for(t in Y)if(Y[t]>=a.closestPointRange){n=i.dateTimeLabelFormats[t];break}return i.headerFormat.replace("{point.key}",s&&o(e)?$(n,e):e).replace("{series.name}",this.name).replace("{series.color}",this.color)},onMouseOver:function(){var e=this.chart,t=e.hoverSeries;t&&t!==this&&t.onMouseOut(),this.options.events.mouseOver&&at(this,"mouseOver"),this.setState("hover"),e.hoverSeries=this},onMouseOut:function(){var e=this.options,t=this.chart,i=t.tooltip,n=t.hoverPoint;n&&n.onMouseOut(),this&&e.events.mouseOut&&at(this,"mouseOut"),i&&!e.stickyTracking&&!i.shared&&i.hide(),this.setState(),t.hoverSeries=null},animate:function(t){var i,n=this,s=n.chart,o=s.renderer;i=n.options.animation;var l,r=s.clipBox,h=s.inverted;i&&!a(i)&&(i=rt[n.type].animation),l="_sharedClip"+i.duration+i.easing,t?(t=s[l],i=s[l+"m"],t||(s[l]=t=o.clipRect(e(r,{width:0})),s[l+"m"]=i=o.clipRect(-99,h?-s.plotLeft:-s.plotTop,99,h?s.chartWidth:s.chartHeight)),n.group.clip(t),n.markerGroup.clip(i),n.sharedClipKey=l):((t=s[l])&&(t.animate({width:s.plotSizeX},i),s[l+"m"].animate({width:s.plotSizeX+99},i)),n.animate=null,n.animationTimeout=setTimeout(function(){n.afterAnimate()},i.duration))},afterAnimate:function(){var e=this.chart,t=this.sharedClipKey,i=this.group;i&&this.options.clip!==!1&&(i.clip(e.clipRect),this.markerGroup.clip()),setTimeout(function(){t&&e[t]&&(e[t]=e[t].destroy(),e[t+"m"]=e[t+"m"].destroy())},100)},drawPoints:function(){var t,i,n,a,s,o,l,r,h,c,d=this.points,u=this.chart,g=this.options.marker,f=this.markerGroup;if(g.enabled||this._hasPointMarkers)for(a=d.length;a--;)s=d[a],i=s.plotX,n=s.plotY,h=s.graphic,l=s.marker||{},t=g.enabled&&l.enabled===R||l.enabled,c=u.isInsidePlot(i,n,u.inverted),t&&n!==R&&!isNaN(n)?(t=s.pointAttr[s.selected?"select":""],o=t.r,l=p(l.symbol,this.symbol),r=0===l.indexOf("url"),h?h.attr({visibility:c?Ce?"inherit":"visible":"hidden"}).animate(e({x:i-o,y:n-o},h.symbolName?{width:2*o,height:2*o}:{})):c&&(o>0||r)&&(s.graphic=u.renderer.symbol(l,i-o,n-o,2*o,2*o).attr(t).add(f))):h&&(s.graphic=h.destroy())},convertAttribs:function(e,t,i,n){var a,s,o=this.pointAttrToOptions,l={},e=e||{},t=t||{},i=i||{},n=n||{};for(a in o)s=o[a],l[a]=p(e[s],t[a],i[a],n[a]);return l},getAttribs:function(){var t,i,n,a=this,s=rt[a.type].marker?a.options.marker:a.options,o=s.states,l=o.hover,r=a.color,h={stroke:r,fill:r},d=a.points||[],u=[],p=a.pointAttrToOptions;for(a.options.marker?(l.radius=l.radius||s.radius+2,l.lineWidth=l.lineWidth||s.lineWidth+1):l.color=l.color||ht(l.color||r).brighten(l.brightness).get(),u[""]=a.convertAttribs(s,h),Ke(["hover","select"],function(e){u[e]=a.convertAttribs(o[e],u[""])}),a.pointAttr=u,r=d.length;r--;){if(h=d[r],(s=h.options&&h.options.marker||h.options)&&s.enabled===!1&&(s.radius=0),t=a.options.colorByPoint,h.options)for(n in p)c(s[p[n]])&&(t=!0);t?(s=s||{},i=[],o=s.states||{},t=o.hover=o.hover||{},a.options.marker||(t.color=ht(t.color||h.color).brighten(t.brightness||l.brightness).get()),i[""]=a.convertAttribs(e({color:h.color},s),u[""]),i.hover=a.convertAttribs(o.hover,u.hover,i[""]),i.select=a.convertAttribs(o.select,u.select,i[""])):i=u,h.pointAttr=i}},destroy:function(){var e,t,i,n,a,s=this,o=s.chart,l=/AppleWebKit\/533/.test(we),r=s.data||[];for(at(s,"destroy"),nt(s),Ke(["xAxis","yAxis"],function(e){(a=s[e])&&(h(a.series,s),a.isDirty=!0)}),s.legendItem&&s.chart.legend.destroyItem(s),t=r.length;t--;)(i=r[t])&&i.destroy&&i.destroy();s.points=null,clearTimeout(s.animationTimeout),Ke("area,graph,dataLabelsGroup,group,markerGroup,tracker,trackerGroup".split(","),function(t){s[t]&&(e=l&&"group"===t?"hide":"destroy",s[t][e]())}),o.hoverSeries===s&&(o.hoverSeries=null),h(o.series,s);for(n in s)delete s[n]},drawDataLabels:function(){var e,t,i,n,a=this,s=a.options.dataLabels,o=a.points;(s.enabled||a._hasPointLabels)&&(a.dlProcessOptions&&a.dlProcessOptions(s),n=a.plotGroup("dataLabelsGroup","data-labels",a.visible?"visible":"hidden",6),t=s,Ke(o,function(o){var l,r,h=o.dataLabel,d=!0;if(e=o.options&&o.options.dataLabels,l=t.enabled||e&&e.enabled,h&&!l)o.dataLabel=h.destroy();else if(l){if(l=s.rotation,s=tt(t,e),i=s.formatter.call(o.getLabelConfig(),s),s.style.color=p(s.color,s.style.color,a.color,"black"),h)h.attr({text:i}),d=!1;else if(c(i)){h={fill:s.backgroundColor,stroke:s.borderColor,"stroke-width":s.borderWidth,r:s.borderRadius||0,rotation:l,padding:s.padding,zIndex:1};for(r in h)h[r]===R&&delete h[r];h=o.dataLabel=a.chart.renderer[l?"text":"label"](i,0,-999,null,null,null,s.useHTML).attr(h).css(s.style).add(n).shadow(s.shadow)}h&&a.alignDataLabel(o,h,s,null,d)}}))},alignDataLabel:function(t,i,n,a,s){var o=this.chart,l=o.inverted,r=p(t.plotX,-999),t=p(t.plotY,-999),h=i.getBBox(),a=e({x:l?o.plotWidth-t:r,y:ce(l?o.plotHeight-r:t),width:0,height:0},a);e(n,{width:h.width,height:h.height}),n.rotation?(a={align:n.align,x:a.x+n.x+a.width/2,y:a.y+n.y+a.height/2},i[s?"attr":"animate"](a)):(i.align(n,null,a),a=i.alignAttr),i.attr({visibility:n.crop===!1||o.isInsidePlot(a.x,a.y)||o.isInsidePlot(r,t,l)?Ce?"inherit":"visible":"hidden"})},getSegmentPath:function(e){var t=this,i=[];return Ke(e,function(n,a){t.getPointSpline?i.push.apply(i,t.getPointSpline(e,n,a)):(i.push(a?"L":"M"),a&&t.options.step&&i.push(n.plotX,e[a-1].plotY),i.push(n.plotX,n.plotY))}),i},getGraphPath:function(){var e,t=this,i=[],n=[];return Ke(t.segments,function(a){e=t.getSegmentPath(a),a.length>1?i=i.concat(e):n.push(a[0])}),t.singlePoints=n,t.graphPath=i},drawGraph:function(){var e=this.options,t=this.graph,i=this.group,n=e.lineColor||this.color,a=e.lineWidth,s=e.dashStyle,o=this.getGraphPath();t?(lt(t),t.animate({d:o})):a&&(t={stroke:n,"stroke-width":a,zIndex:1},s&&(t.dashstyle=s),this.graph=this.chart.renderer.path(o).attr(t).add(i).shadow(e.shadow))},invertGroups:function(){function e(){var e={width:t.yAxis.len,height:t.xAxis.len};Ke(["group","trackerGroup","markerGroup"],function(i){t[i]&&t[i].attr(e).invert()})}var t=this,i=t.chart;it(i,"resize",e),it(t,"destroy",function(){nt(i,"resize",e)}),e(),t.invertGroups=e},plotGroup:function(e,t,i,n,a){var s=this[e],o=this.chart,l=this.xAxis,r=this.yAxis;return s||(this[e]=s=o.renderer.g(t).attr({visibility:i,zIndex:n||.1}).add(a)),s.translate(l?l.left:o.plotLeft,r?r.top:o.plotTop),s},render:function(){var e,t=this.chart,i=this.options,n=i.animation&&!!this.animate,a=this.visible?"visible":"hidden",s=i.zIndex,o=this.hasRendered,l=t.seriesGroup;e=this.plotGroup("group","series",a,s,l),this.markerGroup=this.plotGroup("markerGroup","markers",a,s,l),n&&this.animate(!0),this.getAttribs(),e.inverted=t.inverted,this.drawGraph&&this.drawGraph(),this.drawPoints(),this.drawDataLabels(),this.options.enableMouseTracking!==!1&&this.drawTracker(),t.inverted&&this.invertGroups(),i.clip!==!1&&!this.sharedClipKey&&!o&&(e.clip(t.clipRect),this.trackerGroup&&this.trackerGroup.clip(t.clipRect)),n?this.animate():o||this.afterAnimate(),this.isDirty=this.isDirtyData=!1,this.hasRendered=!0},redraw:function(){var e=this.chart,t=this.isDirtyData,i=this.group;i&&(e.inverted&&i.attr({width:e.plotWidth,height:e.plotHeight}),i.animate({translateX:this.xAxis.left,translateY:this.yAxis.top})),this.translate(),this.setTooltipPoints(!0),this.render(),t&&at(this,"updatedData")},setState:function(e){var t=this.options,i=this.graph,n=t.states,t=t.lineWidth,e=e||"";this.state!==e&&(this.state=e,n[e]&&n[e].enabled===!1||(e&&(t=n[e].lineWidth||t+1),i&&!i.dashstyle&&i.attr({"stroke-width":t},e?0:500)))},setVisible:function(e,t){var i,n=this.chart,a=this.legendItem,s=this.group,o=this.tracker,l=this.dataLabelsGroup,r=this.markerGroup,h=this.points,c=n.options.chart.ignoreHiddenSeries;
if(i=this.visible,i=(this.visible=e=e===R?!i:e)?"show":"hide",s&&s[i](),r&&r[i](),o)o[i]();else if(h)for(s=h.length;s--;)o=h[s],o.tracker&&o.tracker[i]();l&&l[i](),a&&n.legend.colorizeItem(this,e),this.isDirty=!0,this.options.stacking&&Ke(n.series,function(e){e.options.stacking&&e.visible&&(e.isDirty=!0)}),c&&(n.isDirtyBox=!0),t!==!1&&n.redraw(),at(this,i)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(e){this.selected=e=e===R?!this.selected:e,this.checkbox&&(this.checkbox.checked=e),at(this,e?"select":"unselect")},drawTracker:function(){var e,t=this,i=t.options,n=i.trackByArea,a=[].concat(n?t.areaPath:t.graphPath),s=a.length,o=t.chart,l=o.renderer,r=o.options.tooltip.snap,h=t.tracker,c=i.cursor,c=c&&{cursor:c},d=t.singlePoints,u=this.isCartesian&&this.plotGroup("trackerGroup",null,"visible",i.zIndex||1,o.trackerGroup);if(s&&!n)for(e=s+1;e--;)"M"===a[e]&&a.splice(e+1,0,a[e+1]-r,a[e+2],"L"),(e&&"M"===a[e]||e===s)&&a.splice(e,0,"L",a[e-2]+r,a[e-1]);for(e=0;e<d.length;e++)s=d[e],a.push("M",s.plotX-r,s.plotY,"L",s.plotX+r,s.plotY);h?h.attr({d:a}):t.tracker=l.path(a).attr({isTracker:!0,"stroke-linejoin":"bevel",visibility:t.visible?"visible":"hidden",stroke:Oe,fill:n?Oe:Fe,"stroke-width":i.lineWidth+(n?0:2*r)}).on(Ge?"touchstart":"mouseover",function(){o.hoverSeries!==t&&t.onMouseOver()}).on("mouseout",function(){i.stickyTracking||t.onMouseOut()}).css(c).add(u)}},qe=m(mt),$e.line=qe,rt.area=tt(Ve,{threshold:0}),qe=m(mt,{type:"area",getSegmentPath:function(e){var t,i=mt.prototype.getSegmentPath.call(this,e),n=[].concat(i),a=this.options;if(3===i.length&&n.push("L",i[1],i[2]),a.stacking&&!this.closedStacks)for(t=e.length-1;t>=0;t--)t<e.length-1&&a.step&&n.push(e[t+1].plotX,e[t].yBottom),n.push(e[t].plotX,e[t].yBottom);else this.closeSegment(n,e);return this.areaPath=this.areaPath.concat(n),i},closeSegment:function(e,t){var i=this.yAxis.getThreshold(this.options.threshold);e.push("L",t[t.length-1].plotX,i,"L",t[0].plotX,i)},drawGraph:function(){this.areaPath=[],mt.prototype.drawGraph.apply(this);var e=this.areaPath,t=this.options,i=this.area;i?i.animate({d:e}):this.area=this.chart.renderer.path(e).attr({fill:p(t.fillColor,ht(this.color).setOpacity(t.fillOpacity||.75).get()),zIndex:0}).add(this.group)},drawLegendSymbol:function(e,t){t.legendSymbol=this.chart.renderer.rect(0,e.baseline-11,e.options.symbolWidth,12,2).attr({zIndex:3}).add(t.legendGroup)}}),$e.area=qe,rt.spline=tt(Ve),ut=m(mt,{type:"spline",getPointSpline:function(e,t,i){var n,a,s,o,l=t.plotX,r=t.plotY,h=e[i-1],c=e[i+1];if(h&&c){e=h.plotY,s=c.plotX;var d,c=c.plotY;n=(1.5*l+h.plotX)/2.5,a=(1.5*r+e)/2.5,s=(1.5*l+s)/2.5,o=(1.5*r+c)/2.5,d=(o-a)*(s-l)/(s-n)+r-o,a+=d,o+=d,a>e&&a>r?(a=pe(e,r),o=2*r-a):e>a&&r>a&&(a=ge(e,r),o=2*r-a),o>c&&o>r?(o=pe(c,r),a=2*r-o):c>o&&r>o&&(o=ge(c,r),a=2*r-o),t.rightContX=s,t.rightContY=o}return i?(t=["C",h.rightContX||h.plotX,h.rightContY||h.plotY,n||l,a||r,l,r],h.rightContX=h.rightContY=null):t=["M",l,r],t}}),$e.spline=ut,rt.areaspline=tt(rt.area);var vt=qe.prototype,ut=m(ut,{type:"areaspline",closedStacks:!0,getSegmentPath:vt.getSegmentPath,closeSegment:vt.closeSegment,drawGraph:vt.drawGraph});$e.areaspline=ut,rt.column=tt(Ve,{borderColor:"#FFFFFF",borderWidth:1,borderRadius:0,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{brightness:.1,shadow:!1},select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}},dataLabels:{align:null,verticalAlign:null,y:null},threshold:0}),ut=m(mt,{type:"column",tooltipOutsidePlot:!0,pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color",r:"borderRadius"},init:function(){mt.prototype.init.apply(this,arguments);var e=this,t=e.chart;t.hasRendered&&Ke(t.series,function(t){t.type===e.type&&(t.isDirty=!0)})},translate:function(){var e,t,i=this,n=i.chart,a=i.options,s=a.stacking,o=a.borderWidth,l=0,r=i.xAxis,h=r.reversed,d={};mt.prototype.translate.apply(i),a.grouping===!1?l=1:Ke(n.series,function(n){var a=n.options;n.type===i.type&&n.visible&&i.options.group===a.group&&(a.stacking?(e=n.stackKey,d[e]===R&&(d[e]=l++),t=d[e]):a.grouping!==!1&&(t=l++),n.columnIndex=t)});var u=i.points,r=fe(r.transA)*(r.ordinalSlope||a.pointRange||r.closestPointRange||1),g=r*a.groupPadding,f=(r-2*g)/l,m=a.pointWidth,v=c(m)?(f-m)/2:f*a.pointPadding,y=p(m,f-2*v),b=ue(pe(y,1+2*o)),w=v+(g+((h?l-i.columnIndex:i.columnIndex)||0)*f-r/2)*(h?-1:1),_=i.translatedThreshold=i.yAxis.getThreshold(a.threshold),x=p(a.minPointLength,5);Ke(u,function(e){var t=e.plotY,a=p(e.yBottom,_),l=e.plotX+w,r=ue(ge(t,a)),h=ue(pe(t,a)-r),c=i.yAxis.stacks[(e.y<0?"-":"")+i.stackKey];s&&i.visible&&c&&c[e.x]&&c[e.x].setOffset(w,b),fe(h)<x&&x&&(h=x,r=fe(r-_)>x?a-x:_-(_>=t?x:0)),e.barX=l,e.pointWidth=y,e.shapeType="rect",e.shapeArgs=t=n.renderer.Element.prototype.crisp.call(0,o,l,r,b,h),o%2&&(t.y-=1,t.height+=1),e.trackerArgs=fe(h)<3&&tt(e.shapeArgs,{height:6,y:r-3})})},getSymbol:Ie,drawLegendSymbol:qe.prototype.drawLegendSymbol,drawGraph:Ie,drawPoints:function(){var e,t=this,i=t.options,n=t.chart.renderer;Ke(t.points,function(a){var s=a.plotY,o=a.graphic;s===R||isNaN(s)||null===a.y?o&&(a.graphic=o.destroy()):(e=a.shapeArgs,o?(lt(o),o.animate(tt(e))):a.graphic=n[a.shapeType](e).attr(a.pointAttr[a.selected?"select":""]).add(t.group).shadow(i.shadow,null,i.stacking&&!i.borderRadius))})},drawTracker:function(){var e,t,i,n,a,s=this,o=s.chart,l=o.renderer,r=+new Date,h=s.options,c=h.cursor,u=c&&{cursor:c},p=s.isCartesian&&s.plotGroup("trackerGroup",null,"visible",h.zIndex||1,o.trackerGroup);Ke(s.points,function(c){t=c.tracker,e=c.trackerArgs||c.shapeArgs,n=c.plotY,a=!s.isCartesian||n!==R&&!isNaN(n),delete e.strokeWidth,null!==c.y&&a&&(t?t.attr(e):c.tracker=l[c.shapeType](e).attr({isTracker:r,fill:Oe,visibility:s.visible?"visible":"hidden"}).on(Ge?"touchstart":"mouseover",function(e){i=e.relatedTarget||e.fromElement,o.hoverSeries!==s&&d(i,"isTracker")!==r&&s.onMouseOver(),c.onMouseOver()}).on("mouseout",function(e){h.stickyTracking||(i=e.relatedTarget||e.toElement,d(i,"isTracker")===r)||s.onMouseOut()}).css(u).add(c.group||p))})},alignDataLabel:function(e,t,i,n,a){var s=this.chart,o=s.inverted,l=e.below||e.plotY>(this.translatedThreshold||s.plotSizeY),r=this.options.stacking||i.inside;e.shapeArgs&&(n=tt(e.shapeArgs),o&&(n={x:s.plotWidth-n.y-n.height,y:s.plotHeight-n.x-n.width,width:n.height,height:n.width}),!r)&&(o?(n.x+=l?0:n.width,n.width=0):(n.y+=l?n.height:0,n.height=0)),i.align=p(i.align,!o||r?"center":l?"right":"left"),i.verticalAlign=p(i.verticalAlign,o||r?"middle":l?"top":"bottom"),mt.prototype.alignDataLabel.call(this,e,t,i,n,a)},animate:function(e){var t=this,i=t.points,n=t.options;e||(Ke(i,function(e){var i=e.graphic,e=e.shapeArgs,a=t.yAxis,s=n.threshold;i&&(i.attr({height:0,y:c(s)?a.getThreshold(s):a.translate(a.getExtremes().min,0,1,0,1)}),i.animate({height:e.height,y:e.y},n.animation))}),t.animate=null)},remove:function(){var e=this,t=e.chart;t.hasRendered&&Ke(t.series,function(t){t.type===e.type&&(t.isDirty=!0)}),mt.prototype.remove.apply(e,arguments)}}),$e.column=ut,rt.bar=tt(rt.column),vt=m(ut,{type:"bar",inverted:!0}),$e.bar=vt,rt.scatter=tt(Ve,{lineWidth:0,states:{hover:{lineWidth:0}},tooltip:{headerFormat:'<span style="font-size: 10px; color:{series.color}">{series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}}),vt=m(mt,{type:"scatter",sorted:!1,translate:function(){var e=this;mt.prototype.translate.apply(e),Ke(e.points,function(t){t.shapeType="circle",t.shapeArgs={x:t.plotX,y:t.plotY,r:e.chart.options.tooltip.snap}})},drawTracker:function(){for(var e,t=this,i=t.options.cursor,i=i&&{cursor:i},n=t.points,a=n.length;a--;)(e=n[a].graphic)&&(e.element._i=a);t._hasTracking?t._hasTracking=!0:t.markerGroup.attr({isTracker:!0}).on(Ge?"touchstart":"mouseover",function(e){t.onMouseOver(),e.target._i!==R&&n[e.target._i].onMouseOver()}).on("mouseout",function(){t.options.stickyTracking||t.onMouseOut()}).css(i)}}),$e.scatter=vt,rt.pie=tt(Ve,{borderColor:"#FFFFFF",borderWidth:1,center:["50%","50%"],colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.point.name}},legendType:"point",marker:null,size:"75%",showInLegend:!1,slicedOffset:10,states:{hover:{brightness:.1,shadow:!1}}}),Ie={type:"pie",isCartesian:!1,pointClass:m(ft,{init:function(){ft.prototype.init.apply(this,arguments);var t,i=this;return e(i,{visible:i.visible!==!1,name:p(i.name,"Slice")}),t=function(){i.slice()},it(i,"select",t),it(i,"unselect",t),i},setVisible:function(e){var t,i=this.series,n=i.chart,a=this.tracker,s=this.dataLabel,o=this.connector,l=this.shadowGroup;t=(this.visible=e=e===R?!this.visible:e)?"show":"hide",this.group[t](),a&&a[t](),s&&s[t](),o&&o[t](),l&&l[t](),this.legendItem&&n.legend.colorizeItem(this,e),!i.isDirty&&i.options.ignoreHiddenPoint&&(i.isDirty=!0,n.redraw())},slice:function(e,t,i){var n=this.series.chart,a=this.slicedTranslation;G(i,n),p(t,!0),e=this.sliced=c(e)?e:!this.sliced,e={translateX:e?a[0]:n.plotLeft,translateY:e?a[1]:n.plotTop},this.group.animate(e),this.shadowGroup&&this.shadowGroup.animate(e)}}),pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},getColor:function(){this.initialColor=this.chart.counters.color},animate:function(){var e=this;Ke(e.points,function(t){var i=t.graphic,t=t.shapeArgs,n=-ye/2;i&&(i.attr({r:0,start:n,end:n}),i.animate({r:t.r,start:t.start,end:t.end},e.options.animation))}),e.animate=null},setData:function(e,t){mt.prototype.setData.call(this,e,!1),this.processData(),this.generatePoints(),p(t,!0)&&this.chart.redraw()},getCenter:function(){var e,t=this.options,n=this.chart,a=n.plotWidth,s=n.plotHeight,t=t.center.concat([t.size,t.innerSize||0]),o=ge(a,s);return et(t,function(t,n){return(e=/%$/.test(t))?[a,s,o,o][n]*i(t)/100:t})},translate:function(){this.generatePoints();var e,t,i,n,a,s,o=0,l=-.25,r=this.options,h=r.slicedOffset,c=h+r.borderWidth,d=this.chart,u=this.points,p=2*ye,g=r.dataLabels.distance,f=r.ignoreHiddenPoint,m=u.length;for(this.center=e=this.getCenter(),this.getX=function(t,i){return n=he.asin((t-e[1])/(e[2]/2+g)),e[0]+(i?-1:1)*me(n)*(e[2]/2+g)},a=0;m>a;a++)s=u[a],o+=f&&!s.visible?0:s.y;for(a=0;m>a;a++)s=u[a],r=o?s.y/o:0,t=ce(l*p*1e3)/1e3,(!f||s.visible)&&(l+=r),i=ce(l*p*1e3)/1e3,s.shapeType="arc",s.shapeArgs={x:e[0],y:e[1],r:e[2]/2,innerR:e[3]/2,start:t,end:i},n=(i+t)/2,s.slicedTranslation=et([me(n)*h+d.plotLeft,ve(n)*h+d.plotTop],ce),t=me(n)*e[2]/2,i=ve(n)*e[2]/2,s.tooltipPos=[e[0]+.7*t,e[1]+.7*i],s.labelPos=[e[0]+t+me(n)*g,e[1]+i+ve(n)*g,e[0]+t+me(n)*c,e[1]+i+ve(n)*c,e[0]+t,e[1]+i,0>g?"center":p/4>n?"left":"right",n],s.percentage=100*r,s.total=o;this.setTooltipPoints()},render:function(){this.getAttribs(),this.drawPoints(),this.options.enableMouseTracking!==!1&&this.drawTracker(),this.drawDataLabels(),this.options.animation&&this.animate&&this.animate(),this.isDirty=!1},drawPoints:function(){var t,i,n,a,s,o=this,l=o.chart,r=l.renderer,h=o.options.shadow;Ke(o.points,function(c){i=c.graphic,s=c.shapeArgs,n=c.group,a=c.shadowGroup,h&&!a&&(a=c.shadowGroup=r.g("shadow").attr({zIndex:4}).add()),n||(n=c.group=r.g("point").attr({zIndex:5}).add()),t=c.sliced?c.slicedTranslation:[l.plotLeft,l.plotTop],n.translate(t[0],t[1]),a&&a.translate(t[0],t[1]),i?i.animate(s):c.graphic=i=r.arc(s).setRadialReference(o.center).attr(e(c.pointAttr[""],{"stroke-linejoin":"round"})).add(c.group).shadow(h,a),c.visible===!1&&c.setVisible(!1)})},drawDataLabels:function(){var e,t,i,n,a,s,o,l,r=this.data,h=this.chart,c=this.options.dataLabels,d=p(c.connectorPadding,10),u=p(c.connectorWidth,1),g=p(c.softConnector,!0),f=c.distance,m=this.center,v=m[2]/2,y=m[1],b=f>0,w=[[],[]],_=2;if(c.enabled||this._hasPointLabels)for(mt.prototype.drawDataLabels.apply(this),Ke(r,function(e){e.dataLabel&&w[e.labelPos[7]<ye/2?0:1].push(e)}),w[1].reverse(),o=function(e,t){return t.y-e.y},r=w[0][0]&&w[0][0].dataLabel&&(w[0][0].dataLabel.getBBox().height||21);_--;){var x,T=[],k=[],S=w[_],M=S.length;if(f>0){for(l=y-v-f;y+v+f>=l;l+=r)T.push(l);if(s=T.length,M>s){for(i=[].concat(S),i.sort(o),l=M;l--;)i[l].rank=l;for(l=M;l--;)S[l].rank>=s&&S.splice(l,1);M=S.length}for(l=0;M>l;l++){for(e=S[l],i=e.labelPos,e=9999,a=0;s>a;a++)t=fe(T[a]-i[1]),e>t&&(e=t,x=a);if(l>x&&null!==T[l])x=l;else for(M-l+x>s&&null!==T[l]&&(x=s-M+l);null===T[x];)x++;k.push({i:x,y:T[x]}),T[x]=null}k.sort(o)}for(l=0;M>l;l++)e=S[l],i=e.labelPos,t=e.dataLabel,s=e.visible===!1?"hidden":"visible",n=i[1],f>0?(a=k.pop(),x=a.i,a=a.y,(n>a&&null!==T[x+1]||a>n&&null!==T[x-1])&&(a=n)):a=n,n=c.justify?m[0]+(_?-1:1)*(v+f):this.getX(0===x||x===T.length-1?n:a,_),t.attr({visibility:s,align:i[6]})[t.moved?"animate":"attr"]({x:n+c.x+({left:d,right:-d}[i[6]]||0),y:a+c.y-10}),t.moved=!0,b&&u&&(t=e.connector,i=g?["M",n+("left"===i[6]?5:-5),a,"C",n,a,2*i[2]-i[4],2*i[3]-i[5],i[2],i[3],"L",i[4],i[5]]:["M",n+("left"===i[6]?5:-5),a,"L",i[2],i[3],"L",i[4],i[5]],t?(t.animate({d:i}),t.attr("visibility",s)):e.connector=t=this.chart.renderer.path(i).attr({"stroke-width":u,stroke:c.connectorColor||e.color||"#606060",visibility:s,zIndex:3}).translate(h.plotLeft,h.plotTop).add())}},alignDataLabel:Ie,drawTracker:ut.prototype.drawTracker,drawLegendSymbol:qe.prototype.drawLegendSymbol,getSymbol:function(){}},Ie=m(mt,Ie),$e.pie=Ie,e(Highcharts,{Axis:O,CanVGRenderer:pt,Chart:U,Color:ht,Legend:B,MouseTracker:N,Point:ft,Tick:I,Tooltip:W,Renderer:j,Series:mt,SVGRenderer:ct,VMLRenderer:dt,dateFormat:$,pathAnim:q,getOptions:function(){return z},hasBidiBug:De,numberFormat:v,seriesTypes:$e,setOptions:function(e){return z=tt(z,e),E(),z},addEvent:it,removeEvent:nt,createElement:f,discardElement:C,css:g,each:Ke,extend:e,map:et,merge:tt,pick:p,splat:u,extendClass:m,pInt:i,wrap:function(e,t,i){var n=e[t];e[t]=function(){var e=Array.prototype.slice.call(arguments);return e.unshift(n),i.apply(this,e)}},svg:Ce,canvas:Ae,vml:!Ce&&!Ae,product:"Highcharts",version:"2.3.3"})}(),define("highcharts",["jquery"],function(e){return function(){var t;return t||e.Highcharts}}(this)),define("galileo/util/bilinearScale",[],function(){function e(e){var t=e||{},i=t.sortedDomain||!1;if(!t.range||"object"==typeof t.range&&2!==t.range.length)throw{message:"LinearScale requires a range [min, max]!",type:"IllegalArgument",toString:function(){return this.type+": "+this.message}};if(!t.domain||"object"==typeof t.domain&&t.domain.length<1)throw{message:"Domain must contain at least one value",type:"IllegalArgument",toString:function(){return this.type+": "+this.message}};var n=t.range,a=n[0],s=n[1],o=t.domain||[0],l=Number.MAX_VALUE,r=Number.MIN_VALUE;if(i)l=o[0],r=o[o.length-1];else for(var h=o.length-1;h>=0;h--)l>o[h]&&(l=o[h]),r<o[h]&&(r=o[h]);this.range=[Math.min(a,s),Math.max(a,s)],this.rangeDiff=this.range[1]-this.range[0],this.domainDiff=r-l,this.domain=[Math.min(l,r),Math.max(l,r)]}return e.prototype={fromDecimal:function(e){return"undefined"!=typeof e.length&&"object"==typeof e?e.map(this.get.bind(this)):this.range[0]+this.rangeDiff*e},fromDomain:function(e){return"undefined"!=typeof e.length&&"object"==typeof e?e.map(this.fromDomain.bind(this)):(e=Math.max(Math.min(this.domain[1],e),this.domain[0]),this.fromDecimal((e-this.domain[0])/this.domainDiff))}},e}),define("galileo/graphic/sleepMeter",["require","mootools","jquery","./sleepMeterConfig","highcharts","galileo/color/graph","moment","galileo/model/SleepModel","galileo/util/bilinearScale","i18n/i18n","i18n-load!com/fitbit/app/unit"],function(e){e("mootools");var t=e("jquery"),i=e("./sleepMeterConfig"),n=e("highcharts"),a=e("galileo/color/graph"),s=e("moment"),o=e("galileo/model/SleepModel"),l=e("galileo/util/bilinearScale"),r=e("i18n/i18n"),h=new r;h.namespace(e("i18n-load!com/fitbit/app/unit"));var c={GoalNotMet:"goalnotmet",GoalMet:"goalmet"},d=new Class({moonType:"simple",simpleMoonClass:"fitglyph fitglyph-sleep size-d",makeHappy:function(){this.moonType="happy",this.$el.removeClass(this.simpleMoonClass),this.$el.addClass("happy")},makeSimple:function(){this.moonType="simple",this.$el.removeClass("happy"),this.$el.addClass(this.simpleMoonClass)},initialize:function(e){this.$el=e,this.makeSimple()}}),u=new Class({initialize:function(e,n,a){this.renderer=null,this.$el=e,this.$parent=n,this.options=t.extend(!0,{},i,a),this.center_x=this.options.centerX,this.center_y=this.options.centerY,this.inner_radius=null,this.outer_radius=null,this.center_radius=null,this.options.chevron||(this.options.chevron=this.options.chevrons.noGoalHit),this.options.labelStyles||(this.options.labelStyles=this.options.goalLabelStyles)},render:function(e,t,i){var a,s,o,l=this.options,r=this.$el.width()||l.meterWidth,h=this.$el.height()||l.meterHeight,c=i||{},d=c.startText||"",u=c.endText||"",p=c.atBeginning||!1,g=c.drawStartChevron||!1,f=c.drawEndChevron||!1,m=c.drawBackground||!1;return this.outer_radius=(r-2*l.padding)/2,this.inner_radius=this.outer_radius-l.arcThickness,this.center_radius=this.inner_radius+l.arcThickness/2,this.renderer?a=this.renderer:(a=new n.Renderer(this.$el[0],r,h),this.renderer=a),this.group?s=this.group:(s=a.g().add(),this.group=s),m&&a.arc(this.center_x,this.center_y,this.center_radius,this.center_radius,Math.PI,2*Math.PI).attr(l.bgArcStyles).add(s),(t>0||p)&&(p?(o=this.getPosition(this.center_x,this.center_y,this.inner_radius,Math.PI),a.circle(o.x,o.y,this.outer_radius-this.inner_radius).attr({fill:l.atBeginningStyles.color}).add(s)):a.arc(this.center_x,this.center_y,this.center_radius,this.center_radius,Math.PI+Math.PI*e,Math.PI+Math.PI*e).attr(l.fgArcStyles).add(s).animate({end:Math.PI*(1+(t||.001))})),d&&this.renderText(d,0,s),u&&this.renderText(u,1,s),s.translate(l.padding,0),(g||f)&&this.drawChevrons(e,t,g,f),this},hide:function(){this.$el.hide()},show:function(){this.$el.show()},getPosition:function(e,t,i,n){return{x:e+Math.cos(n)*i,y:t+Math.sin(n)*i}},drawChevrons:function(e,t,i,n){i&&this.drawChevron(e),n&&this.drawChevron(t)},drawChevron:function(e){var t=this.getPosition(this.center_x,this.center_y,this.center_radius,Math.PI*(1+e)),i=this.renderer.g().add();this.renderer.circle(t.x,t.y,this.options.markerDiameter/2).attr({fill:this.options.chevron.color,opacity:this.options.chevron.opacity}).add(i),i.translate(this.options.padding,0)},renderText:function(e,t,i){var n=this.getPosition(this.center_x,this.center_y,this.center_radius,Math.PI*(1+t));this.renderer.text(e,n.x,n.y+this.options.endpointLabelSpacing).attr({align:"center"}).css(this.options.labelStyles).add(i)}}),p=new Class({Extends:u,initialize:function(e,t,i,n,s){this.parent(i,n,s),this.sleepOverviewModel=t,this.sleepGoalModel=e,this.summary=this.sleepOverviewModel.get("summary"),this.goalMinutes=this.sleepGoalModel.get("minDuration"),this.goalMet=this.summary.totalMinutesAsleep>=this.goalMinutes,this.goalMetExactly=this.summary.totalMinutesAsleep===this.goalMinutes,this.goalMet&&(this.options.chevron=this.options.chevrons.goalHit,this.options.fgArcStyles.stroke.stops=[[0,a.sleepMeter.goalArc[1]],[1,a.sleepMeter.goalArc[0]],[2,a.sleepMeter.goalArc[1]]])},render:function(){var e=h.plural("hour_short")(1),t="0"+e,i=Math.floor(this.goalMinutes/60)+e,n=this.goalMet?1:Math.min(this.summary.totalMinutesAsleep/this.goalMinutes,1);this.goalMet&&!this.goalMetExactly&&(i+="+"),this.parent(0,n,{startText:t,endText:i,atBeginning:!1,drawStartChevron:!0,drawEndChevron:!0,drawBackground:!0})}}),g=new Class({Extends:u,initialize:function(e,t,i,n){this.parent(t,i,n),this.sleepOverviewModel=e,this.clock12=n&&n.clock12,this.userTimeFormat=this.clock12?"h:mm":"H:mm",this.options.labelStyles=this.options.overviewLabelStyles},render:function(){this.sleepOverviewModel.sleep.length||this.parent(0,0,{startText:"",endText:"",atBeginning:!0,drawStartChevron:!0,drawEndChevron:!0,drawBackground:!0});var e=this.sleepOverviewModel.sleep.first(),t=this.sleepOverviewModel.sleep.last(),i=e.get("startTime"),n=t.get("startTime"),a=s(i),r=s(n).add(t.get("timeInBed"),"minutes"),h=r.diff(a),c=Math.floor(h/1e3/60),d=Math.PI*this.$el.width()/2+this.$el.width(),u=36e5,p=10,g=(this.options.fgArcStyles["stroke-width"]+p)/d,f=Math.max(g*h,u),m=o.sleepStateValues,v=new l({range:[0,1],domain:[0,h]}),y=0,b=this.sleepOverviewModel.sleep.map(function(e){return{model:e,segments:e.getSleepSegments(),msStart:s(e.get("startTime")).diff(a),msEnd:s(e.get("startTime")).add(e.get("timeInBed"),"minutes").diff(a)}}),w=b.filter(function(e,t){var i,n,o,l;if(y>=t&&0!==t)return!1;for(;t<b.length-1;)if(i=b[t+1],n=s(i.model.get("startTime")).diff(a),o=s(i.model.get("startTime")).add(i.model.get("timeInBed"),"minutes").diff(a),e.msEnd>o)t++;else{var r=n-e.msEnd;if(r>f)break;if(r>0)e.segments.push({minutes:r/1e3/60,value:m.awake});else for(l=n;l<e.msEnd&&i.segments.length;)l+=6e4*i.segments[0].minutes,i.segments.splice(0,1);e.segments=e.segments.concat(i.segments),e.msEnd=o,t++}return y=t,!0});w.forEach(function(e,t){var i,n,o,l=this,h=l.options,d=e.segments,u=e.model.isStagesSleep,p=0===t,g=t===w.length-1,f=e.msStart,y=e.msEnd,b=v.fromDomain(f),_=v.fromDomain(y),x=s.duration(f),T=x.asMinutes();l.parent(b,_,{startText:p?a.local().format(l.userTimeFormat):"",endText:g?r.local().format(l.userTimeFormat):"",atBeginning:!1,drawStartChevron:!1,drawEndChevron:!1,drawBackground:p}),i=l.renderer.g().add();var k,S,M=Math.PI/c;if(!u)for(o=0;o<d.length;o++)n=d[o],n.value!==m.asleep&&(k=Math.PI+M*T,S=Math.PI+M*(T+n.minutes),l.renderer.arc(l.center_x,l.center_y,l.inner_radius,l.outer_radius,k,S).attr(n.value===m.restless?h.restlessArcStyles:h.awakeArcStyles).add(i)),T+=n.minutes;i.translate(this.options.padding,0)}.bind(this)),this.drawChevrons(0,1,!0,!0)}});return function(e,i,n,a,s){this.state=c.GoalNotMet,this.sleepOverviewModel=i,this.sleepGoalModel=n,this.$parentContainer=e,this.hoverCallback=function(e){"mouseenter"===e.type?(this.nonGoalMeter.hide(),this.goalMeter.show()):(this.nonGoalMeter.show(),this.goalMeter.hide())}.bind(this),this.renderSleep=function(){var e=t('<div class="meter non-goal-meter">').appendTo(this.$parentContainer),i=t('<div class="meter goal-meter">').appendTo(this.$parentContainer);this.nonGoalMeter=new g(this.sleepOverviewModel,e,this.$parentContainer,s),this.goalMeter=new p(this.sleepGoalModel,this.sleepOverviewModel,i,this.$parentContainer,s),this.nonGoalMeter.render(),this.moon=new d(this.$parentContainer.find(".moon")),this.sleepGoalModel.get("userHasGoal")&&(this.goalMeter.render(),a.on("mouseenter mouseleave",this.hoverCallback),this.sleepOverviewModel.get("summary").totalMinutesAsleep>=this.sleepGoalModel.get("minDuration")&&this.moon.makeHappy()),this.goalMeter.hide(),this.nonGoalMeter.show()},this.destroy=function(){a.off("mouseenter mouseLeave",this.hoverCallback),this.$parentContainer.find(".meter").remove()}}}),define("galileo/util/inputUtil",["require"],function(e){return{isValidNumber:function(e,t){if(null===e||void 0===e)return!1;var i=t?/[-\.]/gi:/[-,\.]/gi;if(e.toString().replace(i,"").match(/\D/i))return!1;var n=parseFloat((e+"").replace(/[,\.]/g,""));return!isNaN(n)&&n>=0}}}),define("hbs!galileo/tile/template/sleepSettings",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/sleep","i18n-load!com/fitbit/app/ngd/tile","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n<div class="settings-view" data-view="sleep-settings-view">\n	<div class="inputContainer">\n	    <h2>',s={hash:{}},n=i.i18n,a=n?n.call(e,"time_asleep_goal",s):h.call(e,"i18n","time_asleep_goal",s),(a||0===a)&&(o+=a),o+='</h2>\n	    <div class="textDecoration">\n	        <input class="editable goal-input hours" contenteditable="true" value="" />\n	        <div class="unitText unit">',(a=i.hours)?a=a.call(e,{hash:{}}):(a=e.hours,a=typeof a===c?a.apply(e):a),o+=d(a)+'</div>\n	    </div>\n	    <div class="textDecoration minutes-decoration">\n	        <input class="editable goal-input minutes" contenteditable="true" value="" />\n	        <div class="unitText subUnit">',(a=i.minutes)?a=a.call(e,{hash:{}}):(a=e.minutes,a=typeof a===c?a.apply(e):a),o+=d(a)+"</div>\n	    </div>\n	</div>\n	<p>\n		",s={hash:{}},n=i.i18n,a=n?n.call(e,"recommended_sleep_per_night",s):h.call(e,"i18n","recommended_sleep_per_night",s),(a||0===a)&&(o+=a),o+=' <span class="goal-error">',s={hash:{}},n=i.i18n,a=n?n.call(e,"goal_duration",s):h.call(e,"i18n","goal_duration",s),(a||0===a)&&(o+=a),o+="</span>\n	</p>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h=i.helperMissing,c="function",d=this.escapeExpression,u=this;return r={hash:{},inverse:u.noop,fn:u.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.sleep","com.fitbit.app.ngd.tile",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.sleep","com.fitbit.app.ngd.tile",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_sleepSettings",t),t}),define("hbs!galileo/tile/template/sleepSettingsFooter",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/sleep","i18n-load!com/fitbit/app/ngd/tile","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a="";return a+="\n",n=i["if"].call(e,e.showOnlySaveButton,{hash:{},inverse:g.program(4,l,t),fn:g.program(2,o,t)}),(n||0===n)&&(a+=n),a+="\n"}function o(e,t){var n,a,s,o="";return o+='\n	<span class="buttonContainer">\n	    <a class="dashButton saveButton centered saveSleepGoal">',s={hash:{}},n=i.i18n,a=n?n.call(e,"Save",s):p.call(e,"i18n","Save",s),(a||0===a)&&(o+=a),o+="</a>\n	</span>\n"}function l(e,t){var n,a,s,o="";return o+='\n	<span class="buttonContainer">\n	',n=i["if"].call(e,e.showDeleteGoalLink,{hash:{},inverse:g.program(7,h,t),fn:g.program(5,r,t)}),(n||0===n)&&(o+=n),o+='\n	</span>\n	<span class="buttonContainer">\n	    <a class="dashButton saveButton saveSleepGoal">',s={hash:{}},n=i.i18n,a=n?n.call(e,"Save",s):p.call(e,"i18n","Save",s),(a||0===a)&&(o+=a),o+="</a>\n	</span>\n"}function r(e,t){var n,a,s,o="";return o+='\n		<a class="delete-goal button-aligned action-link">',s={hash:{}},n=i.i18n,a=n?n.call(e,"delete_goal",s):p.call(e,"i18n","delete_goal",s),(a||0===a)&&(o+=a),o+="</a>\n	"}function h(e,t){var n,a,s,o="";return o+='\n		<a class="dashButton cancelButton">',s={hash:{}},n=i.i18n,a=n?n.call(e,"cancel",s):p.call(e,"i18n","cancel",s),(a||0===a)&&(o+=a),o+="</a>\n	"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var c,d,u,p=i.helperMissing,g=this;return u={hash:{},inverse:g.noop,fn:g.program(1,s,a)},c=i["i18n-namespace"],d=c?c.call(t,"com.fitbit.app.ngd.sleep","com.fitbit.app.ngd.tile",u):p.call(t,"i18n-namespace","com.fitbit.app.ngd.sleep","com.fitbit.app.ngd.tile",u),d||0===d?d:""});return e.registerPartial("galileo_tile_template_sleepSettingsFooter",t),t}),define("hbs!galileo/tile/template/sleepDeleteGoalConfirmation",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/sleep","i18n-load!com/fitbit/app/ngd/tile","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n<div class="settings-view" data-view="sleep-delete-goal-confirmation-view">\n    <p class="important">',s={hash:{}},n=i.i18n,a=n?n.call(e,"you_dont_have",s):h.call(e,"i18n","you_dont_have",s),(a||0===a)&&(o+=a),o+='<p>\n 	<a class="undo-delete-goal action-link">',s={hash:{}},n=i.i18n,a=n?n.call(e,"undo_delete_goal",s):h.call(e,"i18n","undo_delete_goal",s),(a||0===a)&&(o+=a),o+="</a>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h=i.helperMissing,c=this;return r={hash:{},inverse:c.noop,fn:c.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.sleep","com.fitbit.app.ngd.tile",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.sleep","com.fitbit.app.ngd.tile",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_sleepDeleteGoalConfirmation",t),t}),define("hbs!galileo/tile/template/sleepGoalMeter",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/unit","i18n-load!com/fitbit/app/ngd/sleep","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a="";return a+='\n\n<div class="sleep-meter">\n    <div class="moon"></div>\n</div>\n\n<div class="metric metricLarge timeAsleep sleepMetric">\n    <span class="number">',(n=i.hours)?n=n.call(e,{hash:{}}):(n=e.hours,n=typeof n===m?n.apply(e):n),a+=v(n)+'</span>\n    <span class="unit"> ',(n=i.hoursUnit)?n=n.call(e,{hash:{}}):(n=e.hoursUnit,n=typeof n===m?n.apply(e):n),a+=v(n)+'</span>\n    <span class="number">',(n=i.minutes)?n=n.call(e,{hash:{}}):(n=e.minutes,n=typeof n===m?n.apply(e):n),a+=v(n)+'</span>\n    <span class="unit"> ',(n=i.minutesUnit)?n=n.call(e,{hash:{}}):(n=e.minutesUnit,n=typeof n===m?n.apply(e):n),a+=v(n)+'</span>\n</div>\n<div class="interrupt-count sleepMetric',n=i["if"].call(e,e.userHasGoal,{hash:{},inverse:y.noop,fn:y.program(2,o,t)}),(n||0===n)&&(a+=n),a+='">\n    <span class="number">',(n=i.awakeRestless)?n=n.call(e,{hash:{}}):(n=e.awakeRestless,n=typeof n===m?n.apply(e):n),a+=v(n)+'</span>\n    <span class="x">\n        ',n=i["if"].call(e,e.classicSleepType,{hash:{},inverse:y.program(6,r,t),fn:y.program(4,l,t)}),(n||0===n)&&(a+=n),a+="\n    </span>\n</div>\n",n=i["if"].call(e,e.userHasGoal,{hash:{},inverse:y.noop,fn:y.program(8,h,t)}),(n||0===n)&&(a+=n),a+="\n</div>\n"}function o(e,t){return" hide-on-hover"}function l(e,t){var n,a,s,o="";return o+="\n            ",s={hash:{}},n=i.i18n,a=n?n.call(e,"mins_awake_restless",s):f.call(e,"i18n","mins_awake_restless",s),(a||0===a)&&(o+=a),o+="\n        "}function r(e,t){var n,a,s,o="";return o+="\n            ",s={hash:{}},n=i.i18n,a=n?n.call(e,"mins_awake",s):f.call(e,"i18n","mins_awake",s),(a||0===a)&&(o+=a),o+="\n        "}function h(e,t){var n,a="";return a+='\n<div class="show-on-hover sleepMetric">\n    ',n=i["if"].call(e,e.goalMet,{hash:{},inverse:y.program(11,d,t),fn:y.program(9,c,t)}),(n||0===n)&&(a+=n),a+="\n</div>\n"}function c(e,t){var n,a="";return a+='\n    <span class="label">',(n=i.chatter)?n=n.call(e,{hash:{}}):(n=e.chatter,n=typeof n===m?n.apply(e):n),a+=v(n)+"</span>\n    "}function d(e,t){var n,a="";return a+='\n    <span class="label">',(n=i.fromGoalMessage)?n=n.call(e,{hash:{}}):(n=e.fromGoalMessage,n=typeof n===m?n.apply(e):n),a+=v(n)+"</span>\n    "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var u,p,g,f=i.helperMissing,m="function",v=this.escapeExpression,y=this;return g={hash:{},inverse:y.noop,fn:y.program(1,s,a)},u=i["i18n-namespace"],p=u?u.call(t,"com.fitbit.app.unit","com.fitbit.app.ngd.sleep",g):f.call(t,"i18n-namespace","com.fitbit.app.unit","com.fitbit.app.ngd.sleep",g),p||0===p?p:""});return e.registerPartial("galileo_tile_template_sleepGoalMeter",t),t}),define("hbs!galileo/tile/template/sleepNoneToday",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/sleep","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n\n	<div class="onboarding">\n		<div class="moon_stars"></div>\n		<div class="title center larger">\n			',s={hash:{}},n=i.i18n,a=n?n.call(e,"sleep_title_initial",s):c.call(e,"i18n","sleep_title_initial",s),(a||0===a)&&(o+=a),o+="\n		</div>\n	</div>\n\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h="",c=i.helperMissing,d=this;return r={hash:{},inverse:d.noop,fn:d.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.sleep",r):c.call(t,"i18n-namespace","com.fitbit.app.ngd.sleep",r),(l||0===l)&&(h+=l),h+="\n"});return e.registerPartial("galileo_tile_template_sleepNoneToday",t),t}),define("galileo/tile/sleep",["require","underscore","./classes/small","i18n/i18n","galileo/model/sleep","galileo/tile/template/helpers/domPlaceholder","hbs!./template/sleep","hbs!./template/sleepNoneTodayLegacy","hbs!./template/sleepNoneYet","galileo/model/user","galileo/model/SleepGoalModel","galileo/model/SleepOverviewModel","galileo/graphic/sleepMeter","galileo/util/inputUtil","hbs!./template/sleepSettings","hbs!./template/sleepSettingsFooter","hbs!./template/sleepDeleteGoalConfirmation","hbs!./template/sleepGoalMeter","hbs!./template/sleepNoneToday","i18n-load!com/fitbit/app/ngd/sleep","i18n-load!com/fitbit/app/ngd/tile","i18n-load!com/fitbit/app/unit"],function(e){
var t=e("underscore"),i=e("./classes/small"),n=e("i18n/i18n")(),a=e("galileo/model/sleep"),s=e("galileo/tile/template/helpers/domPlaceholder"),o=e("hbs!./template/sleep"),l=e("hbs!./template/sleepNoneTodayLegacy"),r=e("hbs!./template/sleepNoneYet"),h=e("galileo/model/user"),c=e("galileo/model/SleepGoalModel"),d=e("galileo/model/SleepOverviewModel"),u=e("galileo/graphic/sleepMeter"),p=e("galileo/util/inputUtil").isValidNumber,g=e("hbs!./template/sleepSettings"),f=e("hbs!./template/sleepSettingsFooter"),m=e("hbs!./template/sleepDeleteGoalConfirmation"),v=e("hbs!./template/sleepGoalMeter"),y=e("hbs!./template/sleepNoneToday");n.namespace(e("i18n-load!com/fitbit/app/ngd/sleep")),n.namespace(e("i18n-load!com/fitbit/app/ngd/tile")),n.namespace(e("i18n-load!com/fitbit/app/unit"));var b=n.plural("min"),w=n.plural("hour_reduced"),_=n.plural("sleep_hours"),x=n.plural("sleep_minutes"),T=n("from_goal_message"),k=!!$("html.lte-ie9").length,S=[n("chatter_caught_all_z"),n("chatter_goal_met_woo"),n("chatter_sweet_met_goal")],M=180,C=1440;return new Class({Extends:i,title:n("sleep"),tileName:"sleep",tileType:"sleep",options:{controlsList:[{name:n("Settings"),"class":"settingsButton leftSide showSettings",glyphName:"show-settings"},{name:n("See_More"),"class":"more largeRight",href:"/sleep",glyphName:"arrow-right"}]},logUrl:"/sleep",hasModal:!1,savable:!k,allowUpdatingSettingsFromModel:!0,load:function(){k||(this.sleepGoalModel=new c({date:new Date},{user:h.viewer}),this.sleepGoalModel.isValid()||this.sleepGoalModel.isSyncing()||this.sleepGoalModel.fetch()),this.loadSettings();var e=this.getDate(),t=this.getDate();a.loadDays(e,t,function(t){this.isDateEqual(e)&&(t.hasLoggedSleep?0===t.entries.length&&k?this.renderNoSleepTodayForIe9AndBelow():this.renderSleep(t):this.renderNoSleep(),this.showMainContents())}.bind(this))},renderNoSleepTodayForIe9AndBelow:function(){var t=this.main.find(".content"),i=this.isDateEqual(this.today);this.hasModal=!0,t.empty(),e(["galileo/tile/loadDependencies"],function(e){var n=e.SleepClock;t.append(s(l,{clock:(new n).render(),isToday:i}))}.bind(this)),t.on("mousedown",".cancelButton",function(){this.hasModal=!1}.bind(this))},renderNoSleep:function(){var e=this.main.find(".content");this.hasModal=!0,this.hideControls(),e.empty(),e.append(s(r,{})),e.on("mousedown","a",function(){this.hasModal=!1}.bind(this))},renderSleep:function(t){var i;this.main.find(".content").empty(),this.showControls(),k?e(["galileo/tile/loadDependencies"],function(e){var i=e.SleepClock,n=0,l=0,r={awake:0,restless:0},h=this.main.find(".content");t.entries.length?t.entries.forEach(function(e){n+=e.minAsleep,l=a.timesAwake(e),r.awake+=l.awake,r.restless+=l.restless}):(n=0,r={awake:0,restless:0}),h.append(s(o,{clock:new i(t).render(),hours:Math.floor(n/60),minutes:n%60,awake:r.awake,restless:r.restless,hoursUnit:w(this.hours),minutesUnit:b(this.minutes)}))}.bind(this)):(this.sleepOverviewModel=new d({date:this.getDate()},{user:h.viewer}),i=function(){this.sleepGoalModel.afterSync(function(){this.renderSleepMeter(this.sleepOverviewModel)}.bind(this))}.bind(this),this.sleepOverviewModel.isValid()?i():this.sleepOverviewModel.fetch({success:i}))},renderSleepMeter:function(e){var t,i=0===this.sleepOverviewModel.sleep.length;this.sleepOverviewModel.get("date")===e.get("date")&&(i?this.renderNoSleepTemplate():this.renderSleepTemplate(),this.sleepMeter&&(this.sleepMeter.destroy(),delete this.sleepMeter),this.sleepMeter=new u(this.main.find(".content .sleep-meter"),this.sleepOverviewModel,this.sleepGoalModel,this.container,{clock12:h.viewer.clock12}),t=function(){i?this.renderNoSleepTemplate():this.sleepMeter.renderSleep()}.bind(this),this.sleepGoalModel.isValid()?t():this.sleepGoalModel.fetch({success:t}))},renderSleepTemplate:function(){var e=!1,i={classicAwake:[0],classicRestless:[0],stagesWake:[0]};this.sleepOverviewModel.sleep.reduce(function(t,i){var n=i.get("levels").summary;return n.awake&&n.restless?(e=!0,t.classicAwake.push(n.awake.minutes),t.classicRestless.push(n.restless.minutes)):n.wake&&t.stagesWake.push(n.wake.minutes),t},i);var n=t.chain(i).values().flatten().reduce(function(e,t){return e+t},0).value(),a=this.sleepGoalModel.get("userHasGoal")&&this.sleepGoalModel.isValid(),s=this.sleepGoalModel.get("minDuration"),o=this.sleepOverviewModel.get("summary").totalMinutesAsleep,l=Math.floor(o/60),r=o%60,h=this.main.find(".content"),c=s-o,d=Math.floor(c/60),u=c%60,p=o>=s;h.append(v({awakeRestless:n,classicSleepType:e,hours:l,minutes:r,hoursUnit:_(l),minutesUnit:x(r),userHasGoal:a,goalMet:p,chatter:S[Math.floor(Math.random()*S.length)],fromGoalMessage:p?null:this.getFromGoalMessage(d,u)}))},renderNoSleepTemplate:function(){var e=this.main.find(".content");this.hasModal=!0,e.empty(),e.append(y({})),e.on("mousedown",function(){this.hasModal=!1}.bind(this))},loadSettings:function(){if(!k){var e=function(){this.getSleepGoalInputAsMinutesOrFalse()===!1?this.showInputError():this.clearInputError()}.bind(this);this.settings.on("click",".saveButton",this.saveSettings.bind(this)),this.settings.on("click",".cancelButton",this.hideSettings.bind(this)),this.settings.on("click",".delete-goal",this.deleteGoal.bind(this)),this.settings.on("click",".undo-delete-goal",this.undoDeleteGoal.bind(this)),this.settings.on("keyup",".goal-input",e),this.sleepGoalModel.on("invalid",this.showInputError.bind(this)),this.settings.on("focus",".editable",function(){$(this).closest(".textDecoration").addClass("active")}),this.settings.on("blur",".editable",function(){$(this).closest(".textDecoration").removeClass("active")}),this.settings.on("click",".textDecoration, .textDecoration *",function(){$(this).closest(".textDecoration").find(".editable").focus()})}},showSettings:function(){this.sleepGoalModel&&this.sleepGoalModel.afterSync(function(){this.renderSettingsView(),this.updateSleepGoalInputFromModel()}.bind(this)),this.parent()},hideSettings:function(){a.updateDays(this.getDate(),this.getDate()),this.parent()},updateSleepGoalInputFromModel:function(){if(this.allowUpdatingSettingsFromModel){var e=this.sleepGoalModel.get("minDuration");this.sleepGoalModel.get("userHasGoal")?(this.settings.find(".goal-input.hours").val(Math.floor(e/60)),this.settings.find(".goal-input.minutes").val(Math.floor(e%60))):this.settings.find(".goal-input").val(""),this.clearInputError()}},getSleepGoalInputAsMinutesOrFalse:function(){function e(e){return""===e.trim()?0:p(e)&&h.viewer.parseNumber(e)}var t=e(this.settings.find(".goal-input.hours").val()),i=e(this.settings.find(".goal-input.minutes").val()),n=60*t+i;return t===!1||i===!1||this.isGoalDurationInvalid(n)?!1:n},isShowingConfirmationView:function(){return"sleep-delete-goal-confirmation-view"===this.settings.find(".settings-view").data("view")},isSleepGoalInputEmpty:function(){return""===this.settings.find(".goal-input.hours").val().trim()&&""===this.settings.find(".goal-input.minutes").val().trim()},saveSettings:function(){var e;return this.allowUpdatingSettingsFromModel=!1,this.sleepGoalModel.afterSync(function(){return this.allowUpdatingSettingsFromModel=!0,!this.sleepGoalModel.get("userHasGoal")&&this.isSleepGoalInputEmpty()?void this.hideSettings():(e=this.isShowingConfirmationView()?{userHasGoal:!1}:{userHasGoal:!0,minDuration:this.getSleepGoalInputAsMinutesOrFalse()},void this.sleepGoalModel.save(e,{success:this.hideSettings.bind(this),error:this.showInputError.bind(this),wait:!0}))}.bind(this)),!1},isGoalDurationInvalid:function(e){return M>e||e>C},clearInputError:function(){this.settings.find(".goal-error").removeClass("error-message"),this.settings.find(".inputContainer").removeClass("error"),this.settings.find(".saveSleepGoal").removeClass("error")},showInputError:function(){this.settings.find(".goal-error").addClass("error-message"),this.settings.find(".inputContainer").addClass("error"),this.settings.find(".saveSleepGoal").addClass("error")},deleteGoal:function(){this.settings.find(".goal-input").val(""),this.renderSettingsDeleteGoalConfirmationView()},undoDeleteGoal:function(){this.renderSettingsView(),this.updateSleepGoalInputFromModel()},renderSettingsView:function(){this.settings.find(".content").empty().append(g({minutes:b,hours:w})),this.settings.find(".settingsFooter").empty().append(f({showDeleteGoalLink:this.sleepGoalModel.get("userHasGoal")}))},renderSettingsDeleteGoalConfirmationView:function(){this.settings.find(".content").empty().append(m()),this.settings.find(".settingsFooter").empty().append(f({showOnlySaveButton:!0}))},getFromGoalMessage:function(e,t){return T.substitute([e,_(e),t,x(t)])}})}),define("galileo/tile/calories",["require","./classes/configurableWeeklyGoalSmallTile","galileo/model/user","i18n/i18n","i18n-load!com/fitbit/app/ngd/calories","i18n-load!com/fitbit/app/ngd/goal","i18n-load!com/fitbit/app/unit"],function(e){var t=e("./classes/configurableWeeklyGoalSmallTile"),i=e("galileo/model/user").viewer,n=e("i18n/i18n")();n.namespace(e("i18n-load!com/fitbit/app/ngd/calories")),n.namespace(e("i18n-load!com/fitbit/app/ngd/goal")),n.namespace(e("i18n-load!com/fitbit/app/unit"));var a=i.subscriptions.trainer,s=(a&&a.isActive(),n("unit_calories-burned")),o=[{unitPlural:n.plural("calorie"),unitThreshold:1/0,format:"#,##0"}];return new Class({Extends:t,title:n("calories"),tileName:"calories",hasModal:!0,tileType:"calories-burned",unitType:s,precision:0,logUrl:"/activities",options:{metricFormats:{setting:o,goal:o,result:o}},load:function(){var e=this,i=arguments;a.getPlan(function(n){e.trainerPlan=n,t.prototype.load.apply(e,i)})},loadSettings:function(){this.parent(),a.isActive()&&this.trainerPlan&&this.goalSetting.disable()},showOnlyDaily:function(){return a.isActive()&&this.trainerPlan}})}),define("galileo/graphic/weightMeterConfig",["require","galileo/color/graph"],function(e){var t=e("galileo/color/graph");return{padding:0,progressLabelSpacing:20,endpointLabelSpacing:30,markerDiameter:8,bgArcSegments:5,bgArcPadding:.025,bgArcStyles:{stroke:t.weightMeter.bgArc,"stroke-width":4,"stroke-linecap":"round","stroke-linejoin":"round"},fgArcStyles:{stroke:{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,t.weightMeter.arc[0]],[1,t.weightMeter.arc[1]]]},"stroke-width":18,"stroke-linecap":"round","stroke-linejoin":"round"},atBeginningStyles:{color:t.weightMeter.arc[0]},progressLabelStyles:{color:t.weightMeter.progressLabel,fontSize:"14px",fontFamily:'"Proxima Nova Bold", sans-serif'},goalLabelStyles:{color:t.weightMeter.goalLabel,fontSize:"18px",fontFamily:'"Proxima Nova Light", sans-serif'}}}),define("galileo/util/weightUtil",["require","i18n/i18n","i18n-load!com/fitbit/app/unit"],function(e){function t(e){return Math.floor(10*e)/10}function i(e){return Math.floor(e/p*100)/100}function n(e){return Math.ceil(e*p)}function a(e){return Math.floor(e/10)/100}function s(e){return Math.round(1e3*e)}function o(e){return n(14*e)}function l(e){return Math.floor(e/6350.29318*1e3)/1e3}function r(e){return Math.floor(e)}function h(e){var t=e-r(e),i=14*t;return i=Math.round(10*i)/10}function c(e){return e/14}function d(e){return e}var u=e("i18n/i18n")();u.namespace(e("i18n-load!com/fitbit/app/unit"));var p=453.59237,g={METRIC:{METRIC:d,US:function(e){return m(s(e),"US")},UK:function(e){return m(s(e),"UK")}},US:{METRIC:function(e){return m(n(e),"METRIC")},US:d,UK:function(e){return m(n(e),"UK")}},UK:{METRIC:function(e){return m(n(14*e),"METRIC")},US:function(e){return m(n(14*e),"US")},UK:d}},f=function(e,t){return"METRIC"===t?e/1e3:e/453.592},m=function(e,t,n){if(n&&n.inputWeightSystem)return g[n.inputWeightSystem][t](e);if("METRIC"===t)return{weightSystem:t,grams:e,units:a(e),subUnits:0};if("US"===t)return{weightSystem:t,grams:e,units:i(e),subUnits:0};var s=l(e);return{weightSystem:t,grams:e,units:r(s),subUnits:h(s)}},v=function(e){return"METRIC"===e.weightSystem?s(e.units):n("US"===e.weightSystem?e.units:14*e.units+e.subUnits)},y=[{unitPlural:u.plural("pound_short"),unitThreshold:1/0,format:"#,##0.0"}],b=[{type:"subUnit",unitPlural:u.plural("pound_short"),unitThreshold:14,format:"#,##0.0"},{unitPlural:u.plural("stone_short"),unitThreshold:1/0,format:"#,##0"}],w=[{unitPlural:u.plural("kilogram_short"),unitThreshold:1/0,format:"#,##0.0"}],_=function(e){return{US:y,UK:b,METRIC:w}[e]};return{getWeightFormat:_,convertWeightLocale:f,createWeightValue:m,getGramsFromWeightValue:v,truncateToTenthsPlace:t,convert:{gramsToPounds:i,poundsToGrams:n,gramsToKG:a,kgToGrams:s,stoneToGrams:o,gramsToStones:l,stonesFromStoneWeight:r,remainderPoundsFromStoneWeight:h,poundsToStones:c}}}),define("galileo/graphic/weightMeter",["require","jquery","highcharts","./weightMeterConfig","galileo/util/weightUtil","galileo/widget/metric"],function(e){var t=e("jquery"),i=e("highcharts"),n=e("./weightMeterConfig"),a=e("galileo/util/weightUtil"),s=e("galileo/widget/metric");return function(e,o,l,r,h,c,d,u,p){p=t.extend(!0,{},n,p);var g=p.unitType||!1;this.initialize=function(){this.renderer=null,this.$el=null,this.$parent=null,this.options=p},this.getPosition=function(e,t,i,n){return{x:e+Math.cos(n)*i,y:t+Math.sin(n)*i}},this.render=function(){var t,n,f,m,v=h.width(),y=h.height(),b=new i.Renderer(h[0],v,y),w=b.g().add(),_=b.g().add(),x=Number(Math.min(1,Math.max(0,1-r.grams/Math.abs(e.grams-o.grams))).toFixed(2)),T=(1+2*p.bgArcPadding)/p.bgArcSegments-2*p.bgArcPadding,k=(v-2*p.padding)/2,S=k-p.fgArcStyles["stroke-width"]/2,M=e.units,C=o.units,D=e.grams!==o.grams&&e.grams===l.grams;for(this.renderer=b,this.$el=h,this.$parent=c,f=0,t=1-p.bgArcPadding;f<p.bgArcSegments;f++)t+=p.bgArcPadding,n=t+T,b.arc(k,k,S,S,Math.PI*t,Math.PI*n).attr(p.bgArcStyles).add(w),t=n+p.bgArcPadding;if((x>0||D)&&e.units>0&&o.units>0&&(D?(m=this.getPosition(k,k,S,Math.PI),b.circle(m.x,m.y,k-S).attr({fill:p.atBeginningStyles.color}).add(w)):b.arc(k,k,S,S,Math.PI,Math.PI).attr(p.fgArcStyles).add(w).animate({end:Math.PI*(1+(x||.001))}),m=this.getPosition(k,k,S,Math.PI*(1+x)),b.circle(m.x,m.y,p.markerDiameter/2).attr({fill:p.progressLabelStyles.color}).add(_),m=this.getPosition(k,k,k-p.fgArcStyles["stroke-width"]-p.progressLabelSpacing,Math.PI*(1+x)),b.text(Math.round(100*x)+"%",m.x,m.y).attr({align:"center"}).css(p.progressLabelStyles).add(_)),g){var A=a.getWeightFormat(g),G=new s(A,!1,!0);G.update(e.units,e.subUnits),M=G.getUnitValue().value,u&&(M+=d+" "+G.getSubUnitValue().value+u),G.update(o.units,o.subUnits),C=G.getUnitValue().value,u&&(C+=d+" "+G.getSubUnitValue().value+u)}else u&&(M=e.units+d+" "+e.subUnits+u,C=o.units+d+" "+o.subUnits+u);return m=this.getPosition(k,k,S,Math.PI),b.text(M,m.x,m.y+p.endpointLabelSpacing).attr({align:"center"}).css(p.goalLabelStyles).add(_),m=this.getPosition(k,k,S,2*Math.PI),b.text(C,m.x,m.y+p.endpointLabelSpacing).attr({align:"center"}).css(p.goalLabelStyles).add(_),_.hide().translate(p.padding,0),w.translate(p.padding,0),c.on("mouseenter mouseleave",function(e){_["mouseenter"===e.type?"show":"hide"]()}),this},this.initialize()}}),define("galileo/graph/base",["require","mootools","highcharts"],function(e){e("mootools");var t=e("highcharts");return t.setOptions({global:{useUTC:!1}}),function(e,i,n,a){return a=Object.merge({chart:{renderTo:e[0],width:i,height:n},plotOptions:{series:{shadow:!1,pointPadding:0,borderWidth:0},column:{states:{hover:{enabled:!1}}}},credits:{enabled:!1},legend:{enabled:!1},title:{align:"left",text:""},xAxis:{type:"datetime",lineColor:"#bbb"},yAxis:{gridLineColor:"#bbb",min:0,minRange:1,title:{text:null}}},a),new t.Chart(a)}}),define("hbs!galileo/tile/template/weightGraphView",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="chart"></div>\n'});return e.registerPartial("galileo_tile_template_weightGraphView",t),t}),define("galileo/graph/tooltip",["require"],function(e){function t(e,t,i){var n=$("<div class='chartTooltip'/>").append(i);return n.append($("<div class='ttTriangle'>")).appendTo($("body")),n.css("left",Math.round(e)-n.outerWidth(!1)/2),n.css("top",Math.round(t)-n.outerHeight(!1)-35),$.extend(n,{setContents:function(e){return i.detach(),e.appendTo(n),i=e,this},moveTo:function(e,t,i){return n.stop(!0,!1).animate({top:t-n.outerHeight(!1)-35,left:e-n.outerWidth(!1)/2},i),this}})}function i(e,t){e.graphic&&(e.graphic.attr("fill",t),e.graphic.attr("stroke",t))}return t.chartEvents=function(e,n){var a=null,s=null,o=30;return{mouseOver:function(){var l=this.series,r=$(l.chart.container).offset(),h=r.left+l.chart.plotLeft+this.plotX,c=r.top+l.chart.plotTop+o,d=e.call(this),u="undefined"==typeof this.inValidWeek||this.inValidWeek;n&&(this.options.oldColor=this.color,i(this,n(this))),s&&clearTimeout(s),s=null,u&&d?(a=a||t(h,c,d),a.setContents(d).moveTo(h,c,50)):a&&a.detach()},mouseOut:function(){n&&this.options.oldColor&&i(this,this.options.oldColor),s&&clearTimeout(s),s=setTimeout(function(){a&&a.detach(),a=null},10)}}},t.chartMixin=function(e,i){return{plotOptions:{series:{point:{events:t.chartEvents(e,i)}}}}},t}),define("galileo/graph/weightGraphView",["require","jquery","./base","galileo/model/user","galileo/color/graph","hbs!../tile/template/weightGraphView","galileo/ajax/ajax","./tooltip","galileo/util/dateUtil","galileo/model/user"],function(e){function t(e,t,o,l){r.getRaw("/graph/getNewGraphData",{type:"weight",dateFrom:h.ajaxEncode(h.minusDays(t,30)),dateTo:h.ajaxEncode(t)},function(t){var r=[];t.graph.dataSets.weight.dataPoints&&(r=t.graph.dataSets.weight.dataPoints.map(n),i(r));var h,c,d,u,g=[];r.forEach(function(e){g.push(e.y)}),c=Math.min.apply(null,g),h=Math.max.apply(null,g),d=Math.floor(.95*c),u=Math.ceil(1.05*h);var f=a.extend(!0,{series:[{name:"weight",data:r}],yAxis:{min:d,max:u,showFirstLabel:!1,labels:{formatter:function(){return'<span class="yAxisLabel">'+(this.value===d?"":this.value)+"</span>"}}}},p);s(e,o,l,f)})}function i(e){var t=e[e.length-1];t.marker={enabled:!0}}function n(e){return{x:h.ajaxDecode(e.dateTime),y:Number(e.value)}}var a=e("jquery"),s=e("./base"),o=(e("galileo/model/user").viewer,e("galileo/color/graph")),l=e("hbs!../tile/template/weightGraphView"),r=e("galileo/ajax/ajax"),h=(e("./tooltip"),e("galileo/util/dateUtil")),c=(e("galileo/model/user").viewer,.23),d=o.weightGraphView.weight,u=o.fn.hex2rgba(d,c),p={chart:{marginLeft:-3,marginRight:28,type:"areaspline"},plotOptions:{areaspline:{color:d,fillColor:u,lineWidth:5,marker:{enabled:!1,lineColor:o.weightGraphView.markerFill,fillColor:o.weightGraphView.markerLine,lineWidth:4,radius:5,states:{hover:{enabled:!1}}}}},tooltip:{enabled:!1},yAxis:{gridLineColor:o.yAxis,gridLineWidth:1,lineColor:o.yAxis,lineWidth:2,labels:{align:"left",x:28,y:14}},xAxis:{tickLength:0,lineColor:o.xAxis,labels:{enabled:!1}},shadow:!1};return function(e,i,n){var s,o=a(l());return s=o,t(s,e,i,n),o}}),define("hbs!galileo/tile/template/weightGoal",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/goal","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,c="";return c+='\n<div class="weightGoal">\n    <div class="icon-image goalMeter">\n        <i class="fitglyph fitglyph-weight size-d"></i>\n    </div>\n\n    <ul class="stats">\n        <li class="progress">\n            <span class="stat metricContainer">\n                <span class="number">',(n=i.progressValue)?n=n.call(e,{hash:{}}):(n=e.progressValue,n=typeof n===p?n.apply(e):n),c+=g(n)+'</span>\n                <span class="unit">',(n=i.units)?n=n.call(e,{hash:{}}):(n=e.units,n=typeof n===p?n.apply(e):n),c+=g(n)+"</span>\n                ",n=i["if"].call(e,e.subUnits,{hash:{},inverse:m.noop,fn:m.program(2,o,t)}),(n||0===n)&&(c+=n),c+="\n            </span>\n            ",s={hash:{}},n=i.i18n,a=n?n.call(e,"to_go",s):f.call(e,"i18n","to_go",s),(a||0===a)&&(c+=a),c+='\n        </li>\n        <li class="weight">\n            <span class="stat metricContainer">\n                <span class="number">',(a=i.weightValue)?a=a.call(e,{hash:{}}):(a=e.weightValue,a=typeof a===p?a.apply(e):a),c+=g(a)+'</span>\n                <span class="unit">',(a=i.units)?a=a.call(e,{hash:{}}):(a=e.units,a=typeof a===p?a.apply(e):a),c+=g(a)+"</span>\n                ",a=i["if"].call(e,e.subUnits,{hash:{},inverse:m.noop,fn:m.program(4,l,t)}),(a||0===a)&&(c+=a),c+="\n            </span>\n            ",a=i["if"].call(e,e.atBeginning,{hash:{},inverse:m.program(8,h,t),fn:m.program(6,r,t)}),(a||0===a)&&(c+=a),c+="\n        </li>\n    </ul>\n</div>\n"}function o(e,t){var n,a="";return a+='\n                    <span class="number">',(n=i.progressSubValue)?n=n.call(e,{hash:{}}):(n=e.progressSubValue,n=typeof n===p?n.apply(e):n),a+=g(n)+'</span>\n                    <span class="unit">',(n=i.subUnits)?n=n.call(e,{hash:{}}):(n=e.subUnits,n=typeof n===p?n.apply(e):n),a+=g(n)+"</span>\n                "}function l(e,t){var n,a="";return a+='\n                    <span class="number">',(n=i.weightSubValue)?n=n.call(e,{hash:{}}):(n=e.weightSubValue,n=typeof n===p?n.apply(e):n),a+=g(n)+'</span>\n                    <span class="unit">',(n=i.subUnits)?n=n.call(e,{hash:{}}):(n=e.subUnits,n=typeof n===p?n.apply(e):n),a+=g(n)+"</span>\n                "}function r(e,t){var n,a,s,o="";return o+="\n                ",s={hash:{}},n=i.i18n,a=n?n.call(e,"encouragement",s):f.call(e,"i18n","encouragement",s),(a||0===a)&&(o+=a),o+="\n            "}function h(e,t){var n,a,s,o="";return o+="\n                ",s={hash:{}},n=i.i18n,a=n?n.call(e,"today",s):f.call(e,"i18n","today",s),(a||0===a)&&(o+=a),o+="\n            "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var c,d,u,p="function",g=this.escapeExpression,f=i.helperMissing,m=this;return u={hash:{},inverse:m.noop,fn:m.program(1,s,a)},c=i["i18n-namespace"],d=c?c.call(t,"com.fitbit.app.ngd.goal",u):f.call(t,"i18n-namespace","com.fitbit.app.ngd.goal",u),d||0===d?d:""});return e.registerPartial("galileo_tile_template_weightGoal",t),t}),define("hbs!galileo/tile/template/weightTileGraphView",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/weight","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,h="";return h+='\n<div class="weightGoal graph">\n    <div class="graphContainer"></div>\n\n    <ul class="stats">\n        <li class="progress">\n            <span class="stat metricLarge metricContainer">\n                <i class="fitglyph fitglyph-weight size-d"></i>\n                <span class="number">',(n=i.changeValue)?n=n.call(e,{hash:{}}):(n=e.changeValue,n=typeof n===u?n.apply(e):n),h+=p(n)+'</span>\n                <span class="unit">',(n=i.units)?n=n.call(e,{hash:{}}):(n=e.units,n=typeof n===u?n.apply(e):n),h+=p(n)+"</span>\n                ",n=i["if"].call(e,e.subUnits,{hash:{},inverse:f.noop,fn:f.program(2,o,t)}),(n||0===n)&&(h+=n),h+='\n            </span>\n            <span class="monthlyChange">\n                ',s={hash:{}},n=i.i18n,a=n?n.call(e,"monthly_change",s):g.call(e,"i18n","monthly_change",s),(a||0===a)&&(h+=a),h+='\n            </span>\n        </li>\n        <li class="weight">\n            <span class="stat metricLarge metricContainer">\n                <i class="fitglyph fitglyph-weight size-d"></i>\n                <span class="number">',(a=i.weightValue)?a=a.call(e,{hash:{}}):(a=e.weightValue,a=typeof a===u?a.apply(e):a),h+=p(a)+'</span>\n                <span class="unit">',(a=i.units)?a=a.call(e,{hash:{}}):(a=e.units,a=typeof a===u?a.apply(e):a),h+=p(a)+"</span>\n                ",a=i["if"].call(e,e.subUnits,{hash:{},inverse:f.noop,fn:f.program(4,l,t)}),(a||0===a)&&(h+=a),h+="\n            </span>\n            ",a=i["if"].call(e,e.fatValue,{hash:{},inverse:f.noop,fn:f.program(6,r,t)}),(a||0===a)&&(h+=a),h+="\n        </li>\n    </ul>\n</div>\n"}function o(e,t){var n,a="";return a+='\n                    <span class="number subNumber">',(n=i.changeSubValue)?n=n.call(e,{hash:{}}):(n=e.changeSubValue,n=typeof n===u?n.apply(e):n),a+=p(n)+'</span>\n                    <span class="unit">',(n=i.subUnits)?n=n.call(e,{hash:{}}):(n=e.subUnits,n=typeof n===u?n.apply(e):n),a+=p(n)+"</span>\n                "}function l(e,t){var n,a="";return a+='\n                    <span class="number subNumber">',(n=i.weightSubValue)?n=n.call(e,{hash:{}}):(n=e.weightSubValue,n=typeof n===u?n.apply(e):n),a+=p(n)+'</span>\n                    <span class="unit">',(n=i.subUnits)?n=n.call(e,{hash:{}}):(n=e.subUnits,n=typeof n===u?n.apply(e):n),a+=p(n)+"</span>\n                "}function r(e,t){var n,a,s,o="";return o+='\n                <span class="fat">\n                    ',(n=i.fatValue)?n=n.call(e,{hash:{}}):(n=e.fatValue,n=typeof n===u?n.apply(e):n),o+=p(n)+"% ",s={hash:{}},n=i.i18n,a=n?n.call(e,"body_fat",s):g.call(e,"i18n","body_fat",s),(a||0===a)&&(o+=a),o+="\n                </span>\n            "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var h,c,d,u="function",p=this.escapeExpression,g=i.helperMissing,f=this;return d={hash:{},inverse:f.noop,fn:f.program(1,s,a)},h=i["i18n-namespace"],c=h?h.call(t,"com.fitbit.app.ngd.weight",d):g.call(t,"i18n-namespace","com.fitbit.app.ngd.weight",d),c||0===c?c:""});return e.registerPartial("galileo_tile_template_weightTileGraphView",t),t}),define("hbs!galileo/tile/template/weightGoalMet",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/weight","i18n-load!com/fitbit/app/ngd/goal","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,l="";return l+='\n<div class="weightGoal met">\n    <div class="goalMeter">\n        <i class="fitglyph fitglyph-weight size-d"></i>\n    </div>\n\n    <ul class="stats">\n        <li class="progress">\n            <span class="stat">\n                <span class="celebration">0</span><span class="progress-units">',(n=i.unitsToGoMessage)?n=n.call(e,{hash:{}}):(n=e.unitsToGoMessage,n=typeof n===d?n.apply(e):n),l+=u(n)+"</span>\n            </span>\n            ",s={hash:{},inverse:p.noop,fn:p.program(2,o,t)},n=i["i18n-namespace"],a=n?n.call(e,"com.fitbit.app.ngd.goal",s):c.call(e,"i18n-namespace","com.fitbit.app.ngd.goal",s),(a||0===a)&&(l+=a),l+='\n        </li>\n        <li class="weight">\n            <span class="stat metricContainer">\n\n                <span class="gain-or-loss-message">',(a=i.gainOrLossMessage)?a=a.call(e,{hash:{}}):(a=e.gainOrLossMessage,a=typeof a===d?a.apply(e):a),l+=u(a)+'</span>\n                <p class="actions">\n                    <a class="setGoal">',s={hash:{}},n=i.i18n,a=n?n.call(e,"set_new_goal",s):c.call(e,"i18n","set_new_goal",s),(a||0===a)&&(l+=a),l+='</a>\n                    <a class="graphView">',s={hash:{}},n=i.i18n,a=n?n.call(e,"finish_goal",s):c.call(e,"i18n","finish_goal",s),(a||0===a)&&(l+=a),l+="</a>\n                </p>\n            </span>\n        </li>\n    </ul>\n</div>\n"}function o(e,t){var n,a,s,o="";return o+='\n            <span class="stat">',s={hash:{}},n=i.i18n,a=n?n.call(e,"goal_met",s):c.call(e,"i18n","goal_met",s),(a||0===a)&&(o+=a),o+="</span>\n            "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var l,r,h,c=i.helperMissing,d="function",u=this.escapeExpression,p=this;return h={hash:{},inverse:p.noop,fn:p.program(1,s,a)},l=i["i18n-namespace"],r=l?l.call(t,"com.fitbit.app.ngd.weight",h):c.call(t,"i18n-namespace","com.fitbit.app.ngd.weight",h),r||0===r?r:""});return e.registerPartial("galileo_tile_template_weightGoalMet",t),t}),define("hbs!galileo/widget/template/toggle",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var s,o="",l="function",r=this.escapeExpression;return o+='<div class="slider-widget">\n    <div class="capsule"></div>\n    <span class="choice choice-a selected">',(s=i.choiceAText)?s=s.call(t,{hash:{}}):(s=t.choiceAText,s=typeof s===l?s.apply(t):s),o+=r(s)+'</span>\n    <span class="choice choice-b">',(s=i.choiceBText)?s=s.call(t,{hash:{}}):(s=t.choiceBText,s=typeof s===l?s.apply(t):s),o+=r(s)+"</span>\n</div>"});return e.registerPartial("galileo_widget_template_toggle",t),t}),define("galileo/widget/toggle",["hbs!./template/toggle","jquery","mootools"],function(e){return new Class({Extends:Events,currentChoice:"a",$toggle:null,initialize:function(t){var i=t||{},n=i.positionFunction||null,a=i.appendToSelector||null,s=i.prependToSelector||null,o=i.context||{},l=this;if(this.slideAnimationMS="number"==typeof i.slideAnimationMS?i.slideAnimationMS:80,!(n||a||s)||!(o&&o.choiceAText&&o.choiceBText))throw new Error("Toggle cannot be constructed without template context and a positionFunction or append/prepend selectors.");n||(n=function(e){return a?e.appendTo(a):e.prependTo(s)}),this.$toggle=$(e(o)),n(this.$toggle),this.$capsule=this.$toggle.find(".capsule"),this.$choiceA=this.$toggle.find(".choice-a"),this.$choiceB=this.$toggle.find(".choice-b"),this.$toggle.find(".choice").click(function(){var e=$(this);l.choose(e.hasClass("choice-a")?"a":"b")})},choose:function(e){if(e){var t=this,i=e.toString().toLowerCase().trim();("a"==i||"b"==i)&&(this.currentChoice=i,"a"===i?t.$capsule.animate({left:"0"},t.slideAnimationMS,"linear",function(){t.$choiceB.removeClass("selected"),t.$choiceA.addClass("selected"),t.fireEvent("toggle",["a",t.$choiceA.text()])}):t.$capsule.animate({left:t.$toggle.width()/2-4+"px"},t.slideAnimationMS,"linear",function(){t.$choiceA.removeClass("selected"),t.$choiceB.addClass("selected"),t.fireEvent("toggle",["b",t.$choiceB.text()])}))}}})}),define("hbs!galileo/tile/template/weightSettingsGoal",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/unit","i18n-load!com/fitbit/app/ngd/weight","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,r="";return r+='\n<div class="weightGoalSettings">\n    <div class="weightGoal goal">\n        <div class="goalOnboarding" style="display: none">\n            <h2>',s={hash:{}},n=i.i18n,a=n?n.call(e,"you_dont_have_a_weight_goal",s):p.call(e,"i18n","you_dont_have_a_weight_goal",s),(a||0===a)&&(r+=a),r+='</h2>\n            <a class="addGoal">',s={hash:{}},n=i.i18n,a=n?n.call(e,"add_weight_goal",s):p.call(e,"i18n","add_weight_goal",s),(a||0===a)&&(r+=a),r+='</a>\n            <a class="undoDeleteGoal" style="display: none">',s={hash:{}},n=i.i18n,a=n?n.call(e,"undo_delete_goal",s):p.call(e,"i18n","undo_delete_goal",s),(a||0===a)&&(r+=a),r+='</a>\n        </div>\n        <div class="goalEdit">\n            <div class="inputContainer goalStart">\n                <h2>',s={hash:{}},n=i.i18n,a=n?n.call(e,"setting_starting_weight",s):p.call(e,"i18n","setting_starting_weight",s),(a||0===a)&&(r+=a),r+='</h2>\n                <div class="textDecoration">\n                    <label><input class="editable goalInput" contenteditable="true" value="',(a=i.startingWeightGoalValue)?a=a.call(e,{hash:{}}):(a=e.startingWeightGoalValue,a=typeof a===d?a.apply(e):a),r+=u(a)+'" /><span class="unitText unit">',(a=i.units)?a=a.call(e,{hash:{}}):(a=e.units,a=typeof a===d?a.apply(e):a),r+=u(a)+"</span></label>\n                    ",a=i["if"].call(e,e.startingWeightGoalSubValue,{hash:{},inverse:g.noop,fn:g.program(2,o,t)}),(a||0===a)&&(r+=a),r+='\n                </div>\n                <span class="error-message">',s={hash:{}},n=i.i18n,a=n?n.call(e,"setting_goal_invalid",s):p.call(e,"i18n","setting_goal_invalid",s),(a||0===a)&&(r+=a),r+='</span>\n            </div>\n\n            <div class="inputContainer targetGoal">\n                <h2>',s={hash:{}},n=i.i18n,a=n?n.call(e,"setting_weight_goal",s):p.call(e,"i18n","setting_weight_goal",s),(a||0===a)&&(r+=a),r+='</h2>\n                <div class="textDecoration">\n                    <label><input class="editable goalInput" contenteditable="true" value="',(a=i.goalWeightValue)?a=a.call(e,{hash:{}}):(a=e.goalWeightValue,a=typeof a===d?a.apply(e):a),r+=u(a)+'" /><span class="unitText unit">',(a=i.units)?a=a.call(e,{hash:{}}):(a=e.units,a=typeof a===d?a.apply(e):a),r+=u(a)+"</span></label>\n                    ",
a=i["if"].call(e,e.goalWeightSubValue,{hash:{},inverse:g.noop,fn:g.program(4,l,t)}),(a||0===a)&&(r+=a),r+='\n                </div>\n                <span class="error-message">',s={hash:{}},n=i.i18n,a=n?n.call(e,"setting_goal_invalid",s):p.call(e,"i18n","setting_goal_invalid",s),(a||0===a)&&(r+=a),r+='</span>\n            </div>\n        </div>\n    </div>\n    <div class="bodyFatGoal goal" style="display: none">\n        <div class="goalOnboarding" style="display: none">\n            <h2>',s={hash:{}},n=i.i18n,a=n?n.call(e,"you_dont_have_a_body_fat_goal",s):p.call(e,"i18n","you_dont_have_a_body_fat_goal",s),(a||0===a)&&(r+=a),r+='</h2>\n            <a class="addGoal">',s={hash:{}},n=i.i18n,a=n?n.call(e,"add_body_fat_goal",s):p.call(e,"i18n","add_body_fat_goal",s),(a||0===a)&&(r+=a),r+='</a>\n            <a class="undoDeleteGoal" style="display: none">',s={hash:{}},n=i.i18n,a=n?n.call(e,"undo_delete_goal",s):p.call(e,"i18n","undo_delete_goal",s),(a||0===a)&&(r+=a),r+='</a>\n        </div>\n        <div class="goalEdit">\n            <span class="inputContainer goalStart">\n                <h2>',s={hash:{}},n=i.i18n,a=n?n.call(e,"setting_starting_percentage",s):p.call(e,"i18n","setting_starting_percentage",s),(a||0===a)&&(r+=a),r+='</h2>\n                <div class="textDecoration">\n                    <label><input class="editable goalInput" contenteditable="true" value="',(a=i.startingBodyFatGoalValue)?a=a.call(e,{hash:{}}):(a=e.startingBodyFatGoalValue,a=typeof a===d?a.apply(e):a),r+=u(a)+'" /><span class="unitText unit">',s={hash:{}},n=i.i18n,a=n?n.call(e,"percent",s):p.call(e,"i18n","percent",s),(a||0===a)&&(r+=a),r+='</span></label>\n                </div>\n                <span class="error-message">',s={hash:{}},n=i.i18n,a=n?n.call(e,"setting_goal_invalid",s):p.call(e,"i18n","setting_goal_invalid",s),(a||0===a)&&(r+=a),r+='</span>\n            </span>\n            <span class="inputContainer targetGoal">\n                <h2>',s={hash:{}},n=i.i18n,a=n?n.call(e,"setting_goal_percent",s):p.call(e,"i18n","setting_goal_percent",s),(a||0===a)&&(r+=a),r+='</h2>\n                <div class="textDecoration">\n                    <label><input class="editable goalInput" contenteditable="true" value="',(a=i.goalBodyFatValue)?a=a.call(e,{hash:{}}):(a=e.goalBodyFatValue,a=typeof a===d?a.apply(e):a),r+=u(a)+'" /><span class="unitText unit">',s={hash:{}},n=i.i18n,a=n?n.call(e,"percent",s):p.call(e,"i18n","percent",s),(a||0===a)&&(r+=a),r+='</span></label>\n                </div>\n                <span class="error-message">',s={hash:{}},n=i.i18n,a=n?n.call(e,"setting_goal_invalid",s):p.call(e,"i18n","setting_goal_invalid",s),(a||0===a)&&(r+=a),r+="</span>\n            </span>\n        </div>\n    </div>\n</div>\n"}function o(e,t){var n,a="";return a+='\n                    <label><input class="editable goalSubInput" contenteditable="true" value="',(n=i.startingWeightGoalSubValue)?n=n.call(e,{hash:{}}):(n=e.startingWeightGoalSubValue,n=typeof n===d?n.apply(e):n),a+=u(n)+'" /><span class="unitText subUnit">',(n=i.subUnits)?n=n.call(e,{hash:{}}):(n=e.subUnits,n=typeof n===d?n.apply(e):n),a+=u(n)+"</span></label>\n                    "}function l(e,t){var n,a="";return a+='\n                    <label><input class="editable goalSubInput" contenteditable="true" value="',(n=i.goalWeightSubValue)?n=n.call(e,{hash:{}}):(n=e.goalWeightSubValue,n=typeof n===d?n.apply(e):n),a+=u(n)+'" /><span class="unitText subUnit">',(n=i.subUnits)?n=n.call(e,{hash:{}}):(n=e.subUnits,n=typeof n===d?n.apply(e):n),a+=u(n)+"</span></label>\n                    "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,h,c,d="function",u=this.escapeExpression,p=i.helperMissing,g=this;return c={hash:{},inverse:g.noop,fn:g.program(1,s,a)},r=i["i18n-namespace"],h=r?r.call(t,"com.fitbit.app.unit","com.fitbit.app.ngd.weight",c):p.call(t,"i18n-namespace","com.fitbit.app.unit","com.fitbit.app.ngd.weight",c),h||0===h?h:""});return e.registerPartial("galileo_tile_template_weightSettingsGoal",t),t}),define("hbs!galileo/tile/template/weightOnboardingTileContents",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/weight","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n<div class="onboarding">\n    <div class="icon fitglyph fitglyph-weight size-c"></div>\n    <div class="title">\n        ',s={hash:{}},n=i.i18n,a=n?n.call(e,"weight_title",s):h.call(e,"i18n","weight_title",s),(a||0===a)&&(o+=a),o+='\n    </div>\n    <div class="text">\n        <p class="info">',s={hash:{}},n=i.i18n,a=n?n.call(e,"onboarding_header",s):h.call(e,"i18n","onboarding_header",s),(a||0===a)&&(o+=a),o+='</p>\n        <p class="info">',s={hash:{}},n=i.i18n,a=n?n.call(e,"onboarding_message",s):h.call(e,"i18n","onboarding_message",s),(a||0===a)&&(o+=a),o+='</p>\n    </div>\n    <div class="btn-cont clearfix">\n        <span class="buttonContainer">\n            <a class="confirmButton confirm">',s={hash:{}},n=i.i18n,a=n?n.call(e,"set_goal",s):h.call(e,"i18n","set_goal",s),(a||0===a)&&(o+=a),o+='</a>\n        </span>\n        <span class="buttonContainer">\n            <a class="cancelButton no-thanks">',s={hash:{}},n=i.i18n,a=n?n.call(e,"no_thanks",s):h.call(e,"i18n","no_thanks",s),(a||0===a)&&(o+=a),o+="</a>\n        </span>\n    </div>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h=i.helperMissing,c=this;return r={hash:{},inverse:c.noop,fn:c.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.weight",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.weight",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_weightOnboardingTileContents",t),t}),define("hbs!galileo/tile/template/weightGoalModalContents",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/chart","i18n-load!com/fitbit/app/ngd/goal","i18n-load!com/fitbit/app/ngd/weight","i18n-load!com/fitbit/app/ngd/tile","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,h="";return h+='\n<div class="dialog weightGoal">\n    <div class="content">\n        <i class="close fitglyph fitglyph-close-settings size-f"></i>\n        <h2 class="modal-title">',s={hash:{}},n=i.i18n,a=n?n.call(e,"lets_set_a_weight_goal",s):g.call(e,"i18n","lets_set_a_weight_goal",s),(a||0===a)&&(h+=a),h+='</h2>\n        <div class="selection-container">\n            <div class="goal-selection-section section">\n                <p>',s={hash:{}},n=i.i18n,a=n?n.call(e,"do_you_want_to",s):g.call(e,"i18n","do_you_want_to",s),(a||0===a)&&(h+=a),h+='</p>\n                <ul class="toggle-container">\n                    <li><a class="toggle lose">',s={hash:{}},n=i.i18n,a=n?n.call(e,"lose_weight",s):g.call(e,"i18n","lose_weight",s),(a||0===a)&&(h+=a),h+='</a></li>\n                    <li><a class="toggle gain">',s={hash:{}},n=i.i18n,a=n?n.call(e,"gain_weight",s):g.call(e,"i18n","gain_weight",s),(a||0===a)&&(h+=a),h+='</a></li>\n                    <li><a class="toggle maintain">',s={hash:{}},n=i.i18n,a=n?n.call(e,"maintain_weight",s):g.call(e,"i18n","maintain_weight",s),(a||0===a)&&(h+=a),h+='</a></li>\n                </ul>\n            </div>\n            <div class="goal-entry-section section">\n                <h2 class="goal-title">',s={hash:{}},n=i.i18n,a=n?n.call(e,"weight_goal_title",s):g.call(e,"i18n","weight_goal_title",s),(a||0===a)&&(h+=a),h+='</h2>\n                <div class="inputContainer weight-goal-input">\n                    <div class="textDecoration">\n                        <label><input class="editable goalInput" contenteditable="true" value="',(a=i.goalWeight)?a=a.call(e,{hash:{}}):(a=e.goalWeight,a=typeof a===u?a.apply(e):a),h+=p(a)+'" /><span class="unitText unit">',(a=i.units)?a=a.call(e,{hash:{}}):(a=e.units,a=typeof a===u?a.apply(e):a),h+=p(a)+"</span></label>\n                        ",a=i["if"].call(e,e.subUnits,{hash:{},inverse:f.noop,fn:f.program(2,o,t)}),(a||0===a)&&(h+=a),h+='\n                    </div>\n                    <span class="hidden lose error-message">',s={hash:{}},n=i.i18n,a=n?n.call(e,"you_weigh_less_than_this_goal_error",s):g.call(e,"i18n","you_weigh_less_than_this_goal_error",s),(a||0===a)&&(h+=a),h+='</span>\n                    <span class="hidden gain error-message">',s={hash:{}},n=i.i18n,a=n?n.call(e,"you_weigh_more_than_this_goal_error",s):g.call(e,"i18n","you_weigh_more_than_this_goal_error",s),(a||0===a)&&(h+=a),h+='</span>\n                    <span class="hidden generic error-message">',s={hash:{}},n=i.i18n,a=n?n.call(e,"setting_goal_invalid",s):g.call(e,"i18n","setting_goal_invalid",s),(a||0===a)&&(h+=a),h+='</span>\n                </div>\n                <div class="body-fat-button-container">\n                    <a class="body-fat-goal-button">',s={hash:{}},n=i.i18n,a=n?n.call(e,"goal_body_fat_button",s):g.call(e,"i18n","goal_body_fat_button",s),(a||0===a)&&(h+=a),h+='</a>\n                    <p class="body-fat-skip-message">',s={hash:{}},n=i.i18n,a=n?n.call(e,"skip_body_fat_message",s):g.call(e,"i18n","skip_body_fat_message",s),(a||0===a)&&(h+=a),h+='</p>\n                </div>\n                <div class="inputContainer hidden body-fat-goal-input">\n                    <h2>',s={hash:{}},n=i.i18n,a=n?n.call(e,"body_fat_goal_title",s):g.call(e,"i18n","body_fat_goal_title",s),(a||0===a)&&(h+=a),h+='</h2>\n                    <div class="textDecoration">\n                        <label><input class="editable goalInput" contenteditable="true" value="',(a=i.goalBodyFat)?a=a.call(e,{hash:{}}):(a=e.goalBodyFat,a=typeof a===u?a.apply(e):a),h+=p(a)+'" /><span class="unitText unit">%</span></label>\n                    </div>\n                    ',a=i["if"].call(e,e.isFemale,{hash:{},inverse:f.program(6,r,t),fn:f.program(4,l,t)}),(a||0===a)&&(h+=a),h+='\n                    <span class="hidden error-message">',s={hash:{}},n=i.i18n,a=n?n.call(e,"setting_goal_invalid",s):g.call(e,"i18n","setting_goal_invalid",s),(a||0===a)&&(h+=a),h+='</span>\n                </div>\n            </div>\n        </div>\n        <div class="footer">\n            <a class="saveButton button disabled">',s={hash:{}},n=i.i18n,a=n?n.call(e,"Save",s):g.call(e,"i18n","Save",s),(a||0===a)&&(h+=a),h+="</a>\n        </div>\n    </div>\n</div>\n"}function o(e,t){var n,a="";return a+='\n                        <label><input class="editable goalSubInput" contenteditable="true" value="',(n=i.goalWeightSubUnit)?n=n.call(e,{hash:{}}):(n=e.goalWeightSubUnit,n=typeof n===u?n.apply(e):n),a+=p(n)+'" /><span class="unitText subUnit">',(n=i.subUnits)?n=n.call(e,{hash:{}}):(n=e.subUnits,n=typeof n===u?n.apply(e):n),a+=p(n)+"</span></label>\n                        "}function l(e,t){var n,a,s,o="";return o+='\n                        <span class="body-fat-info-message">',s={hash:{}},n=i.i18n,a=n?n.call(e,"female_body_fat_support_text",s):g.call(e,"i18n","female_body_fat_support_text",s),(a||0===a)&&(o+=a),o+="</span>\n                    "}function r(e,t){var n,a,s,o="";return o+='\n                        <span class="body-fat-info-message">',s={hash:{}},n=i.i18n,a=n?n.call(e,"male_body_fat_support_text",s):g.call(e,"i18n","male_body_fat_support_text",s),(a||0===a)&&(o+=a),o+="</span>\n                    "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var h,c,d,u="function",p=this.escapeExpression,g=i.helperMissing,f=this;return d={hash:{},inverse:f.noop,fn:f.program(1,s,a)},h=i["i18n-namespace"],c=h?h.call(t,"com.fitbit.app.ngd.chart","com.fitbit.app.ngd.goal","com.fitbit.app.ngd.weight","com.fitbit.app.ngd.tile",d):g.call(t,"i18n-namespace","com.fitbit.app.ngd.chart","com.fitbit.app.ngd.goal","com.fitbit.app.ngd.weight","com.fitbit.app.ngd.tile",d),c||0===c?c:""});return e.registerPartial("galileo_tile_template_weightGoalModalContents",t),t}),define("galileo/model/WeightGoalModel",["require","exports","module","underscore","shared/scripts/modules/api-client","galileo/model/SharedGoalModel","galileo/util/weightUtil","rsvp","galileo/util/dateUtil"],function(e,t,i){var n=(e("underscore"),1.1),a=e("shared/scripts/modules/api-client"),s=e("galileo/model/SharedGoalModel"),o=e("galileo/util/weightUtil"),l=e("rsvp").Promise,r=e("galileo/util/dateUtil"),h=s.extend({initialize:function(e,t){h.__super__.initialize.apply(this,arguments),this.user=t&&t.user},url:function(){return a.makeFullUrl("/"+n+"/user/"+this.user.encodedId+"/body/log/weight/goal.json")},lookup:function(e,t){return i.uri+"_"+t.user.encodedId},validate:function(e){var t=h.__super__.validate.call(this,e);if(t)return t;if(e.userHasGoal)return isNaN(e.weight)?"weight is invalid":isNaN(e.startWeight)?"startWeight is invalid":void 0},getUnits:function(){return this.getWeightValue().units},getSubUnits:function(){return this.getWeightValue().subUnits},getWeightValue:function(){return o.createWeightValue(this.get("weight"),this.user.weightSystem)},getStartWeightValue:function(){return o.createWeightValue(this.get("startWeight"),this.user.weightSystem)},saveWeightGoal:function(e){e=e||{},e.targetWeight=e.targetWeight||{},e.startWeight=e.startWeight||{};var t=e.targetWeight.units,i=e.targetWeight.subUnits||0,n=e.startWeight.units||void 0,a=e.startWeight.subUnits||0,s=e.startDate||new Date,h={weight:o.getGramsFromWeightValue({units:t,subUnits:i,weightSystem:this.user.weightSystem}),startDate:s.getTime?r.ajaxEncode(s):s,userHasGoal:!0};return n&&(h.startWeight=o.getGramsFromWeightValue({units:n,subUnits:a,weightSystem:this.user.weightSystem})),new l(function(e,t){this.save(h,{wait:!0,success:e,error:t})}.bind(this))},sync:function(e,t,i){return i.acceptsLanguageHeader="x_machine",h.__super__.sync.call(this,e,t,i)}});return h}),define("galileo/model/BodyFatGoalModel",["require","exports","module","underscore","shared/scripts/modules/api-client","galileo/model/SharedGoalModel"],function(e,t,i){var n=(e("underscore"),1.1),a=e("shared/scripts/modules/api-client"),s=e("galileo/model/SharedGoalModel"),o=s.extend({initialize:function(e,t){o.__super__.initialize.apply(this,arguments),this.user=t&&t.user},url:function(){return a.makeFullUrl("/"+n+"/user/-/body/log/fat/goal.json")},lookup:function(e,t){return i.uri+"_"+t.user.encodedId},validate:function(e){var t=o.__super__.validate.call(this,e);if(t)return t;if(e.userHasGoal)return isNaN(e.fat)?"fat is invalid":void 0}});return o}),define("galileo/tile/modal/weightGoal",["require","mootools","jquery","shared/scripts/modal","hbs!../template/weightGoalModalContents","i18n/i18n","galileo/model/user","galileo/util/weightUtil","underscore","galileo/util/inputUtil","galileo/util/dateUtil","rsvp","galileo/model/WeightGoalModel","galileo/model/BodyFatGoalModel","moment","i18n-load!com/fitbit/app/ngd/weight","i18n-load!com/fitbit/app/ngd/chart","i18n-load!com/fitbit/app/unit"],function(e){e("mootools"),e("jquery");var t=e("shared/scripts/modal"),i=e("hbs!../template/weightGoalModalContents"),n=e("i18n/i18n")(),a=e("galileo/model/user"),s=e("galileo/util/weightUtil"),o=e("underscore"),l=e("galileo/util/inputUtil").isValidNumber,r=(e("galileo/util/dateUtil"),e("rsvp").Promise),h=e("galileo/model/WeightGoalModel"),c=e("galileo/model/BodyFatGoalModel"),d=e("moment");n.namespace(e("i18n-load!com/fitbit/app/ngd/weight")),n.namespace(e("i18n-load!com/fitbit/app/ngd/chart")),n.namespace(e("i18n-load!com/fitbit/app/unit"));var u=a.viewer.parseNumber.bind(a.viewer),p=function(e){return{US:n.plural("pound_short")(2),UK:n.plural("stone_short")(2),METRIC:n.plural("kilogram_short")(2)}[e]};return new Class({Implements:[Options,Events],options:{showingBodyFatInput:!1,goalType:"lose"},weightEdited:!1,weightTile:void 0,initialize:function(e,t){if(!e)throw new Error("The weightGoal modal cannot be constructed without a weightTile");this.weightTile=e,this.setOptions(t)},open:function(){this.setupModal()},close:function(){throw new Error("close should not be called before open is")},validate:function(e,t,i){var n,o,r=!0,h="UK"===a.viewer.weightSystem;if(l(e.val())?this.clearWeightInputError():(r=!1,this.showWeightInputError("generic")),h&&!l(t.val())?(r=!1,this.showWeightInputError("generic")):r&&this.clearWeightInputError(),r){n=u(e.val()),h&&(o=u(t.val()));var c=this.weightTile.getCurrentWeight(),d=c.units,p=c.subUnits;switch(h?(d=Math.floor(d),p=s.truncateToTenthsPlace(p)):d=s.truncateToTenthsPlace(d),this.options.goalType){case"lose":(!h&&n>=d||h&&(n>d||n===d&&o>p))&&(this.clearWeightInputError(),this.showWeightInputError("lose"),r=!1);break;case"gain":(!h&&d>=n||h&&(d>n||n===d&&p>o))&&(this.clearWeightInputError(),this.showWeightInputError("gain"),r=!1)}}return this.options.showingBodyFatInput&&i.val().trim()&&!l(i.val())?(r=!1,this.showBodyfatInputError()):this.clearBodyFatInputError(),r?this.$content.find(".saveButton").removeClass("error"):this.$content.find(".saveButton").addClass("error"),r},save:function(){var e=this.$content.find(".weight-goal-input .goalInput"),t=this.$content.find(".weight-goal-input .goalSubInput"),i=this.$content.find(".body-fat-goal-input .goalInput"),n="UK"===a.viewer.weightSystem;if(this.validate(e,t,i)){var l=u(e.val()).toFloat(),p=n?u(t.val()).toFloat():0,g=u(i.val()).toFloat();n?(l=Math.floor(l),p=s.truncateToTenthsPlace(p)):l=s.truncateToTenthsPlace(l);var f=new h(null,{user:a.viewer}),m=new c(null,{user:a.viewer});f.once("error",function(e,t){var i=JSON.parse(t.responseText);o.any(i.errors)&&(this.showWeightInputError(this.options.goalType),this.$content.find(".saveButton").addClass("error"))}.bind(this)),m.once("error",function(e,t){var i=JSON.parse(t.responseText);o.any(i.errors)&&(this.showBodyfatInputError(),this.$content.find(".saveButton").addClass("error"))}.bind(this));var v=!(!this.options.showingBodyFatInput||!i.val().trim());r.all([this.weightTile.loggingPromise(f.saveWeightGoal({targetWeight:{units:l,subUnits:p},startWeight:this.weightTile.getMostRecentWeightLog().getWeightValue(),startDate:d().toDate()})).then(function(){},this.showWeightInputError.bind(this,"generic")),new r(function(e,t){v?m.save({fat:g,userHasGoal:!0},{wait:!0,success:e,error:function(){this.showBodyfatInputError(),t()}.bind(this)}):e()}.bind(this))]).then(function(){this.weightTile&&(this.weightTile.declineOnboarding(),this.weightTile.fetchAllModelsExceptGoals().then(function(){"maintain"===this.options.goalType?this.weightTile.showGraphView():this.weightTile.showMainView()}.bind(this)),this.weightTile.resetViewGraphSetting()),this.closeFromSetGoal=!0,this.close()}.bind(this))}},showWeightInputError:function(e){if(e&&e.trim()){var t=e.trim().toLowerCase();t&&(this.$content.find(".weight-goal-input").addClass("error"),this.$content.find(".weight-goal-input .error-message").addClass("hidden"),this.$content.find(".weight-goal-input .error-message."+t).each(function(){$(this).removeClass("hidden")}),this.$content.find(".saveButton").addClass("error"))}},clearWeightInputError:function(){this.$content.find(".weight-goal-input").removeClass("error"),this.$content.find(".weight-goal-input .error-message").addClass("hidden"),0==this.$content.find(".inputContainer.error").length&&this.$content.find(".saveButton").removeClass("error")},showBodyfatInputError:function(){this.$content.find(".body-fat-goal-input").addClass("error"),this.$content.find(".saveButton").addClass("error")},clearBodyFatInputError:function(){this.$content.find(".body-fat-goal-input").removeClass("error"),0==this.$content.find(".inputContainer.error").length&&this.$content.find(".saveButton").removeClass("error")},deselectToggles:function(){this.$content.find(".toggle-container .toggle").removeClass("selected")},selectToggle:function(e){if(e&&e.trim()){var t=e.trim();if("gain"===t||"lose"===t||"maintain"===t)switch(this.deselectToggles(),this.$content.find(".toggle-container .toggle."+t).addClass("selected"),this.options.goalType=t,t){case"gain":this.selectedGainGoal();break;case"lose":this.selectedLoseGoal();break;case"maintain":this.selectedMaintainWeight()}}},selectedMaintainWeight:function(){this.weightEdited||(this.$content.find(".weight-goal-input input.goalInput").val(this.weightTile.getCurrentWeight()?this.weightTile.getFormattedWeightUnits(this.weightTile.getCurrentWeight()):""),this.$content.find(".weight-goal-input input.goalSubInput").val("UK"===a.viewer.weightSystem?this.weightTile.getFormattedWeightSubUnits(this.weightTile.getCurrentWeight()):""))},selectedLoseGoal:function(){this.weightEdited||this.$content.find(".weight-goal-input input").val("")},selectedGainGoal:function(){this.weightEdited||this.$content.find(".weight-goal-input input").val("")},setupModal:function(){var e=this.modal=t(this.setupDialog.bind(this));this.closeFromSetGoal=!1,e.position()},setupDialog:function(e){var t=p(a.viewer.weightSystem),n=o.find(s.getWeightFormat(a.viewer.weightSystem),function(e){return"subUnit"===e.type}),r=this,h="UK"===a.viewer.weightSystem;return this.$dialog=$(i({goalWeight:"",goalWeightSubUnit:"",goalBodyFat:"",units:t,subUnits:h?n.unitPlural():null,isFemale:a.viewer.isUserFemale})),this.$content=this.$dialog.find(".content"),h&&this.$content.find(".textDecoration").addClass("uk"),this.$content.find(".editable").each(function(){var e=$(this);e.focus(function(){e.parents(".textDecoration").addClass("active")}),e.blur(function(){e.parents(".textDecoration").removeClass("active")})}),this.$content.find(".body-fat-goal-button").click(function(){r.options.showingBodyFatInput=!0,$(this).parent(".body-fat-button-container").addClass("hidden"),r.$content.find(".body-fat-goal-input").removeClass("hidden")}),this.$content.find(".saveButton").click(function(){r.save()}),this.$content.find(".toggle.gain").click(this.selectToggle.bind(this,"gain")),this.$content.find(".toggle.lose").click(this.selectToggle.bind(this,"lose")),this.$content.find(".toggle.maintain").click(this.selectToggle.bind(this,"maintain")),this.$content.find(".editable").each(function(){var e=$(this);e.keyup(function(t){if(9!==t.which){var i=o.all(e.parent().find(".editable"),function(e){return l($(e).val())}),n=e.parents(".weight-goal-input").length;this.weightEdited=this.weightEdited||n,!i&&n?r.showWeightInputError("generic"):r.clearWeightInputError(),i||n||!e.val().trim()?r.clearBodyFatInputError():r.showBodyfatInputError()}})}),this.selectToggle("lose"),this.close=e,this.$dialog},getDate:function(){return this.date?this.date:(this.date=new Date,this.date)},setDate:function(e){return this.date=e,this}})}),define("galileo/model/WeightLogModel",["require","backbone","shared/scripts/modules/api-client","underscore","rsvp","galileo/util/weightUtil","galileo/util/weightUtil","galileo/model/user"],function(e){var t=e("backbone"),i=1,n=e("shared/scripts/modules/api-client"),a=e("underscore"),s=e("rsvp").Promise,o=e("galileo/util/weightUtil"),l=e("galileo/util/weightUtil"),r=e("galileo/model/user"),h=t.Model.extend({idAttribute:"logId",initialize:function(e,t){h.__super__.initialize.apply(this,arguments),this.user=t&&t.user},validate:function(e){return a.isEmpty(e)?"no attributes":void 0},url:function(){return n.makeFullUrl("/"+i+"/user/"+r.viewer.encodedId+"/body/log/weight.json")},getUnits:function(){return this.getWeightValue().units},getSubUnits:function(){return this.getWeightValue().subUnits},getWeightValue:function(){return o.createWeightValue(this.get("weight"),(this.user||this.collection.user).weightSystem)},saveWeightLog:function(e){var t=e.units,i=e.subUnits,n=e.fat||0,a=e.date||new Date,r=e.time||void 0,h={weight:o.getGramsFromWeightValue({units:t,subUnits:i,weightSystem:this.user.weightSystem}),date:a.getTime?l.ajaxEncode(a):a};return n&&(h.fat=n),r&&(h.time=r),new s(function(e,t){this.save(h,{wait:!0,success:e,error:t})}.bind(this))},sync:function(e,t,i){return i.acceptsLanguageHeader="x_machine",("create"===e||"update"===e||"patch"===e)&&(i.emulateJSON=!0,i.data=t.toJSON()),h.__super__.sync.call(this,e,t,i)}});return h}),define("galileo/model/WeightLogsCollection",["require","underscore","backbone","shared/scripts/modules/api-client","galileo/util/dateUtil","./WeightLogModel"],function(e){var t=e("underscore"),i=e("backbone"),n=1,a=e("shared/scripts/modules/api-client"),s=e("galileo/util/dateUtil"),o=e("./WeightLogModel"),l=i.Collection.extend({model:o,initialize:function(e,t){l.__super__.initialize.apply(this,arguments),t=t||{},this.user=t.user,this.type=t.type,this.baseDate=t.baseDate,this.endDate=t.endDate,this.period=t.period,this.list=t.list},validate:function(){if(this.list){var e=this.list.beforeDate?!this.list.afterDate:this.list.afterDate;if(e)return"list endpoint must specify either beforeDate or afterDate";var t=this.list.beforeDate?this.list.beforeDate:this.list.afterDate;if("string"!=typeof t&&!t.getTime||"string"==typeof t&&t.indexOf("-")<0)return"dates must be Date objects or dateUtil.ajaxEncode'd strings";if(isNaN(this.list.offset))return"offset required for list endpoint";if(isNaN(this.list.limit))return"limit required for list endpoint";if(!this.list.sort||"asc"!==this.list.sort.toLowerCase()&&"desc"!==this.list.sort.toLowerCase())return"sort is required and must be one of [asc, desc]"}},url:function(){if(this.list){var e="/"+n+"/user/"+this.user.encodedId+"/body/log/weight/list.json",t=this.list.beforeDate||this.list.afterDate;return"string"!=typeof t&&t.getTime&&(t=s.ajaxEncode(t)),a.makeFullUrl(e+"?offset="+this.list.offset+"&limit="+this.list.limit+"&sort="+this.list.sort+(this.list.afterDate?"&afterDate=":"&beforeDate=")+t)}return this.buildUrlForDateEndpoint()},buildUrlForDateEndpoint:function(){var e="/"+n+"/user/"+this.user.encodedId+"/body/log/weight/date/"+s.ajaxEncode(t.result(this,"baseDate")),i=t.result(this,"endDate"),o=t.result(this,"period");return(i||o)&&(i?e+=s.ajaxEncode(i):o&&(e+=o),e+="/"),a.makeFullUrl(e+".json")},modelId:function(e){return e.logId},parse:function(e){return e.weight?e.weight:e},fetch:function(e){return e.acceptsLanguageHeader="x_machine",i.Collection.prototype.fetch.apply(this,arguments)}});return l}),define("galileo/model/FoodGoalsModel",["require","exports","module","underscore","shared/scripts/modules/api-client","galileo/model/SharedGoalModel","rsvp"],function(e,t,i){var n=e("underscore"),a=1.1,s=e("shared/scripts/modules/api-client"),o=e("galileo/model/SharedGoalModel"),l=e("rsvp").Promise,r=o.extend({initialize:function(e,t){r.__super__.initialize.apply(this,arguments),this.user=t&&t.user},url:function(){return s.makeFullUrl("/"+a+"/user/-/foods/log/goal.json")},lookup:function(e,t){return i.uri+"_"+t.user.encodedId},parse:function(e){if(e&&e.goals&&(this.clear(),!n.isEmpty(e.goals))){var t=n.extend({userHasGoal:!0},e.goals);return t=e.foodPlan?n.extend(t,{userHasFoodPlan:!0,foodPlan:e.foodPlan}):n.extend(t,{userHasFoodPlan:!1})}return{userHasGoal:!1,userHasFoodPlan:!1}},deleteGoal:function(){return new l(function(e,t){t("FoodGoalsModel does not support deletion (only updating)")}.bind(this))},toServerJSON:function(){var e=r.__super__.toJSON.apply(this,arguments);return delete e.userHasGoal,delete e.userHasFoodPlan,e}});return r}),define("galileo/tile/weight",["require","galileo/model/user","./classes/small","i18n/i18n","galileo/graphic/weightMeter","galileo/graph/weightGraphView","hbs!./template/weightGoal","hbs!./template/weightTileGraphView","hbs!./template/weightGoalMet","galileo/util/dateUtil","underscore","galileo/util/weightUtil","galileo/widget/toggle","galileo/widget/metric","hbs!./template/weightSettingsGoal","hbs!./template/weightOnboardingTileContents","galileo/tile/modal/weightGoal","rsvp","moment","galileo/util/inputUtil","galileo/model/WeightGoalModel","galileo/model/BodyFatGoalModel","galileo/model/WeightLogsCollection","galileo/model/WeightLogModel","cdn-logger/siteLogger","galileo/model/FoodGoalsModel","i18n-load!com/fitbit/app/ngd/goal","i18n-load!com/fitbit/app/ngd/weight","i18n-load!com/fitbit/app/unit","i18n-load!com/fitbit/app/ngd/tile"],function(e){var t=e("galileo/model/user"),i=e("./classes/small"),n=e("i18n/i18n")(),a=e("galileo/graphic/weightMeter"),s=e("galileo/graph/weightGraphView"),o=e("hbs!./template/weightGoal"),l=e("hbs!./template/weightTileGraphView"),r=e("hbs!./template/weightGoalMet"),h=e("galileo/util/dateUtil"),c=e("underscore"),d=e("galileo/util/weightUtil"),u=e("galileo/widget/toggle"),p=e("galileo/widget/metric"),g=e("hbs!./template/weightSettingsGoal"),f=e("hbs!./template/weightOnboardingTileContents"),m=e("galileo/tile/modal/weightGoal"),v=e("rsvp").Promise,y=e("moment"),b=e("galileo/util/inputUtil").isValidNumber,w=e("galileo/model/WeightGoalModel"),_=e("galileo/model/BodyFatGoalModel"),x=e("galileo/model/WeightLogsCollection"),T=e("galileo/model/WeightLogModel"),k=e("cdn-logger/siteLogger"),S=e("galileo/model/FoodGoalsModel");n.namespace(e("i18n-load!com/fitbit/app/ngd/goal")),n.namespace(e("i18n-load!com/fitbit/app/ngd/weight")),n.namespace(e("i18n-load!com/fitbit/app/unit")),n.namespace(e("i18n-load!com/fitbit/app/ngd/tile"));var M={US:n.plural("pound_short")(2),UK:n.plural("stone_short")(2),METRIC:n.plural("kilogram_short")(2)},C=n("units_to_go"),D=n("you_gained_amount"),A=n("you_lost_amount"),G={START_FAT_INVALID:{name:"fat",selector:".bodyFatGoal .goalStart"},TARGET_FAT_INVALID:{name:"fat",selector:".bodyFatGoal .targetGoal"},START_WEIGHT_INVALID:{name:"startWeight",selector:".weightGoal .goalStart"},TARGET_WEIGHT_INVALID:{name:"weight",selector:".weightGoal .targetGoal"}},E=!1,P=!1,I="#,###",L="#,###.0",F={editedFat:!1,editedWeight:!1};return F.reset=function(){this.editedFat=!1,this.editedWeight=!1}.bind(F),new Class({Extends:i,title:n("weight_title"),tileName:"weight",hasModal:!0,tileType:"weight",logUrl:"/weight",weightMetric:null,load:function(){var e=this,i=this.main.eq(0).find(".content"),n=this.settings.find(".settingsContainer");return this.activities=t.viewer.activities(),this.userSettings=t.viewer.getSettingsModel(),this.$container=i,this.$settings=n,i.on("click",".onboarding .confirm",function(){e.showGoalModal()}.bind(this)),i.on("click",".onboarding .no-thanks",function(){e.declineOnboarding(),e.fetchAllModels().then(function(){e.showMainView(),e.showMainContents()})}),i.on("mousedown","a, button",function(e){e.stopPropagation()}),$("body").on("fgmClose",function(){e.fetchAllModelsExceptGoals(!0)}),this.weightGoalModel=new w(null,{user:t.viewer}),this.bodyFatGoalModel=new _(null,{user:t.viewer}),this.mostRecentWeightLogCollection=new x(null,{user:t.viewer,list:{beforeDate:y(this.getDate()).add(1,"days").toDate(),offset:0,limit:1,sort:"desc"}}),this.weightAMonthAgoWeightLogCollection=new x(null,{user:t.viewer,list:{beforeDate:y(this.getDate()).add(1,"days").subtract(1,"month").toDate(),offset:0,limit:1,sort:"desc"}}),this.foodGoalsModel=new S(null,{user:t.viewer}),this.fetchAllModels(!0).then(function(){e.weightMetric=new p(d.getWeightFormat(t.viewer.weightSystem),!1,!0),e.loadSettings(),e.showMainView(),e.showMainContents()}),this},showMainView:function(){var e,i=this,n=this.getDate(),s=this.$container,l=this.getUnits(),h=this.getSubUnits();if(i.isDateEqual(n)){if(this.showingGoal&&(this.showingGoal=!1,s.find(".tileTitle").show(),s.find(".inner-content").show(),s.find(".weightGoal.graph").remove(),s.off("click",".meter-view")),this.userSettings.get("weightTileViewGraph")||this.weightGoalModel.userHasGoal()&&"maintain"===this.weightGoalModel.get("goalType").toLowerCase()||!this.weightGoalModel.userHasGoal())return void i.showGraphView();i.showMainContents(),s.find(".afterTitle").text("/ "+l),e=s.find(".inner-content"),e.length?e.empty():e=$('<div class="inner-content">').appendTo(s),e.show();var c=this.getWeightGoalToGo().grams,d=!c||c<this.weightGoalModel.get("weightThreshold");if(!this.userSettings.get("weightTileDeclineOnboarding")&&t.viewer.isNewUser()&&!this.weightGoalModel.userHasGoal())return e.html(f({})),void s.find(".tileTitle").hide();if(s.find(".tileTitle").show(),d)e.html(r({weightValue:this.getFormattedWeightUnits(this.getCurrentWeight()),weightSubValue:this.getFormattedWeightSubUnits(this.getCurrentWeight()),
units:l,subUnits:h?h.unitPlural():null,unitsToGoMessage:C.substitute([l]),gainOrLossMessage:this.getGainOrLossMessage()})),e.off("click",".met .setGoal"),e.on("click",".met .setGoal",function(e){e.stopPropagation(),e.preventDefault(),i.declineOnboarding(),i.showGoalModal()}),e.off("click",".met .graphView"),e.on("click",".met .graphView",function(e){return e.stopPropagation(),e.preventDefault(),t.viewer.saveSetting("weightTileViewGraph",!0),i.showGraphView(),i.weightGoalModel.deleteGoal().then(this.fetchAllModels.bind(this)),!1});else{var u=this.getWeightGoalToGo();u.units=Math.abs(u.units),u.subUnits=Math.abs(u.subUnits),e.html(o({progressValue:this.getFormattedWeightUnits(this.getWeightGoalToGo()),progressSubValue:this.getFormattedWeightSubUnits(this.getWeightGoalToGo()),weightValue:this.getFormattedWeightUnits(this.getCurrentWeight()),weightSubValue:this.getFormattedWeightSubUnits(this.getCurrentWeight()),units:l,subUnits:h?h.unitPlural():null,atBeginning:this.weightGoalModel.getStartWeightValue().grams===this.getCurrentWeight().grams}))}new a(this.weightGoalModel.getStartWeightValue(),this.weightGoalModel.getWeightValue(),this.getCurrentWeight(),this.getWeightGoalToGo(),e.find(".goalMeter"),i.container,l,h?h.unitPlural():null,{unitType:t.viewer.weightSystem}).render()}},showGraphView:function(){var e=this.getDate(),i=this.$container,n=s(e,273,180),a=this.getUnits(),o=this.getSubUnits(),r=i.find(".inner-content");if(r.length?r.empty():r=$('<div class="inner-content">').appendTo(i),!this.userSettings.get("weightTileDeclineOnboarding")&&t.viewer.isNewUser()&&!this.weightGoalModel.userHasGoal())return r.append($(f({}))),void i.find(".tileTitle").hide();i.find(".tileTitle").show(),this.showingGoal=!0,i.find(".tileTitle").hide(),i.find(".inner-content").hide(),i.find(".weightGoal.graph").remove(),i.append(l({weightValue:this.getFormattedWeightUnits(this.getCurrentWeight()),weightSubValue:this.getFormattedWeightSubUnits(this.getCurrentWeight()),changeValue:this.getFormattedWeightUnits(this.getMonthlyWeightChange()),changeSubValue:this.getFormattedWeightSubUnits(Math.abs(this.getMonthlyWeightChange())),units:a,subUnits:o?o.unitPlural():null,fatValue:this.getCurrentBodyFat()?t.viewer.formatNumber(this.getCurrentBodyFat(),L):""}));var h=i.find(".graphContainer");n.appendTo(h)},showSettings:function(){this.$settings.find(".weightGoal .goalStart, .weightGoal .targetGoal, .bodyFatGoal.goalStart, .bodyFatGoal .targetGoal").removeClass("error"),this.$weightGoalSaveButton.removeClass("error"),this.$fatGoalSaveButton.removeClass("error"),this.$settings.find(".goalOnboarding .addGoal").show(),this.$settings.find(".goalOnboarding .undoDeleteGoal").hide(),v.all([this.fetchGoalModels(!0),this.fetchAllModelsExceptGoals()]).then(function(){this.initializeSettingsInputs(),this.weightGoalModel.userHasGoal()?this.showWeightGoalSettings():this.hideWeightGoalSettings(),this.bodyFatGoalModel.userHasGoal()?this.showBodyFatGoalSettings():this.hideBodyFatGoalSettings(),this.toggle.choose(this.toggle.currentChoice)}.bind(this)),this.parent()},loadSettings:function(){var e=this.$settings,i=this,a={addAGoal:n("add_a_goal"),weightGoal:n("setting_weight_goal"),fatGoal:n("setting_body_fat_goal"),done:n("done"),deleteGoal:n("delete_goal"),saveSettings:n("Save"),cancelSettings:n("cancel")},s=this.getSubUnits();e.empty(),this.settings.find(".settingsFooter").empty(),this.$weightGoalDeleteButton=$('<a class="improved deleteGoal weightGoal">'+a.deleteGoal+"</a>").appendTo(this.settings.find(".settingsFooter")),this.$weightGoalSaveButton=$('<a class="improved dashButton saveSettings saveButton weightGoal">'+a.done+"</a>").appendTo(this.settings.find(".settingsFooter")),this.$fatGoalDeleteButton=$('<a class="improved deleteGoal bodyFatGoal">'+a.deleteGoal+"</a>").appendTo(this.settings.find(".settingsFooter")),this.$fatGoalSaveButton=$('<a class="improved dashButton saveSettings saveButton bodyFatGoal">'+a.done+"</a>").appendTo(this.settings.find(".settingsFooter"));var o,l,r=this.getUnits(),p=this.getFormattedWeightUnits(this.getCurrentWeight()),f=this.getFormattedWeightSubUnits(this.getCurrentWeight()),m=this.weightGoalModel.userHasGoal()?this.getFormattedWeightUnits(this.weightGoalModel.getWeightValue()):p,w=this.weightGoalModel.userHasGoal()?this.getFormattedWeightSubUnits(this.weightGoalModel.getWeightValue()):f,_=b;isNaN(this.weightGoalModel.get("startWeight"))||(p=this.getFormattedWeightUnits(this.weightGoalModel.get("startWeight")),f=this.getFormattedWeightSubUnits(this.weightGoalModel.get("startWeight"))),this.toggle=new u({positionFunction:function(t){return t.appendTo(e)},slideAnimationMS:80,context:{choiceAText:a.weightGoal,choiceBText:a.fatGoal}}),this.toggle.addEvent("toggle",function(t){"a"===t?(e.find(".weightGoal").show(),e.find(".bodyFatGoal").hide(),F.reset(),E&&(F.editedWeight=!0)):(e.find(".weightGoal").hide(),e.find(".bodyFatGoal").show(),F.reset(),P&&(F.editedFat=!0)),i.toggleSettingsButtons()}),this.toggle.choose("a"),$(g({units:r,subUnits:s?s.unitPlural():null,startingWeightGoalValue:p,startingWeightGoalSubValue:"UK"===t.viewer.weightSystem?f:null,goalWeightValue:m,goalWeightSubValue:"UK"===t.viewer.weightSystem?w:null,startingBodyFatGoalValue:this.getCurrentBodyFat()>0?this.formatBodyFat(this.getCurrentBodyFat()?this.getCurrentBodyFat():0):"",goalBodyFatValue:this.bodyFatGoalModel.get("fat")?this.formatBodyFat(this.bodyFatGoalModel.get("fat")):""})).appendTo(e),e.off("click",".bodyFatGoal .goalOnboarding .addGoal"),e.on("click",".bodyFatGoal .goalOnboarding .addGoal",function(){i.getCurrentBodyFat()&&e.find(".bodyFatGoal .goalStart .editable.goalInput").val(t.viewer.formatNumber(i.getCurrentBodyFat(),I)),e.find(".bodyFatGoal .targetGoal .editable.goalInput").val(""),i.showBodyFatGoalSettings()}),this.$fatGoalDeleteButton.on("click",function(){F.editedFat=!0,l=e.find(".bodyFatGoal .targetGoal .editable.goalInput").val(),e.find(".bodyFatGoal .targetGoal .editable.goalInput").val(""),e.find(".bodyFatGoal .goalOnboarding .addGoal").hide(),e.find(".bodyFatGoal .goalOnboarding .undoDeleteGoal").show(),i.$fatGoalSaveButton.removeClass("error"),i.showOrHideBodyFatDeleteButton(!1),i.$fatGoalSaveButton.text(a.done),i.hideBodyFatGoalSettings(),P=!1}),e.off("click",".bodyFatGoal .goalOnboarding .undoDeleteGoal"),e.on("click",".bodyFatGoal .goalOnboarding .undoDeleteGoal",function(){F.editedFat=!1,e.find(".bodyFatGoal .targetGoal .editable.goalInput").val(l),i.showBodyFatGoalSettings(),i.showOrHideBodyFatDeleteButton(!0),P=!0}),e.off("click",".weightGoal .goalOnboarding .addGoal"),e.on("click",".weightGoal .goalOnboarding .addGoal",function(){i.showGoalModal(),i.hideSettings()}),this.$weightGoalDeleteButton.on("click",function(){F.editedWeight=!0,o=e.find(".weightGoal .targetGoal .editable.goalInput").val(),e.find(".weightGoal .targetGoal .editable.goalInput").val(""),e.find(".weightGoal .goalOnboarding .addGoal").hide(),e.find(".weightGoal .goalOnboarding .undoDeleteGoal").show(),i.$weightGoalSaveButton.removeClass("error"),i.showOrHideWeightDeleteButton(!1),i.$weightGoalSaveButton.text(a.done),i.hideWeightGoalSettings(),E=!1}),e.off("click",".weightGoal .goalOnboarding .undoDeleteGoal"),e.on("click",".weightGoal .goalOnboarding .undoDeleteGoal",function(){F.editedFat=!1,e.find(".weightGoal .targetGoal .editable.goalInput").val(o),i.showWeightGoalSettings(),i.showOrHideWeightDeleteButton(!0),E=!0}),this.settings.find(".weightGoal .goalStart .editable, .weightGoal .targetGoal .editable").each(function(){var e=$(this);e.keyup(function(t){9!==t.which&&(F.editedWeight=!0,c.all(e.parent().find(".editable"),function(e){var t=$(e);return t.parents(".targetGoal").length&&!t.val().trim()||_(t.val())})?(i.$weightGoalSaveButton.removeClass("error"),e.parents(".inputContainer").removeClass("error")):(i.$weightGoalSaveButton.addClass("error"),e.parents(".inputContainer").addClass("error")),i.$weightGoalSaveButton.text(a.saveSettings))})}),e.find(".bodyFatGoal .goalStart .editable, .bodyFatGoal .targetGoal .editable").each(function(){var e=$(this);e.keyup(function(t){9!==t.which&&(F.editedFat=!0,c.all(e.parent().find(".editable"),function(e){return!$(e).val().trim()||_($(e).val())})?(i.$fatGoalSaveButton.removeClass("error"),e.parents(".inputContainer").removeClass("error")):(i.$fatGoalSaveButton.addClass("error"),e.parents(".inputContainer").addClass("error")),i.$fatGoalSaveButton.text(a.saveSettings))})}),e.find(".unit, .subUnit").click(function(){$(this).prev(".editable").focus()}),e.find(".editable").focus(function(){$(this).closest(".textDecoration").addClass("active")}),e.find(".editable").blur(function(){$(this).closest(".textDecoration").removeClass("active")}),"UK"===t.viewer.weightSystem&&e.find(".textDecoration").addClass("uk"),[this.$weightGoalSaveButton,this.$fatGoalSaveButton].forEach(function(n){n.click(function(){if(!F.editedFat&&!F.editedWeight)return void i.hideSettings();var n=t.viewer.parseNumber.bind(t.viewer),a=e.find(".weightGoal .goalStart .editable.goalInput").val(),s=_(a)?d.truncateToTenthsPlace(n(a).toFloat()):null,o=e.find(".weightGoal .goalStart .editable.goalSubInput").val(),l=_(o)?d.truncateToTenthsPlace(n(o).toFloat()):null,r=e.find(".weightGoal .targetGoal .editable.goalInput").val(),u=_(r)?d.truncateToTenthsPlace(n(r).toFloat()):null,p=e.find(".weightGoal .targetGoal .editable.goalSubInput").val(),g=_(p)?d.truncateToTenthsPlace(n(p).toFloat()):null,f=!(_(r)||r&&r.toString().trim().length),m=e.find(".bodyFatGoal .goalStart .editable.goalInput").val(),b=_(m)?n(m).toFloat():null,w=e.find(".bodyFatGoal .targetGoal .editable.goalInput").val(),x=_(w)?n(w).toFloat():null,k=!(_(w)||x&&x.toString().trim().length),S=!1;if(e.find(c.pluck(c.values(G),"selector").join(",")).removeClass("error"),!F.editedFat||_(w)||k||(e.find(".bodyFatGoal .targetGoal").addClass("error"),S=!0),!F.editedWeight||_(r)||f||(e.find(".weightGoal .targetGoal").addClass("error"),S=!0),!F.editedWeight||_(a)||f||(e.find(".weightGoal .goalStart").addClass("error"),S=!0),F.editedFat&&m.trim()&&!_(m)&&!k&&(e.find(".bodyFatGoal .goalStart").addClass("error"),S=!0),"UK"===t.viewer.weightSystem&&(!F.editedWeight||_(o)||f||(e.find(".weightGoal .goalStart").addClass("error"),S=!0),!F.editedWeight||_(p)||f||(e.find(".weightGoal .targetGoal").addClass("error"),S=!0),S||(s=Math.floor(s),u=Math.floor(u))),S)return!1;var M=[];return F.editedFat&&(k?M.push(i.bodyFatGoalModel.deleteGoal()):(M.push(new v(function(t,n){i.bodyFatGoalModel.save({fat:x,startFat:b,userHasGoal:!0},{wait:!0,success:t,error:function(t,a){a.errors&&c.any(a.errors,function(e){return"fat"===e.fieldName})&&e.find(G.TARGET_FAT_INVALID.selector).addClass("error"),i.$fatGoalSaveButton.addClass("error"),n.apply(null,arguments)}})})),null!==m&&!function(){var n=y(),a={units:i.getCurrentWeight().units,subUnits:i.getCurrentWeight().subUnits,fat:m,date:h.ajaxEncode(n.toDate())};i.mostRecentWeightLogCollection.length>0&&i.mostRecentWeightLogCollection.first().date===a.date&&(a.time=i.mostRecentWeightLogCollection.first().time);var s=new T({},{user:t.viewer});M.push([new v(function(t,i){s.saveWeightLog(a).then(t,function(){e.find(G.START_FAT_INVALID.selector).addClass("error"),i.apply(null,arguments)})})])}())),F.editedWeight&&(f?M.push(i.weightGoalModel.deleteGoal()):(i.weightGoalModel.once("error",function(t,n){var a=JSON.parse(n.responseText);a.errors&&(c.any(a.errors,function(e){return"startWeight"===e.fieldName})&&e.find(G.START_WEIGHT_INVALID.selector).addClass("error"),c.any(a.errors,function(e){return"weight"===e.fieldName})&&e.find(G.TARGET_WEIGHT_INVALID.selector).addClass("error")),i.$weightGoalSaveButton.addClass("error")}),M.push(new v(function(e,t){var n=i.weightGoalModel.get("startDate");n||(n=h.ajaxEncode(new Date)),i.weightGoalModel.saveWeightGoal({startDate:n,startWeight:{units:s,subUnits:l},targetWeight:{units:u,subUnits:g}}).then(e,t)})))),v.all(M).then(function(){i.declineOnboarding(),i.fetchAllModelsExceptGoals(!0).then(function(){i.weightGoalModel.userHasGoal()?i.showMainView():i.showGraphView()}),i.hideSettings(),e.find(c.pluck(c.values(G),"selector").join(",")).removeClass("error"),F.editedFat&&i.$fatGoalSaveButton.removeClass("error"),F.editedWeight&&i.$weightGoalSaveButton.removeClass("error")}),!1})})},hideButton:function(e){e.css("display","none")},showButton:function(e){e.css("display","inline-block")},toggleSettingsButtons:function(){"a"===this.toggle.currentChoice?(this.hideButton(this.$fatGoalSaveButton),this.hideButton(this.$fatGoalDeleteButton),this.showButton(this.$weightGoalSaveButton),this.showOrHideWeightDeleteButton()):(this.hideButton(this.$weightGoalSaveButton),this.hideButton(this.$weightGoalDeleteButton),this.showButton(this.$fatGoalSaveButton),this.showOrHideBodyFatDeleteButton())},showOrHideWeightDeleteButton:function(e){"undefined"!=typeof e&&e||"undefined"==typeof e&&E?(this.$weightGoalDeleteButton.show(),this.$weightGoalSaveButton.removeClass("centered")):(this.$weightGoalDeleteButton.hide(),this.$weightGoalSaveButton.addClass("centered"))},showOrHideBodyFatDeleteButton:function(e){"undefined"!=typeof e&&e||"undefined"==typeof e&&P?(this.$fatGoalDeleteButton.show(),this.$fatGoalSaveButton.removeClass("centered")):(this.$fatGoalDeleteButton.hide(),this.$fatGoalSaveButton.addClass("centered"))},initializeSettingsInputs:function(){var e="UK"===t.viewer.weightSystem,i=this.weightGoalModel.userHasGoal()?this.weightGoalModel.getStartWeightValue():this.getCurrentWeight(),n=this.weightGoalModel.getWeightValue();this.$settings.find(".weightGoal .goalStart .goalInput").val(this.getFormattedWeightUnits(i)),e&&this.$settings.find(".weightGoal .goalStart .goalSubInput").val(this.getFormattedWeightSubUnits(i)),this.$settings.find(".weightGoal .targetGoal .goalInput").val(this.getFormattedWeightUnits(n)),e&&this.$settings.find(".weightGoal .targetGoal .goalSubInput").val(this.getFormattedWeightSubUnits(n)),this.$settings.find(".bodyFatGoal .goalStart .goalInput").val(this.getCurrentBodyFat()?this.formatBodyFat(this.getCurrentBodyFat()):""),this.$settings.find(".bodyFatGoal .targetGoal .goalInput").val(this.bodyFatGoalModel.userHasGoal()?this.formatBodyFat(this.bodyFatGoalModel.get("fat")):"")},hideWeightGoalSettings:function(){E=!1,this.$settings.find(".weightGoal .goalEdit").hide(),this.$settings.find(".weightGoal .goalOnboarding").show()},showWeightGoalSettings:function(){E=!0,this.$settings.find(".weightGoal .goalEdit").show(),this.$settings.find(".weightGoal .goalOnboarding").hide()},hideBodyFatGoalSettings:function(){P=!1,this.$settings.find(".bodyFatGoal .goalEdit").hide(),this.$settings.find(".bodyFatGoal .goalOnboarding").show()},showBodyFatGoalSettings:function(){P=!0,this.$settings.find(".bodyFatGoal .goalEdit").show(),this.$settings.find(".bodyFatGoal .goalOnboarding").hide()},showGoalModal:function(){this.goalModal=new m(this),this.goalModal.open()},declineOnboarding:function(){this.userSettings.get("weightTileDeclineOnboarding")||t.viewer.saveSetting("weightTileDeclineOnboarding",!0)},resetViewGraphSetting:function(){this.userSettings.get("weightTileViewGraph")&&t.viewer.saveSetting("weightTileViewGraph",!1)},getUnits:function(){return M[t.viewer.weightSystem]},getSubUnits:function(){return c.find(d.getWeightFormat(t.viewer.weightSystem),function(e){return"subUnit"===e.type})},getWeightString:function(e){var t=this.getSubUnits();return this.getFormattedWeightUnits(e)+" "+this.getUnits()+(t?" "+this.getFormattedWeightSubUnits(e)+" "+t.unitPlural():"")},getGainOrLossMessage:function(){var e=this.weightGoalModel.get("weight"),i=this.weightGoalModel.get("startWeight"),n=Math.abs(e-i),a="GAIN"===this.weightGoalModel.get("goalType")?D:A;return a.substitute([this.getWeightString(d.createWeightValue(n,t.viewer.weightSystem))])},getFormattedWeightUnits:function(e){var t=this.weightMetric.update(e.units,e.subUnits).getUnitValue();return t?t.value:""},getFormattedWeightSubUnits:function(e){var t=this.weightMetric.update(e.units,e.subUnits).getSubUnitValue();return t?t.value:""},formatBodyFat:function(e){return t.viewer.formatNumber(e,I)},fetchAllModels:function(e){return this.loggingPromise(v.all([this.fetchMostRecentWeightLogCollection(e),this.fetchWeightAMonthAgoWeightLogCollection(e),this.fetchGoalModels(e)]))},fetchAllModelsExceptGoals:function(e){return this.loggingPromise(v.all([this.fetchMostRecentWeightLogCollection(e),this.fetchWeightAMonthAgoWeightLogCollection(e)]))},fetchGoalModels:function(e){return v.all([this.fetchWeightGoalModel(e),this.fetchBodyFatGoalModel(e),this.fetchFoodGoalsModel(e)])},fetchMostRecentWeightLogCollection:function(e){return new v(function(i,n){this.wrapModelFetch(this.mostRecentWeightLogCollection,e).then(function(){this.mostRecentWeightLogCollection.length?i():(this.mostRecentWeightLogCollection=new x(null,{user:t.viewer,list:{afterDate:y(this.getDate()).subtract(1e3,"years").toDate(),offset:0,limit:1,sort:"asc"}}),this.wrapModelFetch(this.mostRecentWeightLogCollection,e).then(i,n))}.bind(this))}.bind(this))},fetchWeightAMonthAgoWeightLogCollection:function(e){return this.wrapModelFetch(this.weightAMonthAgoWeightLogCollection,e)},fetchWeightGoalModel:function(e){return this.wrapModelFetch(this.weightGoalModel,e)},fetchBodyFatGoalModel:function(e){return this.wrapModelFetch(this.bodyFatGoalModel,e)},fetchFoodGoalsModel:function(e){return this.wrapModelFetch(this.foodGoalsModel,e)},wrapModelFetch:function(e,t){return t||e.models&&"length"in e&&!e.length||e.isValid&&!e.isValid()||e.isNew&&e.isNew()?this.loggingPromise(new v(function(t,i){e.fetch({success:t,error:i})})):this.autoResolve()},loggingPromise:function(e){return new v(function(t,i){e.then(t,function(){var e=JSON.stringify(Array.prototype.splice.apply(arguments));console.error?console.error(e):console.log("Error: "+e),i.apply(null,e)})})},autoResolve:function(){return new v(function(e){e()})},getWeightGoalToGo:function(){return this.weightGoalModel.userHasGoal()?"lose"===this.weightGoalModel.get("goalType").toLowerCase()&&this.getCurrentWeight().grams<=this.weightGoalModel.getWeightValue().grams?this.zeroWeightValue():"gain"===this.weightGoalModel.get("goalType").toLowerCase()&&this.getCurrentWeight().grams>=this.weightGoalModel.getWeightValue().grams?this.zeroWeightValue():d.createWeightValue(Math.abs(this.weightGoalModel.getWeightValue().grams-this.getCurrentWeight().grams),t.viewer.weightSystem):this.zeroWeightValue()},zeroWeightValue:function(){return d.createWeightValue(0,t.viewer.weightSystem)},getCurrentWeight:function(){return this.mostRecentWeightLogCollection.first().getWeightValue()},getCurrentBodyFat:function(){var e=this.mostRecentWeightLogCollection.first();return e&&e.has("fat")?e.get("fat"):0},getMostRecentWeightLog:function(){return this.mostRecentWeightLogCollection.first()},getWeightAMonthAgo:function(){var e=this.weightAMonthAgoWeightLogCollection.first();return e?e.getWeightValue():this.getMostRecentWeightLog().getWeightValue()},getMonthlyWeightChange:function(){return d.createWeightValue(this.getCurrentWeight().grams-this.getWeightAMonthAgo().grams,t.viewer.weightSystem)},logWeightGoalView:function(){k.logV2Event({id:k.INTERACTION_IDS.VIEW_WEIGHT_GOAL,type:"screen"}),this.trackEditWeightGoal()},logBodyFatGoalView:function(){k.logV2Event({id:k.INTERACTION_IDS.VIEW_BODY_FAT_GOAL,type:"screen"}),this.trackEditFatGoal()}})}),define("hbs!galileo/tile/template/badges",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/badges","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a="";return a+='\n<div class="badgeWrapper chartContainer">\n    ',n=i["if"].call(e,e.multipleBadges,{hash:{},inverse:x.noop,fn:x.program(2,o,t)}),(n||0===n)&&(a+=n),a+='\n\n    <div class="badgeTileCont">\n\n        ',n=i["if"].call(e,e.emptyState,{hash:{},inverse:x.program(9,c,t),fn:x.program(4,l,t)}),(n||0===n)&&(a+=n),a+="\n    </div>\n</div>\n"}function o(e,t){return'\n        <nav class="back"></nav>\n        <nav class="next"></nav>\n    '}function l(e,t){var n,a="";return a+='\n            <div class="emptyRow">\n\n                ',n=i["if"].call(e,e.deviceWeight,{hash:{},inverse:x.program(7,h,t),fn:x.program(5,r,t)}),(n||0===n)&&(a+=n),a+="\n\n            </div>\n        "}function r(e,t){var n,a,s,o="";return o+="\n                    <p>",s={hash:{}},n=i.i18n,a=n?n.call(e,"get_started_badges",s):_.call(e,"i18n","get_started_badges",s),(a||0===a)&&(o+=a),o+="</p>\n                    <p>",s={hash:{}},n=i.i18n,a=n?n.call(e,"set_weight_goal_start",s):_.call(e,"i18n","set_weight_goal_start",s),(a||0===a)&&(o+=a),o+="</p>\n                "}function h(e,t){var n,a,s,o="";return o+="\n                    <p>",s={hash:{}},n=i.i18n,a=n?n.call(e,"get_stepping_earn_badges",s):_.call(e,"i18n","get_stepping_earn_badges",s),(a||0===a)&&(o+=a),o+="</p>\n                    <p>",s={hash:{}},n=i.i18n,a=n?n.call(e,"earn_first_badge",s):_.call(e,"i18n","earn_first_badge",s),(a||0===a)&&(o+=a),o+="</p>\n                "}function c(e,t){var n,a="";return a+='\n            <ul class="badgeCollection clearfix">\n                ',n=i.each.call(e,e.badgeList,{hash:{},inverse:x.noop,fn:x.program(10,d,t)}),(n||0===n)&&(a+=n),a+="\n            </ul>\n        "}function d(e,t){var n,a,s,o="";return o+="\n                    ",s={hash:{},inverse:x.noop,fn:x.program(11,u,t)},n=i["i18n-namespace"],a=n?n.call(e,"com.fitbit.app.ngd.badges",s):_.call(e,"i18n-namespace","com.fitbit.app.ngd.badges",s),(a||0===a)&&(o+=a),o+="\n                "}function u(e,t){var n,a="";return a+="\n                    ",n=i["if"].call(e,e.isWeightBadge,{hash:{},inverse:x.program(17,m,t),fn:x.program(12,p,t)}),(n||0===n)&&(a+=n),a+="\n                    "}function p(e,t){var n,a="";return a+="\n                        ",n=i["if"].call(e,e.weightNoHover,{hash:{},inverse:x.program(15,f,t),fn:x.program(13,g,t)}),(n||0===n)&&(a+=n),a+='\n                            <div class="metricContainer"><span class="metric metricLarge"><span class="number">',(n=i.quantityEarned)?n=n.call(e,{hash:{}}):(n=e.quantityEarned,n=typeof n===T?n.apply(e):n),a+=k(n)+'</span><span class="unit">',(n=i.quantityUnit)?n=n.call(e,{hash:{}}):(n=e.quantityUnit,n=typeof n===T?n.apply(e):n),a+=k(n)+'</span> </span></div>\n                            <div><span class="label">',(n=i.label)?n=n.call(e,{hash:{}}):(n=e.label,n=typeof n===T?n.apply(e):n),a+=k(n)+"</span></div>\n                            </li>\n                        "}function g(e,t){var n,a="";return a+='\n                            <li class="badgeTile ',(n=i.className)?n=n.call(e,{hash:{}}):(n=e.className,n=typeof n===T?n.apply(e):n),a+=k(n)+'">\n                        '}function f(e,t){var n,a,s,o="";return o+='\n                            <li class="badgeTile ',(n=i.className)?n=n.call(e,{hash:{}}):(n=e.className,n=typeof n===T?n.apply(e):n),o+=k(n)+'"\n                                data-hover="',s={hash:{}},n=i.i18n,a=n?n.call(e,"next_up",s):_.call(e,"i18n","next_up",s),(a||0===a)&&(o+=a),o+=" ",(a=i.nextQuantity)?a=a.call(e,{hash:{}}):(a=e.nextQuantity,a=typeof a===T?a.apply(e):a),o+=k(a)+" ",(a=i.quantityUnit)?a=a.call(e,{hash:{}}):(a=e.quantityUnit,a=typeof a===T?a.apply(e):a),o+=k(a)+'"\n                                data-initial="',(a=i.label)?a=a.call(e,{hash:{}}):(a=e.label,a=typeof a===T?a.apply(e):a),o+=k(a)+'"\n                            >\n                        '}function m(e,t){var n,a="";return a+='\n                        <li class="badgeTile ',(n=i.className)?n=n.call(e,{hash:{}}):(n=e.className,n=typeof n===T?n.apply(e):n),a+=k(n)+'"\n                            ',n=i.unless.call(e,e.nextNotNeeded,{hash:{},inverse:x.noop,fn:x.program(18,v,t)}),(n||0===n)&&(a+=n),a+='\n                            data-initial="',(n=i.label)?n=n.call(e,{hash:{}}):(n=e.label,n=typeof n===T?n.apply(e):n),a+=k(n)+'"\n                        >\n                            <div class="metricContainer"><span class="metric metricLarge"><span class="number">',(n=i.quantityEarned)?n=n.call(e,{hash:{}}):(n=e.quantityEarned,n=typeof n===T?n.apply(e):n),a+=k(n)+'</span><span class="unit">',(n=i.quantityUnit)?n=n.call(e,{hash:{}}):(n=e.quantityUnit,n=typeof n===T?n.apply(e):n),a+=k(n)+'</span> </span></div>\n                            <div><span class="label">',(n=i.label)?n=n.call(e,{hash:{}}):(n=e.label,n=typeof n===T?n.apply(e):n),a+=k(n)+"</span></div>\n                        </li>\n                    "}function v(e,t){var n,a,s,o="";return o+='\n                                data-hover="',s={hash:{}},n=i.i18n,a=n?n.call(e,"next_up",s):_.call(e,"i18n","next_up",s),(a||0===a)&&(o+=a),o+=" ",(a=i.nextQuantity)?a=a.call(e,{hash:{}}):(a=e.nextQuantity,a=typeof a===T?a.apply(e):a),o+=k(a)+" ",(a=i.quantityUnit)?a=a.call(e,{hash:{}}):(a=e.quantityUnit,a=typeof a===T?a.apply(e):a),o+=k(a)+'"\n                            '}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var y,b,w,_=i.helperMissing,x=this,T="function",k=this.escapeExpression;return w={hash:{},inverse:x.noop,fn:x.program(1,s,a)},y=i["i18n-namespace"],b=y?y.call(t,"com.fitbit.app.ngd.badges",w):_.call(t,"i18n-namespace","com.fitbit.app.ngd.badges",w),b||0===b?b:""});return e.registerPartial("galileo_tile_template_badges",t),t}),define("galileo/model/badges",["require","galileo/ajax/ajax","shared/scripts/modules/api-client","galileo/model/user"],function(e){var t=e("galileo/ajax/ajax"),i=e("shared/scripts/modules/api-client"),n=e("galileo/model/user"),a=1;return{loadTopWithUpcomingBadges:function(e){if(n.viewer.isBadgesTileUsingAjax){var s=i.makeFullUrl("/"+a+"/user/-/badges/topwithupcoming.json");i.ajax({url:s,success:function(t,i,n){e(t)}})}else t.getOwner("getTopWithUpcomingBadges","badge",{},function(t){e(t)})},loadAchievements:function(e){t.getOwner("getLifetimeAchievementsTracker","achievement",{},function(t){e(t)})}}}),define("galileo/widget/carousel",["require","mootools","jquery"],function(e){return e("mootools"),e("jquery"),new Class({Implements:[Options],options:{activeClass:"active",circular:!1,clonedClass:"cloned",disabledClass:"disabled",easing:"swing",initialIndex:0,item:null,items:".items",next:".next",prev:".prev",speed:400},current:null,find:function(e,t){var i=$(t);return i.length<2?i:e.parent().find(t)},initialize:function(e,t){this.setOptions(t),t=this.options;var i=this,n=$(e),a=n.add(i),s=n.children(),o=0;if(i.current||(i.current=i),s.length>1&&(s=$(t.items,n)),$.extend(i,{getConf:function(){return t},getIndex:function(){return o},getSize:function(){return i.getItems().size()},getNaviButtons:function(){return h.add(c)},getRoot:function(){return n},getItemWrap:function(){return s},getItems:function(){return s.children(t.item).not("."+t.clonedClass)},move:function(e,t){return i.seekTo(o+e,t)},next:function(e){return i.move(1,e)},prev:function(e){return i.move(-1,e)},begin:function(e){return i.seekTo(0,e)},end:function(e){return i.seekTo(i.getSize()-1,e)},focus:function(){return i.current=i,i},addItem:function(e){return e=$(e),t.circular?(s.children("."+t.clonedClass+":last").before(e),s.children("."+t.clonedClass+":first").replaceWith(e.clone().addClass(t.clonedClass))):s.append(e),a.trigger("onAddItem",[e]),i},seekTo:function(e,n,l){if(e.jquery||(e*=1),t.circular&&0===e&&-1==o&&0!==n)return i;if(!t.circular&&0>e||e>i.getSize()||-1>e)return i;var r=e;e.jquery?e=i.getItems().index(e):r=i.getItems().eq(e);var h=$.Event("onBeforeSeek");if(!l&&(a.trigger(h,[e,n]),h.isDefaultPrevented()||!r.length))return i;var c={left:-r.position().left};return o=e,i.current=i,void 0===n&&(n=t.speed),s.animate(c,n,t.easing,l||function(){a.trigger("onSeek",[e])}),i}}),$.each(["onBeforeSeek","onSeek","onAddItem"],function(e,n){$.isFunction(t[n])&&$(i).bind(n,t[n]),i[n]=function(e){return e&&$(i).bind(n,e),i}}),t.circular){var l=i.getItems().slice(-1).clone().prependTo(s),r=i.getItems().eq(1).clone().appendTo(s);l.add(r).addClass(t.clonedClass),i.onBeforeSeek(function(e,t,n){return e.isDefaultPrevented()?void 0:-1===t?(i.seekTo(l,n,function(){i.end(0)}),e.preventDefault()):void(t===i.getSize()&&i.seekTo(r,n,function(){i.begin(0)}))}),i.seekTo(0,0,function(){})}var h=i.find(n,t.prev).click(function(){i.prev()}),c=i.find(n,t.next).click(function(){i.next()});!t.circular&&i.getSize()>1&&(i.onBeforeSeek(function(e,n){setTimeout(function(){e.isDefaultPrevented()||(h.toggleClass(t.disabledClass,0>=n),c.toggleClass(t.disabledClass,n>=i.getSize()-1))},1)}),t.initialIndex||h.addClass(t.disabledClass)),t.initialIndex&&i.seekTo(t.initialIndex,0,function(){})}})}),define("galileo/tile/badges",["require","mootools","jquery","./classes/small","galileo/model/user","hbs!./template/badges","i18n/i18n","galileo/model/badges","galileo/ajax/ajax","galileo/widget/carousel","i18n-load!com/fitbit/app/ngd/badges"],function(e){e("mootools"),e("jquery");var t=e("./classes/small"),i=e("galileo/model/user"),n=e("hbs!./template/badges"),a=e("i18n/i18n")(),s=e("galileo/model/badges"),o=(e("galileo/ajax/ajax"),e("galileo/widget/carousel"));a.namespace(e("i18n-load!com/fitbit/app/ngd/badges"));var l={floors_daily:a("floors_daily"),steps_daily:a("steps_daily"),floors_lifetime:a("floors_lifetime"),miles_lifetime:a("miles_lifetime"),kilometers_lifetime:a("kilometers_lifetime"),next_floors_daily:a("next_floors_daily"),next_steps_daily:a("next_steps_daily"),next_floors_lifetime:a("next_floors_lifetime"),next_steps_lifetime:a("next_steps_lifetime"),next_miles_lifetime:a("next_miles_lifetime"),grams:a("grams"),pounds:a("pounds"),steps:a("steps"),floors:a("floors"),miles:a("miles"),kilometers:a("kilometers"),best_in_a_day:a("best_in_a_day"),lifetime_climb:a("lifetime_climb"),lifetime_distance:a("lifetime_distance"),weight_loss:a("weight_loss")},r=function(e){return l[e]},h=function(e,t){return i.viewer.formatNumber(e,t)};return new Class({Extends:t,options:{},savable:!1,tileName:"badges",hasModal:!0,title:a("top_badges"),logUrl:"/badges/all",load:function(){var e=this,t=this.main.eq(0).find(".content"),o=(i.viewer.activities(),this.getDate());e.isDateEqual(o)&&(this.showMainContents(),s.loadTopWithUpcomingBadges(function(s){var o=Object.clone(s);if(o.badgeList=o.activityBadges.append(o.weightBadges),o.badgeList.length>1)o.multipleBadges=!0;else{if(1!==o.badgeList.length)return o.deviceWeight=i.viewer.deviceFeatures.WEIGHT,o.emptyState=!0,void t.append(n(o));t.find("nav").hide()}var l=function(e,t){$.each(e,function(){var e=this.className.match(/weight/)?!0:!1,t=this.className.match(/finish/g)?!0:!1,i=this.nextClassName.match(/finish/g)?!0:!1,n=(this.className.match(/start/g)?!0:!1,this.nextQuantity&&this.nextQuantity>0?!1:!0),s=!(!e||!i)||n;1===this.quantityEarned?this.quantityEarned=a(t?"goal_met":"goal_set"):(this.leftToGo=h(this.nextQuantity-this.quantityEarned,"#,###"),this.quantityEarned="grams"===this.quantityUnit?h(Math.round(this.quantityEarned/1e3),"#,###"):h(this.quantityEarned,"#,###"),this.nextQuantity=this.nextQuantity?h(this.nextQuantity,"#,###"):""),this.label=r(this.label),this.toGoText=a(this.lifetime?"more_to_go":"more_to_earn_today"),this.description=this.lifetime?this.description:"",this.quantityUnit=r(this.quantityUnit),this.weightNoHover=e&&i||e&&t?!0:!1,this.isWeightBadge=e,this.nextNotNeeded=s}),o[t]=e};o.activityBadges.length&&l(o.activityBadges,"activityBadges"),t.append(n(o)),e.tileHover(t),setTimeout(function(){e.initializeCarousel(t)},300)}))},initializeCarousel:function(e){var t=e.find(".badgeTileCont");new o(t,{circular:!0,items:".badgeTile",next:".next",prev:".back",speed:500})},tileHover:function(e){var t=e.find(".badgeTile"),i=e.find("nav"),n=this;i&&i.hover(function(){n.hasModal=!1},function(){n.hasModal=!0}),t.each(function(){var t=$(this).data("hover"),i=$(this).data("initial"),n=$(this).find(".label"),a=this;t&&e.hover(function(){$(a).addClass("over"),n.text(t)},function(){$(a).removeClass("over"),n.text(i)})})},setDate:function(e){this.date=e}})}),define("galileo/tile/classes/wide",["require","mootools","jquery","galileo/prototype/all","./base","i18n/i18n","i18n-load!com/fitbit/app/ngd/tile","hbs!../template/mainContents"],function(e){
e("mootools"),e("jquery"),e("galileo/prototype/all");var t=e("./base"),i=e("i18n/i18n")();return i.namespace(e("i18n-load!com/fitbit/app/ngd/tile")),new Class({Extends:t,shape:"wide",options:{tileClass:"wide",controlsList:[{name:i("Settings"),"class":"settingsButton wideLeft showSettings",glyphName:"show-settings"},{name:i("See_More"),"class":"more rightSide",glyphName:"arrow-right"}]},initialize:function(e){this.parent(e),this.renderMainContents(),this.showLoading()},renderMainContents:function(){this.mainContents&&(this.mainContents=void this.mainContents.remove());var t=e("hbs!../template/mainContents");return this.mainContents=$(t({title:this.title,afterTitle:this.afterTitle,controlsList:this.getControlsList(),savable:this.savable})),this.main=this.mainContents.closest(".main"),this.settings=this.mainContents.closest(".settings"),this.initializeSettings(),this},setDate:function(e){return this.parent(e),this.showLoading(),this.renderMainContents(),this.load(),this.trigger("dateChange",e),this}})}),define("hbs!galileo/tile/template/activity",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/activity","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,l="";return l+='\n<nav class="graph-controls">\n    <select class="series" title="',s={hash:{}},n=i.i18n,a=n?n.call(e,"series",s):f.call(e,"i18n","series",s),(a||0===a)&&(l+=a),l+='">\n        ',a=i.each.call(e,e.series,{hash:{},inverse:g.noop,fn:g.program(2,o,t)}),(a||0===a)&&(l+=a),l+='\n    </select>\n\n    <select class="period" title="',s={hash:{}},n=i.i18n,a=n?n.call(e,"time_period",s):f.call(e,"i18n","time_period",s),(a||0===a)&&(l+=a),l+='">\n        ',a=i.each.call(e,e.periods,{hash:{},inverse:g.noop,fn:g.program(5,r,t)}),(a||0===a)&&(l+=a),l+='\n    </select>\n</nav>\n<div class="chartContainer"></div>\n<div class="legendContainer chart"></div>\n'}function o(e,t){var n,a="";return a+='\n            <option\n                value="',(n=i.value)?n=n.call(e,{hash:{}}):(n=e.value,n=typeof n===u?n.apply(e):n),a+=p(n)+'"\n                title="',(n=i.text)?n=n.call(e,{hash:{}}):(n=e.text,n=typeof n===u?n.apply(e):n),a+=p(n)+'"\n                ',n=i["if"].call(e,e.isSelected,{hash:{},inverse:g.noop,fn:g.program(3,l,t)}),(n||0===n)&&(a+=n),a+="\n            ></option>\n        "}function l(e,t){return'\n                    selected="selected"\n                '}function r(e,t){var n,a="";return a+='\n            <option\n                value="',(n=i.value)?n=n.call(e,{hash:{}}):(n=e.value,n=typeof n===u?n.apply(e):n),a+=p(n)+'"\n                ',n=i["if"].call(e,e.isSelected,{hash:{},inverse:g.noop,fn:g.program(3,l,t)}),(n||0===n)&&(a+=n),a+="\n            >",(n=i.text)?n=n.call(e,{hash:{}}):(n=e.text,n=typeof n===u?n.apply(e):n),a+=p(n)+"</option>\n        "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var h,c,d,u="function",p=this.escapeExpression,g=this,f=i.helperMissing;return d={hash:{},inverse:g.noop,fn:g.program(1,s,a)},h=i["i18n-namespace"],c=h?h.call(t,"com.fitbit.app.ngd.activity",d):f.call(t,"i18n-namespace","com.fitbit.app.ngd.activity",d),c||0===c?c:""});return e.registerPartial("galileo_tile_template_activity",t),t}),define("galileo/graph/configs/activity",[],function(){var e={chart_column_gradient:{x1:0,y1:0,x2:0,y2:1},goalLine:{dashstyle:"4,1",strokeWidth:2},column:{weekWidth:47,weeksWidth:12},colBorderRadius:{tl:2,tr:2},yAxisLabel:{alignment:"left",yAxisLabels_x:20,yAxisLabels_y:4},labelStyle:{fontFamily:"Proxima Nova Regular",fontSize:12},marginRect:{x:0,y:0,width:60,height:135,radius:0,zIndex:3}};return e}),define("galileo/graph/scrollableChart",["jquery","highcharts"],function(e,t){function i(t,i){function n(){var i=e('<button type="button" class="back" data-direction="left">Back</button>'),n=e('<button type="button" class="next" data-direction="right">Next</button>');i.add(n).click(function(){clearInterval(a),s.pan(e(this).data("direction"))}).appendTo(t.container.parentNode)}var a,s=this,o=0,l=t.xAxis[0];s.init=function(){return n(),s.stepTo("initialPosition"in i?i.initialPosition:i.min,i.panStep,"",!1),s},s.scrollTo=function(e,t){var n=Math.min(Math.max(e-i.panStep/2,i.min),i.max-i.panStep);l.setExtremes(n,n+i.panStep,!0,t)},s.snapPosition=function(e,t,n){var a={left:-1,right:1}[n]||0,s=i.min+i.panStep/2,o=i.max-i.panStep/2;e=Math.min(Math.max(e,s),o);var l=Math.ceil(i.valueSpan/t),r=i.valueSpan/l,h=Math.floor((e-i.min)/r)+a;return h=Math.min(Math.max(h,0),l-1),i.min+r*h+r/2},s.stepTo=function(e,t,i,n){o=s.snapPosition(e,t,i),s.scrollTo(o,n)},s.pan=function(e){s.stepTo(o,i.panStep,e,!0)},s.scroll=function(e){s.stepTo(o,i.scrollStep,e,!1)},s.init()}return i}),define("hbs!galileo/graph/template/tooltipHeartRateZone",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var s,o="",l="function",r=this.escapeExpression;return o+='<div class="graphTip">\n    <div class="date">\n        ',(s=i.timeInterval)?s=s.call(t,{hash:{}}):(s=t.timeInterval,s=typeof s===l?s.apply(t):s),o+=r(s)+'\n    </div>\n    <div class="details">\n        ',(s=i.valueAndUnit)?s=s.call(t,{hash:{}}):(s=t.valueAndUnit,s=typeof s===l?s.apply(t):s),o+=r(s)+'\n    </div>\n    <div class="moreDetail">\n        ',(s=i.calBurnValueAndUnit)?s=s.call(t,{hash:{}}):(s=t.calBurnValueAndUnit,s=typeof s===l?s.apply(t):s),o+=r(s)+'\n    </div>\n    <div class="moreDetail">\n        ',(s=i.defaultZone)?s=s.call(t,{hash:{}}):(s=t.defaultZone,s=typeof s===l?s.apply(t):s),o+=r(s)+'\n    </div>\n    <div class="moreDetail">\n        ',(s=i.customZone)?s=s.call(t,{hash:{}}):(s=t.customZone,s=typeof s===l?s.apply(t):s),o+=r(s)+"\n    </div>\n</div>\n"});return e.registerPartial("galileo_graph_template_tooltipHeartRateZone",t),t}),define("galileo/graph/intraday",["require","mootools","./tooltip","i18n/i18n","galileo/color/graph","./configs/activity","galileo/ajax/ajax","./base","galileo/model/user","galileo/graph/scrollableChart","hbs!./template/tooltipHeartRateZone","galileo/util/dateUtil","jquery","i18n-load!com/fitbit/app/ngd/intraday","i18n-load!com/fitbit/app/unit"],function(e){function t(e){return e===_?n("zone_peak"):e===w?n("zone_cardio"):e===b?n("zone_fat_burn"):e===x?n("zone_custom"):""}e("mootools");var i=e("./tooltip"),n=e("i18n/i18n")(),a=e("galileo/color/graph"),s=e("./configs/activity"),o=e("galileo/ajax/ajax"),l=e("./base"),r=e("galileo/model/user").viewer,h=r.activities(),c=!1,d=e("galileo/graph/scrollableChart"),u=e("hbs!./template/tooltipHeartRateZone"),p=e("galileo/util/dateUtil"),g=e("jquery"),f=a.heartRateLine.noZone,m=a.heartRateLine.fatBurn,v=a.heartRateLine.cardio,y=a.heartRateLine.peak,b="IN_DEFAULT_ZONE_1",w="IN_DEFAULT_ZONE_2",_="IN_DEFAULT_ZONE_3",x="IN_CUSTOM_ZONE",T=220,k=0,S=30,M=15,C=5,D={linearGradient:s.chart_column_gradient};return n.namespace(e("i18n-load!com/fitbit/app/ngd/intraday")),n.namespace(e("i18n-load!com/fitbit/app/unit")),function(e,x,A,G,E,P){function I(e,t,i){var n=[[1,f]];return e&&(e[b]&&e[b].lower<i&&n.unshift([(i-e[b].lower)/i,m]),e[w]&&e[w].lower<i&&n.unshift([(i-e[w].lower)/i,v]),e[_]&&e[_].lower<i&&n.unshift([(i-e[_].lower)/i,y])),g.extend(!0,D,{stops:n})}function L(o,h,f){function D(e,t){return r.clock12?p.localeFormat(e,"hh:mm")+" - "+p.localeFormat(t,"hh:mm a"):p.localeFormat(e,"HH:mm")+" - "+p.localeFormat(t,"HH:mm")}var E,L,F,R,j,H,z,$,V,q,Y=2e3,X=T,Z=k,K=S,J=s.marginRect,Q={leftMarginMaskOff:20,yAxisLabelsOff:30,plotLinesOn:40,leftMarginMaskOn:50,yAxisLabelsOn:60};z=o.dataSets.activity.dataPoints.map(function(e,t){var i,n,o=e.dateTime.split(" ")[1].split(":"),l=new Date;return l.setHours(o[0]),l.setMinutes(o[1]),l.setSeconds(0),W&&e.bpm>0&&(e.bpm<X&&(X=e.bpm),e.bpm>Z&&(Z=e.bpm),e.bpm<K&&(K=e.bpm)),i={x:Number(l.getTime()),y:Number(W?e.bpm:e.value),low:-100,defaultZone:e.defaultZone,customZone:e.customZone,caloriesBurned:e.caloriesBurned,confidence:e.confidence},x?(n=h.dataSets.activity.dataPoints[t].activityLevel,i.color={linearGradient:s.chart_column_gradient,stops:a.activityColumn[n]}):i.color=a.very_active,i}),E={chart:{marginLeft:0,marginRight:0,type:W?"spline":"column",style:{color:"#00ff00"},events:{load:W&&function(){var e=this.series[0];e.data.forEach(function(e){0===e.y&&(e.y=null)})}}},plotOptions:{column:{pointWidth:4,states:{hover:{enabled:!0}}},series:{borderRadius:0,shadow:!1,pointPadding:0,borderWidth:0},spline:{color:W&&I(f,X,Z),lineWidth:3,states:{hover:{enabled:!0}},marker:{enabled:!1,states:{hover:{fillColor:y}}},events:{mouseOver:function(){var e=-10,t=20,i=4,s=1,o=function(t,i,n){return{id:t+"_line",color:n,value:f[t].lower,zIndex:Q.plotLinesOn,width:s,label:{text:i,align:"right",style:{color:n,fontWeight:"bold"},x:e}}},l=function(e,n){return{id:e+"_label",color:"rgba(255,255,255,0)",value:f[e].lower,zIndex:Q.yAxisLabelsOn,width:s,label:{text:f[e].lower,align:"left",style:{color:n,fontWeight:"bold"},x:t,y:i}}},r=function(){q=V.renderer.rect(J.x,J.y,J.width,J.height,J.radius).attr({fill:a.graphBgFill,zIndex:Q.leftMarginMaskOn}).add()};this.yAxis.addPlotLine(o(b,n("fat_burn"),m)),this.yAxis.addPlotLine(o(w,n("cardio"),v)),this.yAxis.addPlotLine(o(_,n("peak"),y)),this.yAxis.addPlotLine(l(b,m)),this.yAxis.addPlotLine(l(w,v)),this.yAxis.addPlotLine(l(_,y)),r()},mouseOut:function(){this.yAxis.removePlotLine(b+"_label"),this.yAxis.removePlotLine(w+"_label"),this.yAxis.removePlotLine(_+"_label"),this.yAxis.removePlotLine(b+"_line"),this.yAxis.removePlotLine(w+"_line"),this.yAxis.removePlotLine(_+"_line"),q.destroy()}}}},xAxis:{tickInterval:60*(c?1:2)*60*1e3,showLastLabel:!0,showFirstLabel:c,lineColor:a.xAxisBaseline,gridLineColor:a.xAxis,minorGridLineColor:a.xAxis,tickLength:0,lineWidth:2,labels:{style:{fontFamily:s.labelStyle.fontFamily,fontSize:s.labelStyle.fontSize,color:a.labelText},formatter:function(){var e=new Date(this.value);if(c){if(!r.clock12)return 0===e.getHours()&&this.isLast?"24":p.localeFormat(e,"HH");if("ko_KR"==r.locale)switch(e.getHours()){case 0:return n("AM")+"<br>12";case 12:return n("PM")+"<br>12"}else switch(e.getHours()){case 0:return"12<br>"+n("AM");case 12:return"12<br>"+n("PM")}return p.localeFormat(e,"hh")+"<br> "}if(!r.clock12)return this.isLast?"24":p.localeFormat(e,"HH");if("ko_KR"==r.locale||"ja_JP"==r.locale||"zh_CN"==r.locale||"zh_TW"==r.locale)switch(e.getHours()){case 0:return n("AM")+" 12";case 12:return n("PM")+" 12"}else switch(e.getHours()){case 0:return"12"+n("AM");case 12:return"12"+n("PM")}return p.localeFormat(e,"hh")}}},yAxis:{lineColor:a.yAxis,gridLineColor:a.yAxis,minorGridLineColor:a.yAxis,tickPixelInterval:60,showFirstLabel:!1,labels:{style:{fontFamily:s.labelStyle.fontFamily,fontSize:s.labelStyle.fontSize,color:a.labelText},align:s.yAxisLabel.alignment,x:s.yAxisLabel.yAxisLabels_x,y:s.yAxisLabel.yAxisLabels_y,zIndex:Q.yAxisLabelsOff,formatter:function(){return r.formatNumber(this.value,"#,##0.#")}},title:{text:""},min:W?K:0},tooltip:{enabled:!1},series:[{name:e,data:z}]},B&&r.bmr&&($=r.bmr/96,E.yAxis.minRange=5*$),V=l(O,A,G,Object.merge(E,i.chartMixin(function(){var e=new Date(this.x),i=c||W?C:M,a=Math.round(10*this.caloriesBurned/C)/10,s=new Date(this.x+60*i*1e3),o=t(this.defaultZone),l=t(this.customZone);return g(u({timeInterval:D(e,s),valueAndUnit:r.formatNumber(N?Math.round(100*this.y)/100:Math.round(this.y),"#,##0.#")+" "+U(Math.round(this.y)),calBurnValueAndUnit:W?r.formatNumber(a,"#,##0.#")+" "+n.plural("cals_per_minute")(Math.round(a)):"",defaultZone:W?o:"",customZone:W?l:""}))}))),V.renderer.rect(J.x,J.y,J.width,J.height,J.radius).attr({fill:a.graphBgFill,zIndex:Q.leftMarginMaskOff}).add(),P&&P(V),c?(L=V.yAxis[0].getExtremes(),L.dataMax-L.dataMin<=Y&&V.yAxis[0].setExtremes(L.dataMin,L.dataMax),j=new Date(V.xAxis[0].getExtremes().dataMin),H=new d(V,{initialPosition:+new Date,min:+new Date(j.getFullYear(),j.getMonth(),j.getDate()-1,22,30),max:+new Date(j.getFullYear(),j.getMonth(),j.getDate()+1,0,10,0,0),valueSpan:864e5,panStep:342e5,scrollStep:3e5})):(F=V.xAxis[0].getExtremes().dataMin-126e5,R=V.xAxis[0].getExtremes().dataMax+72e5,V.xAxis[0].setExtremes(F,R,!0))}function F(e,t){o.get("getHeartRateZones","activityTileData",{date:p.ajaxEncode(e)},t)}var O=g("<div>"),W="heart-rate"===e,N="distance"===e,B="calories-burned"===e,U={steps:n.plural("step"),distance:n.plural("US"===r.heightSystem?"mile":"km"),"active-minutes":n.plural("active_minute_reduced"),floors:n.plural("floor"),"calories-burned":n.plural("calorie"),"heart-rate":n.plural("heart_rate")}[e];return E=E||new Date,x&&W?Function.join(h.loadIntraday.bind(h,e,E),h.loadIntraday.bind(h,"calories-burned",E),F.bind(this,E),L):W?Function.join(h.loadIntraday.bind(h,e,E),function(e){e()},F.bind(this,E),L):x?Function.join(h.loadIntraday.bind(h,e,E),h.loadIntraday.bind(h,"calories-burned",E),L):Function.join(h.loadIntraday.bind(h,e,E),L),O}}),define("galileo/graph/graphUtil",["require","mootools","galileo/util/dateUtil","../color/graph"],function(e){function t(e,t,a,s,o,l,r){l=l||"E";var h=7,c=h+1,d=s||0,u=o||0,p=t*c+d+u,g=1;if(void 0!==a&&(g=a),!r){var f=(g-1).mod(7),m=f-e.getDay();e=i.plusDays(e,m.mod(7))}var v,y,b=function(n){var a;t=n,a=i.minusWeeks(e,t),v=i.plusDays(a,1),y=i.ajaxEncode(v)};b(t);var w=function(e){return e+Math.floor(e/h)+1+d},_=function(e){var t=i.diffInDays(e,v);return t+Math.floor(t/h)+1+d},x=function(e){var t=new Date(v.toDateString());e=e-1-d;var n=Math.floor(e/c);return i.plusDays(t,e-n)},T=function(e,t){t=t||{};var i=t.useDateForOffset||!1;return e.map(function(e,t){var n=i?_(e.x):w(t);return $.extend(!0,{},e,{x:n,y:e.y,date:e.x,inValidWeek:n>d&&p-u>n})})},k=function(){if(this.value<d||this.value>p-u)return"";var e=x(this.value),t=S(this.value,e),n="";if(e.getDay()===(v.getDay()+3)%7){var a=i.minusDays(e,3),s=i.plusDays(e,3);n="<br/>",n+='<span class="weekLabel">',n+=i.localeFormat(a,"MMM dd"),n+=" - "+i.localeFormat(s,"MMM dd"),n+="</span>"}return'<div class="xAxisLabel">'+t+n+"</div>"},S=function(e,n){if(d>e||e>p-u||(e-d).mod(c)<=0)return"";var a=i.localeFormat(n,l),s=4===t?"month":"";return a=n.toDateString()===(new Date).toDateString()?'<span class="graphCurrentDay '+s+'">'+a+"</span>":'<span class="graphDay '+s+'">'+a+"</span>"},M=function(){var e=x(this.value);return S(this.value,e)},C=function(e,t){return{tickLength:0,tickInterval:1,lineColor:n.xAxisBaseline,lineWidth:2,type:"",min:0,max:p,labels:{align:"center",formatter:t?M:k,useHTML:!0}}},D=function(){return v};return{modifySeries:T,getXAxisOptions:C,getStartDate:D,setNumWeeks:b}}e("mootools");var i=e("galileo/util/dateUtil"),n=e("../color/graph");return t}),define("hbs!galileo/graph/template/hrActivityGraphTip",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/intraday","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n<div class="graphTip hrZoneMinutesTooltip">\n    <div class="date">',(n=i.date)?n=n.call(e,{hash:{}}):(n=e.date,n=typeof n===h?n.apply(e):n),o+=c(n)+'</div>\n    <div class="details">\n        <ul class="hearRateZones">\n            <li class="peak">\n                <span class="color">',s={hash:{}},n=i.i18n,a=n?n.call(e,"peak",s):d.call(e,"i18n","peak",s),(a||0===a)&&(o+=a),o+=":</span>\n                ",(a=i.peakNum)?a=a.call(e,{hash:{}}):(a=e.peakNum,a=typeof a===h?a.apply(e):a),o+=c(a)+" ",(a=i.peakLabel)?a=a.call(e,{hash:{}}):(a=e.peakLabel,a=typeof a===h?a.apply(e):a),o+=c(a)+'\n            </li>\n            <li class="cardio">\n                <span class="color">',s={hash:{}},n=i.i18n,a=n?n.call(e,"cardio",s):d.call(e,"i18n","cardio",s),(a||0===a)&&(o+=a),o+=":</span>\n                ",(a=i.cardioNum)?a=a.call(e,{hash:{}}):(a=e.cardioNum,a=typeof a===h?a.apply(e):a),o+=c(a)+" ",(a=i.cardioLabel)?a=a.call(e,{hash:{}}):(a=e.cardioLabel,a=typeof a===h?a.apply(e):a),o+=c(a)+'\n            </li>\n            <li class="fat">\n                <span class="color">',s={hash:{}},n=i.i18n,a=n?n.call(e,"fat_burn",s):d.call(e,"i18n","fat_burn",s),(a||0===a)&&(o+=a),o+=":</span>\n                ",(a=i.fatNum)?a=a.call(e,{hash:{}}):(a=e.fatNum,a=typeof a===h?a.apply(e):a),o+=c(a)+" ",(a=i.fatLabel)?a=a.call(e,{hash:{}}):(a=e.fatLabel,a=typeof a===h?a.apply(e):a),o+=c(a)+"\n            </li>\n        </ul>\n    </div>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h="function",c=this.escapeExpression,d=i.helperMissing,u=this;return r={hash:{},inverse:u.noop,fn:u.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.intraday",r):d.call(t,"i18n-namespace","com.fitbit.app.ngd.intraday",r),l||0===l?l:""});return e.registerPartial("galileo_graph_template_hrActivityGraphTip",t),t}),define("galileo/graph/perDayHeartRate",["require","mootools","underscore","jquery","./base","./configs/activity","galileo/ajax/ajax","../color/graph","./tooltip","i18n/i18n","galileo/model/user","./graphUtil","galileo/util/dateUtil","hbs!./template/hrActivityGraphTip","i18n-load!com/fitbit/app/ngd/intraday","i18n-load!com/fitbit/app/unit"],function(e){e("mootools");var t=e("underscore"),i=e("jquery"),n=e("./base"),a=e("./configs/activity"),s=e("galileo/ajax/ajax"),o=e("../color/graph"),l=e("./tooltip"),r=e("i18n/i18n")(),h=e("galileo/model/user").viewer,c=e("./graphUtil"),d=e("galileo/util/dateUtil"),u=e("hbs!./template/hrActivityGraphTip"),p=16,g=2,f=1;r.namespace(e("i18n-load!com/fitbit/app/ngd/intraday")),r.namespace(e("i18n-load!com/fitbit/app/unit"));var m={seriesName:"heart-rate",width:0,height:0,date:new Date,precision:0,readyGraph:null,readySummary:null,weeks:1,goalColor:o.goal_line,maxY:null};return function(e){function v(s){var h,c=s,m=c.length,v=0,y=[[],[],[]];t.map(c,function(e){m>v&&v++,e.value=t.defaults(e.value,{IN_DEFAULT_ZONE_3:0,IN_DEFAULT_ZONE_2:0,IN_DEFAULT_ZONE_1:0}),t.each(e.value,function(t,i){var n=Number(t),s={x:d.ajaxDecode(e.dateTime),y:n,dayIndex:v,color:{linearGradient:a.chart_column_gradient}};"IN_DEFAULT_ZONE_1"===i?(s.color.stops=o.columnGradients.gold,y[2].push(s)):"IN_DEFAULT_ZONE_2"===i?(s.color.stops=o.columnGradients.orange,y[1].push(s)):"IN_DEFAULT_ZONE_3"===i&&(s.color.stops=o.columnGradients.red,y[0].push(s))})}),y=y.map(function(e){return{data:T.modifySeries(e)}});var w=o.xAxis,k=T.getXAxisOptions(b);k.lineColor=w,k.labels.y=p,k.lineWidth=g;var S={chart:{animation:!1,marginLeft:0,marginRight:0,type:"column",events:{load:function(){var e=a.marginRect;this.renderer.rect(e.x,e.y,e.width,e.height,e.radius).attr({fill:o.graphBgFill,zIndex:e.zIndex}).add()}}},plotOptions:{column:{animation:!1,stacking:"normal",stickyTracking:!1,colorByPoint:!1,pointPadding:0,groupPadding:0,borderWidth:0,shadow:!1,pointWidth:"28d"===x?a.column.weeksWidth:a.column.weekWidth},series:{}},xAxis:k,yAxis:{min:0,gridLineWidth:f,gridLineColor:w,minorGridLineColor:w,showFirstLabel:!1,labels:{style:{fontFamily:a.labelStyle.fontFamily,fontSize:a.labelStyle.fontSize,color:o.labelText},align:a.yAxisLabel.alignment,x:a.yAxisLabel.yAxisLabels_x,y:a.yAxisLabel.yAxisLabels_y}},tooltip:{enabled:!1},series:y,legend:{enabled:!1}};h=n(_,e.width,e.height,Object.merge(S,l.chartMixin(function(){if(!this.date)return null;var e=this.dayIndex-1,t=c[e]||null,n=t?t.value:null,a=d.localeFormat(this.date,"MMM dd"),s=r.plural("minute_reduced"),o=Math.round(n.IN_DEFAULT_ZONE_3),l=Math.round(n.IN_DEFAULT_ZONE_2),h=Math.round(n.IN_DEFAULT_ZONE_1),p=s(o),g=s(l),f=s(h);return i(u({date:a,peakNum:o,cardioNum:l,fatNum:h,peakLabel:p,cardioLabel:g,fatLabel:f}))}))),b?t.isNumber(e.weekAxisMin)&&t.isNumber(e.weekAxisMax)&&h.xAxis[0].setExtremes(e.weekAxisMin,e.weekAxisMax,!0):t.isNumber(e.weeksAxisMin)&&t.isNumber(e.weeksAxisMax)&&h.xAxis[0].setExtremes(e.weeksAxisMin,e.weeksAxisMax,!0)}function y(t){var i=e.date,n=d.ajaxEncode(i),a=d.ajaxEncode(T.getStartDate());s.get("getTimeInHeartRateZonesPerDay","activityTileData",{startDate:a,endDate:n},t)}e=Object.merge({},m,e);var b=1===e.weeks,w=b?"EEE":"E";e.date=e.date||new Date;var _=i("<div>").addClass(e.seriesName).width(e.width).height(e.height),x=e.period,T=c(e.date,e.weeks,h.startDayOfWeek,e.rightMargin,e.leftMargin,w,e.endOnToday);return y(function(e){v(e)}),_}}),define("hbs!galileo/tile/template/chartLegend",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s="";return s+='\n<div class="legend">\n    ',n=i["if"].call(e,e.legendTitle,{hash:{},inverse:d.noop,fn:d.program(2,o,t)}),(n||0===n)&&(s+=n),s+='\n    <ul class="legendList">\n        ',a={hash:{},inverse:d.noop,fn:d.program(4,l,t)},(n=i.legendList)?n=n.call(e,a):(n=e.legendList,n=typeof n===h?n.apply(e):n),i.legendList||(n=u.call(e,n,a)),(n||0===n)&&(s+=n),s+="\n    </ul>\n</div>\n"}function o(e,t){var n,a="";return a+='\n    <strong class="legendTitle">',(n=i.legendTitle)?n=n.call(e,{hash:{}}):(n=e.legendTitle,n=typeof n===h?n.apply(e):n),a+=c(n)+":</strong>\n    "}function l(e,t){var n,a="";return a+='\n        <li class="legendItem ',(n=i["class"])?n=n.call(e,{hash:{}}):(n=e["class"],n=typeof n===h?n.apply(e):n),a+=c(n)+'">\n            <span class="icon"></span> ',(n=i.name)?n=n.call(e,{hash:{}}):(n=e.name,n=typeof n===h?n.apply(e):n),a+=c(n)+"\n        </li>\n        "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,h="function",c=this.escapeExpression,d=this,u=i.blockHelperMissing;return r=i["if"].call(t,t.legendList,{hash:{},inverse:d.noop,fn:d.program(1,s,a)}),r||0===r?r:""});return e.registerPartial("galileo_tile_template_chartLegend",t),t}),define("hbs!galileo/tile/template/hrLegend",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/intraday","galileo/tile/template/helpers/i18n","galileo/tile/template/helpers/domPlaceholder"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n<div class="legend">\n    <ul class="legendList">\n        <li class="legendItem fat_burn">\n            <span class="icon"></span> ',s={hash:{}},n=i.i18n,a=n?n.call(e,"fat_burn",s):h.call(e,"i18n","fat_burn",s),(a||0===a)&&(o+=a),o+='\n            <span class="legendValue">',s={hash:{}},o+=c((n=i.domPlaceholder,n?n.call(e,"fatBurn",s):h.call(e,"domPlaceholder","fatBurn",s)))+'</span>\n        </li>\n        <li class="legendItem cardio">\n            <span class="icon"></span> ',s={hash:{}},n=i.i18n,a=n?n.call(e,"cardio",s):h.call(e,"i18n","cardio",s),(a||0===a)&&(o+=a),o+='\n            <span class="legendValue">',s={hash:{}},o+=c((n=i.domPlaceholder,n?n.call(e,"cardio",s):h.call(e,"domPlaceholder","cardio",s)))+'</span>\n        </li>\n        <li class="legendItem peak">\n            <span class="icon"></span> ',s={hash:{}},n=i.i18n,a=n?n.call(e,"peak",s):h.call(e,"i18n","peak",s),(a||0===a)&&(o+=a),o+='\n            <span class="legendValue">',s={hash:{}},o+=c((n=i.domPlaceholder,n?n.call(e,"peak",s):h.call(e,"domPlaceholder","peak",s)))+"</span>\n        </li>\n    </ul>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h=i.helperMissing,c=this.escapeExpression,d=this;return r={hash:{},inverse:d.noop,fn:d.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.intraday",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.intraday",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_hrLegend",t),t}),define("hbs!galileo/tile/template/help/activityHeartRate",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/tooltips","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+="\n<h3>",s={hash:{}},n=i.i18n,a=n?n.call(e,"activity_hr_info_title",s):h.call(e,"i18n","activity_hr_info_title",s),(a||0===a)&&(o+=a),o+="</h3>\n<p>\n    ",s={hash:{}},n=i.i18n,a=n?n.call(e,"activity_hr_info_body",s):h.call(e,"i18n","activity_hr_info_body",s),(a||0===a)&&(o+=a),o+="\n    <br>\n    <a class='activityHRHelp' href='",s={hash:{}},n=i.i18n,a=n?n.call(e,"activity_hr_info_href",s):h.call(e,"i18n","activity_hr_info_href",s),(a||0===a)&&(o+=a),o+="'>",s={hash:{}},n=i.i18n,a=n?n.call(e,"activity_hr_info_learn_more",s):h.call(e,"i18n","activity_hr_info_learn_more",s),(a||0===a)&&(o+=a),o+="</a>\n</p>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h=i.helperMissing,c=this;return r={hash:{},inverse:c.noop,fn:c.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.tooltips",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.tooltips",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_help_activityHeartRate",t),t}),define("shared/scripts/libs/requirejs/plugins/css/0.1.5-custom/normalize",[],function(){function e(e,i,a){if(e.match(l)||e.match(o))return e;e=s(e);var r=a.match(o),h=i.match(o);return!h||r&&r[1]==h[1]&&r[2]==h[2]?n(t(e,i),a):t(e,i)}function t(e,t){if("./"==e.substr(0,2)&&(e=e.substr(2)),e.match(l)||e.match(o))return e;var i=t.split("/"),n=e.split("/");for(i.pop();curPart=n.shift();)".."==curPart?i.pop():i.push(curPart);return i.join("/")}function n(e,t){var n=t.split("/");for(n.pop(),t=n.join("/")+"/",i=0;t.substr(i,1)==e.substr(i,1);)i++;for(;"/"!=t.substr(i,1);)i--;t=t.substr(i+1),e=e.substr(i+1),n=t.split("/");var a=e.split("/");for(out="";n.shift();)out+="../";for(;curPart=a.shift();)out+=curPart+"/";return out.substr(0,out.length-1)}var a=/([^:])\/+/g,s=function(e){return e.replace(a,"$1/")},o=/[^\:\/]*:\/\/([^\/])*/,l=/^(\/|data:)/,r=function(t,i,n){i=s(i),n=s(n);for(var a,o,t,l=/@import\s*("([^"]*)"|'([^']*)')|url\s*\(\s*(\s*"([^"]*)"|'([^']*)'|[^\)]*\s*)\s*\)/gi;a=l.exec(t);){o=a[3]||a[2]||a[5]||a[6]||a[4];var r;r=e(o,i,n);var h=a[5]||a[6]?1:0;t=t.substr(0,l.lastIndex-o.length-h-1)+r+t.substr(l.lastIndex-h-1),l.lastIndex=l.lastIndex+(r.length-o.length)}return t};return r.convertURIBase=e,r.absoluteURI=t,r.relativeURI=n,r}),define("shared/scripts/libs/requirejs/plugins/css/0.1.5-custom/css",[],function(){if("undefined"==typeof window)return{load:function(e,t,i){i()}};var e=document.getElementsByTagName("head")[0],t=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)/)||0,i=!1,n=!0;t[1]||t[7]?i=parseInt(t[1])<6||parseInt(t[7])<=9:t[2]?n=!1:t[4]&&(i=parseInt(t[4])<18);var a={};a.pluginBuilder="./css-builder-custom";var s,o,l,r=function(){s=document.createElement("style"),e.appendChild(s),o=s.styleSheet||s.sheet},h=0,c=[],d=function(e){h++,32==h&&(r(),h=0),o.addImport(e),s.onload=function(){u()}},u=function(){l();var e=c.shift();return e?(l=e[1],void d(e[0])):void(l=null)},p=function(e,t){if(o&&o.addImport||r(),o&&o.addImport)l?c.push([e,t]):(d(e),l=t);else{s.textContent='@import "'+e+'";';var i=setInterval(function(){try{s.sheet.cssRules,clearInterval(i),t()}catch(e){}},10)}},g=function(t,i){var a=document.createElement("link");if(a.type="text/css",a.rel="stylesheet",n)a.onload=function(){a.onload=function(){},setTimeout(i,7)};else var s=setInterval(function(){for(var e=0;e<document.styleSheets.length;e++){var t=document.styleSheets[e];if(t.href==a.href)return clearInterval(s),i()}},10);a.href=t,e.appendChild(a)};return a.normalize=function(e,t){return".css"==e.substr(e.length-4,4)&&(e=e.substr(0,e.length-4)),t(e)},a.load=function(e,t,n,a){(i?p:g)(t.toUrl(e+".css"),n)},a}),define("shared/scripts/libs/requirejs/plugins/css/0.1.5-custom/css!jquery.selectbox",[],function(){}),/*!
	 * jQuery Selectbox plugin 0.2
	 *
	 * Copyright 2011-2012, Dimitar Ivanov (http://www.bulgaria-web-developers.com/projects/javascript/selectbox/)
	 * Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
	 *
	 * Date: Tue Jul 17 19:58:36 2012 +0300
	 */
function(e,t){function i(){this._state=[],this._defaults={classHolder:"sbHolder",classHolderDisabled:"sbHolderDisabled",classSelector:"sbSelector",classOptions:"sbOptions",classGroup:"sbGroup",classSub:"sbSub",classDisabled:"sbDisabled",classToggleOpen:"sbToggleOpen",classToggle:"sbToggle",classFocus:"sbFocus",speed:200,effect:"slide",onChange:null,onOpen:null,onClose:null}}var n="selectbox",a=!1,s=!0;e.extend(i.prototype,{_isOpenSelectbox:function(e){if(!e)return a;var t=this._getInst(e);return t.isOpen},_isDisabledSelectbox:function(e){if(!e)return a;var t=this._getInst(e);return t.isDisabled},_attachSelectbox:function(t,i){function o(){var t,i,n=this.attr("id").split("_")[1];for(t in p._state)t!==n&&p._state.hasOwnProperty(t)&&(i=e("select[sb='"+t+"']")[0],i&&p._closeSelectbox(i))}function l(){var i=arguments[1]&&arguments[1].sub?!0:!1,n=arguments[1]&&arguments[1].disabled?!0:!1;arguments[0].each(function(a){var o,l=e(this),r=e("<li>");l.is(":selected")&&(h.text(l.text()),f=s),a===v-1&&r.addClass("last"),l.is(":disabled")||n?(o=e("<span>",{text:l.text()}).addClass(g.settings.classDisabled),i&&o.addClass(g.settings.classSub),o.appendTo(r)):(o=e("<a>",{href:"#"+l.val(),rel:l.val(),title:l.prop("title")}).text(l.text()).bind("click.sb",function(i){i&&i.preventDefault&&i.preventDefault();var n=c,a=e(this);n.attr("id").split("_")[1];p._changeSelectbox(t,a.attr("rel"),a.text()),p._closeSelectbox(t)}).bind("mouseover.sb",function(){var t=e(this);t.parent().siblings().find("a").removeClass(g.settings.classFocus),t.addClass(g.settings.classFocus)}).bind("mouseout.sb",function(){e(this).removeClass(g.settings.classFocus)}),i&&o.addClass(g.settings.classSub),l.is(":selected")&&o.addClass(g.settings.classFocus),o.appendTo(r)),r.appendTo(d)})}if(this._getInst(t))return a;var r,h,c,d,u=e(t),p=this,g=p._newInst(u),f=a,m=(u.find("optgroup"),u.find("option")),v=m.length;u.attr("sb",g.uid),e.extend(g.settings,p._defaults,i),p._state[g.uid]=a,u.hide(),r=e("<div>",{id:"sbHolder_"+g.uid,"class":g.settings.classHolder,tabindex:u.attr("tabindex")}),h=e("<a>",{id:"sbSelector_"+g.uid,href:"#","class":g.settings.classSelector,click:function(i){i.preventDefault(),o.apply(e(this),[]);var n=e(this).attr("id").split("_")[1];p._state[n]?p._closeSelectbox(t):p._openSelectbox(t)}}),c=e("<a>",{id:"sbToggle_"+g.uid,href:"#","class":g.settings.classToggle,click:function(i){i.preventDefault(),o.apply(e(this),[]);var n=e(this).attr("id").split("_")[1];p._state[n]?p._closeSelectbox(t):p._openSelectbox(t)}}),c.appendTo(r),d=e("<ul>",{id:"sbOptions_"+g.uid,"class":g.settings.classOptions,css:{display:"none"}}),u.children().each(function(t){var i,n=e(this),a={};n.is("option")?l(n):n.is("optgroup")&&(i=e("<li>"),e("<span>",{text:n.attr("label")}).addClass(g.settings.classGroup).appendTo(i),i.appendTo(d),n.is(":disabled")&&(a.disabled=!0),a.sub=!0,l(n.find("option"),a))}),f||h.text(m.first().text()),e.data(t,n,g),r.data("uid",g.uid).bind("keydown.sb",function(t){var i=t.charCode?t.charCode:t.keyCode?t.keyCode:0,a=e(this),s=a.data("uid"),o=a.siblings("select[sb='"+s+"']").data(n),l=a.siblings(["select[sb='",s,"']"].join("")).get(0),r=a.find("ul").find("a."+o.settings.classFocus);switch(i){case 37:case 38:if(r.length>0){var h;e("a",a).removeClass(o.settings.classFocus),h=r.parent().prevAll("li:has(a)").eq(0).find("a"),h.length>0&&(h.addClass(o.settings.classFocus).focus(),e("#sbSelector_"+s).text(h.text()))}break;case 39:case 40:var h;e("a",a).removeClass(o.settings.classFocus),h=r.length>0?r.parent().nextAll("li:has(a)").eq(0).find("a"):a.find("ul").find("a").eq(0),h.length>0&&(h.addClass(o.settings.classFocus).focus(),e("#sbSelector_"+s).text(h.text()));break;case 13:r.length>0&&p._changeSelectbox(l,r.attr("rel"),r.text()),p._closeSelectbox(l);break;case 9:if(l){var o=p._getInst(l);o&&(r.length>0&&p._changeSelectbox(l,r.attr("rel"),r.text()),p._closeSelectbox(l))}var c=parseInt(a.attr("tabindex"),10);t.shiftKey?c--:c++,e("*[tabindex='"+c+"']").focus();break;case 27:p._closeSelectbox(l)}return t.stopPropagation(),!1}).delegate("a","mouseover",function(t){e(this).addClass(g.settings.classFocus)}).delegate("a","mouseout",function(t){e(this).removeClass(g.settings.classFocus)}),h.appendTo(r),d.appendTo(r),r.insertAfter(u),this.htmlListenerAttached||(this.htmlListenerAttached=!0,e("html").on("mousedown",function(t){t.stopPropagation(),e("select").selectbox("close")})),r.add(h).mousedown(function(e){e.stopPropagation()})},_detachSelectbox:function(t){var i=this._getInst(t);return i?(e("#sbHolder_"+i.uid).remove(),e.data(t,n,null),void e(t).show()):a},_changeSelectbox:function(t,i,n){var o,l=this._getInst(t);l&&(o=this._get(l,"onChange"),e("#sbSelector_"+l.uid).text(n)),i=i.replace(/\'/g,"\\'"),e(t).find("option[selected]").attr("selected",a),e(t).find("option[value='"+i+"']").attr("selected",s),l&&o?o.apply(l.input?l.input[0]:null,[i,l]):l&&l.input&&l.input.trigger("change")},_enableSelectbox:function(t){var i=this._getInst(t);return i&&i.isDisabled?(e("#sbHolder_"+i.uid).removeClass(i.settings.classHolderDisabled),i.isDisabled=a,void e.data(t,n,i)):a},_disableSelectbox:function(t){var i=this._getInst(t);return!i||i.isDisabled?a:(e("#sbHolder_"+i.uid).addClass(i.settings.classHolderDisabled),i.isDisabled=s,void e.data(t,n,i))},_optionSelectbox:function(t,i,s){var o=this._getInst(t);return o?(o[i]=s,void e.data(t,n,o)):a},_openSelectbox:function(t){var i=this._getInst(t);if(i&&!i.isOpen&&!i.isDisabled){var a=e("#sbOptions_"+i.uid),o=parseInt(e(window).height(),10),l=e("#sbHolder_"+i.uid).offset(),r=e(window).scrollTop(),h=a.prev().height(),c=o-(l.top-r)-h/2,d=this._get(i,"onOpen");a.css({top:h+"px",maxHeight:c-h+"px"}),"fade"===i.settings.effect?a.fadeIn(i.settings.speed):a.slideDown(i.settings.speed),e("#sbToggle_"+i.uid).addClass(i.settings.classToggleOpen),this._state[i.uid]=s,i.isOpen=s,d&&d.apply(i.input?i.input[0]:null,[i]),e.data(t,n,i)}},_closeSelectbox:function(t){var i=this._getInst(t);if(i&&i.isOpen){var s=this._get(i,"onClose");"fade"===i.settings.effect?e("#sbOptions_"+i.uid).fadeOut(i.settings.speed):e("#sbOptions_"+i.uid).slideUp(i.settings.speed),e("#sbToggle_"+i.uid).removeClass(i.settings.classToggleOpen),this._state[i.uid]=a,i.isOpen=a,s&&s.apply(i.input?i.input[0]:null,[i]),e.data(t,n,i)}},_newInst:function(e){var t=e[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:t,input:e,uid:Math.floor(99999999*Math.random()),isOpen:a,isDisabled:a,settings:{}}},_getInst:function(t){try{return e.data(t,n)}catch(i){throw"Missing instance data for this selectbox"}},_get:function(e,i){return e.settings[i]!==t?e.settings[i]:this._defaults[i]}}),e.fn.selectbox=function(t){var i=Array.prototype.slice.call(arguments,1);return"string"==typeof t&&"isDisabled"==t?e.selectbox["_"+t+"Selectbox"].apply(e.selectbox,[this[0]].concat(i)):"option"==t&&2==arguments.length&&"string"==typeof arguments[1]?e.selectbox["_"+t+"Selectbox"].apply(e.selectbox,[this[0]].concat(i)):this.each(function(){"string"==typeof t?e.selectbox["_"+t+"Selectbox"].apply(e.selectbox,[this].concat(i)):e.selectbox._attachSelectbox(this,t)})},e.selectbox=new i,e.selectbox.version="0.2"}(jQuery),define("jquery.selectbox",function(){}),define("galileo/tile/activity",["require","underscore","./classes/wide","hbs!./template/activity","galileo/graph/intraday","galileo/graph/perDayHeartRate","galileo/model/user","galileo/util/dateUtil","hbs!galileo/tile/template/chartLegend","hbs!galileo/tile/template/hrLegend","hbs!./template/help/activityHeartRate","popup","i18n/i18n","galileo/ajax/ajax","galileo/widget/metric","galileo/tile/template/helpers/domPlaceholder","jquery","galileo/graph/graphUtil","jquery.selectbox","i18n-load!com/fitbit/app/ngd/activity","i18n-load!com/fitbit/app/unit"],function(e){var t=e("underscore"),i=e("./classes/wide"),n=e("hbs!./template/activity"),a=e("galileo/graph/intraday"),s=e("galileo/graph/perDayHeartRate"),o=e("galileo/model/user").viewer,l=e("galileo/util/dateUtil"),r=e("hbs!galileo/tile/template/chartLegend"),h=e("hbs!galileo/tile/template/hrLegend"),c=e("hbs!./template/help/activityHeartRate"),d=e("popup"),u=e("i18n/i18n")(),p=e("galileo/ajax/ajax"),g=e("galileo/widget/metric"),f=e("galileo/tile/template/helpers/domPlaceholder"),m=e("jquery"),v=e("galileo/graph/graphUtil");e("jquery.selectbox"),u.namespace(e("i18n-load!com/fitbit/app/ngd/activity")),u.namespace(e("i18n-load!com/fitbit/app/unit"));var y=u.plural("METRIC"===o.distanceUnit?"Kilometer":"Mile"),b="steps",w="1d",_=[{value:"1d",text:u("daily")},{value:"7d",text:u("seven_days")},{value:"28d",text:u("twenty_eight_days")}],x={marginLeft:0,marginRight:0,weekAxisMin:0,weekAxisMax:7.5,weeksAxisMin:-5,weeksAxisMax:33},T={steps:u("steps_title"),floors:u("floors_title"),"calories-burned":u("calories_title"),"heart-rate":u("heart_rate_title"),distance:u("distance_title"),"active-minutes":u("active_minutes_title")},k=[{unitPlural:u.plural("minute_reduced"),unitThreshold:60,format:"#0"},{unitPlural:u.plural("hour_reduced"),unitThreshold:1/0,format:"#0"}];return new Class({Extends:i,title:u("activity_title"),tileName:"intradayActivities",logUrl:"/activities",savable:!1,options:{metricFormats:{steps:[{unitPlural:u.plural("step"),unitThreshold:1/0,format:"#,##0",editable:!0}],"calories-burned":[{unitPlural:u.plural("calorie"),unitThreshold:1/0,format:"#,##0",editable:!0}],floors:[{unitPlural:u.plural("floor"),unitThreshold:1/0,format:"#,##0",editable:!0}],distance:[{unitPlural:y,unitThreshold:1/0,format:"#,##0.00",editable:!0}],"active-minutes":[{unitPlural:u.plural("active_minute_reduced"),unitThreshold:1/0,format:"#,##0",editable:!0}]}},load:function(){var e,t,i=this,a=this.main.find(".content"),s=o.getSettingsModel().get("intradayActiveTab"),l=s?s.split(" "):[];this.selectedSeries=l[0]||b,this.selectedPeriod=l[1]||w,a.append(m(n({series:this.getSeriesItems(),periods:m.map(_,function(e){return{value:e.value,text:e.text,isSelected:e.value===i.selectedPeriod}})}))),t=a.find(".period").selectbox(),e=a.find(".series").selectbox(),e.next(".sbHolder").addClass("series").prop("title",e.prop("title")),t.next(".sbHolder").addClass("period").prop("title",t.prop("title")),m([e[0],t[0]]).change(function(n,a){e.next(".sbHolder").find(".sbSelector").prop("rel",e.val()),i.loadGraph(e.val(),t.val()),o.saveSetting("intradayActiveTab",e.val()+" "+t.val())}).next(".sbHolder").find("a").mousedown(function(e){e.stopPropagation()}),e.trigger("change","loading")},setTitle:function(e,t){var i=T[e],n=this.main.find(".title"),a=this.main.find(".contentInfo"),s=new d({className:"tiles-tooltip"});n.text(i),t?(a.css("visibility","visible"),a.on("mouseover",function(){s.showHTML(c,a)})):a.css("visibility","hidden")},loadGraph:function(t,i){var n="heart-rate"===t,o="active-minutes"===t,l=this.container.find(".content"),r=l.outerWidth(!1),h=this.getDate(),c=n&&("28d"===i||"7d"===i),d=this.main.find(".chartContainer"),u="7d"===i,p=this;this.setTitle(t,n),this.selectedSeries=t,this.selectedPeriod=i,this.chartContainer=d,this.loadGraphLegends(n),"1d"===i?this.isDateEqual(h)&&(this.showMainContents(),d.empty().append(new a(t,!n&&!o,r,180,h))):c?(this.showMainContents(),d.empty().append(s(m.extend(x,{width:r,height:180,date:h,endOnToday:u,period:i,weeks:"28d"===i?4:1,leftPadding:"28d"===i?5:1})))):e(["galileo/tile/loadDependencies"],function(e){p.showMainContents(),p.isDateEqual(h)&&d.empty().append(e.WeekBeta(m.extend(x,{series_name:t,width:r,height:180,date:h,weeks:"28d"===i?4:1,endOnToday:u,tooltipFormat:p.options.metricFormats[t],alternateLayout:!0,yAxis:{labels:{align:"right",x:55}}})))})},loadGraphLegends:function(e){function i(){var e=!1;return t.each(c,function(t){s===t&&"1d"!==o&&(e=!0)}),e}var n=this.main.find(".legendContainer"),a="",s=this.selectedSeries,o=this.selectedPeriod,l="active-minutes"===this.selectedSeries,c=["steps","distance","floors","calories-burned"],d=i();e?this.loadTimeInHeartRateZones(function(e){var t=new g(k),i=new g(k),s=new g(k);t.update(e.IN_DEFAULT_ZONE_1),i.update(e.IN_DEFAULT_ZONE_2),s.update(e.IN_DEFAULT_ZONE_3),a=f(h,{fatBurn:t.elements(),cardio:i.elements(),peak:s.elements()}),n.html(a)}):a=r(d||l&&"1d"!==o?{legendList:[{"class":"goal_met",name:u("goal_met")},{"class":"goal_unmet",name:u("goal_unmet")}]}:l?{legendList:[]}:{legendList:[{"class":"light",name:u("light")},{"class":"moderate",name:u("moderate")},{"class":"intense",name:u("intense")}]}),e||n.html(a),this.chartContainer.on("mouseenter mouseleave",function(e){n.css({visibility:"mouseleave"===e.type?"hidden":"visible"})})},loadTimeInHeartRateZones:function(e){function t(){return"1d"===i?n:s.getStartDate()}var i=this.selectedPeriod,n=this.getDate(),a=l.ajaxEncode(n),s=v(n,"28d"===i?4:1,o.startDayOfWeek,0,0,null,"7d"===i),r=l.ajaxEncode(t());p.get("getTimeInHeartRateZones","activityTileData",{startDate:r,endDate:a},e)},getSeriesItems:function(){var e=[],t=o.getDeviceFeatures();return t.STEPS&&e.push(this.getSeriesData("steps")),t.HEART_RATE&&e.push(this.getSeriesData("heart-rate")),t.STEPS&&e.push(this.getSeriesData("distance")),t.CALORIES&&e.push(this.getSeriesData("calories-burned")),t.ELEVATION&&e.push(this.getSeriesData("floors")),t.CALORIES&&!o.isOnlySoftTrackerUser&&e.push(this.getSeriesData("active-minutes")),e},getSeriesData:function(e){return{value:e,text:T[e]||"",isSelected:this.selectedSeries===e}}})}),define("hbs!galileo/tile/template/leaderboard/leaderboardTile",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/user/friends/message","i18n-load!com/fitbit/app/ngd/leaderboard","i18n-load!com/fitbit/app/leaderboard/error","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n<div class="inner-content" xmlns="http://www.w3.org/1999/html">\n    <div class="todaysContents">\n        <div class="empty-list"></div>\n        <div class="empty-list-msg">',s={hash:{}},n=i.i18n,a=n?n.call(e,"tile_friends_fun",s):h.call(e,"i18n","tile_friends_fun",s),(a||0===a)&&(o+=a),o+="</div>\n    </div>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h=i.helperMissing,c=this;return r={hash:{},inverse:c.noop,fn:c.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.user.friends.message","com.fitbit.app.ngd.leaderboard","com.fitbit.app.leaderboard.error",r):h.call(t,"i18n-namespace","com.fitbit.app.user.friends.message","com.fitbit.app.ngd.leaderboard","com.fitbit.app.leaderboard.error",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_leaderboard_leaderboardTile",t),t}),define("galileo/tile/leaderboard",["require","./classes/small","hbs!./template/leaderboard/leaderboardTile","i18n/i18n","i18n-load!com/fitbit/app/ngd/tile","i18n-load!com/fitbit/app/user/friends/message","i18n-load!com/fitbit/app/user/profile/message","i18n-load!com/fitbit/app/socialMedia/error"],function(e){var t=e("./classes/small"),i=e("hbs!./template/leaderboard/leaderboardTile"),n=e("i18n/i18n")();n.namespace(e("i18n-load!com/fitbit/app/ngd/tile")),n.namespace(e("i18n-load!com/fitbit/app/user/friends/message")),n.namespace(e("i18n-load!com/fitbit/app/user/profile/message")),n.namespace(e("i18n-load!com/fitbit/app/socialMedia/error"));var a="leaderboard";return new Class({Extends:t,options:{controlsList:[{name:n("Settings"),"class":"settingsButton showSettings",glyphName:"show-settings"},{name:n("Find_Friends"),"class":"addFriend",href:"/friends",glyphName:"add-friend"},{name:n("See_More"),"class":"more",href:"/friends",glyphName:"arrow-right"}]},savable:!1,tileName:a,title:n("module_headline"),load:function(){this.rootWrapper=this.main.find(".content"),this.showMainContents();var e=$(i());this.main.on("click",function(){this.container.hasClass("unflipped")&&(window.location.href="/friends")}.bind(this)),e.hide().appendTo(this.rootWrapper).fadeIn("slow")}})}),define("galileo/util/calZoneUtil",["require"],function(e){var t=864e5,i={};return i.calculateDynamicDeficitGoal=function(e){var i=(new Date).getTime(),n=i%t===0?i:new Date(i).setHours(0,0,0,0),a=(i-n)/t,s=e*a;return s},i}),define("hbs!galileo/tile/template/planInput",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n;return(n=i.className)?n=n.call(e,{hash:{}}):(n=e.className,n=typeof n===u?n.apply(e):n),p(n)}function o(e,t){return"editable"}function l(e,t){return'\n            <span class="planEdit"></span>\n            '}function r(e,t){var n,a="";return a+='\n            <span class="unit">',(n=i.units)?n=n.call(e,{hash:{}}):(n=e.units,n=typeof n===u?n.apply(e):n),a+=p(n)+"</span>\n            "}function h(e,t){var n,a="";return a+='\n        <div class="subtitle">\n            <span>',(n=i.subtitle)?n=n.call(e,{hash:{}}):(n=e.subtitle,n=typeof n===u?n.apply(e):n),a+=p(n)+"</span>\n        </div>\n    "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var c,d="",u="function",p=this.escapeExpression,g=this;return d+='<div class="plan-input ',c=i["if"].call(t,t.className,{hash:{},inverse:g.noop,fn:g.program(1,s,a)}),(c||0===c)&&(d+=c),d+='">\n    <div class="goal_title">',(c=i.title)?c=c.call(t,{hash:{}}):(c=t.title,c=typeof c===u?c.apply(t):c),d+=p(c)+'</div>\n    <div class="setting">\n        <span class="metric disabled ',c=i["if"].call(t,t.editable,{hash:{},inverse:g.noop,fn:g.program(3,o,a)}),(c||0===c)&&(d+=c),d+='">\n            <input type="text" class="number" readonly="readonly" value="',(c=i.value)?c=c.call(t,{hash:{}}):(c=t.value,c=typeof c===u?c.apply(t):c),d+=p(c)+'">\n            ',c=i["if"].call(t,t.editable,{hash:{},inverse:g.noop,fn:g.program(5,l,a)}),(c||0===c)&&(d+=c),d+="\n            ",c=i.unless.call(t,t.editable,{hash:{},inverse:g.noop,fn:g.program(7,r,a)}),(c||0===c)&&(d+=c),d+="\n        </span>\n    </div>\n    ",c=i["if"].call(t,t.subtitle,{hash:{},inverse:g.noop,fn:g.program(9,h,a)}),(c||0===c)&&(d+=c),d+="\n</div>\n"});return e.registerPartial("galileo_tile_template_planInput",t),t}),define("hbs!galileo/tile/template/inVsOutManCal",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var s,o="",l="function",r=this.escapeExpression;return o+='<div class="setting">\n    <span>',(s=i.message)?s=s.call(t,{hash:{}}):(s=t.message,s=typeof s===l?s.apply(t):s),o+=r(s)+"</span>\n</div>\n"});return e.registerPartial("galileo_tile_template_inVsOutManCal",t),t}),define("galileo/tile/calZone",["require","galileo/model/user","./classes/small","galileo/util/channel","i18n/i18n","galileo/ajax/ajax","galileo/util/foodGoalLoader","galileo/util/dateUtil","galileo/util/calZoneUtil","mootools","i18n-load!com/fitbit/app/ngd/calzone","i18n-load!com/fitbit/app/unit","hbs!./template/planInput","hbs!./template/inVsOutManCal"],function(e){var t=e("galileo/model/user"),i=e("./classes/small"),n=e("galileo/util/channel"),a=e("i18n/i18n")(),s=e("galileo/ajax/ajax"),o=e("galileo/util/foodGoalLoader"),l=e("galileo/util/dateUtil"),r=e("galileo/util/calZoneUtil");return e("mootools"),a.namespace(e("i18n-load!com/fitbit/app/ngd/calzone")),a.namespace(e("i18n-load!com/fitbit/app/unit")),new Class({Extends:i,title:a("cals_in_out"),tileName:"calZone",hasModal:!0,tileType:"calZone",logUrl:"/foods/log",initialize:function(){this.parent(),this.loadSettings()},load:function(){var e=this,i=this.main.eq(0).find(".content"),n=this.getDate(),a=t.viewer.activities(),o=s.get.bind(a,"getCaloriesInVsOutTileDataAt","activityTileData",{date:l.ajaxEncode(n)});return this.loadGoal(this.main.eq(0).find(".content")),$("body").on("fgmClose",function(){s.get("getCaloriesInVsOutTileDataAt","activityTileData",{date:l.ajaxEncode(n)}).update()}),Function.join(o,function(t){this.isDateEqual(n)&&(this.showMainContents(),setTimeout(function(){e.updateTile(t,i)},350))}.bind(this)),this},updateTile:function(t,i){var n=this,s=e("hbs!./template/planInput"),o=e("hbs!./template/inVsOutManCal");if(!t.foodBudgetEnabled&&t.calTarget>0)i.addClass("showIntro"),this.hideControls(),this.loadGoalModal(),this.hasModal=!1,this.manualCalorieMessage=$(o({message:a("man_cal_msg")})),i.find(".description").html(this.manualCalorieMessage);else if(t.foodPlanIntensity){i.removeClass("showIntro"),this.showControls(),this.loadGoalModal(),this.hasModal=!0;var l={Low:a("easy"),Medium:a("medium"),High:a("kinda_hard"),Extreme:a("harder"),Maintenance:a("maintenance")};this.settings.find(".settingsContainer").empty(),this.weightPlan=$(s({title:a("plan_intensity"),value:l[t.foodPlanIntensity],editable:!0})),this.weightPlan.find(".setting").click(function(){n.weightCallback.call(this)}),this.deficitGoal=$(s({title:a("deficit_goal"),value:-t.calDeficit,editable:!1,units:a("cals")})),this.settings.find(".settingsContainer").append(this.weightPlan,this.deficitGoal);var r=this.calculateStatus(t.calIntakeToday,t.calBurnedToday,t.calDeficit),t={status:r,inValue:t.calIntakeToday,outValue:t.calBurnedToday};this.goalElementChan.take(function(e){e.update(t,!0)}),this.goalElement&&this.goalElement.update(t,!0)}else i.addClass("showIntro"),this.hideControls(),this.loadGoalModal(),this.hasModal=!1},calculateStatus:function(e,t,i){var n=e-t,a=50,s=r.calculateDynamicDeficitGoal(i);return-a>n+s?"UNDER":n+s>a?"OVER":"ONTRACK"},loadGoal:function(t){var i=this;this.goalElementChan=n(!0),this.goalElement||e(["galileo/tile/loadDependencies"],function(e){var n=new e.CalZoneGoal(t,function(){i.weightCallback.call(this)});n.renderInit(),this.goalElementChan.give(n),this.goalElement=n}.bind(this))},loadSettings:function(){var e=this;this.on("showSettings",function(){e.loadGoalModal()})},loadGoalModal:function(){var e=this;o(function(){e.weightCallback=function(){$(this).foodGoalModal()}})}})}),define("hbs!galileo/tile/template/foodPlanNoPlan",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/foodplan","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n<div class="onboarding">\n    <div class="icon"></div>\n    <div class="title">\n        ',s={hash:{}},n=i.i18n,a=n?n.call(e,"food_plan",s):c.call(e,"i18n","food_plan",s),(a||0===a)&&(o+=a),o+='\n    </div>\n    <div class="text">\n        <p class="info">',s={hash:{}},n=i.i18n,a=n?n.call(e,"how_much",s):c.call(e,"i18n","how_much",s),(a||0===a)&&(o+=a),o+='</p>\n        <p class="info">',s={hash:{}},n=i.i18n,a=n?n.call(e,"see_how_many",s):c.call(e,"i18n","see_how_many",s),(a||0===a)&&(o+=a),o+='</p>\n    </div>\n    <div class="btn-cont clearfix">\n        <span class="buttonContainer">\n            <a class="confirmButton start-food-plan-link">',s={hash:{}},n=i.i18n,a=n?n.call(e,"start_now",s):c.call(e,"i18n","start_now",s),(a||0===a)&&(o+=a),o+='</a>\n        </span>\n        <span class="buttonContainer">\n            <a class="cancelButton removeEmptyTile">',s={hash:{}},n=i.i18n,a=n?n.call(e,"no_thanks",s):c.call(e,"i18n","no_thanks",s),(a||0===a)&&(o+=a),o+="</a>\n        </span>\n    </div>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h="",c=i.helperMissing,d=this;return r={hash:{},inverse:d.noop,fn:d.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.foodplan",r):c.call(t,"i18n-namespace","com.fitbit.app.ngd.foodplan",r),(l||0===l)&&(h+=l),h+="\n"});return e.registerPartial("galileo_tile_template_foodPlanNoPlan",t),t}),define("hbs!galileo/tile/template/foodPlan",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/foodplan","galileo/tile/template/helpers/domPlaceholder","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n<div class="plateContainer">\n    ',s={hash:{}},o+=c((n=i.domPlaceholder,n?n.call(e,"plate",s):h.call(e,"domPlaceholder","plate",s)))+'\n</div>\n<div class="notLoggedContainer">\n    <div class="nonHover">\n        <p>\n            <span class="number leftToEat">',(a=i.leftToEat)?a=a.call(e,{hash:{}}):(a=e.leftToEat,a=typeof a===d?a.apply(e):a),o+=c(a)+'</span>\n            <span class="unit">',s={hash:{}},n=i.i18n,a=n?n.call(e,"cals",s):h.call(e,"i18n","cals",s),(a||0===a)&&(o+=a),o+='</span>\n        </p>\n        <p class="information">\n            ',s={hash:{}},n=i.i18n,a=n?n.call(e,"left_to_eat",s):h.call(e,"i18n","left_to_eat",s),(a||0===a)&&(o+=a),o+='\n        </p>\n    </div>\n    <div class="hover">\n        <p class="notLogged">\n            ',s={hash:{}},n=i.i18n,a=n?n.call(e,"you_have_not_logged",s):h.call(e,"i18n","you_have_not_logged",s),(a||0===a)&&(o+=a),o+='\n        </p>\n    </div>\n</div>\n<div class="underContainer">\n    <div class="nonHover">\n        <p>\n            <span class="number leftToEat">',(a=i.leftToEat)?a=a.call(e,{hash:{}}):(a=e.leftToEat,a=typeof a===d?a.apply(e):a),o+=c(a)+'</span>\n            <span class="unit">',s={hash:{}},n=i.i18n,a=n?n.call(e,"cals",s):h.call(e,"i18n","cals",s),(a||0===a)&&(o+=a),o+='</span>\n        </p>\n        <p class="information">\n            ',s={hash:{}},n=i.i18n,a=n?n.call(e,"left_to_eat",s):h.call(e,"i18n","left_to_eat",s),(a||0===a)&&(o+=a),o+='\n        </p>\n    </div>\n    <div class="hover">\n        <p>\n            <span class="number eaten">',(a=i.eaten)?a=a.call(e,{hash:{}}):(a=e.eaten,a=typeof a===d?a.apply(e):a),o+=c(a)+'</span>\n            <span class="divisor">/</span>\n            <span class="number goal">',(a=i.goal)?a=a.call(e,{hash:{}}):(a=e.goal,a=typeof a===d?a.apply(e):a),o+=c(a)+'</span>\n            <span class="unit">',s={hash:{}},n=i.i18n,a=n?n.call(e,"cals",s):h.call(e,"i18n","cals",s),(a||0===a)&&(o+=a),o+='</span>\n        </p>\n        <p class="information">\n            ',s={hash:{}},n=i.i18n,a=n?n.call(e,"eaten",s):h.call(e,"i18n","eaten",s),(a||0===a)&&(o+=a),o+='\n        </p>\n    </div>\n</div>\n<div class="goalReachedContainer">\n    <div class="nonHover">\n        <p>\n            ',s={hash:{}},n=i.i18n,a=n?n.call(e,"reached_goal_of",s):h.call(e,"i18n","reached_goal_of",s),(a||0===a)&&(o+=a),o+='\n            <span class="number">',(a=i.goal)?a=a.call(e,{hash:{}}):(a=e.goal,a=typeof a===d?a.apply(e):a),o+=c(a)+'</span>\n            <span class="unit">',s={hash:{}},n=i.i18n,a=n?n.call(e,"cals",s):h.call(e,"i18n","cals",s),(a||0===a)&&(o+=a),o+='</span>\n        </p>\n    </div>\n    <div class="hover">\n        <p>\n            <span class="number eaten">',(a=i.eaten)?a=a.call(e,{hash:{}}):(a=e.eaten,a=typeof a===d?a.apply(e):a),o+=c(a)+'</span>\n            <span class="divisor">/</span>\n            <span class="number goal">',(a=i.goal)?a=a.call(e,{hash:{}}):(a=e.goal,a=typeof a===d?a.apply(e):a),o+=c(a)+'</span>\n            <span class="unit">',s={hash:{}},n=i.i18n,a=n?n.call(e,"cals",s):h.call(e,"i18n","cals",s),(a||0===a)&&(o+=a),o+='</span>\n        </p>\n        <p class="information">\n            ',s={hash:{}},n=i.i18n,a=n?n.call(e,"eaten",s):h.call(e,"i18n","eaten",s),(a||0===a)&&(o+=a),o+='\n        </p>\n    </div>\n</div>\n<div class="overContainer">\n    <div class="nonHover">\n        <p>\n            <span class="number">',(a=i.over)?a=a.call(e,{hash:{}}):(a=e.over,a=typeof a===d?a.apply(e):a),o+=c(a)+'</span>\n            <span class="unit">',s={hash:{}},n=i.i18n,a=n?n.call(e,"cals",s):h.call(e,"i18n","cals",s),(a||0===a)&&(o+=a),o+='</span>\n        </p>\n        <p class="information over">\n            ',s={hash:{}},n=i.i18n,a=n?n.call(e,"over",s):h.call(e,"i18n","over",s),(a||0===a)&&(o+=a),o+='\n        </p>\n    </div>\n    <div class="hover">\n        <p>\n            <span class="number eaten">',(a=i.eaten)?a=a.call(e,{hash:{}}):(a=e.eaten,a=typeof a===d?a.apply(e):a),o+=c(a)+'</span>\n            <span class="divisor">/</span>\n            <span class="number goal">',(a=i.goal)?a=a.call(e,{hash:{}}):(a=e.goal,a=typeof a===d?a.apply(e):a),o+=c(a)+'</span>\n            <span class="unit">',s={hash:{}},n=i.i18n,a=n?n.call(e,"cals",s):h.call(e,"i18n","cals",s),(a||0===a)&&(o+=a),o+='</span>\n        </p>\n        <p class="information over">\n            ',s={hash:{}},n=i.i18n,a=n?n.call(e,"eaten",s):h.call(e,"i18n","eaten",s),(a||0===a)&&(o+=a),o+="\n        </p>\n    </div>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h=i.helperMissing,c=this.escapeExpression,d="function",u=this;return r={hash:{},inverse:u.noop,fn:u.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.foodplan",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.foodplan",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_foodPlan",t),t}),define("galileo/model/calorieGoal",["require","mootools"],function(e){e("mootools");var t=50,i={goalState:function(e,t){0===e.eaten?t.none():e.eaten>e.goal&&"REACHED"!==e.goalStatus?t.over():"REACHED"===e.goalStatus?t.reached():t.under()},goalStateHelper:function(e,t){return e>t+this.getCalorieBuffer()?1:e<t-this.getCalorieBuffer()?-1:0},getCalorieBuffer:function(){return t}};return i.goalStateHelper=i.goalStateHelper.bind(i),i}),define("galileo/graphic/foodPlanPlate",["require","galileo/prototype/all","highcharts","../color/graph"],function(e){function t(e,t,i){function a(e){p.clip(u.clipRect(0,h*r*(g-e)/g,l,r)),e&&setTimeout(a.bind(this,e-1),70)}if(t>=e||"OVER"!==i){var h=n(e/t),c=$("<div>"),u=new s.Renderer(c[0],l,r);u.circle(l/2,r/2,r/2-2).attr("stroke",o.foodPlan.emptyPlateStroke).attr("stroke-width",4).attr("fill",o.foodPlan.emptyPlateFill).add();if("REACHED"!==i){var p=u.circle(l/2,r/2,r/2).attr("fill",o.foodPlan.fullPlateFill).add(),g=20;a(g)}return d&&u.image("/images/dashboard/galileo/foodPlan/forkAndKnife.png",l/2-16.5,r/2-36,33,72).add(),c}return $('<div class="plateOver">')}function i(e,t,i){if(i)return $("<div class='food-before-creation'>");if(void 0===e)return $("<div class='food-in-future'>");if(t>=e){var a=n(e/t),l=$("<div  class='food-below-goal'>"),r=new s.Renderer(l[0],h,c);r.circle(h/2,c/2,c/2-1).attr("stroke",o.foodPlan.emptyPlateStroke).attr("stroke-width",2).attr("fill",o.foodPlan.emptyPlateFill).add();return r.circle(h/2,c/2,c/2).attr("fill",o.foodPlan.fullPlateFill).clip(r.clipRect(0,a*c,h,c)).add(),d&&r.image("/images/dashboard/galileo/foodPlan/forkAndKnifeSmall.png",19,9,16,36).add(),l}return $("<div class='food-above-goal'>")}function n(e){if(Math.abs(e-.5)<.05)return e;if(e>=.5)return 1-n(1-e);var t=a(function(t){return t-Math.sin(t)-2*e*Math.PI},0,Math.PI);return.5*(1-Math.cos(t/2))}function a(e,t,i){var n=(i+t)/2;return.01>=i-t?n:e(n)>0?a(e,t,n):a(e,n,i)}e("galileo/prototype/all");var s=e("highcharts"),o=e("../color/graph"),l=130,r=130,h=54,c=50,d=$("html").hasClass("ie8");return{full:t,small:i}}),define("galileo/tile/foodPlan",["require","galileo/model/user","./classes/small","i18n/i18n","galileo/ajax/ajax","galileo/util/foodGoalLoader","hbs!galileo/tile/template/foodPlanNoPlan","hbs!galileo/tile/template/foodPlan","galileo/tile/template/helpers/domPlaceholder","galileo/util/dateUtil","galileo/model/calorieGoal","galileo/graphic/foodPlanPlate","jquery","i18n-load!com/fitbit/app/ngd/foodplan","hbs!galileo/tile/template/planInput"],function(e){var t=e("galileo/model/user"),i=e("./classes/small"),n=e("i18n/i18n")(),a=e("galileo/ajax/ajax"),s=e("galileo/util/foodGoalLoader"),o=e("hbs!galileo/tile/template/foodPlanNoPlan"),l=e("hbs!galileo/tile/template/foodPlan"),r=e("galileo/tile/template/helpers/domPlaceholder"),h=e("galileo/util/dateUtil"),c=e("galileo/model/calorieGoal"),d=e("galileo/graphic/foodPlanPlate"),u=e("jquery"),p=function(e){return t.viewer.formatNumber(e,"#,###")};return n.namespace(e("i18n-load!com/fitbit/app/ngd/foodplan")),new Class({Extends:i,title:n("food_plan"),tileName:"foodPlan",hasModal:!1,tileType:"foodPlan",logUrl:"/foods/log",load:function(){function t(t){var a=this.settings.find(".settingsContainer").empty(),r=this.main.find(".content"),h=e("hbs!galileo/tile/template/planInput");i.isDateEqual(o)&&(this.on("showSettings",function(){s(function(){l=function(){u(this).foodGoalModal()}}.bind(this))}.bind(this)),u.get("/goal/caloriesConsumptionGoalSetup",{
apiFormat:"json",getForm:"on"}).done(function(e){t.calTarget=e.result.target||0,t.foodBudgetEnabled||t.calTarget>0?(i.hasModal=!0,r.children().not("h2").detach(),r.children().show(),i.showMainContents(!1),i.renderPlan(t)):(i.hasModal=!1,r.children().not("h2").detach(),r.children().hide(),i.renderNoPlan(),i.showMainContents(!1)),t.foodBudgetEnabled?t.foodPlanIntensity?(this.foodPlan=u(h({title:n("plan_intensity"),value:i.getIntensityTranslation(t.foodPlanIntensity),editable:!0})),a.append(this.foodPlan),this.deficitGoal=u(h({title:n("deficit_goal"),value:-t.calDeficit,editable:!1,units:n("cals")})),a.append(this.deficitGoal)):(this.foodPlan=u(h({title:"",value:n("start_a_plan"),editable:!0,subtitle:n("you_dont_have_plan")})),a.append(this.foodPlan)):(this.foodPlan=u(h({title:n("man_cal_goal"),value:t.calTarget,editable:!0})),a.append(this.foodPlan)),this.foodPlan.find(".setting").click(function(){l()})}))}var i=this,o=this.getDate(),l=function(){};return a.get("getCaloriesInVsOutTileDataAt","activityTileData",{date:h.ajaxEncode(o)},t.bind(this)),this},renderNoPlan:function(){var e=function(){s(function(){u(this).foodGoalModal()}.bind(this))};this.hideControls(),this.main.find(".content").append(o()),this.main.find(".start-food-plan-link").click(e)},renderPlan:function(e){var t=this,i=e.calBurnedTodayFullDay-e.calDeficit,n=e.calIntakeToday,a=e.caloriesGoalStatus;this.showControls(),e.foodBudgetEnabled||(i=e.calTarget),this.main.find(".content").append(r(l,{plate:d.full(n,i,a),goal:p(i),eaten:p(n),leftToEat:p(i-n),over:p(n-i)})),t.main.find(".plateContainer").removeClass("emptyPlate"),c.goalState({goal:i,eaten:n,goalStatus:a},{none:function(){t.main.find(".notLoggedContainer").show()},over:function(){t.main.find(".overContainer").show(),t.main.find(".plateContainer").addClass("emptyPlate")},reached:function(){t.main.find(".goalReachedContainer").show()},under:function(){t.main.find(".underContainer").show()}})},getIntensityTranslation:function(e){switch(e){case"Maintenance":return n("intensity_maintenance");case"Low":return n("intensity_low");case"Medium":return n("intensity_medium");case"High":return n("intensity_high");case"Extreme":return n("intensity_extreme");default:return e}}})}),define("hbs!galileo/tile/template/trainer/emptyState",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/premium","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n<div class="main empty">\n    <div class="content">\n        <div class="messageArea">\n            <h2 class="title">',s={hash:{}},n=i.i18n,a=n?n.call(e,"trainer",s):c.call(e,"i18n","trainer",s),(a||0===a)&&(o+=a),o+='</h2>\n            <h3 class="subTitle">',s={hash:{}},n=i.i18n,a=n?n.call(e,"plan_to_be_more_active",s):c.call(e,"i18n","plan_to_be_more_active",s),(a||0===a)&&(o+=a),o+='</h3>\n            <p class="bodyText">',s={hash:{}},n=i.i18n,a=n?n.call(e,"increase_activity_each_day",s):c.call(e,"i18n","increase_activity_each_day",s),(a||0===a)&&(o+=a),o+='</p>\n        </div>\n        <div class="clearfix onboardingFooter">\n            <span class="buttonContainer">\n                <a class="dashButton saveButton" href="/trainer/trainerSetup">',s={hash:{}},n=i.i18n,a=n?n.call(e,"learn_more",s):c.call(e,"i18n","learn_more",s),(a||0===a)&&(o+=a),o+='</a>\n            </span>\n            <span class="buttonContainer">\n                <a class="dashButton cancelButton removeEmptyTile">',s={hash:{}},n=i.i18n,a=n?n.call(e,"no_thanks",s):c.call(e,"i18n","no_thanks",s),(a||0===a)&&(o+=a),o+="</a>\n            </span>\n        </div>\n    </div>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h="",c=i.helperMissing,d=this;return r={hash:{},inverse:d.noop,fn:d.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.premium",r):c.call(t,"i18n-namespace","com.fitbit.app.ngd.premium",r),(l||0===l)&&(h+=l),h+="\n"});return e.registerPartial("galileo_tile_template_trainer_emptyState",t),t}),define("galileo/tile/trainer",["require","./classes/smallBasic","i18n/i18n","galileo/ajax/ajax","galileo/model/user","galileo/util/dateUtil","hbs!./template/trainer/emptyState","i18n-load!com/fitbit/app/ngd/premium","i18n-load!com/fitbit/app/ngd/goal","i18n-load!com/fitbit/app/unit"],function(e){var t=e("./classes/smallBasic"),i=e("i18n/i18n")(),n=e("galileo/ajax/ajax"),a=e("galileo/model/user").viewer,s=e("galileo/util/dateUtil"),o=e("hbs!./template/trainer/emptyState");i.namespace(e("i18n-load!com/fitbit/app/ngd/premium")),i.namespace(e("i18n-load!com/fitbit/app/ngd/goal")),i.namespace(e("i18n-load!com/fitbit/app/unit"));var l=a.subscriptions.trainer,r={setting:[{unitPlural:i.plural("calorie"),unitThreshold:1/0,format:"#,##0"}],result:[{unitKey:i("activity_cals"),unitThreshold:1/0,format:"#,##0"}]};return"ko_KR"==a.locale&&(r.goal=[{unitPlural:i.plural("calorie"),unitThreshold:1/0,format:"#,##0"}]),new Class({Extends:t,title:i("trainer"),tileName:"trainer",hasModal:!1,tileType:"trainer",logUrl:"/premium/cb",options:{metricFormats:r},initialize:function(e){this.parent(e)},updateSettings:function(){this.parent();var e=this.tileData.trainerPlan,t=this.weeklyGoalMsg;if(e&&e.suggestedGoal){this._tmpWeeklyGoalMsg||(this._tmpWeeklyGoalMsg=t.children().detach());var n=i("suggest_changing_goal").substitute({suggestedGoal:e.suggestedGoal});t.text(n)}else this._tmpWeeklyGoalMsg&&(t.empty().append(this._tmpWeeklyGoalMsg),this._tmpWeeklyGoalMsg=void 0)},load:function(){var e=this.main.eq(0).find(".content"),t=this.getDate(),i=this.goalData=this.tileData={};this.showMainContents(!1),l.getPlan(function(n){if(this.isDateEqual(t)){i.trainerPlan=n;var o;n&&(o=n.weeks.filter(function(e){return new Date(e.start[0],e.start[1]-1,e.start[2]).getTime()<=t.getTime()}).length);var l=0===s.diffInDays(t,this.today);o||!a.hasTrainerPlan()||l?o?(this.displayTrainerState(e,o,n),this.updateSettings()):(this.displayEmptyState(),this.setupEmptyRemoveLink()):this.displayInactiveState(e,o)}}.bind(this))},displayInactiveState:function(e,t){this.hasModal=!1,this.container.addClass("inactive"),this.tileData.dailyGoal=1,this.tileData.dayTotal=0,this.goalElementChan.take(function(e){e.setGoalData(this.tileData),e.setCustomText(i("trainer_inactive_plan"))}.bind(this)),this.displayGoal(e)},displayEmptyState:function(){this.hasModal=!1,this.container.removeClass("inactive"),this.body.children().detach(),this.body.append(this.getEmptyStateView())},displayTrainerState:function(e,t,i){this.hasModal=!0,this.container.removeClass("inactive"),this.getTrainerView(t,e),this.goalElementChan.take(function(e){e.resetCustomText()}.bind(this))},getTrainerView:function(e,t){var a=this;this.body.children().detach(),this.showMainContents(!1);var o=this.getDate();this.tileData.trainerPlan.weeks[e-1]&&(this.main.find(".afterTitle").text(i("slash_week_n").substitute([e])),n.get("getActivityCalories","activityTileData",{dates:JSON.encode([s.ajaxEncode(o)])},function(i){this.tileData.dailyGoal=this.tileData.trainerPlan.weeks[e-1].target,this.tileData.dayTotal=i[0],this.displayGoal(t),this.loadSettings(),this.goalElementChan.take(function(e){e.setGoalData(this.tileData),e.render(1)}.bind(this))}.bind(this)));var l=$("#trainerTooltipTemplate");if(l[0]){var r=a.main.find(".tileInfo"),h=$(l.text());l.remove(),a.container.addClass("showNotice"),h.find(".edit").click(function(){h.fadeOut(function(){a.showSettings()})}),h.find(".noThanks").click(function(e){h.fadeOut(function(){h.remove()}),r.fadeOut(function(){r.remove()}),$.post("/userSettings/fp/save?apiFormat=json",{"added[0].name":"fpSuppressNotice","added[0].value":$(this).data("week-number"),csrfToken:window.fitbitCsrfToken})}),a.on("showSettings",function(){h.fadeOut(),r.mouseenter(function(){h.fadeIn()})}),a.positionTooltip(h,r),a.on("positionComplete",function(){a.positionTooltip(h,r)})}},getEmptyStateView:function(){return o({})},updateGoals:function(e,t,i){return n.post("updateDailyGoal","activityTileData",{dataType:e,goalValue:t},function(){n.get("getGoalData","activityTileData",{dataTypes:"calories-burned"}).update(),n.get("getTileData","activityTileData",{date:s.ajaxEncode(i),dataTypes:"calories-burned"}).update(),n.get("getGoalData","activityTileData",{dataTypes:e}).update(),l.getPlan().update(),n.get("getActivityCalories","activityTileData",{dates:JSON.encode([s.ajaxEncode(i)])}).update()}),this},positionTooltip:function(e,t){var i=t.offset();e.appendTo("body").css({left:i.left+t.outerWidth()/2-e.outerWidth()/2+"px",top:i.top-e.outerHeight()+"px",marginTop:"-25px",opacity:1})}})}),define("hbs!galileo/tile/template/dialog/largeTileModalContainer",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var s,o="",l="function";return o+='<div class="dialog largeTileContainer">\n    <div class="content">\n        ',(s=i.content)?s=s.call(t,{hash:{}}):(s=t.content,s=typeof s===l?s.apply(t):s),(s||0===s)&&(o+=s),o+="\n    </div>\n</div>"});return e.registerPartial("galileo_tile_template_dialog_largeTileModalContainer",t),t}),define("hbs!galileo/tile/template/large",["handlebars","hbs!galileo/tile/template/tileControls"],function(e){var t=e.template(function(e,t,i,n,a){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,n=n||e.partials;var s,o="",l="function",r=this.escapeExpression,h=this;return o+='<div class="largeTile ',(s=i.tileClass)?s=s.call(t,{hash:{}}):(s=t.tileClass,s=typeof s===l?s.apply(t):s),o+=r(s)+'">\n    <div class="main">\n        <div class="content">\n            <h2>\n                <span class="icon"></span>\n                <i class="fitglyph fitglyph-',(s=i.tileClass)?s=s.call(t,{hash:{}}):(s=t.tileClass,s=typeof s===l?s.apply(t):s),o+=r(s)+' size-c">\n                    <span class="path1"></span><span class="path2"></span><span class="path3"></span>\n                </i>\n                <span class="largeTileTitle">',(s=i.title)?s=s.call(t,{hash:{}}):(s=t.title,s=typeof s===l?s.apply(t):s),o+=r(s)+'</span>\n                <span class="afterTitle">',(s=i.afterTitle)?s=s.call(t,{hash:{}}):(s=t.afterTitle,s=typeof s===l?s.apply(t):s),o+=r(s)+"</span>\n            </h2>\n            ",(s=i.contents)?s=s.call(t,{hash:{}}):(s=t.contents,s=typeof s===l?s.apply(t):s),(s||0===s)&&(o+=s),o+="\n        </div>\n        ",s=h.invokePartial(n.galileo_tile_template_tileControls,"galileo_tile_template_tileControls",t,i,n),(s||0===s)&&(o+=s),o+="\n    </div>\n</div>"});return e.registerPartial("galileo_tile_template_large",t),t}),define("galileo/tile/classes/modal",["require","mootools","jquery","shared/scripts/modal","hbs!../template/dialog/largeTileModalContainer","hbs!../template/large","galileo/util/help","cdn-logger/siteLogger"],function(e){e("mootools"),e("jquery");var t=e("shared/scripts/modal"),i=e("hbs!../template/dialog/largeTileModalContainer"),n=e("hbs!../template/large"),a=e("galileo/util/help"),s=e("cdn-logger/siteLogger"),o={VIEW:{weight:s.INTERACTION_IDS.VIEW_WEIGHT,sleep:s.INTERACTION_IDS.VIEW_SLEEP,calZone:s.INTERACTION_IDS.VIEW_FOOD,foodPlan:s.INTERACTION_IDS.VIEW_FOOD,water:s.INTERACTION_IDS.VIEW_WATER}};return new Class({Implements:Options,options:{date:new Date,controlsList:[{name:"more","class":"more secondRight",glyphName:"arrow-right",href:""}]},tileName:"",initialize:function(e){this.setOptions(e),this.date=this.options.date,this.setupModal()},setupModal:function(){var e=this.modal=new t(this.setupDialog.bind(this));e.position(),this.body=e.dialog.find(".main .content"),a.handle("setupModal",this),this.logViewInteraction()},setupDialog:function(){var e=$(this.renderDialogTpl()),t=e.find(".content"),i=$(this.renderTileTpl({title:this.title,tileClass:this.options.tileClass,afterTitle:this.afterTitle}));return i.appendTo(t),e},renderDialogTpl:function(e){return i(e||{})},renderTileTpl:function(e){return this.options.controlsList&&(e.controlsList=this.options.controlsList),n(e||{})},setDate:function(e){return this.date=e,this},getDate:function(){return this.date},isDateEqual:function(e){return this.getDate()===e},logViewInteraction:function(){var e=this.options&&this.options.tileClass&&o.VIEW[this.options.tileClass];null!=e&&s.logV2Event({id:e,type:"screen"})}})}),define("hbs!galileo/tile/template/stepsModalContents",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/chart","galileo/tile/template/helpers/i18n","hbs!galileo/tile/template/chartLegend"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var a,s,o,l="";return l+='\n<div class="goalContainer"></div>\n<div class="chart">\n    <div class="js_graphHeader graphHeader">\n        <h3 class="graphTitle js_graphTitle">',o={hash:{}},a=i.i18n,s=a?a.call(e,"title_past_month",o):h.call(e,"i18n","title_past_month",o),(s||0===s)&&(l+=s),l+='</h3>\n    </div>\n    <div class="chartContainer"></div>\n    ',s=c.invokePartial(n.galileo_tile_template_chartLegend,"galileo_tile_template_chartLegend",e,i,n),(s||0===s)&&(l+=s),l+="\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,n=n||e.partials;var o,l,r,h=i.helperMissing,c=this;return r={hash:{},inverse:c.noop,fn:c.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.chart",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.chart",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_stepsModalContents",t),t}),define("galileo/tile/classes/largeBasic",["require","mootools","jquery","../classes/modal","hbs!../template/stepsModalContents","i18n/i18n","galileo/model/user","i18n-load!com/fitbit/app/ngd/chart"],function(e){e("mootools"),e("jquery");var t=e("../classes/modal"),i=e("hbs!../template/stepsModalContents"),n=e("i18n/i18n")();e("galileo/model/user");return n.namespace(e("i18n-load!com/fitbit/app/ngd/chart")),new Class({Extends:t,title:"LargeBasic",tileName:"largeBasic",tileType:"largeBasic",options:{metricFormats:{weeklyTotal:[{unitKey:"",unitThreshold:1/0,format:"#,##0"}],tooltipFormat:[{unitKey:"",unitThreshold:1/0,format:"#,##0"}]},tileClass:"distance",legendList:[{"class":"goal_met",name:n("legend_goal_met")}]},load:function(){var t=this,i=this.getDate(),n=t.modal,a=t.body.find(".goalContainer");e(["galileo/model/user","galileo/tile/element/goal/modal","galileo/model/goals"],function(e,s,o){var l=new s(a,{metricFormats:t.options.metricFormats});t.goalElement=l,n.overlay.on("click",l.stopProgressAnimation.bind(l));var r=e.viewer.activities(),h=(r.loadSummary,r.loadSummary.bind(r,t.tileType,i));Function.join(h,function(e){t.isDateEqual(i)&&(l.render(e),t.loadChart(),n.position())})})},getTemplate:function(){return i},renderTileTpl:function(e){return e.contents=this.getTemplate()({legendList:this.options.legendList}),this.parent(e)},loadChart:function(){var t=this,i=t.body.find(".chartContainer"),n=t.modal,a=this.getDate();e(["galileo/graph/weeks"],function(e){var s={series_name:t.tileType,width:i.width(),height:i.height(),date:a,precision:t.precision,weeks:4,tooltipFormat:t.options.metricFormats.tooltipFormat};i.empty().append(e(s)),n.position()})}})}),define("galileo/tile/element/goal/base",["require","jquery","mootools","galileo/prototype/all"],function(e){return e("jquery"),e("mootools"),e("galileo/prototype/all"),new Class({Implements:[Events,Options],initialize:function(e,t){this.element=$(e),this.setOptions(t)},_setGoalData:function(e){this.goalData=e&&Object.clone(e)||void 0},setGoalData:function(e){this._setGoalData(e)},setPrecision:function(e){this.precision=e},startProgressAnimation:function(e){function t(){var o=s(i/e);o>1&&(o=1),n.fireEvent("animationProgress",[o]),i+=a,e+a>=i?n.timer=setTimeout(t,a):n.stopProgressAnimation()}var i=0,n=this;n.stopProgressAnimation();var a=jQuery&&jQuery.fx.interval||15,s=function(e){return 1-Math.pow(1-e,3)};t()},stopProgressAnimation:function(){this.timer=clearTimeout(this.timer)},getGoalState:function(e){var t,i=this.options.goalStates||[];return i.some(function(i,n){var a=i.range;return e>=a[0]&&e<a[1]?(t=i,!0):!1}),t}})}),define("galileo/graphic/base",["require","mootools","highcharts"],function(e){e("mootools");var t=e("highcharts"),i=new Class({Implements:[Events,Options],options:{percent:0,width:0,height:0,colors:["#55C2C2","#FF6D43","#FFC807","#9ADE11"]},initialize:function(e,t){this.element=e,this.setOptions(t);var i=this.width=this.options.width,n=this.height=this.options.height;this.percent=this.options.percent;this.setupPaper(e,i,n)},setupPaper:function(e,i,n){return this.paper=new t.Renderer(e,i,n),this},setProgress:function(e){return this.percent=e,this},getProgressColor:function(e){var t=this.options.colors;return.33>=e?t[0]:.66>=e?t[1]:.99>e?t[2]:t[3]}});return i}),define("galileo/graphic/goalBar",["require","mootools","./base"],function(e){e("mootools");var t=e("./base"),i=.01,n=18,a=new Class({Extends:t,options:{radius:0},initialize:function(e,t){this.parent(e,t),this.radius=this.options.radius,this.stroke=this.options.stroke||n,this.colors={front:"",shadow:""},this.render()},render:function(){this.renderBack(),this.renderBar()},renderBack:function(){var e=this.paper.arc(this.width/2,this.height/2,this.radius,this.radius-1,a.ARC_START+i,a.ARC_START+a.ARC_LENGTH-i),t="#F0F0F0";e.attr("stroke",t),e.attr("stroke-width",4),e.attr("stroke-linejoin","round"),e.attr("stroke-linecap","round"),e.add()},renderBar:function(){this.percent>1&&(this.percent=1);var e=this.percent*a.ARC_LENGTH;if(!this.progressBar){var t=this.paper.arc(this.width/2,this.height/2,this.radius,this.radius-1,a.ARC_START+i,a.ARC_START+e-i);t.attr("stroke-width",this.stroke),t.attr("stroke-linejoin","round"),this.progressBar=t,t.add()}if(this.marker&&$(this.marker.element).remove(),this.percent<1){var n=Math.round(this.stroke*(5/9));this.marker=this.paper.circle(this.width/2,this.height-this.stroke/2,n/2),this.marker.attr({fill:"rgba(0,0,0,0.25)"})}else{var s=Math.round(.75*this.stroke);this.marker=this.paper.text("",this.width/2-s/2,this.height-this.stroke+s),this.marker.css({"font-family":"Fitbit Icons","font-size":s+"px",color:"#83aa20"})}this.marker.add(),$(this.marker.element).html("&#xE622"),this.percent<=0?(this.progressBar.css({display:"none"}),this.marker.css({display:"none"})):(this.progressBar.css({display:"inline"}),this.marker.css({display:"inline"})),this.progressBar.attr("end",a.ARC_START+e),this.progressBar.attr("stroke",{linearGradient:{x1:0,x2:0,y1:0,y1:1},stops:[[0,this.colors[0]],[1,this.colors[1]]]})},setProgress:function(e){return this.parent(e),this.renderBar(),this},setColors:function(e){return this.colors=e,this.renderBar(),this}});a.STROKE_WIDTH=18,a.ARC_LENGTH=2*Math.PI,a.ARC_START=Math.PI/2;var s=new Class({Extends:t,options:{corner:15},initialize:function(e,t){this.parent(e,t),this.corner=this.options.corner,this.colors={front:""},this.render()},render:function(){this.renderBack(),this.renderBar()},renderBack:function(){var e=this.paper.rect(0,0,this.width,this.height,this.corner),t="#dddddd";e.attr("fill",t),e.attr("stroke",t),e.add()},renderBar:function(){if(this.progressBar&&(this.progressBar.destroy(),this.progressBar=null),0!=this.percent){this.percent>1&&(this.percent=1);var e=(this.width-6)*this.percent;if(e>=this.corner+6){var t=this.paper.rect(3,3,e,this.height-6,this.corner-3),i=this.colors;t.attr("fill",i.front),t.attr("stroke",i.front),this.progressBar=t,t.add()}}},setProgress:function(e){return this.parent(e),this.renderBar(),this},setColors:function(e){return this.colors=e,this.renderBar(),this}});return{Arc:a,Bar:s}}),define("galileo/tile/element/goal/goalBar",["require","jquery","mootools","galileo/prototype/all","galileo/tile/element/goal/base","galileo/graphic/goalBar","i18n/i18n","galileo/widget/metric","i18n-load!com/fitbit/app/ngd/goal","i18n-load!com/fitbit/app/unit"],function(e){e("jquery"),e("mootools"),e("galileo/prototype/all");var t=e("galileo/tile/element/goal/base"),i=e("galileo/graphic/goalBar"),n=e("i18n/i18n")();e("galileo/widget/metric");return n.namespace(e("i18n-load!com/fitbit/app/ngd/goal")),n.namespace(e("i18n-load!com/fitbit/app/unit")),new Class({Extends:t,options:{metricFormats:{weeklyTotal:[{unitKey:"",unitThreshold:1/0,precision:0}]},styles:{number:{color:"#333",fontSize:"21px",paddingRight:"2px"},unit:{color:"#333",fontSize:"14px",textTransform:"lowercase",paddingRight:"4px"}},goalStates:[{range:[0,.33],praiseText:"",goalColors:{front:"#55C2C2"}},{range:[.33,.66],praiseText:"",goalColors:{front:"#FF6D43"}},{range:[.66,.99],praiseText:"",goalColors:{front:"#FFC807"}},{range:[.99,1/0],praiseText:n("champ"),goalColors:{front:"#9ADE11"}}]},initialize:function(e,t){this.parent(e,t),this.progressBar=this.renderGraphic(e[0],t.width,t.height,t.corner)},setProgress:function(e){this.progressBar.setProgress(e);var t=this.getGoalState(e)||{},i=t.goalColors;i&&this.progressBar.setColors(i),this.animate(e)},animate:function(e){return this.addEvent("animationProgress",function(t){this.progressBar.setProgress(t*e)}.bind(this)),this.startProgressAnimation(500),this},renderGraphic:function(e,t,n,a){return new i.Bar(e,{width:t,height:n,corner:a})}})}),define("hbs!galileo/tile/template/modalGoalContainerTemplate",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/goal","galileo/tile/template/helpers/i18n","galileo/tile/template/helpers/domPlaceholder"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n<div class="goal">\n    <div class="data">\n        <div>\n            <div class="total">\n                <span class="weeklyTotal">',s={hash:{}},n=i.i18n,a=n?n.call(e,"this_weeks_total",s):h.call(e,"i18n","this_weeks_total",s),(a||0===a)&&(o+=a),o+="</span>\n                ",s={hash:{}},o+=c((n=i.domPlaceholder,n?n.call(e,"weeklyMetric",s):h.call(e,"domPlaceholder","weeklyMetric",s)))+'\n            </div>\n            <div class="avg">\n                <span class="dailyTotal">',s={hash:{}},n=i.i18n,a=n?n.call(e,"daily_avg",s):h.call(e,"i18n","daily_avg",s),(a||0===a)&&(o+=a),o+="</span>\n                ",s={hash:{}},o+=c((n=i.domPlaceholder,n?n.call(e,"dailyMetric",s):h.call(e,"domPlaceholder","dailyMetric",s)))+'\n                <span class="dailyAvgPerc"></span>\n            </div>\n        </div>\n    </div>\n    <div class="progressStatus">\n        <div class="progressMsg"></div>\n        <div class="progressPerc"></div>\n    </div>\n    <div class="meter">\n        <div class="percentage">\n            <div class="icon"></div>\n        </div>\n    </div>\n</div>\n'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h=i.helperMissing,c=this.escapeExpression,d=this;return r={hash:{},inverse:d.noop,fn:d.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.goal",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.goal",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_modalGoalContainerTemplate",t),t}),define("galileo/tile/element/goal/modal",["require","jquery","mootools","galileo/prototype/all","galileo/tile/element/goal/base","galileo/tile/element/goal/goalBar","i18n/i18n","galileo/widget/metric","galileo/widget/metric","galileo/model/user","galileo/color/graph","hbs!galileo/tile/template/modalGoalContainerTemplate","galileo/tile/template/helpers/domPlaceholder","i18n-load!com/fitbit/app/ngd/goal","i18n-load!com/fitbit/app/unit"],function(e){e("jquery"),e("mootools"),e("galileo/prototype/all");var t=e("galileo/tile/element/goal/base"),i=(e("galileo/tile/element/goal/goalBar"),e("i18n/i18n")()),n=e("galileo/widget/metric"),n=e("galileo/widget/metric"),a=e("galileo/model/user").viewer,s=e("galileo/color/graph"),o=e("hbs!galileo/tile/template/modalGoalContainerTemplate"),l=e("galileo/tile/template/helpers/domPlaceholder");i.namespace(e("i18n-load!com/fitbit/app/ngd/goal")),i.namespace(e("i18n-load!com/fitbit/app/unit"));var r=function(e){var t;return 50>e?t=i("progress_msg_49"):100>e?t=i("progress_msg_99"):125>e?t=i("progress_msg_124"):e>=125&&(t=i("progress_msg_125+")),t},h=function(e,t){return i("progress_percentage_of_val").substitute({percent:a.formatNumber(e,"#,##0"),target:a.formatNumber(t,"#,##0")})},c=function(e){var t;return 50>e?t=s.progressClasses[1]:100>e?t=s.progressClasses[2]:125>e?t=s.progressClasses[3]:e>=125&&(t=s.progressClasses[3]),t},d=function(e,t){return Math.ceil(e/t*100)},u=function(e,t){return e==t?0:0==e?-100:0==t?100:Math.ceil(100*(e-t)/t)},p=function(e){var t;return e>0?t=i("daily_avg_change_up"):0>e&&(t=i("daily_avg_change_down")),t};return new Class({Extends:t,options:{metricFormats:{weeklyTotal:[{unitKey:"",unitThreshold:1/0,precision:0}]},goalStates:[{range:[0,.33],praiseText:"",goalColors:{front:"#55C2C2"}},{range:[.33,.66],praiseText:"",goalColors:{front:"#FF6D43"}},{range:[.66,.99],praiseText:"",goalColors:{front:"#FFC807"}},{range:[.99,1/0],praiseText:i("champ"),goalColors:{front:"#9ADE11"}}]},initialize:function(e,t){this.parent(e,t)},elements:function(){var e=new n(this.options.metricFormats.weeklyTotal);this.weeklyTotal=e;var t=new n(this.options.metricFormats.weeklyTotal);this.dailyAvg=t;var i=l(o,{weeklyMetric:e.elements(),dailyMetric:t.elements()});this.els={progressMsg:i.find(".progressMsg"),progressPerc:i.find(".progressPerc"),dailyAvgPerc:i.find(".dailyAvgPerc"),progressStatus:i.find(".progressStatus"),meter:i.find(".meter"),percentage:i.find(".percentage")};return i.appendTo(this.element),this.goalContainer=i,i},render:function(e){!this.goalContainer&&this.elements();var t=d(e.thisWeekTotal,e.weeklyGoal),n=u(e.thisWeekDailyAvg,e.prevWeekDailyAvg),a=p(n);if(a){var o=i("daily_avg_change_format").substitute({percent:Math.abs(n),direction:a});this.els.dailyAvgPerc.text("("+o+")")}this.els.progressMsg.text(r(t)),this.els.progressPerc.text(h(t,e.weeklyGoal)),this.weeklyTotal.update(e.thisWeekTotal),this.dailyAvg.update(e.thisWeekDailyAvg);var l=c(t);this.els.progressStatus.removeClass(s.progressClasses.join(" ")).addClass(l),this.els.percentage.removeClass(s.progressClasses.join(" ")).addClass(l),this.els.percentage.css({width:(100>t?t:100)+"%"})}})}),define("hbs!galileo/tile/template/waterModalWeek",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/goal","i18n-load!com/fitbit/app/ngd/water"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a="";return a+='\n<div class="goal">\n    <ul class="daySummary" id ="waterModalDayList">\n        ',n=i.each.call(e,e,{hash:{},inverse:g.noop,fn:g.program(2,o,t)}),(n||0===n)&&(a+=n),a+="\n    </ul>\n</div>\n"}function o(e,t){var n,a="";return a+='\n            <li class="statusIndicator ',(n=i.goalMarker)?n=n.call(e,{hash:{}}):(n=e.goalMarker,n=typeof n===u?n.apply(e):n),a+=p(n)+'">\n                <div class="statusText ',n=i["if"].call(e,e.today,{hash:{},inverse:g.noop,fn:g.program(3,l,t)}),(n||0===n)&&(a+=n),a+='">\n                    <!-- todo: need more glyphs for 25 and 75 percents -->\n                    <!-- this html is ready to go once we get the missing two glyphs added to font set -->\n                    <!-- <i class="fitglyph fitglyph-',(n=i.goalMarker)?n=n.call(e,{hash:{}}):(n=e.goalMarker,n=typeof n===u?n.apply(e):n),a+=p(n)+' size-b"></i>-->\n                    <div class="dayName">\n                        ',(n=i.day)?n=n.call(e,{hash:{}}):(n=e.day,n=typeof n===u?n.apply(e):n),a+=p(n)+'\n                    </div>\n                    <div class="consumed">\n                        ',n=i["if"].call(e,e.beforeOrOnToday,{hash:{},inverse:g.noop,fn:g.program(5,r,t)}),(n||0===n)&&(a+=n),a+="\n                    </div>\n                </div>\n            </li>\n        "}function l(e,t){return"today"}function r(e,t){var n,a="";return a+="\n                            ",(n=i.waterConsumedFormatted)?n=n.call(e,{hash:{}}):(n=e.waterConsumedFormatted,n=typeof n===u?n.apply(e):n),a+=p(n)+"\n                        "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var h,c,d,u="function",p=this.escapeExpression,g=this,f=i.helperMissing;return d={hash:{},inverse:g.noop,fn:g.program(1,s,a)},h=i["i18n-namespace"],c=h?h.call(t,"com.fitbit.app.ngd.goal","com.fitbit.app.ngd.water",d):f.call(t,"i18n-namespace","com.fitbit.app.ngd.goal","com.fitbit.app.ngd.water",d),c||0===c?c:""});return e.registerPartial("galileo_tile_template_waterModalWeek",t),t}),define("galileo/tile/element/goal/waterModalWeekView",["require","i18n/i18n","i18n-load!core/com/fitbit/util/dateformat","i18n-load!com/fitbit/app/unit","hbs!../../template/waterModalWeek"],function(e){var t=e("i18n/i18n")();return t.namespace(e("i18n-load!core/com/fitbit/util/dateformat")),t.namespace(e("i18n-load!com/fitbit/app/unit")),new Class({initialize:function(e){this.parentContainer=e},render:function(t){var i=e("hbs!../../template/waterModalWeek");$(this.parentContainer).html(i(t))}})}),define("hbs!galileo/tile/template/waterModalContents",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/chart","galileo/tile/template/helpers/i18n","hbs!galileo/tile/template/chartLegend"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var a,s,o,l="";return l+='\n<header class="stats"></header>\n<div class="goalContainer"></div>\n<div class="chart">\n    <div class="graphHeader">\n        <h3 class="graphTitle js_graphTitle">',o={hash:{}},a=i.i18n,s=a?a.call(e,"title_past_month",o):h.call(e,"i18n","title_past_month",o),(s||0===s)&&(l+=s),l+='</h3>\n    </div>\n    <div class="chartContainer"></div>\n    <div class="legendContainer">\n    	',s=c.invokePartial(n.galileo_tile_template_chartLegend,"galileo_tile_template_chartLegend",e,i,n),(s||0===s)&&(l+=s),l+="\n  	</div>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,n=n||e.partials;var o,l,r,h=i.helperMissing,c=this;return r={hash:{},inverse:c.noop,fn:c.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.chart",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.chart",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_waterModalContents",t),t}),define("hbs!galileo/tile/template/waterModalDailyAverage",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/goal","i18n-load!com/fitbit/app/ngd/water","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n<ul class="items">\n    <li class="weekTotal">\n        <h3 class="title">',s={hash:{}},n=i.i18n,a=n?n.call(e,"week_total",s):h.call(e,"i18n","week_total",s),(a||0===a)&&(o+=a),o+='</h3>\n        <span class="value">',(a=i.totalWaterConsumed)?a=a.call(e,{hash:{}}):(a=e.totalWaterConsumed,a=typeof a===c?a.apply(e):a),o+=d(a)+'</span>\n        <span class="units">',(a=i.unit)?a=a.call(e,{hash:{}}):(a=e.unit,a=typeof a===c?a.apply(e):a),o+=d(a)+'</span>\n    </li>\n    <li class="dailyAverage">\n        <h3 class="title">',s={hash:{}},n=i.i18n,a=n?n.call(e,"daily_avg",s):h.call(e,"i18n","daily_avg",s),(a||0===a)&&(o+=a),o+='</h3>\n        <span class="value">',(a=i.average)?a=a.call(e,{hash:{}}):(a=e.average,a=typeof a===c?a.apply(e):a),o+=d(a)+'</span>\n        <span class="units">',(a=i.unit)?a=a.call(e,{hash:{}}):(a=e.unit,a=typeof a===c?a.apply(e):a),o+=d(a)+"</span>\n    </li>\n</ul>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h=i.helperMissing,c="function",d=this.escapeExpression,u=this;return r={hash:{},inverse:u.noop,fn:u.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.goal","com.fitbit.app.ngd.water",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.goal","com.fitbit.app.ngd.water",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_waterModalDailyAverage",t),t}),define("galileo/tile/modal/water",["require","mootools","jquery","../classes/largeBasic","i18n/i18n","galileo/model/user","galileo/ajax/ajax","galileo/tile/element/goal/modal","galileo/tile/element/goal/waterModalWeekView","hbs!../template/waterModalContents","hbs!../template/waterModalDailyAverage","galileo/util/dateUtil","i18n-load!com/fitbit/app/ngd/water","i18n-load!com/fitbit/app/ngd/chart","i18n-load!com/fitbit/app/unit","i18n-load!core/com/fitbit/util/dateformat"],function(e){
e("mootools"),e("jquery");var t=e("../classes/largeBasic"),i=e("i18n/i18n")(),n=e("galileo/model/user"),a=e("galileo/ajax/ajax"),s=(e("galileo/tile/element/goal/modal"),e("galileo/tile/element/goal/waterModalWeekView")),o=e("hbs!../template/waterModalContents"),l=e("hbs!../template/waterModalDailyAverage"),r=e("galileo/util/dateUtil");i.namespace(e("i18n-load!com/fitbit/app/ngd/water")),i.namespace(e("i18n-load!com/fitbit/app/ngd/chart")),i.namespace(e("i18n-load!com/fitbit/app/unit")),i.namespace(e("i18n-load!core/com/fitbit/util/dateformat"));var h=function(){return 128==n.viewer.waterId?i.plural("oz_pl"):209==n.viewer.waterId?i.plural("ml_pl"):91==n.viewer.waterId?i.plural("cups_pl"):void 0}(),c=r.getShortWeekdayNames(),d=i("water");return"ko_KR"==n.viewer.locale&&(d+=" / "+h(1)),new Class({Extends:t,title:d,tileName:"water",tileType:"water",precision:1,options:{metricFormats:{weeklyTotal:[{unitPlural:h,unitThreshold:1/0,format:"#,##0.00"}],tooltipFormat:[{unitPlural:h,unitThreshold:1/0,format:"#,##0.00"}]},tileClass:"water",legendList:[{"class":"goal_met",name:i("legend_goal_met")}]},getTemplate:function(){return o},renderDailyAverage:function(e,t){this.body.find(".stats").html(l({average:n.viewer.formatNumber(e,"#,##0.#"),totalWaterConsumed:n.viewer.formatNumber(t,"#,##0.#"),unit:h()}))},load:function(){var t=this,i=this.getDate(),o=t.modal,l=t.body.find(".goalContainer");this.weeklyView=new s(l);var d=(n.viewer.activities(),a.get.bind(this,"getWaterTileWeekModalData","activityTileData",{date:r.ajaxEncode(i)})),u=a.get.bind(this,"getWaterTileDailyAverage","activityTileData",{startDate:r.ajaxEncode(r.minusWeeks(i,4)),endDate:r.ajaxEncode(i)}),p=a.get.bind(this,"getWaterTileData","activityTileData",{dateFrom:r.ajaxEncode(i)});Function.join(d,u,p,function(a,s,l){e(["galileo/tile/loadDependencies"],function(e){var r=0;t.isDateEqual(i)&&(a.each(function(t){t.goalMarker=e.waterCups.getGoalMarkers(t.waterConsumed,l.waterGoal,l.unit,["size0","size25","size50","size75","size100"]),t.waterConsumedFormatted=n.viewer.formatNumber(t.waterConsumed,"#,##0.#")+" "+h(),t.day=c[t.dayOfWeek%7],r+=t.waterConsumed}),t.renderDailyAverage(s,r),t.weeklyView.render(a),t.loadChart(),o.position())})})}})}),define("galileo/model/water",["require","galileo/ajax/ajax","galileo/util/dateUtil"],function(e){var t=e("galileo/ajax/ajax"),i=e("galileo/util/dateUtil");return{getWater:function(e,n){t.get("getWaterTileData","activityTileData",{dateFrom:i.ajaxEncode(e)},function(e){n(e)})},postNewGoal:function(e,n,a){t.post("updateWaterGoal","activityTileData",{goalValue:e},function(e){a(e),t.get("getTileData","activityTileData",{dataTypes:"water",date:i.ajaxEncode(n)}).update(),t.get("getWaterTileData","activityTileData",{dateFrom:i.ajaxEncode(n)}).update()})}}}),define("hbs!galileo/tile/template/waterConsumption",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a="";return a+='\n        <div class="highGoalContainer">\n            <span class="consumptionLevel" style="height: ',(n=i.goalPercentage)?n=n.call(e,{hash:{}}):(n=e.goalPercentage,n=typeof n===c?n.apply(e):n),a+=d(n)+'">\n                ',(n=i.totalWaterConsumption)?n=n.call(e,{hash:{}}):(n=e.totalWaterConsumption,n=typeof n===c?n.apply(e):n),a+=d(n)+"/",(n=i.waterGoal)?n=n.call(e,{hash:{}}):(n=e.waterGoal,n=typeof n===c?n.apply(e):n),a+=d(n)+"\n            </span>\n        </div>\n    "}function o(e,t){var n,a="";return a+="\n        ",n=i.each.call(e,e.goalMarkers,{hash:{},inverse:u.noop,fn:u.program(4,l,t)}),(n||0===n)&&(a+=n),a+='\n        <span class="consumptionLevel">\n            ',(n=i.totalWaterConsumption)?n=n.call(e,{hash:{}}):(n=e.totalWaterConsumption,n=typeof n===c?n.apply(e):n),a+=d(n)+"/",(n=i.waterGoal)?n=n.call(e,{hash:{}}):(n=e.waterGoal,n=typeof n===c?n.apply(e):n),a+=d(n)+"\n        </span>\n    "}function l(e,t){var i="";return i+='<span class="container '+d(typeof e===c?e.apply(e):e)+'"></span>'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,h="",c="function",d=this.escapeExpression,u=this;return h+='<div class="waterConsumption">\n    ',r=i["if"].call(t,t.goalPercentage,{hash:{},inverse:u.program(3,o,a),fn:u.program(1,s,a)}),(r||0===r)&&(h+=r),h+="\n</div>\n"});return e.registerPartial("galileo_tile_template_waterConsumption",t),t}),define("galileo/tile/water",["require","mootools","galileo/tile/modal/water","galileo/model/water","i18n/i18n","./classes/small","galileo/util/channel","galileo/model/user","galileo/widget/metric","hbs!galileo/tile/template/waterConsumption","i18n-load!com/fitbit/app/ngd/water"],function(e){e("mootools"),e("galileo/tile/modal/water");var t=e("galileo/model/water"),i=e("i18n/i18n")(),n=e("./classes/small"),a=e("galileo/util/channel"),s=e("galileo/model/user").viewer,o=e("galileo/widget/metric"),l=e("hbs!galileo/tile/template/waterConsumption"),r=8,h=function(){return $("<div>")},c=function(){return $("<span>")};i.namespace(e("i18n-load!com/fitbit/app/ngd/water"));var d=function(){return 128==s.waterId?i("oz"):209==s.waterId?i("ml"):91==s.waterId?i("cups"):void 0},u=function(e){return 128==s.waterId?29.5735*e:209==s.waterId?1*e:91==s.waterId?236.588*e:void 0};return new Class({Extends:n,title:i("water"),tileName:"water",tileType:"water",logUrl:"/foods/log",hasModal:!0,options:{metricFormats:{result:[{unitKey:d,unitThreshold:1/0,format:"#,##0"}],goal:[{unitKey:d,unitThreshold:1/0,format:"#,##0"}],setting:[{unitKey:d,unitThreshold:1/0,format:"###0.0"}]},style:{goalSetting:{marginTop:8,border:"3px #DDD solid",overflow:"auto",padding:"8px 10px 6px",display:"block"},settingInput:{"float":"left",width:120,fontSize:"16px",fontWeight:"bold",color:"#333",border:"none",padding:0,lineHeight:"20px",margin:0},settingUnit:{"float":"right",fontSize:15,lineHeight:"20px",fontWeight:"bold",color:"#666"},weeklyGoal:{color:"#999",fontSize:"15px",marginTop:"20px"},weeklyGoalTarget:{fontWeight:"bold"},weeklyGoalTargetUnit:{paddingLeft:"2px"},weeklyGoalTargetNumber:{paddingLeft:"4px"}}},initialize:function(e){this.parent(e),this.metricFormats=this.options.metricFormats,this.style=this.options.style,this.goalElement=null,this.goalElementChan=a(!0)},load:function(){var e=this.getDate();t.getWater(e,function(t){this.renderWater(this.roundWaterInfo(t),e),this.showMainContents(),this.loadSettings(e)}.bind(this))},roundNumberFirstDecimal:function(e){return Math.round(10*e)/10},roundWaterInfo:function(e){var t=new Object;return t.differenceFromGoal=this.roundNumberFirstDecimal(e.differenceFromGoal),t.totalWaterConsumption=this.roundNumberFirstDecimal(e.totalWaterConsumption),t.waterGoal=this.roundNumberFirstDecimal(e.waterGoal),t.unit=e.unit,t.isGoalMet=e.isGoalMet,t},renderWater:function(t,n){var a=this.main.find(".content");a.empty();var o=h().addClass("water-content");a.append(o),e(["galileo/tile/loadDependencies"],function(e){var i=$.extend({},t),n=e.waterCups;n.valueAsCups(i.waterGoal,i.unit)>r?i.goalPercentage=n.getGoalPercentage(i.totalWaterConsumption,i.waterGoal):i.goalMarkers=n.getGoalMarkers(i.totalWaterConsumption,i.waterGoal,i.unit,["size0","size50","size100"],8),o.html(l(i))});var u=h().addClass("metricLarge"),p=c().addClass("number"),g=t.differenceFromGoal<0?0:t.differenceFromGoal;p.append(s.formatNumber(g,"#,###")),p.append(c().addClass("units").text(d())),u.append(p),a.append(u);var f=i(0==t.totalWaterConsumption?"to_drink":"left"),m=c().addClass("metric"),v=h().addClass("metricContainer percentContainer");m.append(c().addClass("number").append(f)),v.append(m),a.append(v)},loadSettings:function(e){if(!this.settingsElement){var n=this.goalSetting=new o(this.metricFormats.setting,!0,!0);n.style({container:this.style.goalSetting,number:this.style.settingInput,unit:this.style.settingUnit});var a=this.weeklyGoal=new o(this.metricFormats.setting,!1);a.style({container:this.style.weeklyGoalTarget,number:this.style.weeklyGoalTargetNumber,unit:this.style.weeklyGoalTargetUnit}),n.addEvent("edit",this.updateWeeklyGoal.bind(this));var s=this.weeklyGoalMsg=h().append($("<span>").text(i("your_weekly_goal_is")),a.elements()),l=this.settingsElement=[h().addClass("goal_title").text(i("daily_goal")),h().append(n.elements()).addClass("setting"),s.addClass("weeklyGoal")],r=this.settings;r.find(".settingsContainer").append(l),t.getWater(e,function(e){n.update(e.waterGoal),a.update(7*e.waterGoal)}),r.find(".saveSettings").on("click",this.saveSettings.bind(this))}},updateWeeklyGoal:function(e){this.weeklyGoal.update(7*e)},saveSettings:function(){var e=this.roundNumberFirstDecimal(this.goalSetting.getValue()),i=this.getDate();t.postNewGoal(e,i,function(e){}.bind(this)),this.trigger("saveSettings","water",u(e)),this.load()}})}),define("hbs!galileo/tile/template/weeklyActivity",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/weekly","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,l="";return l+="\n",n=i["if"].call(e,e.graphTabs,{hash:{},inverse:p.noop,fn:p.program(2,o,t)}),(n||0===n)&&(l+=n),l+='\n<div class="chartContainer"></div>\n\n<div class="legendContainer chart"></div>\n\n<div class="goalContainer">\n    <h3 class="heading">',s={hash:{}},n=i.i18n,a=n?n.call(e,"goal",s):g.call(e,"i18n","goal",s),(a||0===a)&&(l+=a),l+='</h3>\n    <div class="meter">\n        <div class="percentage">\n            <div class="icon"></div>\n        </div>\n    </div>\n    <span class="progress">\n        <strong class="weekTotal"></strong>\n        <span class="of">',s={hash:{}},n=i.i18n,a=n?n.call(e,"of",s):g.call(e,"i18n","of",s),(a||0===a)&&(l+=a),l+='</span>\n        <span class="weekGoal"></span>\n    </span>\n</div>\n'}function o(e,t){var n,a="";return a+='\n<ul class="tabs">\n    ',n=i.each.call(e,e.graphTabs,{hash:{},inverse:p.noop,fn:p.program(3,l,t)}),(n||0===n)&&(a+=n),a+="\n</ul>\n"}function l(e,t){var n,a="";return a+='\n    <li data-series="',(n=i.series)?n=n.call(e,{hash:{}}):(n=e.series,n=typeof n===d?n.apply(e):n),a+=u(n)+'" title="',(n=i.text)?n=n.call(e,{hash:{}}):(n=e.text,n=typeof n===d?n.apply(e):n),a+=u(n)+'">',(n=i.text)?n=n.call(e,{hash:{}}):(n=e.text,n=typeof n===d?n.apply(e):n),a+=u(n)+"</li>\n    "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,h,c,d="function",u=this.escapeExpression,p=this,g=i.helperMissing;return c={hash:{},inverse:p.noop,fn:p.program(1,s,a)},r=i["i18n-namespace"],h=r?r.call(t,"com.fitbit.app.ngd.weekly",c):g.call(t,"i18n-namespace","com.fitbit.app.ngd.weekly",c),h||0===h?h:""});return e.registerPartial("galileo_tile_template_weeklyActivity",t),t}),define("hbs!galileo/tile/template/weeklyGoalTitle",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/goal/message","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n<div>\n    <div class="metricTitle">',s={hash:{}},n=i.i18n,a=n?n.call(e,"goal_duration_week",s):c.call(e,"i18n","goal_duration_week",s),(a||0===a)&&(o+=a),o+="</div>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h="",c=i.helperMissing,d=this;return r={hash:{},inverse:d.noop,fn:d.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.goal.message",r):c.call(t,"i18n-namespace","com.fitbit.app.goal.message",r),(l||0===l)&&(h+=l),h+="\n"});return e.registerPartial("galileo_tile_template_weeklyGoalTitle",t),t}),define("hbs!galileo/tile/template/weeklyGoal",["handlebars","galileo/tile/template/helpers/domPlaceholder"],function(e){var t=e.template(function(e,t,i,n,a){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var s,o,l="",r=i.helperMissing,h=this.escapeExpression;return l+="<div>\n    ",o={hash:{}},l+=h((s=i.domPlaceholder,s?s.call(t,"weekly",o):r.call(t,"domPlaceholder","weekly",o)))+"\n</div>\n"});return e.registerPartial("galileo_tile_template_weeklyGoal",t),t}),define("galileo/tile/weeklyActivity",["require","./classes/wide","hbs!./template/weeklyActivity","hbs!./template/chartLegend","galileo/model/user","i18n/i18n","galileo/model/goals","../color/graph","galileo/tile/element/goal/dailyWeeklyGoalSetting","hbs!galileo/tile/template/weeklyGoalTitle","hbs!galileo/tile/template/weeklyGoal","i18n-load!com/fitbit/app/ngd/weekly","i18n-load!com/fitbit/app/ngd/goal","i18n-load!com/fitbit/app/unit","i18n-load!com/fitbit/app/ngd/chart"],function(e){var t=e("./classes/wide"),i=e("hbs!./template/weeklyActivity"),n=e("hbs!./template/chartLegend"),a=e("galileo/model/user").viewer,s=e("i18n/i18n"),o=new s,l=e("galileo/model/goals"),r=e("../color/graph"),h=e("galileo/tile/element/goal/dailyWeeklyGoalSetting"),c=e("hbs!galileo/tile/template/weeklyGoalTitle"),d=e("hbs!galileo/tile/template/weeklyGoal"),u=[{"class":"cals_burned",name:o("legend_burned")},{"class":"cals_intake",name:o("legend_eaten")}],p={steps:o("steps"),distance:o("distance"),"calories-burned":o("calories"),floors:o("floors"),"active-minutes":o("active_minutes")},g=function(){return $("<div>")};o.namespace(e("i18n-load!com/fitbit/app/ngd/weekly")),o.namespace(e("i18n-load!com/fitbit/app/ngd/goal")),o.namespace(e("i18n-load!com/fitbit/app/unit")),o.namespace(e("i18n-load!com/fitbit/app/ngd/chart"));var f=o.plural("METRIC"===a.distanceUnit?"Kilometer":"Mile");return new Class({Extends:t,title:o("weekly_activity"),tileName:"weeklyActivity",logUrl:"/activities",savable:!0,options:{metricFormats:{steps:[{unitPlural:o.plural("step"),unitThreshold:1/0,format:"#,##0",editable:!0}],"calories-burned":[{unitPlural:o.plural("calorie"),unitThreshold:1/0,format:"#,##0",editable:!0}],floors:[{unitPlural:o.plural("floor"),unitThreshold:1/0,format:"#,##0",editable:!0}],distance:[{unitPlural:f,unitThreshold:1/0,format:"#,##0.00",editable:!0}],"active-minutes":[{unitPlural:o.plural("active_minute_reduced"),unitThreshold:1/0,format:"#,##0",editable:!0}]}},load:function(){var e=this,t=this.main.find(".content");this.style=this.options.style,this.metricFormats=this.options.metricFormats,t.append($(i({graphTabs:e.getGraphTabsObj()}))),t.find(".tabs > li").click(function(){var t=$(this).data("series");e.loadTab(t),a.saveSetting("weeklyActiveTab",t)}),this.subscriptionPromise=$.Deferred();var n=a.subscriptions.trainer;n.getPlan(function(t){e.metricFormats["calories-burned"][0].editable=!(n&&n.isActive()&&t),e.subscriptionPromise.resolve()}),this.subscriptionPromise.done(function(){e.loadSettings(),e.loadTab(a.getSettingsModel().get("weeklyActiveTab")||"steps")})},loadTab:function(t){var i=this.main.find(".content"),s=this.getDate();this.currentSeries=t,i.find(".tabs > li").each(function(){var e=$(this);e.removeClass("active"),e.data("series")===t&&e.addClass("active")});var o=function(e){var s=i.find(".goalContainer"),o=i.find(".legendContainer").hide().empty();if(this.currentSeries===t)if(e){var l=r.fn.progressClass(e.thisWeekTotal,e.weeklyGoal),h=e.thisWeekTotal/e.weeklyGoal*100;h>100&&(h=100),s.find(".percentage").removeClass(r.progressClasses.join(" ")).addClass(l).animate({width:h+"%"}),s.find(".weekTotal").empty().text(a.thousands(e.thisWeekTotal)),s.find(".weekGoal").empty().text("ko_KR"!==a.locale?a.thousands(e.weeklyGoal):a.thousands(e.weeklyGoal)+" "+this.metricFormats[t][0].unitPlural(1)),s.show()}else s.hide(),o.append(n({legendList:u})).show()}.bind(this);e(["galileo/tile/loadDependencies"],function(e){var n=this;this.showMainContents();var l=a.activities(),r=l.loadSummary.bind(l,t,s);Function.join(r,function(a){if(n.isDateEqual(s)&&i.find(".tabs > li.active").data("series")===t){var l=n.options.metricFormats[t],r={labels:{align:"left",x:20}};i.find(".chartContainer").empty().append(e.WeekBeta({series_name:t,width:i.outerWidth(!1),height:180,date:s,tooltipFormat:l,alternateLayout:!0,updateTileFooter:o,yAxis:r,marginLeft:0,marginRight:0})),"calories-burned"!==t&&o(a)}})}.bind(this))},getGraphTabsObj:function(){var e=this,t=[],i=a.getDeviceFeatures();return i.STEPS&&t.push(e.getSeriesTabObj("steps")),i.STEPS&&t.push(e.getSeriesTabObj("distance")),i.CALORIES&&t.push(e.getSeriesTabObj("calories-burned")),i.ELEVATION&&t.push(e.getSeriesTabObj("floors")),t},getSeriesTabObj:function(e){return{series:e,text:p[e]||""}},loadSettings:function(){var e,t=this.settings;this.settingsElement||(t.find(".settingsContainer").append($(c())),this.goalSettings={},e=this.getGraphTabsObj(),$.each(e,function(e,i){var n=i.series,a={type:n},s=this.metricFormats[a.type][0],o=this.goalSettings[n]=new h(n,s,d);t.find(".settingsContainer").append(g().addClass("weeklyMetricsBlock").addClass(a.type).append(o.render()))}.bind(this)),this.settings.find(".saveSettings").on("click",this.saveSettings.bind(this)))},saveSettings:function(){$.each(this.goalSettings,function(e,t){t.saveSettings(t.tileType,this.getDate()).done(function(e,t,i){this.trigger("saveSettings",e,t,i)}.bind(this))}.bind(this))},updateGoals:function(e,t,i){return l.update(e,t,i),this}})}),define("galileo/tile/classes/tall",["require","mootools","jquery","galileo/prototype/all","./base","galileo/ajax/ajax","hbs!../template/mainContents"],function(e){e("mootools"),e("jquery"),e("galileo/prototype/all");var t=e("./base");e("galileo/ajax/ajax");return new Class({Extends:t,shape:"tall",options:{tileClass:"tall"},initialize:function(e){if(this.parent(e),!this.title||!this.tileName||!this.load)throw"missing required option in tall tile builder";this.renderMainContents(),this.showLoading()},renderMainContents:function(){this.mainContents&&(this.mainContents=void this.mainContents.remove());var t=e("hbs!../template/mainContents");return this.mainContents=$(t({title:this.title,controlsList:this.getControlsList(),savable:this.savable})),this.main=this.mainContents.closest(".main"),this.settings=this.mainContents.closest(".settings"),this.initializeSettings(),this}})}),function(e){"function"==typeof define&&define.amd?define("backbone.deep-model",["underscore","backbone"],e):e(_,Backbone)}(function(t,i){function n(e){var i={},a=l.keyPathSeparator;for(var s in e){var o=e[s];if(o&&o.constructor===Object&&!t.isEmpty(o)){var r=n(o);for(var h in r){var c=r[h];i[s+a+h]=c}}else i[s]=o}return i}function a(e,n,a){for(var s=l.keyPathSeparator,o=n.split(s),r=e,h=0,c=o.length;c>h;h++){if(a&&!t.has(r,o[h]))return!1;if(r=r instanceof i.Model?r.get(o[h]):r instanceof i.Collection?r.at(o[h]):r[o[h]],null==r&&c-1>h&&(r={}),"undefined"==typeof r)return a?!0:r}return a?!0:r}function s(e,n,a,s){s=s||{};for(var o=l.keyPathSeparator,r=n.split(o),h=e,c=0,d=r.length;d>c&&void 0!==h;c++){var u=r[c];c===d-1?h instanceof i.Model?s.unset?h.unset(filed,s):h.set(u,a,s):s.unset?delete h[u]:h[u]=a:("undefined"!=typeof h[u]&&t.isObject(h[u])||(h[u]={}),h=h instanceof i.Model?h.get(u):h instanceof i.Collection?h.at(u):h[u])}}function o(e,i,n){s(e,i,null,t.extend(n||{},{unset:!0}))}(function(){var e,n,a,s,o,l,r=[].slice;a=function(e){var n,s;return!t.isObject(e)||t.isFunction(e)?e:e instanceof i.Collection||e instanceof i.Model?e:t.isDate(e)?new Date(e.getTime()):t.isRegExp(e)?new RegExp(e.source,e.toString().replace(/.*\//,"")):(s=t.isArray(e||t.isArguments(e)),n=function(e,t,i){return s?e.push(a(t)):e[i]=a(t),e},t.reduce(e,n,s?[]:{}))},l=function(e){return null==e?!1:!(e.prototype!=={}.prototype&&e.prototype!==Object.prototype||!t.isObject(e)||t.isArray(e)||t.isFunction(e)||t.isDate(e)||t.isRegExp(e)||t.isArguments(e))},n=function(e){return t.filter(t.keys(e),function(t){return l(e[t])})},e=function(e){return t.filter(t.keys(e),function(i){return t.isArray(e[i])})},o=function(i,a,s){var l,r,h,c,d,u,p,g,f,m;if(null==s&&(s=20),0>=s)return console.warn("_.deepExtend(): Maximum depth of recursion hit."),t.extend(i,a);for(u=t.intersection(n(i),n(a)),r=function(e){return a[e]=o(i[e],a[e],s-1)},p=0,f=u.length;f>p;p++)d=u[p],r(d);for(c=t.intersection(e(i),e(a)),l=function(e){return a[e]=t.union(i[e],a[e])},g=0,m=c.length;m>g;g++)h=c[g],l(h);return t.extend(i,a)},s=function(){var e,i,n,s;if(n=2<=arguments.length?r.call(arguments,0,s=arguments.length-1):(s=0,[]),i=arguments[s++],t.isNumber(i)||(n.push(i),i=20),n.length<=1)return n[0];if(0>=i)return t.extend.apply(this,n);for(e=n.shift();n.length>0;)e=o(e,a(n.shift()),i);return e},t.mixin({deepClone:a,isBasicObject:l,basicObjects:n,arrays:e,deepExtend:s})}).call(this);var l=i.Model.extend({constructor:function(e,i){var n,a=e||{};this.cid=t.uniqueId("c"),this.attributes={},i&&i.collection&&(this.collection=i.collection),i&&i.parse&&(a=this.parse(a,i)||{}),(n=t.result(this,"defaults"))&&(a=t.deepExtend({},n,a)),this.set(a,i),this.changed={},this.initialize.apply(this,arguments)},toJSON:function(e){return t.deepClone(this.attributes)},get:function(e){return a(this.attributes,e)},set:function(e,i,r){var h,c,d,u,p,g,f,m;if(null==e)return this;if("object"==typeof e?(c=e,r=i||{}):(c={})[e]=i,r||(r={}),!this._validate(c,r))return!1;d=r.unset,p=r.silent,u=[],g=this._changing,this._changing=!0,g||(this._previousAttributes=t.deepClone(this.attributes),this.changed={}),m=this.attributes,f=this._previousAttributes,this.idAttribute in c&&(this.id=c[this.idAttribute]),c=n(c);for(h in c)i=c[h],t.isEqual(a(m,h),i)||u.push(h),t.isEqual(a(f,h),i)?o(this.changed,h):s(this.changed,h,i,r),d?o(m,h):s(m,h,i,r);if(!p){u.length&&(this._pending=!0);for(var v=l.keyPathSeparator,y={},b=0,w=u.length;w>b;b++){var e=u[b];y.hasOwnProperty(e)&&y[e]||(y[e]=!0,this.trigger("change:"+e,this,a(m,e),r));for(var _=e.split(v),x=_.length-1;x>0;x--){var T=t.first(_,x).join(v),k=T+v+"*";y.hasOwnProperty(k)&&y[k]||(y[k]=!0,this.trigger("change:"+k,this,a(m,T),r)),y.hasOwnProperty(T)&&y[T]||(y[T]=!0,this.trigger("change:"+T,this,a(m,T),r))}}}if(g)return this;if(!p)for(;this._pending;)this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},clear:function(e){var i={},a=n(this.attributes);for(var s in a)i[s]=void 0;return this.set(i,t.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!t.isEmpty(this.changed):void 0!==a(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n(this.changed):!1;var i=this._changing?this._previousAttributes:this.attributes;e=n(e),i=n(i);var a,s=!1;for(var o in e)t.isEqual(i[o],a=e[o])||((s||(s={}))[o]=a);return s},previous:function(e){return null!=e&&this._previousAttributes?a(this._previousAttributes,e):null},previousAttributes:function(){return t.deepClone(this._previousAttributes)}});return l.keyPathSeparator=".",i.DeepModel=l,"undefined"!=typeof e&&(e.exports=l),i}),define("backbone+",["backbone","backbone.deep-model"],function(e){return e}),define("modules/i18n",[],function(){function e(){function e(i,n){if(void 0===i)return t;if(i instanceof Array){for(var a={},s=i.length;s--;)a[i[s]]=t[i[s]];return a}if("string"==typeof i){if(void 0===n)return t[i];t[i]=n}else for(var o in i)t[o]=i[o];return e}var t={};return e.apply(this,arguments),e}function t(t){var n=i;if(t)for(var a,s=t.split(/[/.]+/),o=0,l=s.length;l>o;o++)a=s[o],a in n||(n[a]=new e),n=n[a];return arguments.length>1?n.apply(n,Array.prototype.slice.call(arguments,1)):n}var i=new e;return t}),define("mods/exercise/scripts/models/base",["require","backbone+","modules/i18n"],function(e){var t=e("backbone+"),i=e("modules/i18n")(),n=t.DeepModel.extend({getFormatted:function(e,t){var i=this.get(e);return n.format(i,t||n.strip(e))}});return n.format=function(e,t){var a=e;switch(t){case"duration":a=n.formatDuration(e);break;case"distance":a=n.truncate(e,2);break;case"speed":a=e&&e.toFixed(1);break;case"integer":case"steps":case"elevation":case"elevationGain":a=Math.floor(e);break;case"calories":a=Math.floor(10*e)/10;break;case"pace":case"averageSplitPace":case"slowestSplitPace":case"fastestSplitPace":a=n.formatPace(e);break;case"latitude":case"longitude":a=e.toFixed(6).replace(/(\.\d+?)0+$/,"$1");break;case"heart-rate-zone":a=["",i("com.fitbit.app.activities.exercise.label.out_of_zone"),i("com.fitbit.app.activities.exercise.label.fat_burn"),i("com.fitbit.app.activities.exercise.label.cardio"),i("com.fitbit.app.activities.exercise.label.peak")][e]}switch(t){case"thousands":case"lap":case"distance":case"steps":case"calories":case"elevation":case"elevationGain":a=a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}return a},n.formatDuration=function(e){var t,i,n,a;return a=e/1e3,t=a/3600>>0,a%=3600,i=a/60>>0,a%=60,n=a>>0,[t,("0"+i).slice(-2),("0"+n).slice(-2)].join(":").replace(/^[0:]+(?=.*\d:\d\d$)/,"")},n.formatPace=function(e){var t,i,n;return n=e,t=n/60>>0,n%=60,i=n>>0,t+"'"+("0"+i).slice(-2)+'"'},n.strip=function(e){return e.slice(e.lastIndexOf(".")+1)},n.truncate=function(e,t){var i=Math.pow(10,t||0);return(Math.floor(e*i)/i).toFixed(t||0)},n}),define("mods/exercise/scripts/models/summary",["require","./base"],function(e){var t=e("./base");return t.extend({urlRoot:"/exercise/summary",defaults:{title:"Untitled",activity:"Run",weather:"",source:"N/A",date:"2013-01-01T00:00:00.000Z",duration:0,distance:0,steps:0,floors:0,calories:0,elevationGain:0,averageSplitPace:0,slowestSplitPace:0,fastestSplitPace:0,mapUrl:null}})}),define("mods/exercise/scripts/collections/exercise-summaries",["require","backbone","../models/summary"],function(e){var t=e("backbone"),i=e("../models/summary");return t.Collection.extend({model:i,url:"/exercise/summary",comparator:function(e){return-new Date(e.get("date"))}})}),define("galileo/graph/exercisePreview",["require","./base","i18n/i18n","i18n-load!com/fitbit/app/unit"],function(e){function t(e){var t,n=e.container,o=e.dataPoints,d=e.seriesName,u=e.lineColor,g=e.fillColor,f=e.image;return t=i(n,a,s,$.extend(!0,{series:[{name:d,data:o,states:{hover:{enabled:!1}}}],plotOptions:{area:{color:u,fillColor:g,marker:{enabled:!1}}}},p)),t.renderer.image(f,l,r,h,c).add(),n}var i=e("./base"),n=e("i18n/i18n")(),a=122,s=84;n.namespace(e("i18n-load!com/fitbit/app/unit"));var o="rgba(255, 255, 255, 0.1)",l=6,r=6,h=20,c=20,d=5,u={lineWidth:0,minorGridLineWidth:0,lineColor:o,gridLineColor:o,minorGridLineColor:o,labels:{enabled:!1},minorTickLength:0,tickLength:0},p={chart:{marginLeft:0,marginRight:0,spacingTop:c+d+r,spacingBottom:0,type:"area",backgroundColor:o},xAxis:u,yAxis:u,tooltip:{enabled:!1}};return function(e){return t(e)}}),define("hbs!galileo/tile/template/exerciseActivityGPS",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/exercise","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,c="";return c+='\n<li class="activity sub-tile">\n    <a class="details-link" href="/activities/exercise/',(n=i.id)?n=n.call(e,{hash:{}}):(n=e.id,n=typeof n===f?n.apply(e):n),c+=m(n)+'">\n        <header>\n            <h3 class="name ',n=i["if"].call(e,e.isFitStar,{hash:{},inverse:y.noop,fn:y.program(2,o,t)}),(n||0===n)&&(c+=n),c+=" ",n=i["if"].call(e,e.isFitStarYoga,{hash:{},inverse:y.noop,fn:y.program(4,l,t)}),(n||0===n)&&(c+=n),c+='">',(n=i.name)?n=n.call(e,{hash:{}}):(n=e.name,n=typeof n===f?n.apply(e):n),c+=m(n)+'</h3>\n        </header>\n\n        <div class="info">\n            <ul class="summary">\n                <li><time class="date" datetime="',(n=i.datetime)?n=n.call(e,{hash:{}}):(n=e.datetime,n=typeof n===f?n.apply(e):n),c+=m(n)+'">',(n=i.date)?n=n.call(e,{hash:{}}):(n=e.date,n=typeof n===f?n.apply(e):n),c+=m(n)+'</time></li>\n                <li><b class="distance">',(n=i.distance)?n=n.call(e,{hash:{}}):(n=e.distance,n=typeof n===f?n.apply(e):n),c+=m(n)+"</b> ",(n=i.distanceUnitLabel)?n=n.call(e,{hash:{}}):(n=e.distanceUnitLabel,n=typeof n===f?n.apply(e):n),c+=m(n)+'</li>\n                <li><b class="calories">',(n=i.calories)?n=n.call(e,{hash:{}}):(n=e.calories,n=typeof n===f?n.apply(e):n),c+=m(n)+"</b> ",(n=i.caloriesLabel)?n=n.call(e,{hash:{}}):(n=e.caloriesLabel,n=typeof n===f?n.apply(e):n),c+=m(n)+"</li>\n                ",n=i["if"].call(e,e.hasPace,{hash:{},inverse:y.program(8,h,t),fn:y.program(6,r,t)}),(n||0===n)&&(c+=n),c+='\n            </ul>\n\n            <img class="map" width="122" height="84" alt="',s={hash:{}},n=i.i18n,a=n?n.call(e,"map",s):v.call(e,"i18n","map",s),(a||0===a)&&(c+=a),c+=": ",(a=i.name)?a=a.call(e,{hash:{}}):(a=e.name,a=typeof a===f?a.apply(e):a),c+=m(a)+'" src="',(a=i.map)?a=a.call(e,{hash:{}}):(a=e.map,a=typeof a===f?a.apply(e):a),c+=m(a)+'">\n        </div>\n    </a>\n</li>\n'}function o(e,t){return"fitstar"}function l(e,t){return"fitstar-yoga"}function r(e,t){var n,a,s,o="";return o+='\n                    <li><b class="pace">',(n=i.pace)?n=n.call(e,{hash:{}}):(n=e.pace,n=typeof n===f?n.apply(e):n),o+=m(n)+"</b> ",s={hash:{}},n=i.i18n,a=n?n.call(e,"pace",s):v.call(e,"i18n","pace",s),(a||0===a)&&(o+=a),o+="</li>\n                "}function h(e,t){var n,a="";return a+="\n                    ",n=i["if"].call(e,e.hasSpeed,{hash:{},inverse:y.noop,fn:y.program(9,c,t)}),(n||0===n)&&(a+=n),a+="\n                "}function c(e,t){var n,a="";return a+='\n                        <li><b class="speed">',(n=i.speed)?n=n.call(e,{hash:{}}):(n=e.speed,n=typeof n===f?n.apply(e):n),a+=m(n)+"</b> ",(n=i.speedUnitLabel)?n=n.call(e,{hash:{}}):(n=e.speedUnitLabel,n=typeof n===f?n.apply(e):n),a+=m(n)+"</li>\n                    "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var d,u,p,g="",f="function",m=this.escapeExpression,v=i.helperMissing,y=this;return p={hash:{},inverse:y.noop,fn:y.program(1,s,a)},d=i["i18n-namespace"],u=d?d.call(t,"com.fitbit.app.ngd.exercise",p):v.call(t,"i18n-namespace","com.fitbit.app.ngd.exercise",p),(u||0===u)&&(g+=u),g+="\n"});return e.registerPartial("galileo_tile_template_exerciseActivityGPS",t),t}),define("hbs!galileo/tile/template/exerciseActivityLoading",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<li class="activity sub-tile">\n    <a class="loading"></a>\n</li>\n'});return e.registerPartial("galileo_tile_template_exerciseActivityLoading",t),t}),define("hbs!galileo/tile/template/exerciseActivityHeartRate",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/exercise","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,r="";return r+='\n<li class="activity sub-tile">\n    <a class="details-link" href="/activities/exercise/',(n=i.id)?n=n.call(e,{hash:{}}):(n=e.id,n=typeof n===u?n.apply(e):n),r+=p(n)+'">\n        <header>\n            <h3 class="name ',n=i["if"].call(e,e.isFitStar,{hash:{},inverse:g.noop,fn:g.program(2,o,t)}),(n||0===n)&&(r+=n),r+=" ",n=i["if"].call(e,e.isFitStarYoga,{hash:{},inverse:g.noop,fn:g.program(4,l,t)}),(n||0===n)&&(r+=n),r+='">',(n=i.name)?n=n.call(e,{hash:{}}):(n=e.name,n=typeof n===u?n.apply(e):n),r+=p(n)+'</h3>\n        </header>\n\n        <div class="info">\n            <ul class="summary">\n                <li><time class="date" datetime="',(n=i.datetime)?n=n.call(e,{hash:{}}):(n=e.datetime,n=typeof n===u?n.apply(e):n),r+=p(n)+'">',(n=i.date)?n=n.call(e,{hash:{}}):(n=e.date,n=typeof n===u?n.apply(e):n),r+=p(n)+'</time></li>\n                <li><b class="duration">',(n=i.durationMinutes)?n=n.call(e,{hash:{}}):(n=e.durationMinutes,n=typeof n===u?n.apply(e):n),r+=p(n)+"</b> ",(n=i.durationMinutesLabel)?n=n.call(e,{hash:{}}):(n=e.durationMinutesLabel,n=typeof n===u?n.apply(e):n),r+=p(n)+'</li>\n                <li><b class="calories">',(n=i.calories)?n=n.call(e,{hash:{}}):(n=e.calories,n=typeof n===u?n.apply(e):n),r+=p(n)+"</b> ",(n=i.caloriesLabel)?n=n.call(e,{hash:{}}):(n=e.caloriesLabel,n=typeof n===u?n.apply(e):n),r+=p(n)+'</li>\n                <li><b class="averageHeartRate">',(n=i.averageHeartRate)?n=n.call(e,{hash:{}}):(n=e.averageHeartRate,n=typeof n===u?n.apply(e):n),r+=p(n)+"</b> ",s={hash:{}},n=i.i18n,a=n?n.call(e,"average_heart_rate",s):f.call(e,"i18n","average_heart_rate",s),(a||0===a)&&(r+=a),r+='</li>\n            </ul>\n\n            <div class="chartContainer">\n                <div class="chart"></div>\n            </div>\n        </div>\n    </a>\n</li>\n'}function o(e,t){return"fitstar"}function l(e,t){return"fitstar-yoga";
}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,h,c,d="",u="function",p=this.escapeExpression,g=this,f=i.helperMissing;return c={hash:{},inverse:g.noop,fn:g.program(1,s,a)},r=i["i18n-namespace"],h=r?r.call(t,"com.fitbit.app.ngd.exercise",c):f.call(t,"i18n-namespace","com.fitbit.app.ngd.exercise",c),(h||0===h)&&(d+=h),d+="\n"});return e.registerPartial("galileo_tile_template_exerciseActivityHeartRate",t),t}),define("hbs!galileo/tile/template/exerciseActivityHeartRateAndGPS",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/exercise","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,c="";return c+='\n<li class="activity sub-tile">\n    <a class="details-link" href="/activities/exercise/',(n=i.id)?n=n.call(e,{hash:{}}):(n=e.id,n=typeof n===f?n.apply(e):n),c+=m(n)+'">\n        <header>\n            <h3 class="name ',n=i["if"].call(e,e.isFitStar,{hash:{},inverse:y.noop,fn:y.program(2,o,t)}),(n||0===n)&&(c+=n),c+=" ",n=i["if"].call(e,e.isFitStarYoga,{hash:{},inverse:y.noop,fn:y.program(4,l,t)}),(n||0===n)&&(c+=n),c+='">',(n=i.name)?n=n.call(e,{hash:{}}):(n=e.name,n=typeof n===f?n.apply(e):n),c+=m(n)+'</h3>\n        </header>\n\n        <div class="info">\n            <ul class="summary">\n                <li><time class="date" datetime="',(n=i.datetime)?n=n.call(e,{hash:{}}):(n=e.datetime,n=typeof n===f?n.apply(e):n),c+=m(n)+'">',(n=i.date)?n=n.call(e,{hash:{}}):(n=e.date,n=typeof n===f?n.apply(e):n),c+=m(n)+'</time></li>\n                <li><b class="distance">',(n=i.distance)?n=n.call(e,{hash:{}}):(n=e.distance,n=typeof n===f?n.apply(e):n),c+=m(n)+"</b> ",(n=i.distanceUnitLabel)?n=n.call(e,{hash:{}}):(n=e.distanceUnitLabel,n=typeof n===f?n.apply(e):n),c+=m(n)+"</li>\n                ",n=i["if"].call(e,e.hasPace,{hash:{},inverse:y.program(8,h,t),fn:y.program(6,r,t)}),(n||0===n)&&(c+=n),c+='\n                <li><b class="averageHeartRate">',(n=i.averageHeartRate)?n=n.call(e,{hash:{}}):(n=e.averageHeartRate,n=typeof n===f?n.apply(e):n),c+=m(n)+"</b> ",s={hash:{}},n=i.i18n,a=n?n.call(e,"average_heart_rate",s):v.call(e,"i18n","average_heart_rate",s),(a||0===a)&&(c+=a),c+='</li>\n            </ul>\n\n            <img class="map" width="122" height="84" alt="',s={hash:{}},n=i.i18n,a=n?n.call(e,"map",s):v.call(e,"i18n","map",s),(a||0===a)&&(c+=a),c+=": ",(a=i.name)?a=a.call(e,{hash:{}}):(a=e.name,a=typeof a===f?a.apply(e):a),c+=m(a)+'" src="',(a=i.map)?a=a.call(e,{hash:{}}):(a=e.map,a=typeof a===f?a.apply(e):a),c+=m(a)+'">\n        </div>\n    </a>\n</li>\n'}function o(e,t){return"fitstar"}function l(e,t){return"fitstar-yoga"}function r(e,t){var n,a,s,o="";return o+='\n                    <li><b class="pace">',(n=i.pace)?n=n.call(e,{hash:{}}):(n=e.pace,n=typeof n===f?n.apply(e):n),o+=m(n)+"</b> ",s={hash:{}},n=i.i18n,a=n?n.call(e,"pace",s):v.call(e,"i18n","pace",s),(a||0===a)&&(o+=a),o+="</li>\n                "}function h(e,t){var n,a="";return a+="\n                    ",n=i["if"].call(e,e.hasSpeed,{hash:{},inverse:y.noop,fn:y.program(9,c,t)}),(n||0===n)&&(a+=n),a+="\n                "}function c(e,t){var n,a="";return a+='\n                        <li><b class="speed">',(n=i.speed)?n=n.call(e,{hash:{}}):(n=e.speed,n=typeof n===f?n.apply(e):n),a+=m(n)+"</b> ",(n=i.speedUnitLabel)?n=n.call(e,{hash:{}}):(n=e.speedUnitLabel,n=typeof n===f?n.apply(e):n),a+=m(n)+"</li>\n                    "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var d,u,p,g="",f="function",m=this.escapeExpression,v=i.helperMissing,y=this;return p={hash:{},inverse:y.noop,fn:y.program(1,s,a)},d=i["i18n-namespace"],u=d?d.call(t,"com.fitbit.app.ngd.exercise",p):v.call(t,"i18n-namespace","com.fitbit.app.ngd.exercise",p),(u||0===u)&&(g+=u),g+="\n"});return e.registerPartial("galileo_tile_template_exerciseActivityHeartRateAndGPS",t),t}),define("hbs!galileo/tile/template/exerciseActivitySimple",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){return"fitstar"}function o(e,t){return"fitstar-yoga"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var l,r="",h="function",c=this.escapeExpression,d=this;return r+='<li class="activity sub-tile">\n    <a class="details-link" href="/activities/exercise/',(l=i.id)?l=l.call(t,{hash:{}}):(l=t.id,l=typeof l===h?l.apply(t):l),r+=c(l)+'">\n        <header>\n            <h3 class="name ',l=i["if"].call(t,t.isFitStar,{hash:{},inverse:d.noop,fn:d.program(1,s,a)}),(l||0===l)&&(r+=l),r+=" ",l=i["if"].call(t,t.isFitStarYoga,{hash:{},inverse:d.noop,fn:d.program(3,o,a)}),(l||0===l)&&(r+=l),r+='">',(l=i.name)?l=l.call(t,{hash:{}}):(l=t.name,l=typeof l===h?l.apply(t):l),r+=c(l)+'</h3>\n        </header>\n\n        <div class="info">\n            <ul class="summary">\n                <li><time class="date" datetime="',(l=i.datetime)?l=l.call(t,{hash:{}}):(l=t.datetime,l=typeof l===h?l.apply(t):l),r+=c(l)+'">',(l=i.date)?l=l.call(t,{hash:{}}):(l=t.date,l=typeof l===h?l.apply(t):l),r+=c(l)+'</time></li>\n                <li><b class="duration">',(l=i.durationMinutes)?l=l.call(t,{hash:{}}):(l=t.durationMinutes,l=typeof l===h?l.apply(t):l),r+=c(l)+"</b> ",(l=i.durationMinutesLabel)?l=l.call(t,{hash:{}}):(l=t.durationMinutesLabel,l=typeof l===h?l.apply(t):l),r+=c(l)+'</li>\n                <li><b class="calories">',(l=i.calories)?l=l.call(t,{hash:{}}):(l=t.calories,l=typeof l===h?l.apply(t):l),r+=c(l)+"</b> ",(l=i.caloriesLabel)?l=l.call(t,{hash:{}}):(l=t.caloriesLabel,l=typeof l===h?l.apply(t):l),r+=c(l)+'</li>\n            </ul>\n\n            <div class="chartContainer">\n                <div class="chart"></div>\n            </div>\n        </div>\n    </a>\n</li>\n'});return e.registerPartial("galileo_tile_template_exerciseActivitySimple",t),t}),define("galileo/tile/exerciseActivity",["require","underscore","backbone","i18n/i18n","galileo/model/user","galileo/graph/exercisePreview","galileo/color/graph","hbs!./template/exerciseActivityGPS","hbs!./template/exerciseActivityLoading","hbs!./template/exerciseActivityHeartRate","hbs!./template/exerciseActivityHeartRateAndGPS","hbs!./template/exerciseActivitySimple","galileo/util/dateUtil","i18n-load!com/fitbit/app/unit","i18n-load!com/fitbit/app/ngd/exercise"],function(e){var t=e("underscore"),i=e("backbone"),n=e("i18n/i18n")(),a=e("galileo/model/user").viewer,s=e("galileo/graph/exercisePreview"),o=e("galileo/color/graph"),l=e("hbs!./template/exerciseActivityGPS"),r=e("hbs!./template/exerciseActivityLoading"),h=e("hbs!./template/exerciseActivityHeartRate"),c=e("hbs!./template/exerciseActivityHeartRateAndGPS"),d=e("hbs!./template/exerciseActivitySimple"),u=e("galileo/util/dateUtil"),p="/images/dashboard/galileo/activity_hr.png",g="/images/dashboard/galileo/activity_cals.png";return n.namespace(e("i18n-load!com/fitbit/app/unit")),n.namespace(e("i18n-load!com/fitbit/app/ngd/exercise")),i.View.extend({initialize:function(){this.setElement(r({})),this.model.bind("change",this.render,this)},render:function(){var e,i,r,f,m,v,y,b,w,_;return this.model.get("name")?(_=this.model.get("exerciseFeatures")||[],e=!!this.model.get("mapUrl"),i=!!(this.model.get("heartRateDataPoints")&&this.model.get("heartRateDataPoints").length>1),r=!!(this.model.get("caloriesDataPoints")&&this.model.get("caloriesDataPoints").length>1),m=Math.round(this.model.get("duration")/6e4),v=a.formatNumber(this.model.get("calories"),"#,###"),y=a.formatNumber(this.model.get("elevationGain"),"#,###"),b="FITSTAR"===this.model.get("logType")||"FITSTAR_YOGA"===this.model.get("logType"),w="FITSTAR_YOGA"===this.model.get("logType"),f={id:this.model.id,name:this.model.get("name"),distance:a.formatNumber(this.model.get("distance"),"#,##0.00"),calories:v,caloriesLabel:n.plural("calorie_reduced")(v),elevationGain:y,isFitStar:b,isFitStarYoga:w,elevationGainUnitLabel:"US"===a.heightSystem?n.plural("foot_reduced")(y):n.plural("m_reduced")(y),pace:this.model.getFormatted("averageSplitPace"),speed:this.model.getFormatted("speed"),speedUnitLabel:n("US"===a.heightSystem?"miles_per_hour":"kilometers_per_hour"),hasPace:t.contains(_,"PACE"),hasSpeed:t.contains(_,"SPEED"),duration:this.model.get("duration"),durationMinutes:a.formatNumber(m,"#,##0.#"),durationMinutesLabel:n.plural("minute_full")(m),date:u.localeFormat(new Date(this.model.get("date")),"MMM dd"),datetime:this.model.get("dateISO"),distanceUnitLabel:n("US"===a.heightSystem?"plural_miles_label":"plural_km_label"),map:this.model.get("mapUrl"),averageHeartRate:this.model.get("averageHeartRate")||"--"},e&&!i?this.$el.empty().append($(l(f)).children()):e&&i?this.$el.empty().append($(c(f)).children()):!e&&i?(this.$el.empty().append($(h(f)).children()),s({container:this.$el.find(".chart"),dataPoints:this.model.get("heartRateDataPoints").map(function(e){return{x:u.ajaxDecode(e.dateTime),y:Number(e.bpm)}}),seriesName:"heart-rate",lineColor:o.hrLine,fillColor:o.hrFill,image:p})):r?(this.$el.empty().append($(d(f)).children()),s({container:this.$el.find(".chart"),dataPoints:this.model.get("caloriesDataPoints").map(function(e){return{x:u.ajaxDecode(e.dateTime),y:Number(e.value)}}),seriesName:"calories-burned",lineColor:o.calsLine,fillColor:o.calsFill,image:g})):this.$el.empty().append($(d(f)).children()),this):this}})}),define("hbs!galileo/tile/template/exerciseTile",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/exercise","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a="";return a+='\n<div class="exercise-content">\n',n=i["if"].call(e,e.hasNoActivities,{hash:{},inverse:f.program(4,l,t),fn:f.program(2,o,t)}),(n||0===n)&&(a+=n),a+="\n\n",n=i["if"].call(e,e.hasOnlyOneActivity,{hash:{},inverse:f.noop,fn:f.program(6,r,t)}),(n||0===n)&&(a+=n),a+="\n\n",n=i["if"].call(e,e.hasOnlyTwoActivities,{hash:{},inverse:f.noop,fn:f.program(8,h,t)}),(n||0===n)&&(a+=n),a+="\n</div>\n"}function o(e,t){var n,a,s,o="";return o+='\n    <div class="sub-tile status size3 empty-state">\n        <div class="cont-circle">\n            <i class="fitglyph fitglyph-exercise size-a"></i>\n        </div>\n        <p class="headline">\n            <strong>',s={hash:{}},n=i.i18n,a=n?n.call(e,"no_recent",s):g.call(e,"i18n","no_recent",s),(a||0===a)&&(o+=a),o+='</strong>\n        </p>\n        <p class="message">\n            ',s={hash:{}},n=i.i18n,a=n?n.call(e,"log_exercises",s):g.call(e,"i18n","log_exercises",s),(a||0===a)&&(o+=a),o+="\n        </p>\n    </div>\n"}function l(e,t){return'\n    <ul class="activities">\n    </ul>\n'}function r(e,t){var n,a,s,o="";return o+='\n    <div class="sub-tile status size2">\n        <div class="cont-circle">\n            <i class="fitglyph fitglyph-exercise size-a"></i>\n        </div>\n        <p class="headline">\n            <span>',s={hash:{}},n=i.i18n,a=n?n.call(e,"you_vs_couch",s):g.call(e,"i18n","you_vs_couch",s),(a||0===a)&&(o+=a),o+='</span>\n        </p>\n        <p class="message">\n            ',s={hash:{}},n=i.i18n,a=n?n.call(e,"exercise_is_great",s):g.call(e,"i18n","exercise_is_great",s),(a||0===a)&&(o+=a),o+="\n        </p>\n    </div>\n"}function h(e,t){var n,a,s,o="";return o+='\n    <div class="sub-tile status">\n        <p class="headline">\n            <strong>',s={hash:{}},n=i.i18n,a=n?n.call(e,"congrats",s):g.call(e,"i18n","congrats",s),(a||0===a)&&(o+=a),o+=" ",s={hash:{}},n=i.i18n,a=n?n.call(e,"getting_out_there",s):g.call(e,"i18n","getting_out_there",s),(a||0===a)&&(o+=a),o+='</strong>\n        </p>\n        <p class="message">\n            ',s={hash:{}},n=i.i18n,a=n?n.call(e,"increasing_exercise",s):g.call(e,"i18n","increasing_exercise",s),(a||0===a)&&(o+=a),o+="\n        </p>\n    </div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var c,d,u,p="",g=i.helperMissing,f=this;return u={hash:{},inverse:f.noop,fn:f.program(1,s,a)},c=i["i18n-namespace"],d=c?c.call(t,"com.fitbit.app.ngd.exercise",u):g.call(t,"i18n-namespace","com.fitbit.app.ngd.exercise",u),(d||0===d)&&(p+=d),p+="\n"});return e.registerPartial("galileo_tile_template_exerciseTile",t),t}),define("galileo/tile/exerciseTile",["require","backbone","mods/exercise/scripts/models/summary","mods/exercise/scripts/collections/exercise-summaries","./exerciseActivity","i18n/i18n","hbs!./template/exerciseTile","i18n-load!com/fitbit/app/ngd/exercise"],function(e){var t=e("backbone"),i=e("mods/exercise/scripts/models/summary"),n=e("mods/exercise/scripts/collections/exercise-summaries"),a=e("./exerciseActivity"),s=e("i18n/i18n")(),o=e("hbs!./template/exerciseTile");return s.namespace(e("i18n-load!com/fitbit/app/ngd/exercise")),t.View.extend({initialize:function(){this.activities=new n,this.views={},this.listenTo(this.activities,"add remove reset sort sync",this.render),this.activities.bind("change:date",function(){this.activities.sort()},this)},loadActivities:function(e){return this.activities.reset(e.map(function(e){return new i({id:e},{parse:!1})})),this.activities.each(function(e){e.fetch()}),this},render:function(){var e,t,i,n={},s=this.activities,l=s.length;return $.each(this.views,function(e,t){s.get(e)?(n[e]=t,t.$el.detach()):t.remove()}),this.views=n,e={hasNoActivities:0===l,hasOnlyOneActivity:1===l,hasOnlyTwoActivities:2===l},t=$(o(e)),i=t.find(".activities"),s.each(function(e){var t=n[e.id];t||(t=new a({model:e}),n[e.id]=t),i.append(t.$el)}),this.$el.empty().append(t),this}})}),define("galileo/tile/exercise",["require","./classes/tall","./exerciseTile","i18n/i18n","galileo/util/dateUtil","galileo/ajax/ajax","i18n-load!com/fitbit/app/ngd/tile","i18n-load!com/fitbit/app/ngd/exercise"],function(e){var t=e("./classes/tall"),i=e("./exerciseTile"),n=e("i18n/i18n")(),a=e("galileo/util/dateUtil"),s=e("galileo/ajax/ajax");return n.namespace(e("i18n-load!com/fitbit/app/ngd/tile")),n.namespace(e("i18n-load!com/fitbit/app/ngd/exercise")),new Class({Extends:t,options:{controlsList:[{name:n("Settings"),"class":"settingsButton leftSide showSettings",glyphName:"show-settings"},{name:n("See_More"),"class":"more largeRight",href:"/activities",glyphName:"arrow-right"}]},savable:!1,tileName:"exercise",title:n("exercise_title"),load:function(){var e=this,t=this.main.find(".content");this.exerciseTile||(this.exerciseTile=new i,t.append(this.exerciseTile.$el)),s.get("getLatestExercise","user",{date:a.ajaxEncode(this.getDate())},function(t){e.exerciseTile.activities.once("reset",function(){e.showMainContents()}),e.exerciseTile.loadActivities(t.exerciseIDs)})},setDate:function(e){return this.parent(e),this.showLoading(),this.load(),this.trigger("dateChange"),this}})}),define("galileo/tile/activeMinutes",["require","./classes/smallBasic","i18n/i18n","i18n-load!com/fitbit/app/ngd/activeminutes","i18n-load!com/fitbit/app/unit"],function(e){var t=e("./classes/smallBasic"),i=e("i18n/i18n")();i.namespace(e("i18n-load!com/fitbit/app/ngd/activeminutes")),i.namespace(e("i18n-load!com/fitbit/app/unit"));var n=[{unitPlural:i.plural("active_minute_reduced"),unitThreshold:1/0,format:"#,##0"}];return new Class({Extends:t,title:i("activeminutes"),tileName:"activeMinutes",hasModal:!0,tileType:"active-minutes",unitType:i.plural("minute_full"),logUrl:"/activities",currentGoalIconClass:"",precision:0,options:{metricFormats:{setting:n,goal:n,result:n},style:{goalSetting:{textAlign:"center"},settingInput:{width:40,"float":"none",textAlign:"center",display:"inline-block"},settingUnit:{width:30,"float":"none",textAlign:"center",display:"inline-block"}}}})}),define("hbs!galileo/tile/template/restingHeartRate",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/unit","i18n-load!com/fitbit/app/ngd/restingHeartRate","galileo/tile/template/helpers/domPlaceholder","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n<div class="container">\n    <div class="chartContainer">',s={hash:{}},o+=d((n=i.domPlaceholder,n?n.call(e,"graph",s):c.call(e,"domPlaceholder","graph",s)))+'</div>\n\n    <div class="summary">\n        <span class="stat metricLarge metricContainer">\n            <span class="number">',(a=i.bpm)?a=a.call(e,{hash:{}}):(a=e.bpm,a=typeof a===u?a.apply(e):a),o+=d(a)+' </span>\n            <span class="unit-label">',s={hash:{}},n=i.i18n,a=n?n.call(e,"bpm",s):c.call(e,"i18n","bpm",s),(a||0===a)&&(o+=a),o+='</span>\n            <span class="zone">',s={hash:{}},n=i.i18n,a=n?n.call(e,"resting_heart_rate_title",s):c.call(e,"i18n","resting_heart_rate_title",s),(a||0===a)&&(o+=a),o+='\n                <span class="contentInfo">?</span>\n            </span>\n        </span>\n    </div>\n</div>\n'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h="",c=i.helperMissing,d=this.escapeExpression,u="function",p=this;return r={hash:{},inverse:p.noop,fn:p.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.unit","com.fitbit.app.ngd.restingHeartRate",r):c.call(t,"i18n-namespace","com.fitbit.app.unit","com.fitbit.app.ngd.restingHeartRate",r),(l||0===l)&&(h+=l),h+="\n"});return e.registerPartial("galileo_tile_template_restingHeartRate",t),t}),define("hbs!galileo/tile/template/restingHeartRateonboarding",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/restingHeartRate","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+='\n<div class="onboarding">\n    <div class="icon">\n        <i class="fitglyph fitglyph-heart-solid size-c"></i>\n    </div>\n    <div class="title">\n        ',s={hash:{}},n=i.i18n,a=n?n.call(e,"rhr_onboarding_title",s):c.call(e,"i18n","rhr_onboarding_title",s),(a||0===a)&&(o+=a),o+='\n    </div>\n    <div class="text">\n        <p class="info">',s={hash:{}},n=i.i18n,a=n?n.call(e,"rhr_onboarding_subtitle",s):c.call(e,"i18n","rhr_onboarding_subtitle",s),(a||0===a)&&(o+=a),o+='</p>\n        <p class="info">',s={hash:{}},n=i.i18n,a=n?n.call(e,"rhr_onboarding_body",s):c.call(e,"i18n","rhr_onboarding_body",s),(a||0===a)&&(o+=a),o+='</p>\n    </div>\n    <div class="footer">\n        <a class="confirmButton" href="',s={hash:{}},n=i.i18n,a=n?n.call(e,"rhr_onboarding_href",s):c.call(e,"i18n","rhr_onboarding_href",s),(a||0===a)&&(o+=a),o+='">',s={hash:{}},n=i.i18n,a=n?n.call(e,"rhr_onboarding_learn_more",s):c.call(e,"i18n","rhr_onboarding_learn_more",s),(a||0===a)&&(o+=a),o+="</a>\n    </div>\n</div>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h="",c=i.helperMissing,d=this;return r={hash:{},inverse:d.noop,fn:d.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.restingHeartRate",r):c.call(t,"i18n-namespace","com.fitbit.app.ngd.restingHeartRate",r),(l||0===l)&&(h+=l),h+="\n"});return e.registerPartial("galileo_tile_template_restingHeartRateonboarding",t),t}),define("hbs!galileo/tile/template/help/restingHeartRate",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/tooltips","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+="\n<h3>",s={hash:{}},n=i.i18n,a=n?n.call(e,"rhr_header",s):c.call(e,"i18n","rhr_header",s),(a||0===a)&&(o+=a),o+="</h3>\n<p>\n    ",s={hash:{}},n=i.i18n,a=n?n.call(e,"rhr_msg",s):c.call(e,"i18n","rhr_msg",s),(a||0===a)&&(o+=a),o+="\n    <br>\n    <a class='rhrHelp' href='",s={hash:{}},n=i.i18n,a=n?n.call(e,"rhr_faq",s):c.call(e,"i18n","rhr_faq",s),(a||0===a)&&(o+=a),o+="'>",s={hash:{}},n=i.i18n,a=n?n.call(e,"rhr_learn_more",s):c.call(e,"i18n","rhr_learn_more",s),(a||0===a)&&(o+=a),o+="</a>\n</p>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h="",c=i.helperMissing,d=this;return r={hash:{},inverse:d.noop,fn:d.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.tooltips",r):c.call(t,"i18n-namespace","com.fitbit.app.ngd.tooltips",r),(l||0===l)&&(h+=l),h+="\n"});return e.registerPartial("galileo_tile_template_help_restingHeartRate",t),t}),define("hbs!galileo/tile/template/restingHeartRateGraph",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="chart"></div>\n'});return e.registerPartial("galileo_tile_template_restingHeartRateGraph",t),t}),define("galileo/util/mathUtil",[],function(){return{round:function(e,t){var i=Math.pow(10,t);return Math.round(e*i)/i}}}),define("galileo/graph/restingHeartRate",["require","jquery","underscore","./base","./tooltip","i18n/i18n","galileo/color/graph","hbs!../tile/template/restingHeartRateGraph","galileo/widget/metric","galileo/ajax/ajax","galileo/util/mathUtil","galileo/util/dateUtil","i18n-load!com/fitbit/app/unit","i18n-load!com/fitbit/app/ngd/restingHeartRate"],function(e){function t(e,t,o,r){var h=t,c=p.minusDays(h,30);d.get("getRestingHeartRateData","activityTileData",{endDate:p.ajaxEncode(h),startDate:p.ajaxEncode(c)},function(h){var c,d,g,v,y,b,w,_=h.dataPoints,x=p.ajaxDecode(_[0].date).getTime(),T=p.ajaxDecode(_[_.length-1].date).getTime(),k=T-x,S=[],M=[];if(_.forEach(function(e){S.push(e.value)}),d=Math.min.apply(null,S),c=Math.max.apply(null,S),v=Math.floor(.95*d),y=Math.ceil(1.05*c),g=Math.floor(S.length/2)||0,_.forEach(function(e,t){e.xOrientationPoint=g>t}),a.findWhere(_,{value:d}).isMinPoint=!0,a.findWhere(_,{value:c}).isMaxPoint=!0,_&&(M=_.map(i)),b=n.extend(!0,{tooltip:{crosshairs:[{width:2,color:"#323A45"}],style:{display:"none"}},series:[{name:"heart-rate",data:M}],yAxis:{min:v,max:y,showFirstLabel:!1},plotOptions:{series:{marker:{enabled:!0,fillColor:"#FF5959",radius:2,states:{hover:{enabled:!0,radius:5,fillColor:"#323A45",lineWidth:2,lineColor:"#FFFFFF"}}}},spline:{dataLabels:{enabled:!0,useHTML:!0,formatter:function(){var e=this.point.xOrientation?"left":"right";return this.point.isMax||this.point.isMin?"<span class='rhr-datalabel "+e+"'>"+u.round(this.point.y,f)+"</span>":""}},marker:{enabled:1===_.length}}},xAxis:{tickPositioner:function(){return[x,T]},labels:{formatter:function(){var e=new Date(this.value),i=new Date(t);return e.setHours(0,0,0,0),i.setHours(0,0,0,0),e.getTime()===i.getTime()?l("today"):p.localeFormat(e,"MMM dd")}}}},m),w=s(e,o,r,b),k){var d=w.xAxis[0].getExtremes().dataMin-k/6,c=w.xAxis[0].getExtremes().dataMax+k/10;w.xAxis[0].setExtremes(d,c,!0)}})}function i(e){return{x:p.ajaxDecode(e.date),y:Number(e.value),isMax:e.isMaxPoint,isMin:e.isMinPoint,xOrientation:e.xOrientationPoint}}var n=e("jquery"),a=e("underscore"),s=e("./base"),o=e("./tooltip"),l=e("i18n/i18n")(),r=e("galileo/color/graph"),h=e("hbs!../tile/template/restingHeartRateGraph"),c=e("galileo/widget/metric"),d=e("galileo/ajax/ajax"),u=e("galileo/util/mathUtil"),p=e("galileo/util/dateUtil");l.namespace(e("i18n-load!com/fitbit/app/unit")),l.namespace(e("i18n-load!com/fitbit/app/ngd/restingHeartRate"));var g=[{unitPlural:l.plural("resting_heart_rate"),unitThreshold:1/0,format:"#,##0"}],f=0,m=n.extend(!0,{chart:{marginLeft:0,marginRight:0,type:"spline"},plotOptions:{spline:{color:"#FB7464"},series:{states:{hover:{enabled:!0}}}},xAxis:{showLastLabel:!0,showFirstLabel:!0,lineColor:r.yAxis,gridLineColor:r.xAxis,minorGridLineColor:r.xAxis,tickLength:0,lineWidth:2,labels:{style:{"font-family":'"Proxima Nova Regular",arial,sans-serif',"font-size":"12px",color:r.labelText}}},yAxis:{lineColor:r.yAxis,gridLineColor:r.yAxis,minorGridLineColor:r.yAxis,tickPixelInterval:60,labels:{style:{"font-family":'"Proxima Nova Regular",arial,sans-serif',"font-size":"12px",color:r.labelText},align:"right",x:30,y:14,formatter:function(){return'<span class="yAxisLabel">'+(this.value||"")+"</span>"}},title:{text:""}},tooltip:{enabled:!0}},o.chartMixin(function(){var e=new Date(this.x),t=new c(g);return t.update(this.y),n('<div class="graphTip">').append(n('<div class="date">').text(p.localeFormat(e,"MMM dd")),n('<div class="details">').append(t.elements()))}));return function(e,i,a){var s,o=n(h());return s=o,t(s,e,i,a),o}}),define("galileo/tile/restingHeartRate",["require","./classes/small","i18n/i18n","hbs!./template/restingHeartRate","hbs!./template/restingHeartRateonboarding","hbs!./template/help/restingHeartRate","galileo/ajax/ajax","galileo/tile/template/helpers/domPlaceholder","galileo/util/dateUtil","galileo/graph/restingHeartRate","popup","galileo/util/mathUtil","i18n-load!com/fitbit/app/ngd/tile","i18n-load!com/fitbit/app/ngd/restingHeartRate"],function(e){var t=e("./classes/small"),i=e("i18n/i18n")(),n=e("hbs!./template/restingHeartRate"),a=e("hbs!./template/restingHeartRateonboarding"),s=e("hbs!./template/help/restingHeartRate"),o=e("galileo/ajax/ajax"),l=e("galileo/tile/template/helpers/domPlaceholder"),r=e("galileo/util/dateUtil"),h=e("galileo/graph/restingHeartRate"),c=e("popup"),d=e("galileo/util/mathUtil");i.namespace(e("i18n-load!com/fitbit/app/ngd/tile")),i.namespace(e("i18n-load!com/fitbit/app/ngd/restingHeartRate"));var u=167,p=0;return new Class({Extends:t,options:{controlsList:[{name:i("Settings"),"class":"settingsButton showSettings",glyphName:"show-settings"}]},tileName:"restingHeartRate",savable:!1,hasModal:!1,title:i("resting_heart_rate_title"),load:function(){var e=this.getDate(),t=r.minusDays(e,30),i=this.main.eq(0).find(".content"),g=new c({className:"tiles-tooltip"});i.find(".container").remove(),i.empty(),this.showMainContents(),o.get("getRestingHeartRateData","activityTileData",{endDate:r.ajaxEncode(e),startDate:r.ajaxEncode(t)},function(t){var s,o,r=t.dataPoints,c=i.closest(".main");r&&r.length?(s=r[r.length-1],o=s.value,i.append(l(n,{bpm:d.round(o,p),graph:h(e,c.width(),u)}))):i.append(a({}))}),i.on("mouseover",".container .contentInfo",function(e){g.showHTML(s,$(e.target))})}})}),define("galileo/tile/BackboneTile",["require","backbone","underscore","hbs!galileo/tile/template/dialog/dialogContainer","hbs!galileo/tile/template/dialog/removeTile","hbs!./template/loading","shared/scripts/modal","galileo/tile/classes/animate"],function(e){var t=e("backbone"),i=e("underscore"),n=e("hbs!galileo/tile/template/dialog/dialogContainer"),a=e("hbs!galileo/tile/template/dialog/removeTile"),s=e("hbs!./template/loading"),o=e("shared/scripts/modal"),l=e("galileo/tile/classes/animate"),r=t.View.extend({className:"tile unflipped",events:{"mousedown input":"stopPropagation","click .settingsButton":"showSettings","click .removeTile":"removalDialog"},stopPropagation:function(e){e.stopPropagation()},showSettings:function(){var e=this.$el;return e.on("animationend webkitAnimationEnd",function(){e.hasClass("flippedAnimation")&&(e.addClass("flipped"),e.removeClass("flippedAnimation"))}),e.removeClass("unflipped unflippedAnimation").addClass("flippedAnimation"),this.showingSettings=!0,this.trigger("showSettings"),this},hideSettings:function(){var e=this.$el;return e.on("animationend webkitAnimationEnd",function(){e.hasClass("unflippedAnimation")&&(e.addClass("unflipped"),e.removeClass("unflippedAnimation"))}),e.removeClass("flipped flippedAnimation").addClass("unflippedAnimation"),this.showingSettings=!1,this.trigger("hideSettings"),this},removalDialog:function(){var e=this,t=a({tileName:this.title||""});o(function(i){var a=$(n({content:t}));return a.on("click",".confirm",function(){i(),e.remove()}),a})},initialize:function(){this.$el.addClass(this.shape),this.$el.addClass(this.tileName),i.extend(this,new l),this.$el.data("view",this);var e=r.prototype;this.className!==e.className&&this.$el.addClass(e.className),this.events!==e.events&&i.defaults(this.events,e.events),this.showLoading()},showLoading:function(){return this.$el.html(s(this.title)),this},remove:function(){return r.__super__.remove.apply(this),this._cleanupClickDrag&&this._cleanupClickDrag(),this.trigger("remove"),this}});return r}),define("galileo/util/whenAboveFPS",["require","rsvp"],function(e){var t=e("rsvp").Promise;return function(e){var i=Date.now();e=e||{};var n="undefined"!=typeof e.fps?e.fps:30,a=i+("undefined"!=typeof e.timeoutMS?e.timeoutMS:3e3),s=i,o=0,l=0,r="undefined"!=typeof e.runOnTimeout?e.runOnTimeout:!0,h="undefined"!=typeof e.sustainedFrames?e.sustainedFrames:0,c=requestAnimationFrame?requestAnimationFrame:function(e){setTimeout(e,1e3/60)};return new t(function(e,t){var d=function(){var u=Date.now();if(u>a)return r?void e(u-i):void t(u-i);var p=(u-s)/1e3;if(s=u,o=1/p,o>=n){if(l++,l>=h)return void e(u-i)}else l=0;c(d)};c(d)})}}),define("galileo/graphic/celebrationStarsPhysics",[],function(){return function(e,t,i,n){function a(e,t){this.x=e,this.y=t}function s(e){return 180*e/Math.PI}function o(e,t,i,n){this.fontSize="undefined"==typeof n?18:n,this.$el=$('<span style="position: absolute; display: block; z-index:-100; color: #89DE00; font-size: '+this.fontSize+'px;" class="fitglyph fitglyph-star"></span>').appendTo(i),this.pos=e,this.oldPos=t;var a=this.oldPos.vectorTo(e);this.startDegrees=s(Math.atan2(a.x,a.y)),this.endFade=f,this.startFade=0,this.lifetime=0,this.maxLife=2e3}function l(e){for(var t,i=Math.max(0,e-w-_),n=[],a=(Math.floor(10*Math.random())%2===0?Math.ceil:Math.floor)(_/w),s=0;_>s;s++)n.push(T),s%a===0&&n.splice(s,0,x);for(s=0;i>s;s++)t=Math.ceil(n.length/i),s%t===0&&n.splice(s,0,k);return n}function r(){for(var i=l(S),n=0;S>n;n++){var s=(Math.random()-.5)*Math.PI/32,r=h(Math.PI+Math.PI*(n/(S-1))+s),c=2000.3+(1-Math.abs(r-1.5*Math.PI)/(Math.PI/2)),d=t.sub(a.fromAngle(r,c)),u=t.clone(),p=i.shift();b.push(new o(u,d,e,p))}}function h(e){return Math.max(1.1*Math.PI,Math.min(1.9*Math.PI,e))}function c(e,t){for(var i=0;i<b.length;i++)b[i].update(e,t)}function d(){var e=Date.now();D||(D=e-M);var t=e-D,i=Math.min(Math.max(t,M),2*M)/1e3;c(i,A),A=i,D=e,b.length&&C(d)}a.prototype={add:function(e){return new a(this.x+e.x,this.y+e.y)},sub:function(e){return new a(this.x-e.x,this.y-e.y)},mul:function(e){return new a(this.x*e.x,this.y*e.y)},div:function(e){return new a(this.x/e.x,this.y/e.y)},scale:function(e){return new a(this.x*e,this.y*e)},distanceTo:function(e){var t=e.x-this.x,i=e.y-this.y;return Math.sqrt(t*t+i*i)},angle:function(e){return Math.atan2(this.x*e.y-this.y*e.x,this.x*e.x+this.y*e.y)},normal:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y);return new a(this.x/e,this.y/e)},clone:function(){return new a(this.x,this.y)},vectorTo:function(e){return e.sub(this)},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},a.fromAngle=function(e,t){var i=Math.cos(e)*t,n=Math.sin(e)*t;return new a(i,n)};var u=.99,p=.8,g=i,f=500,m=new a(0,75),v=e.height(),y=e.width();t=t?new a(t.x,t.y):new a(v/2,y/2);var b=[];o.prototype={getVelocity:function(){return this.pos.sub(this.oldPos)},update:function(e,t){this.lifetime+=1e3*e,this.updateMove(e,t),this.shouldStartFadeAndRotate()&&this.fadeAndRotate(e),this.render(e)},updateMove:function(e,t){var i=this.getVelocity().scale(e/t);this.oldPos=this.pos.clone(),this.pos=i.scale(u).add(this.pos).add(m.scale(e*e))},constrain:function(e,t){return this.constrainBounds(e,t)},constrainBounds:function(e,t){var i=0,n=0,a=y-this.fontSize,s=v-this.fontSize,o=this.getVelocity().scale(e/t);return this.pos.x>a?(this.pos.x=a,this.oldPos.x=this.pos.x+o.x*p,!0):this.pos.x<i?(this.pos.x=i,this.oldPos.x=this.pos.x+o.x*p,!0):this.pos.y>s?(this.pos.y=s,this.oldPos.y=this.pos.y+o.y*p,!0):this.pos.y<n?(this.pos.y=n,this.oldPos.y=this.pos.y+o.y*p,!0):!1},shouldStartFadeAndRotate:function(){return this.startFade||this.lifetime>this.maxLife||this.pos.distanceTo(t)>.6*g},render:function(){var e=this.startFade?(this.endFade-this.lifetime)/f:1,t=this.startDegrees;this.startFade&&(t+=(this.lifetime-this.startFade)/1e3*Math.PI*90),this.$el.css({opacity:e,transform:"translate("+this.pos.x+"px,"+this.pos.y+"px) rotate("+t+"deg)"})},fadeAndRotate:function(){this.startFade||(this.startFade=this.lifetime,this.endFade=this.startFade+f),this.lifetime>=this.endFade&&this.fadeAndRotateComplete()},fadeAndRotateComplete:function(){b.indexOf(this)>-1&&b.splice(b.indexOf(this),1),this.$el.remove()}};var w=2,_=3,x=18,T=15,k=8,S=n,M=1e3/60,C=requestAnimationFrame?requestAnimationFrame:function(e){setTimeout(e,M)},D=0,A=M;return function(){
var e=function(){$(this).remove()};r(),setTimeout(function(){for(;b.length;)b.pop().$el.animate({opacity:0},400,e)},3500),C(d)}}}),define("galileo/tile/sedentaryTimeMeter",["require","highcharts","rsvp","galileo/util/whenAboveFPS","galileo/graphic/celebrationStarsPhysics"],function(e){function t(e,t,i){return{x:e.x+Math.cos(i)*t,y:e.y+Math.sin(i)*t}}function i(e){var t=new r(function(t){e.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){e.removeClass("animate-to-star").addClass("star"),e.addClass("animate-star"),e.outerWidth(e.outerWidth()),t()})});return e.addClass("animate-to-star"),t}function n(e,n,a,s){function o(){c(e.parents(".main"),y,b,S)()}var l,r,h,d,u=a.numHours(),p=a.numHoursCompleted(n);s.arc(y.x,y.y,D,C,Math.PI,Math.PI).attr({"stroke-width":x,stroke:f,"stroke-linecap":"butt","stroke-linejoin":"round"}).add().animate({end:2*Math.PI},{duration:T}),setTimeout(function(){i(e.find("i")).then(o)},k);for(var m=0;u>m;m++){h=Math.PI+Math.PI*(m/(u-1)),l=a.isBeforeStart(n)||m>p,r=l?_:w,d=g;var v=t(y,b,h);!function(e,i){var n=t(y,b-10,h),a=s.circle(n.x,n.y,r).attr({"stroke-width":0,fill:d,opacity:0}).add();setTimeout(function(){a.animate({cx:e.x,cy:e.y,opacity:1},{duration:300})},i*(T/u)+M)}(v,m)}}function a(e,i,n){for(var a,s,o,l,r=i.numHours(),h=i.numHoursCompleted(e),c=i.isGoalMetByHour(),g=0;r>g;g++){o=Math.PI+Math.PI*(g/(r-1)),a=i.isBeforeStart(e)||g>h,s=a?_:w,l=c[g]?p:a?u:d;var f=t(y,b,o);n.circle(f.x,f.y,s).attr({"stroke-width":0,fill:l}).add()}}function s(){}function o(e){return new l.Renderer(e[0],e.width(),e.height())}var l=e("highcharts"),r=e("rsvp").Promise,h=e("galileo/util/whenAboveFPS"),c=e("galileo/graphic/celebrationStarsPhysics"),d="#DCDADA",u=d,p="#FF3A60",g="#89DE00",f="#D6EE9A",m=126,v=100,y={x:m,y:v},b=75,w=6,_=3,x=w,T=1e3,k=T/2,S=10,M=0,C=b+x/2,D=C-x;return s.prototype={render:function(e,t,i){a(t,i,o(e))},renderCelebration:function(e,t,i){h({fps:30,timeoutMS:3e3,sustainedFrames:10}).then(n.bind(this,e,t,i,o(e)))}},s}),define("hbs!galileo/tile/template/sedentaryTime",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a="";return a+='\n            <div class="metricLarge">\n                <span class="number">',(n=i.goalMetHours)?n=n.call(e,{hash:{}}):(n=e.goalMetHours,n=typeof n===u?n.apply(e):n),a+=p(n)+'</span><span class="unit"> ',(n=i.totalHoursPhrase)?n=n.call(e,{hash:{}}):(n=e.totalHoursPhrase,n=typeof n===u?n.apply(e):n),a+=p(n)+"</span>\n                ",n=i["if"].call(e,e.showGoalCaption,{hash:{},inverse:g.noop,fn:g.program(2,o,t)}),(n||0===n)&&(a+=n),a+="\n            </div>\n        "}function o(e,t){var n,a="";return a+='\n                    <p class="goal-caption">',(n=i.goalCaption)?n=n.call(e,{hash:{}}):(n=e.goalCaption,n=typeof n===u?n.apply(e):n),a+=p(n)+"</p>\n                "}function l(e,t){var n,a="";return a+="\n            ",n=i["if"].call(e,e.showCelebration,{hash:{},inverse:g.program(7,h,t),fn:g.program(5,r,t)}),(n||0===n)&&(a+=n),a+="\n        "}function r(e,t){var n,a="";return a+='\n            <div class="celebrationChatter">\n                <p class="boom">',(n=i.chatter1)?n=n.call(e,{hash:{}}):(n=e.chatter1,n=typeof n===u?n.apply(e):n),a+=p(n)+'</p>\n                <p class="celebration">\n                    ',(n=i.chatter2)?n=n.call(e,{hash:{}}):(n=e.chatter2,n=typeof n===u?n.apply(e):n),a+=p(n)+' <span class="celebrationHours">',(n=i.chatter3)?n=n.call(e,{hash:{}}):(n=e.chatter3,n=typeof n===u?n.apply(e):n),a+=p(n)+"</span> ",(n=i.chatter4)?n=n.call(e,{hash:{}}):(n=e.chatter4,n=typeof n===u?n.apply(e):n),a+=p(n)+"\n                </p>\n            </div>\n            "}function h(e,t){var n,a="";return a+='\n            <div class="chatter">\n                <p>',(n=i.chatter1)?n=n.call(e,{hash:{}}):(n=e.chatter1,n=typeof n===u?n.apply(e):n),a+=p(n)+"</p>\n                <p>",(n=i.chatter2)?n=n.call(e,{hash:{}}):(n=e.chatter2,n=typeof n===u?n.apply(e):n),a+=p(n)+"</p>\n            </div>\n            "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var c,d="",u="function",p=this.escapeExpression,g=this;return d+='<div class="main">\n    <div class="content">\n        <h2 class="tileTitle">\n            <span class="tileInfo">?</span>\n        </h2>\n        <div class="meter">\n             <p class="time start">',(c=i.startTime)?c=c.call(t,{hash:{}}):(c=t.startTime,c=typeof c===u?c.apply(t):c),d+=p(c)+'</p>\n             <p class="time end">',(c=i.endTime)?c=c.call(t,{hash:{}}):(c=t.endTime,c=typeof c===u?c.apply(t):c),d+=p(c)+'</p>\n             <i class="glyphicon fitglyph fitglyph-sedentaryTime size-b"></i>\n        </div>\n\n        ',c=i["if"].call(t,t.showMetric,{hash:{},inverse:g.noop,fn:g.program(1,s,a)}),(c||0===c)&&(d+=c),d+="\n        ",c=i["if"].call(t,t.showChatter,{hash:{},inverse:g.noop,fn:g.program(4,l,a)}),(c||0===c)&&(d+=c),d+='\n    </div>\n</div>\n    <div class="controls">\n        <ul class="controlsList">\n            <li class="control settingsButton leftSide showSettings">\n                <a title="Settings">\n                    <i class="fitglyph fitglyph-show-settings size-f"></i>\n                </a>\n            </li>\n            <li class="control more largeRight">\n            </li>\n        </ul>\n    </div>\n</div>'});return e.registerPartial("galileo_tile_template_sedentaryTime",t),t}),define("galileo/model/SedentaryTimeSettingsModel",["require","underscore","moment","backbone","shared/scripts/modules/api-client"],function(e){var t=e("underscore"),i=e("moment"),n=e("backbone"),a=e("shared/scripts/modules/api-client"),s=1.1,o="HH:mm",l=n.Model.extend({initialize:function(e,t){l.__super__.initialize.apply(this,arguments),this.user=t&&t.user,this.on("change:startTime",function(){this.has("startTime")&&this.has("endTime")?this.updateDuration():this.has("startTime")&&this.has("duration")&&this.set("endTime",i(this.get("startTime"),o).add(this.get("duration"),"hours").format(o))}.bind(this)),this.on("change:endTime",function(){this.has("startTime")&&this.updateDuration()})},updateDuration:function(){var e=i(this.get("startTime"),o),t=i(this.get("endTime"),o);t.isBefore(e)&&0===t.hour()&&(t=t.add(1,"days")),this.set("duration",t.diff(e,"hours"))},url:function(){return a.makeFullUrl("/"+s+"/user/"+this.user.encodedId+"/sed/settings.json")},validate:function(){if(!this.has("startTime"))return"no startTime attribute found";if(!this.has("duration"))return"no duration attribute found";if(!this.has("endTime"))return"no endTime attribute found";var e=!1;try{e=!i(i(this.get("startTime"),o).format(o),o).isValid(),e=e||!i(i(this.get("endTime"),o).format(o),o).isValid()}catch(t){e=!1}if(e)return"invalid format or value for start/endTime!";var n=this.get("duration");return 5>n||n>14?"The duration must be between 5 and 14 hours":void 0},parse:function(e,i){return t.has(e,"sedentaryTime")?e.sedentaryTime:e},getUserJSON:function(){return{sedStartTime:this.get("startTime"),sedDuration:this.get("duration")}},save:function(e,t,i){var n,a;return null==e||"object"==typeof e?(n=e,i=t):(n={})[e]=t,i=i||{},a=i.success,i.success=function(){a&&a(),this.trigger("save")}.bind(this),l.__super__.save.call(this,n,i)},sync:function(e,t,i){return("update"===e||"patch"===e||"create"===e)&&(i.emulateJSON=!0,i.data=t.getUserJSON()),l.__super__.sync.call(this,e,t,i)}});return l}),define("galileo/model/SedentaryTimeDaySummaryModel",["require","exports","module","moment","shared/scripts/modules/api-client","galileo/model/SharedModel"],function(e,t,i){function n(e){return a(e).format(h)}var a=e("moment"),s=e("shared/scripts/modules/api-client"),o=e("galileo/model/SharedModel"),l=1.1,r=250,h="YYYY-MM-DD",c=h+" hh:mm",d=0,u=o.extend({initialize:function(e,t){u.__super__.initialize.apply(this,arguments),this.user=t&&t.user,this.moment=a(t&&t.date||new Date).startOf("day")},url:function(){return s.makeFullUrl(["/",l,"/user/",this.user.encodedId,"/sed/date/",n(this.moment),".json"].join(""))},lookup:function(e,t){return t.user&&[i.uri,"_",d,"_",t.user.encodedId,"_",n(t.date)].join("")},parse:function(e){return e&&e.sed},isLoaded:function(){if(!this.attributes||!this.attributes.date)return!1;var e=a(this.attributes.date,h);return this.moment.isSame(e,"day")},goalSteps:function(){return r},startMoment:function(){var e=this.attributes.hourlyData[0].dateTime;return a(this.attributes.date+" "+e,c)},endMoment:function(){var e=this.attributes.hourlyData[this.attributes.hourlyData.length-1].dateTime;return a(this.attributes.date+" "+e,c).add(1,"hours")},numHours:function(){return this.attributes.hourlyData.length},numHoursCompleted:function(e){return e=e||a(),this.isBeforeStart(e)?0:this.isAfterEnd(e)?this.numHours():e.diff(this.startMoment(),"hours")},isBeforeStart:function(e){return e=e||a(),e.isBefore(this.startMoment())},isAfterEnd:function(e){return e=e||a(),e.isAfter(this.endMoment())},isGoalMetByHour:function(){var e=this.goalSteps();return this.attributes.hourlyData.map(function(t){return t.steps>=e})},numHoursWithGoalMet:function(){return this.isGoalMetByHour().reduce(function(e,t){return e+t},0)}});return u.invalidateAll=function(){d++},u}),define("hbs!galileo/tile/template/sedentaryTimeSettings",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/sedentaryTime","i18n-load!com/fitbit/app/ngd/tile","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,h="";return h+='\n<div class="settings">\n    <div class="settingsHeader">\n        <div class="settingsTitle">\n            <h2 title="activity_title">',s={hash:{}},n=i.i18n,a=n?n.call(e,"sedentaryTime_title",s):T.call(e,"i18n","sedentaryTime_title",s),(a||0===a)&&(h+=a),h+='</h2>\n        </div>\n        <div class="removeTile removeButton">\n            <span class="fitglyph fitglyph-remove size-g"></span>\n        </div>\n    </div>\n    <div class="content">\n        <div class="timeInputSection">\n            <div class="timeInput">\n                <span class="timeInputBox validateTime">\n                    <span class="timeText">',s={hash:{}},n=i.i18n,a=n?n.call(e,"sedentaryTime_start",s):T.call(e,"i18n","sedentaryTime_start",s),(a||0===a)&&(h+=a),h+="</span>\n                    ",a=i["if"].call(e,e.ampmAfter,{hash:{},inverse:x.program(4,l,t),fn:x.program(2,o,t)}),(a||0===a)&&(h+=a),h+="\n                        ",a=i.each.call(e,e.startTimeMeridians,{hash:{},inverse:x.noop,fn:x.program(6,r,t)}),(a||0===a)&&(h+=a),h+='\n                    </div>\n                </span>\n            </div>\n            <div class="timeInput">\n                <span class="timeInputBox validateTime">\n                    <span class="timeText">',s={hash:{}},n=i.i18n,a=n?n.call(e,"sedentaryTime_end",s):T.call(e,"i18n","sedentaryTime_end",s),(a||0===a)&&(h+=a),h+="</span>\n                    ",a=i["if"].call(e,e.ampmAfter,{hash:{},inverse:x.program(13,u,t),fn:x.program(11,d,t)}),(a||0===a)&&(h+=a),h+="\n                        ",a=i.each.call(e,e.endTimeMeridians,{hash:{},inverse:x.noop,fn:x.program(15,p,t)}),(a||0===a)&&(h+=a),h+='\n                    </div>\n                </span>\n            </div>\n        </div>\n        <p class="infoText">',s={hash:{}},n=i.i18n,a=n?n.call(e,"sedentaryTime_info",s):T.call(e,"i18n","sedentaryTime_info",s),(a||0===a)&&(h+=a),h+=' <span class="errorText">',s={hash:{}},n=i.i18n,a=n?n.call(e,"sedentaryTime_invalid",s):T.call(e,"i18n","sedentaryTime_invalid",s),(a||0===a)&&(h+=a),h+='</span></p>\n    </div>\n    <div class="settingsFooter">\n        <a class="dashButton cancelButton close">',s={hash:{}},n=i.i18n,a=n?n.call(e,"cancel",s):T.call(e,"i18n","cancel",s),(a||0===a)&&(h+=a),h+='</a>\n        <a class="dashButton saveSettings saveButton">',s={hash:{}},n=i.i18n,a=n?n.call(e,"Save",s):T.call(e,"i18n","Save",s),(a||0===a)&&(h+=a),h+="</a>\n    </div>\n</div>\n"}function o(e,t){var n,a="";return a+='\n                    <input class="time startTime validateTime middle" type="text" value="',(n=i.startTime)?n=n.call(e,{hash:{}}):(n=e.startTime,n=typeof n===w?n.apply(e):n),a+=_(n)+'" />\n                    <div class="startAMPM timeMeridian right">\n                    '}function l(e,t){var n,a="";return a+='\n                    <input class="time startTime validateTime right" type="text" value="',(n=i.startTime)?n=n.call(e,{hash:{}}):(n=e.startTime,n=typeof n===w?n.apply(e):n),a+=_(n)+'" />\n                    <div class="startAMPM timeMeridian middle">\n                    '}function r(e,t){var n,a="";return a+='\n                        <div\n                            data-value="',(n=i.value)?n=n.call(e,{hash:{}}):(n=e.value,n=typeof n===w?n.apply(e):n),a+=_(n)+'"\n                            ',n=i["if"].call(e,e.isSelected,{hash:{},inverse:x.program(9,c,t),fn:x.program(7,h,t)}),(n||0===n)&&(a+=n),a+="\n                            >\n                            <span>",(n=i.text)?n=n.call(e,{hash:{}}):(n=e.text,n=typeof n===w?n.apply(e):n),a+=_(n)+'</span>\n                            <div class="up"></div>\n                            <div class="down"></div>\n                        </div>\n                        '}function h(e,t){var n,a="";return a+='\n                            class="selected ',(n=i.value)?n=n.call(e,{hash:{}}):(n=e.value,n=typeof n===w?n.apply(e):n),a+=_(n)+'"\n                            '}function c(e,t){var n,a="";return a+='\n                            class="',(n=i.value)?n=n.call(e,{hash:{}}):(n=e.value,n=typeof n===w?n.apply(e):n),a+=_(n)+'"\n                            '}function d(e,t){var n,a="";return a+='\n                    <input class="time endTime validateTime middle" type="text" value="',(n=i.endTime)?n=n.call(e,{hash:{}}):(n=e.endTime,n=typeof n===w?n.apply(e):n),a+=_(n)+'" />\n                    <div class="endAMPM timeMeridian right">\n                    '}function u(e,t){var n,a="";return a+='\n                    <input class="time endTime validateTime right" type="text" value="',(n=i.endTime)?n=n.call(e,{hash:{}}):(n=e.endTime,n=typeof n===w?n.apply(e):n),a+=_(n)+'" />\n                    <div class="endAMPM timeMeridian middle">\n                    '}function p(e,t){var n,a="";return a+='\n                        <div\n                                data-value="',(n=i.value)?n=n.call(e,{hash:{}}):(n=e.value,n=typeof n===w?n.apply(e):n),a+=_(n)+'"\n                                ',n=i["if"].call(e,e.isSelected,{hash:{},inverse:x.program(18,f,t),fn:x.program(16,g,t)}),(n||0===n)&&(a+=n),a+="\n                        >\n                            <span>",(n=i.text)?n=n.call(e,{hash:{}}):(n=e.text,n=typeof n===w?n.apply(e):n),a+=_(n)+'</span>\n                            <div class="up"></div>\n                            <div class="down"></div>\n                        </div>\n                        '}function g(e,t){var n,a="";return a+='\n                                class="selected ',(n=i.value)?n=n.call(e,{hash:{}}):(n=e.value,n=typeof n===w?n.apply(e):n),a+=_(n)+'"\n                                '}function f(e,t){var n,a="";return a+='\n                                class="',(n=i.value)?n=n.call(e,{hash:{}}):(n=e.value,n=typeof n===w?n.apply(e):n),a+=_(n)+'"\n                                '}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var m,v,y,b="",w="function",_=this.escapeExpression,x=this,T=i.helperMissing;return y={hash:{},inverse:x.noop,fn:x.program(1,s,a)},m=i["i18n-namespace"],v=m?m.call(t,"com.fitbit.app.ngd.sedentaryTime","com.fitbit.app.ngd.tile",y):T.call(t,"i18n-namespace","com.fitbit.app.ngd.sedentaryTime","com.fitbit.app.ngd.tile",y),(v||0===v)&&(b+=v),b+="\n"});return e.registerPartial("galileo_tile_template_sedentaryTimeSettings",t),t}),define("hbs!galileo/tile/template/help/sedentaryTimeSettingsIAImpact",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/tooltips","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,o="";return o+="\n<p>\n    ",s={hash:{}},n=i.i18n,a=n?n.call(e,"sedentaryTime_hourly_move_goal_tip",s):h.call(e,"i18n","sedentaryTime_hourly_move_goal_tip",s),(a||0===a)&&(o+=a),o+="\n    <br>\n    <a class='stGoalTooltipHelp' href='",s={hash:{}},n=i.i18n,a=n?n.call(e,"sedentaryTime_info_href",s):h.call(e,"i18n","sedentaryTime_info_href",s),(a||0===a)&&(o+=a),o+="'>",s={hash:{}},n=i.i18n,a=n?n.call(e,"sedentaryTime_info_learn_more",s):h.call(e,"i18n","sedentaryTime_info_learn_more",s),(a||0===a)&&(o+=a),o+="</a>\n</p>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l,r,h=i.helperMissing,c=this;return r={hash:{},inverse:c.noop,fn:c.program(1,s,a)},o=i["i18n-namespace"],l=o?o.call(t,"com.fitbit.app.ngd.tooltips",r):h.call(t,"i18n-namespace","com.fitbit.app.ngd.tooltips",r),l||0===l?l:""});return e.registerPartial("galileo_tile_template_help_sedentaryTimeSettingsIAImpact",t),t}),define("galileo/tile/sedentaryTimeSettingsView",["require","backbone","moment","hbs!galileo/tile/template/sedentaryTimeSettings","galileo/model/user","i18n/i18n","underscore","popup","hbs!galileo/tile/template/help/sedentaryTimeSettingsIAImpact","cdn-logger/siteLogger","i18n-load!core/com/fitbit/util/dateformat","i18n-load!com/fitbit/app/ngd/sedentaryTime"],function(e){var t=e("backbone"),i=e("moment"),n=e("hbs!galileo/tile/template/sedentaryTimeSettings"),a=e("galileo/model/user"),s=e("i18n/i18n"),o=new s,l=e("underscore"),r=e("popup"),h=e("hbs!galileo/tile/template/help/sedentaryTimeSettingsIAImpact"),c=e("cdn-logger/siteLogger");o.namespace(e("i18n-load!core/com/fitbit/util/dateformat"));var d=o("am_pm");d=d.split(",");var u=d[0].trim(),p=d[1].trim(),g=o("time_12_hours"),f=g.trim().indexOf("a")>0,m=a.viewer.clock12?"h:mm":"H:mm",v="HH:mm";o.namespace(e("i18n-load!com/fitbit/app/ngd/sedentaryTime"));var y=t.View.extend({template:n,events:{"keydown .time":"typeTime","click .time":"focusTime","keyup .time":"validateTimeNumber","click .timeMeridian":"toggleAmPm","click .saveButton":"done","click .cancelButton":"cancel","paste .time":"preventPaste"},initialize:function(e){this.parentView=e.parentView,this.parentView.on("hideSettings",this.resetTime),this.popup=new r({className:"tiles-tooltip",closeOnClick:!0,renderCallback:function(){}}),this.shownTooltip=!1},getStartTimeMeridians:function(){return this.getTimeMeridians(this.model.get("startTime"))},getEndTimeMeridians:function(){return this.getTimeMeridians(this.model.get("endTime"))},getTimeMeridians:function(e){if(!a.viewer.clock12)return[];var t="am"===i(e,v).format("a");return[{text:u,value:"am",isSelected:t},{text:p,value:"pm",isSelected:!t}]},render:function(){return c.logV2Event({id:c.INTERACTION_IDS.VIEW_SEDENTARY_TIME_SETTINGS,type:"screen"}),this.parentView.showingSettings?(this.shownTooltip=!1,this.updateSavedTime(),this.$el.html(this.template({showingSettings:!0,startTime:i(this.model.get("startTime"),v).format(m),endTime:i(this.model.get("endTime"),v).format(m),ampmAfter:f,startTimeMeridians:this.getStartTimeMeridians(),endTimeMeridians:this.getEndTimeMeridians()})),a.viewer.clock12?(this.$startTimeMeridian=$(".startAMPM.timeMeridian"),this.$endTimeMeridian=$(".endAMPM.timeMeridian"),this.$startTimeMeridian.addClass(f?"right":"middle"),this.$endTimeMeridian.addClass(f?"right":"middle")):$(".timeMeridian").hide(),$(".validateTime").focus(function(){$(this).closest(".timeInputBox").addClass("active")}),$(".validateTime").blur(function(){$(this).closest(".timeInputBox").removeClass("active")})):this.parentView.hideSettings(),this},done:function(){this.model.isValid()?(this.model.save(),this.updateSavedTime(),this.parentView.hideSettings()):this.invalidTime()},cancel:function(){this.parentView.hideSettings()},resetTime:function(){this.settingsModel.set("startTime",this.settingsView.savedStartTime),this.settingsModel.set("endTime",this.settingsView.savedEndTime)},updateSavedTime:function(){this.savedStartTime=this.model.get("startTime"),this.savedEndTime=this.model.get("endTime")},focusTime:function(e){var t=e.target,i=t.value.lastIndexOf(":"),n=t.selectionStart;n>i&&(t.selectionStart=0,t.selectionEnd=i)},typeTime:function(e){var t=e.target,i=e.which,n=t.value.lastIndexOf(":"),a=t.selectionEnd,s=t.selectionEnd-t.selectionStart;if(a>n)if(t.selectionStart<n)t.selectionStart=0,t.selectionEnd=n;else if(37!==i)return!1;return this.isAlphabeticalKey(i)||this.isPunctuationKey(i)||this.isNotNavigationKey(i)&&this.isNotDeletionKey(i)&&2===n&&2>=a&&0===s?!1:void 0},isAlphabeticalKey:function(e){return e>=65&&90>=e},isPunctuationKey:function(e){return e>=186},isNotNavigationKey:function(e){return 37!==e&&39!==e&&9!==e&&36!==e},isNotDeletionKey:function(e){return 45!==e&&8!==e&&46!==e},toggleAmPm:function(e){var t=$(e.target).parents(".timeInput").find(".timeMeridian"),i=t.parent().find("input.time"),n=l.find(i.attr("class").split(" "),function(e){return e.indexOf("Time")>-1}),s=t.find(".selected").attr("data-value");"am"===s?(t.find(".am").removeClass("selected"),t.find(".pm").addClass("selected"),s="pm"):(t.find(".pm").removeClass("selected"),t.find(".am").addClass("selected"),s="am");var o=i.val()+s,r=a.viewer.clock12?m+" a":m;this.validateTime(o,r,n)&&this.showInfoPopup(e)},validateTimeNumber:function(e){var t=$(e.target),i=l.find(t.attr("class").split(" "),function(e){return e.indexOf("Time")>-1}),n=a.viewer.clock12?t.val()+t.parent().find(".timeMeridian .selected").attr("data-value"):t.val(),s=a.viewer.clock12?m+" a":m;":"===n[0]?this.invalidTime():this.validateTime(n,s,i)&&this.showInfoPopup(e)},validateTime:function(e,t,n){var a=!1;try{e=i(e,t).format(v),a=!i(e,v).isValid()}catch(s){a=!0}return this.model.set(n,e),this.model.isValid()?(a=!1,this.$(".validateTime").removeClass("invalid"),this.$(".timeInputBox").removeClass("invalid-border"),this.$(".saveButton").removeClass("error"),this.$(".errorText").removeClass("error")):(this.invalidTime(),a=!0),!a},invalidTime:function(){this.$(".validateTime").addClass("invalid"),this.$(".timeInputBox").addClass("invalid-border"),this.$(".saveButton").addClass("error"),this.$(".errorText").addClass("error")},preventPaste:function(e){e.preventDefault()},showInfoPopup:function(e){!this.shownTooltip&&[37,39,9,16,17,18,91].indexOf(e.which)<0&&(65===e.which||80===e.which||e.which<65||e.which>90)&&e.which<186&&(this.shownTooltip=!0,this.popup.showHTML(h,$(e.target).parents(".timeInputBox")))}});return y}),define("galileo/tile/sedentaryTime",["require","moment","galileo/tile/BackboneTile","./sedentaryTimeMeter","i18n/i18n","cdn-logger/siteLogger","hbs!galileo/tile/template/sedentaryTime","galileo/model/SedentaryTimeSettingsModel","galileo/model/user","galileo/model/SedentaryTimeDaySummaryModel","galileo/tile/sedentaryTimeSettingsView","i18n-load!core/com/fitbit/util/dateformat","i18n-load!com/fitbit/app/ngd/sedentaryTime"],function(e){var t=e("moment"),i=e("galileo/tile/BackboneTile"),n=e("./sedentaryTimeMeter"),a=e("i18n/i18n"),s=new a,o=e("cdn-logger/siteLogger"),l=e("hbs!galileo/tile/template/sedentaryTime"),r=e("galileo/model/SedentaryTimeSettingsModel"),h=e("galileo/model/user"),c=e("galileo/model/SedentaryTimeDaySummaryModel"),d=e("galileo/tile/sedentaryTimeSettingsView");s.namespace(e("i18n-load!core/com/fitbit/util/dateformat"));var u=s("am_pm");u=u.split(",");var p=u[0].trim(),g=u[1].trim();s.namespace(e("i18n-load!com/fitbit/app/ngd/sedentaryTime"));var f=h.viewer.clock12?"hA":"H:mm",m=i.extend({shape:"small",title:s("sedentaryTime_title"),tileName:"sedentaryTime",savable:!1,template:l,events:{"mouseover .tileInfo":"showInfoPopup"},initialize:function(e){o.logV2Event({id:o.INTERACTION_IDS.VIEW_SEDENTARY_TIME,type:"screen"}),m.__super__.initialize.apply(this,arguments),e=e||{},this.on("showSettings",this.renderSettings),this.on("hideSettings",this.render),this.date=e.date,this.loadModelForDate(),this.on("changeDate",function(e){this.date=e.date,this.loadModelForDate()}),this.settingsModel=new r({},{user:h.viewer}),this.settingsModel.fetch(),this.listenTo(this.settingsModel,"save",this.handleSettingsSave),this.settingsView=new d({model:this.settingsModel,el:this.$el,parentView:this}),this.showLoading(),this.meter=new n},loadModelForDate:function(){this.stopListening(this.model),this.model=new c(null,{user:h.viewer,date:this.date}),this.model.isLoaded()&&this.model.isAfterEnd()||this.model.fetch(),this.render(),this.listenTo(this.model,"change",this.render)},handleSettingsSave:function(){c.invalidateAll(),this.loadModelForDate()},render:function(){var e,i;return this.showingSettings?this:this.model.isLoaded()?(e=t(),this.renderTemplate(e),i=this.model.numHoursWithGoalMet()>=this.model.numHours(),i?this.meter.renderCelebration(this.$(".meter"),e,this.model):this.meter.render(this.$(".meter"),e,this.model),this):(this.showLoading(),this)},renderTemplate:function(e){var t=this.chatter(e),i=this.model.numHoursWithGoalMet()>=this.model.numHours(),n=this.model.isLoaded()?{startTime:this.i18nTime(this.model.startMoment()),endTime:this.i18nTime(this.model.endMoment()),showChatter:this.model.isBeforeStart(e)||this.model.isAfterEnd(e),showMetric:!this.model.isBeforeStart(e)&&!i,showGoalCaption:!this.model.isAfterEnd(e),showCelebration:i,chatter1:t[0],chatter2:t[1],chatter3:t[2],chatter4:t[3],goalMetHours:this.model.numHoursWithGoalMet(),totalHoursPhrase:this.totalHoursPhrase(this.model.numHours()),goalCaption:this.goalCaption()}:{};this.$el.html(this.template(n)),this.$el.data("viewData",n)},chatter:function(e){var t;if(this.model.isAfterEnd(e)){var i=this.model.numHoursWithGoalMet()/this.model.numHours()*100;t=100===i?[s("chatter_boom"),s("chatter_way_to_get"),s("chatter_num_hours").substitute([this.model.numHoursWithGoalMet(),this.model.numHours()]),s("chatter_hours")]:i>=90?[s("chatter_stepping_machine"),"","",""]:i>=60?[s("chatter_big_moves"),"","",""]:i>=30?[s("chatter_right_direction"),"","",""]:[s("chatter_beat_this"),"","",""]}else t=[s("chatter_are_you_ready_to"),s("chatter_get_moving"),"",""];return t},totalHoursPhrase:function(e){return s("sedentaryTime_number_of_hours").substitute([e])},goalCaption:function(){return s("sedentaryTime_goal_steps").substitute([this.model.goalSteps()])},i18nTime:function(e){var t=e.format(f);if("hA"==f){var i="AM"===t.slice(-2)?p:g;return t.slice(0,-2)+i}return t},renderSettings:function(){this.settingsView.render()}});return m}),define("hbs!galileo/tile/template/goalTile",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/goal","i18n-load!com/fitbit/app/ngd/tile","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,l="";return l+='\n<div class="main ',(n=i.subGoalNumber)?n=n.call(e,{hash:{},data:t}):(n=e.subGoalNumber,n=typeof n===p?n.apply(e):n),l+=g(n)+'">\n    <div class="content">\n        <h2 class="tileTitle">\n            <span class="title">',(n=i.prettyDate)?n=n.call(e,{hash:{},data:t}):(n=e.prettyDate,n=typeof n===p?n.apply(e):n),l+=g(n)+'</span>\n            <span class="tileInfo">?</span>\n        </h2>\n        <div class="goals">\n            <div class="goal '+g((n=e.mainGoal,n=null==n||n===!1?n:n.name,typeof n===p?n.apply(e):n))+'">\n                <div class="meter" data-percent="'+g((n=e.mainGoal,n=null==n||n===!1?n:n.percent,typeof n===p?n.apply(e):n))+'" data-name="'+g((n=e.mainGoal,n=null==n||n===!1?n:n.name,typeof n===p?n.apply(e):n))+'" data-sizeclass="large"></div>\n                <div class="icon-image fitglyph fitglyph-'+g((n=e.mainGoal,n=null==n||n===!1?n:n.name,typeof n===p?n.apply(e):n))+'"></div>\n                <div class="metricText">\n                    <div class="metricContainer absoluteContainer">\n                        <span class="number">'+g((n=e.mainGoal,n=null==n||n===!1?n:n.absolute,typeof n===p?n.apply(e):n))+'</span>\n                        <span class="unit">'+g((n=e.mainGoal,n=null==n||n===!1?n:n.units,typeof n===p?n.apply(e):n))+'</span>\n                        <div class="praise"></div>\n                    </div>\n                    <div class="metricContainer percentContainer">\n                        <span class="number">'+g((n=e.mainGoal,n=null==n||n===!1?n:n.percent,typeof n===p?n.apply(e):n))+'%</span>\n                        <span class="goalTarget">',s={hash:{},data:t},n=i.i18n,a=n?n.call(e,"of_goal_of",s):m.call(e,"i18n","of_goal_of",s),(a||0===a)&&(l+=a),l+=" "+g((n=e.mainGoal,n=null==n||n===!1?n:n.goal,typeof n===p?n.apply(e):n))+'</span>\n                        <span class="unit">'+g((n=e.mainGoal,n=null==n||n===!1?n:n.units,typeof n===p?n.apply(e):n))+'</span>\n                    </div>\n                </div>\n            </div>\n            <div class="smallGoals">\n                ',s={hash:{},inverse:f.noop,fn:f.program(2,o,t),data:t},(a=i.subGoals)?a=a.call(e,s):(a=e.subGoals,a=typeof a===p?a.apply(e):a),i.subGoals||(a=v.call(e,a,s)),(a||0===a)&&(l+=a),l+='\n            </div>\n        </div>\n    </div>\n    <div class="controls">\n        <ul class="controlsList">\n            <li class="control settingsButton leftSide showSettings">\n                <a title="Settings">\n                    <i class="fitglyph fitglyph-show-settings size-f"></i>\n                </a>\n            </li>\n            <li class="control more largeRight">\n                <a href="/activities" title="See_More">\n                    <i class="fitglyph fitglyph-arrow-right size-f"></i>\n                    <span class="controlsLabel arrow-right">',s={hash:{},data:t},n=i.i18n,a=n?n.call(e,"See_More",s):m.call(e,"i18n","See_More",s),(a||0===a)&&(l+=a),l+="</span>\n                </a>\n            </li>\n        </ul>\n    </div>\n</div>\n"}function o(e,t){var n,a,s,o="";return o+="\n                ",s={hash:{},inverse:f.noop,fn:f.program(3,l,t),data:t},n=i["i18n-namespace"],a=n?n.call(e,"com.fitbit.app.ngd.goal","com.fitbit.app.ngd.tile",s):m.call(e,"i18n-namespace","com.fitbit.app.ngd.goal","com.fitbit.app.ngd.tile",s),(a||0===a)&&(o+=a),o+="\n                "}function l(e,t){var n,a,s,o="";return o+='\n                <div class="goal ',(n=i.name)?n=n.call(e,{hash:{},data:t}):(n=e.name,n=typeof n===p?n.apply(e):n),o+=g(n)+" subGoal"+g((n=t.index,typeof n===p?n.apply(e):n))+'">\n                    <div class="meter" data-percent="',(a=i.percent)?a=a.call(e,{hash:{},data:t}):(a=e.percent,a=typeof a===p?a.apply(e):a),o+=g(a)+'" data-name="',(a=i.name)?a=a.call(e,{hash:{},data:t}):(a=e.name,a=typeof a===p?a.apply(e):a),o+=g(a)+'" data-sizeclass="small"></div>\n                    <div class="icon-image fitglyph fitglyph-',a=i["if"].call(e,e.iconClass,{hash:{},inverse:f.program(6,h,t),fn:f.program(4,r,t),data:t}),(a||0===a)&&(o+=a),o+='"></div>\n                    <div class="metricText">\n                        <div class="metricContainer absoluteContainer">\n                            <span class="number">',(a=i.absolute)?a=a.call(e,{hash:{},data:t}):(a=e.absolute,a=typeof a===p?a.apply(e):a),o+=g(a)+'</span>\n                            <span class="unit">',(a=i.units)?a=a.call(e,{hash:{},data:t}):(a=e.units,a=typeof a===p?a.apply(e):a),o+=g(a)+'</span>\n                            <div class="praise"></div>\n                        </div>\n                        <div class="metricContainer percentContainer">\n                            <span class="number">',(a=i.percent)?a=a.call(e,{hash:{},data:t}):(a=e.percent,a=typeof a===p?a.apply(e):a),o+=g(a)+'%</span>\n                            <span class="goalTarget">',s={hash:{},data:t},n=i.i18n,a=n?n.call(e,"of_goal_of",s):m.call(e,"i18n","of_goal_of",s),(a||0===a)&&(o+=a),o+=" ",(a=i.goal)?a=a.call(e,{hash:{},data:t}):(a=e.goal,a=typeof a===p?a.apply(e):a),o+=g(a)+'</span>\n                            <span class="unit">',(a=i.units)?a=a.call(e,{hash:{},data:t}):(a=e.units,a=typeof a===p?a.apply(e):a),o+=g(a)+"</span>\n                        </div>\n                    </div>\n                </div>\n                "}function r(e,t){
var n;return(n=i.iconClass)?n=n.call(e,{hash:{},data:t}):(n=e.iconClass,n=typeof n===p?n.apply(e):n),g(n)}function h(e,t){var n;return(n=i.name)?n=n.call(e,{hash:{},data:t}):(n=e.name,n=typeof n===p?n.apply(e):n),g(n)}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var c,d,u,p="function",g=this.escapeExpression,f=this,m=i.helperMissing,v=i.blockHelperMissing;return u={hash:{},inverse:f.noop,fn:f.program(1,s,a),data:a},c=i["i18n-namespace"],d=c?c.call(t,"com.fitbit.app.ngd.goal","com.fitbit.app.ngd.tile",u):m.call(t,"i18n-namespace","com.fitbit.app.ngd.goal","com.fitbit.app.ngd.tile",u),d||0===d?d:""});return e.registerPartial("galileo_tile_template_goalTile",t),t}),define("hbs!galileo/tile/template/goalTileSettings",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/goalTile","i18n-load!com/fitbit/app/ngd/activity","i18n-load!com/fitbit/app/ngd/tile","i18n-load!com/fitbit/app/unit","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a,s,d="";return d+='\n<div class="settings">\n    <div class="settingsHeader">\n        <div class="settingsTitle">\n            <!-- check actual string -->\n            <h2 title="weight_title">',s={hash:{}},n=i.i18n,a=n?n.call(e,"activity_goals",s):T.call(e,"i18n","activity_goals",s),(a||0===a)&&(d+=a),d+='</h2>\n        </div>\n    </div>\n    <div class="tabContainer">\n        <nav class="tabs">\n            <ul class="items">\n                <li class="item"><a class="tab daily ',a=i["if"].call(e,e.daily,{hash:{},inverse:k.noop,fn:k.program(2,o,t)}),(a||0===a)&&(d+=a),d+='">',s={hash:{}},n=i.i18n,a=n?n.call(e,"daily",s):T.call(e,"i18n","daily",s),(a||0===a)&&(d+=a),d+='</a></li>\n                <li class="item"><a class="tab weekly ',a=i.unless.call(e,e.daily,{hash:{},inverse:k.noop,fn:k.program(2,o,t)}),(a||0===a)&&(d+=a),d+=' ">',s={hash:{}},n=i.i18n,a=n?n.call(e,"weekly",s):T.call(e,"i18n","weekly",s),(a||0===a)&&(d+=a),d+="</a></li>\n            </ul>\n        </nav>\n    </div>\n        ",a=i["if"].call(e,e.daily,{hash:{},inverse:k.noop,fn:k.program(4,l,t)}),(a||0===a)&&(d+=a),d+='\n    <form class="form">\n        <div class="content">\n            <div class="inputContainer">\n                <div class="setting" data-key="steps" >\n                    ',a=i["if"].call(e,e.daily,{hash:{},inverse:k.noop,fn:k.program(6,r,t)}),(a||0===a)&&(d+=a),d+='\n                    <span class="metric">\n                        <input type="text" class="number" value="',(a=i.steps)?a=a.call(e,{hash:{}}):(a=e.steps,a=typeof a===S?a.apply(e):a),d+=M(a)+'"/>\n                        <label class="unit">'+M((n=e.translations,n=null==n||n===!1?n:n.step,typeof n===S?n.apply(e):n))+'</label>\n                    </span>\n                    <span class="error-message">',s={hash:{}},n=i.i18n,a=n?n.call(e,"invalid_step_goal",s):T.call(e,"i18n","invalid_step_goal",s),(a||0===a)&&(d+=a),d+="</span>\n                </div>\n            </div>\n            ",a=i["if"].call(e,e.daily,{hash:{},inverse:k.noop,fn:k.program(8,h,t)}),(a||0===a)&&(d+=a),d+='\n            <div class="inputContainer">\n                <div class="setting ',a=i["if"].call(e,(n=e.disabledGoals,null==n||n===!1?n:n.distance),{hash:{},inverse:k.noop,fn:k.program(9,c,t)}),(a||0===a)&&(d+=a),d+='" data-key="distance">\n                    ',a=i["if"].call(e,e.daily,{hash:{},inverse:k.noop,fn:k.program(14,p,t)}),(a||0===a)&&(d+=a),d+='\n                    <span class="metric">\n                        <input type="text" class="number" value="',(a=i.distance)?a=a.call(e,{hash:{}}):(a=e.distance,a=typeof a===S?a.apply(e):a),d+=M(a)+'" ',a=i["if"].call(e,(n=e.disabledGoals,null==n||n===!1?n:n.distance),{hash:{},inverse:k.noop,fn:k.program(16,g,t)}),(a||0===a)&&(d+=a),d+='/>\n                        <label class="unit">'+M((n=e.translations,n=null==n||n===!1?n:n.distanceTranslation,typeof n===S?n.apply(e):n))+'</label>\n                    </span>\n                    <span class="error-message">',s={hash:{}},n=i.i18n,a=n?n.call(e,"invalid_miles_goal",s):T.call(e,"i18n","invalid_miles_goal",s),(a||0===a)&&(d+=a),d+="</span>\n                </div>\n            </div>\n            ",a=i["if"].call(e,e.daily,{hash:{},inverse:k.noop,fn:k.program(18,f,t)}),(a||0===a)&&(d+=a),d+="\n            ",a=i["if"].call(e,e.showFloors,{hash:{},inverse:k.noop,fn:k.program(22,y,t)}),(a||0===a)&&(d+=a),d+='\n        </div>\n        <div class="settingsFooter savable">\n            <a class="removeTile removeButton">\n                <i class="fitglyph fitglyph-remove size-g"></i>\n            </a>\n            <button class="dashButton saveSettings saveButton" type="submit">',s={hash:{}},n=i.i18n,a=n?n.call(e,"done",s):T.call(e,"i18n","done",s),(a||0===a)&&(d+=a),d+="</button>\n        </div>\n    </form>\n</div>\n"}function o(e,t){return" selected "}function l(e,t){var n,a,s,o="";return o+='\n        <div class="inputHeader">\n            <span class="checkboxHeader">',s={hash:{}},n=i.i18n,a=n?n.call(e,"disable_checkbox_header",s):T.call(e,"i18n","disable_checkbox_header",s),(a||0===a)&&(o+=a),o+='</span>\n            <span class="textboxHeader">',s={hash:{}},n=i.i18n,a=n?n.call(e,"setting_input_header",s):T.call(e,"i18n","setting_input_header",s),(a||0===a)&&(o+=a),o+="</span>\n        </div>\n        "}function r(e,t){return'\n                    <div class="disabled-checkbox">\n                        <i class="fitglyph fitglyph-check size-g"></i>\n                    </div>\n                    '}function h(e,t){var n,a,s,o="";return o+='\n            <div class="inputContainer">\n                <div class="setting ',a=i["if"].call(e,(n=e.disabledGoals,null==n||n===!1?n:n.caloriesOut),{hash:{},inverse:k.noop,fn:k.program(9,c,t)}),(a||0===a)&&(o+=a),o+='" data-key="caloriesOut">\n                    <div class="checkbox">\n                        <i class="fitglyph fitglyph-check size-g"></i>\n                    </div>\n                    <span class="metric">\n                        <input type="text" class="number" value="',(a=i.caloriesOut)?a=a.call(e,{hash:{}}):(a=e.caloriesOut,a=typeof a===S?a.apply(e):a),o+=M(a)+'" ',a=i["if"].call(e,e.caloriesDisabled,{hash:{},inverse:k.noop,fn:k.program(12,u,t)}),(a||0===a)&&(o+=a),o+=' />\n                        <label class="unit">'+M((n=e.translations,n=null==n||n===!1?n:n.calorieReduced,typeof n===S?n.apply(e):n))+'</label>\n                    </span>\n                    <span class="error-message">',s={hash:{}},n=i.i18n,a=n?n.call(e,"invalid_cals_goal",s):T.call(e,"i18n","invalid_cals_goal",s),(a||0===a)&&(o+=a),o+="</span>\n                </div>\n            </div>\n            "}function c(e,t){var n;return n=i["if"].call(e,e.daily,{hash:{},inverse:k.noop,fn:k.program(10,d,t)}),n||0===n?n:""}function d(e,t){return"disabledGoal"}function u(e,t){return'readonly="readonly"'}function p(e,t){return'\n                    <div class="checkbox">\n                        <i class="fitglyph fitglyph-check size-g"></i>\n                    </div>\n                    '}function g(e,t){var n;return n=i["if"].call(e,e.daily,{hash:{},inverse:k.noop,fn:k.program(12,u,t)}),n||0===n?n:""}function f(e,t){var n,a="";return a+="\n                ",n=i["if"].call(e,e.showActiveMinutes,{hash:{},inverse:k.noop,fn:k.program(19,m,t)}),(n||0===n)&&(a+=n),a+="\n            "}function m(e,t){var n,a,s,o="";return o+='\n                <div class="inputContainer">\n                    <div class="setting ',a=i["if"].call(e,(n=e.disabledGoals,null==n||n===!1?n:n.activeMinutes),{hash:{},inverse:k.noop,fn:k.program(9,c,t)}),(a||0===a)&&(o+=a),o+='" data-key="activeMinutes">\n                        <div class="checkbox">\n                            <i class="fitglyph fitglyph-check size-g"></i>\n                        </div>\n                        <span class="metric">\n                            <input type="text" class="number" value="',(a=i.activeMinutes)?a=a.call(e,{hash:{}}):(a=e.activeMinutes,a=typeof a===S?a.apply(e):a),o+=M(a)+'" ',a=i["if"].call(e,(n=e.disabledGoals,null==n||n===!1?n:n.activeMinutes),{hash:{},inverse:k.noop,fn:k.program(20,v,t)}),(a||0===a)&&(o+=a),o+='/>\n                            <label class="unit">'+M((n=e.translations,n=null==n||n===!1?n:n.activeMinuteReduced,typeof n===S?n.apply(e):n))+'</label>\n                        </span>\n                        <span class="error-message">',s={hash:{}},n=i.i18n,a=n?n.call(e,"invalid_active_mins_goal",s):T.call(e,"i18n","invalid_active_mins_goal",s),(a||0===a)&&(o+=a),o+="</span>\n                    </div>\n                </div>\n                "}function v(e,t){return' readonly="readonly"'}function y(e,t){var n,a,s,o="";return o+='\n            <div class="inputContainer">\n                <div class="setting ',a=i["if"].call(e,(n=e.disabledGoals,null==n||n===!1?n:n.floors),{hash:{},inverse:k.noop,fn:k.program(9,c,t)}),(a||0===a)&&(o+=a),o+='" data-key="floors">\n                    ',a=i["if"].call(e,e.daily,{hash:{},inverse:k.noop,fn:k.program(14,p,t)}),(a||0===a)&&(o+=a),o+='\n                    <span class="metric">\n                        <input type="text" class="number" value="',(a=i.floors)?a=a.call(e,{hash:{}}):(a=e.floors,a=typeof a===S?a.apply(e):a),o+=M(a)+'" ',a=i["if"].call(e,(n=e.disabledGoals,null==n||n===!1?n:n.floors),{hash:{},inverse:k.noop,fn:k.program(23,b,t)}),(a||0===a)&&(o+=a),o+='/>\n                        <label class="unit">'+M((n=e.translations,n=null==n||n===!1?n:n.floor,typeof n===S?n.apply(e):n))+'</label>\n                    </span>\n                    <span class="error-message">',s={hash:{}},n=i.i18n,a=n?n.call(e,"invalid_floors_goal",s):T.call(e,"i18n","invalid_floors_goal",s),(a||0===a)&&(o+=a),o+="</span>\n                </div>\n            </div>\n            "}function b(e,t){var n;return n=i["if"].call(e,e.daily,{hash:{},inverse:k.noop,fn:k.program(20,v,t)}),n||0===n?n:""}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var w,_,x,T=i.helperMissing,k=this,S="function",M=this.escapeExpression;return x={hash:{},inverse:k.noop,fn:k.program(1,s,a)},w=i["i18n-namespace"],_=w?w.call(t,"com.fitbit.app.ngd.goalTile","com.fitbit.app.ngd.activity","com.fitbit.app.ngd.tile","com.fitbit.app.unit",x):T.call(t,"i18n-namespace","com.fitbit.app.ngd.goalTile","com.fitbit.app.ngd.activity","com.fitbit.app.ngd.tile","com.fitbit.app.unit",x),_||0===_?_:""});return e.registerPartial("galileo_tile_template_goalTileSettings",t),t}),define("galileo/model/WeeklyGoalModel",["require","exports","module","galileo/model/SharedModel","underscore","shared/scripts/modules/api-client"],function(e,t,i){var n=e("galileo/model/SharedModel"),a=e("underscore"),s=1,o=e("shared/scripts/modules/api-client"),l=n.extend({initialize:function(e,t){l.__super__.initialize.apply(this,arguments),this.user=t&&t.user},url:function(){return o.makeFullUrl("/"+s+"/user/"+this.user.encodedId+"/activities/goals/weekly.json")},lookup:function(e,t){return t.user&&i.uri+"_"+t.user.encodedId},parse:function(e){return e.goals&&(e=e.goals),e},validate:function(e){var t=[];return a.isEmpty(e)?"no attributes":(a.each(e,function(e,i){(0>=e||a.isNaN(e))&&t.push(i)}),t.length?t:!1)},sync:function(e,t,i){return"read"!==e&&(i.data=t.toJSON(),i.emulateJSON=!0),i.useDistanceUnitSystem=!0,l.__super__.sync.call(this,e,t,i)}});return l}),define("galileo/model/DailyGoalModel",["require","exports","module","galileo/model/SharedModel","shared/scripts/modules/api-client","underscore"],function(e,t,i){var n=e("galileo/model/SharedModel"),a=e("shared/scripts/modules/api-client"),s=e("underscore"),o=1,l=n.extend({initialize:function(e,t){l.__super__.initialize.apply(this,arguments),this.user=t&&t.user},url:function(){return a.makeFullUrl("/"+o+"/user/"+this.user.encodedId+"/activities/goals/daily.json")},lookup:function(e,t){return t.user&&i.uri+"_"+t.user.encodedId},parse:function(e){return e.goals&&(e=e.goals),e},validate:function(e){var t=[];return s.isEmpty(e)?"no attributes":(s.each(e,function(e,i){(0>=e||s.isNaN(e))&&t.push(i)}),t.length?t:!1)},sync:function(e,t,i){return"read"!==e&&(i.data=t.toJSON(),i.emulateJSON=!0),i.useDistanceUnitSystem=!0,l.__super__.sync.call(this,e,t,i)}});return l}),define("galileo/model/ActivityModel",["require","exports","module","galileo/model/user","underscore","shared/scripts/modules/api-client","galileo/model/SharedModel","galileo/model/DailyGoalModel","galileo/util/dateUtil","backbone"],function(e,t,i){var n=e("galileo/model/user").viewer,a=e("underscore"),s=1,o=e("shared/scripts/modules/api-client"),l=e("galileo/model/SharedModel"),r=e("galileo/model/DailyGoalModel"),h=e("galileo/util/dateUtil"),c=e("backbone"),d=l.extend({user:n,initialize:function(e,t){d.__super__.initialize.apply(this,arguments),this.user=t&&t.user},url:function(){return o.makeFullUrl("/"+s+"/user/"+this.user.encodedId+"/activities/date/"+h.ajaxEncode(this.get("date"))+".json")},lookup:function(e,t){return i.uri+"_"+t.user.encodedId+"_"+h.ajaxEncode(e.date)},validate:function(e){return a.isEmpty(e)?"no attributes":e.goals&&e.goals instanceof c.Model&&e.goals.isValid()?!e.summary||a.isEmpty(e.summary)?"summary data missing":void 0:"daily goals not a valid backbone model"},parse:function(e){var t=this,i=a.findWhere(e.summary.distances,{activity:"total"});e.summary.distance=i&&i.distance,e.summary.activeMinutes=e.summary.veryActiveMinutes+e.summary.fairlyActiveMinutes;var n=e.goals=new r(e.goals,{user:this.user,validate:!0});return n.on("invalid",function(){t.trigger.apply(t,["invalid"].concat(a.toArray(arguments)))}),e},fetch:function(e){e=e||{},e.useDistanceUnitSystem=!0,d.__super__.fetch.call(this,e)}});return d}),define("galileo/tile/goalTile",["require","i18n/i18n","hbs!./template/goalTile","hbs!./template/goalTileSettings","galileo/tile/BackboneTile","underscore","galileo/model/WeeklyGoalModel","galileo/model/ActivityModel","galileo/graphic/goalBar","galileo/color/graph","galileo/util/dateUtil","galileo/model/user","galileo/widget/TourPopup","i18n-load!com/fitbit/util/dateutil","i18n-load!com/fitbit/app/unit","i18n-load!com/fitbit/app/ngd/goalTile"],function(e){var t=e("i18n/i18n")(),i=e("hbs!./template/goalTile"),n=e("hbs!./template/goalTileSettings"),a=e("galileo/tile/BackboneTile"),s=e("underscore"),o=e("galileo/model/WeeklyGoalModel"),l=e("galileo/model/ActivityModel"),r=e("galileo/graphic/goalBar"),h=e("galileo/color/graph"),c=e("galileo/util/dateUtil"),d=e("galileo/model/user").viewer,u=e("galileo/widget/TourPopup"),p=144,g=16,f=92,m=102,v=11,y=500,b="MMMM dd";t.namespace(e("i18n-load!com/fitbit/util/dateutil")),t.namespace(e("i18n-load!com/fitbit/app/unit")),t.namespace(e("i18n-load!com/fitbit/app/ngd/goalTile"));var w=t.plural("US"===d.heightSystem?"mile":"km"),_=function(e){return["zero","one","two","three","four"][e]||""},x=[{range:[-(1/0),0],goalColors:h.goalTile.INACTIVE},{range:[0,.33],goalColors:h.goalTile.SEDENTARY},{range:[.33,.66],goalColors:h.goalTile.LIGHTLY_ACTIVE},{range:[.66,1],goalColors:h.goalTile.MODERATELY_ACTIVE},{range:[1,1/0],goalColors:h.goalTile.VERY_ACTIVE}],T=function(e){return s.find(x,function(t){var i=t.range;return e>=i[0]&&e<i[1]?t:void 0})},k=a.extend({title:t("goal_tile"),tileName:"goalTile",shape:"tall",events:{"keypress .error input":"hideError","click .error input":"hideError","submit .form":"saveSettings","click .tabs .daily":"selectDaily","click .tabs .weekly":"selectWeekly","click .tileInfo":"showPopup","click .checkbox":"selectSetting"},daily:!0,selectWeekly:function(){this.daily=!1,this.render()},selectDaily:function(){this.daily=!0,this.render()},selectSetting:function(e){var t=$(e.target).closest(".setting"),i=t.find(".number"),n=t.data("key"),a=this.user.getSettingsModel().get("disabledGoals")||{};a[n]?(t.removeClass("disabledGoal"),a[n]=!1,i.removeProp("readonly")):(t.addClass("disabledGoal"),a[n]=!0,i.prop("readonly",!0)),this.user.getSettingsModel().set("disabledGoals",a)},saveSettings:function(e){var t,i=this.$(".setting input"),n={};this.user.getSettingsModel().save(),i.each(function(){var e=$(this),t=e.closest(".setting").data("key");n[t]=+e.val()}),t=this.daily?this.model.get("goals"):this.weeklyGoals;var a=t.save(n);return a&&this.hideSettings(),e&&e.preventDefault(),a},initialize:function(e){k.__super__.initialize.apply(this,arguments),e=e||{};var t=this.date=e.date,i=this.user=e.user;this.showActiveMinutes=!i.isOnlySoftTrackerUser&&i.getTrackerType(),this.showFloors=i.deviceFeatures.ELEVATION,this.popup=new u({className:"tiles-tooltip",closeOnClick:!0,states:this.getPopupStates()}),this.model||(this.model=new l({date:t},{user:i}));var n=this.model;this.listenToModel(n),this.on("changeDate",function(e){var t=this.date=e.date;this.stopListening(n),n=this.model=new l({date:t},{user:this.user}),this.listenToModel(n),n.isValid()?this.render():n.fetch()});var a=this.weeklyGoals=new o(null,{user:i});this.listenToModel(a),this.on("showSettings hideSettings",function(){this.render()}),n.isValid()||n.fetch(),a.isValid()||a.fetch({validate:!0}),n.isValid()&&this.render()},listenToModel:function(e){this.listenTo(e,"change",function(){this.model.isValid()&&this.render()}),this.listenTo(e,"invalid",function(e,t){this.showErrors(t)})},getPopupStates:function(){var e=this,i=this.user.getSettingsModel().get("disabledGoals")||{},n=[{header:t("steps_popup_h3"),body:t("steps_popup_msg"),link:t("steps_link")}];return i.caloriesOut||n.push({header:t("calories_popup_h3"),body:t("calories_popup_msg"),link:t("calories_link")}),i.distance||n.push({header:t("distance_popup_h3"),body:t("distance_popup_msg"),link:t("distance_link")}),this.showActiveMinutes&&!i.activeMinutes&&n.push({header:t("active_mins_popup_h3"),body:t("include_moderate_popup_msg"),link:t("active_minutes_link")}),this.showFloors&&!i.floors&&n.push({header:t("floors_popup_h3"),body:t("floors_popup_msg"),link:t("floors_link")}),s.each(n,function(t,i){t.anchor=function(){return e.$(".meter").eq(i)}}),n},showErrors:function(e){return this.showingSettings?(this.$el.addClass("error"),void this.$(".setting").filter(function(){return s.contains(e,$(this).data("key"))}).addClass("error").find("input").addClass("error")):!1},hideError:function(e){var t=$(e.target).closest(".setting");t.removeClass("error").find("input").removeClass("error"),this.$(".setting.error").length||this.$el.removeClass("error")},getStrWeekday:function(e){var i;return i=c.isToday(e)?t.inNamespace("com.fitbit.util.dateutil")("today"):c.isYesterday(e)?t("yesterday"):c.localeFormat(e,b)},render:function(){var e,a=this.user.getSettingsModel().get("disabledGoals")||{},o=this.model.get("summary"),l=this.model.get("date"),r=this.model.get("goals").toJSON(),h=this.showActiveMinutes,d=this.showFloors;if(this.showingSettings){this.daily||(r=this.weeklyGoals.toJSON());var p={step:t.plural("step")(10),calorieReduced:t.plural("calorie_reduced")(10),distanceTranslation:w(10),activeMinuteReduced:t.plural("active_minute_reduced")(10),floor:t.plural("floor")(10)};this.$el.html(n(s.extend({daily:this.daily,showFloors:d,showActiveMinutes:h,caloriesDisabled:this.user.hasTrainerPlan()||a.caloriesOut,disabledGoals:a},r,{translations:p})))}else{this.popup=new u({className:"tiles-tooltip",closeOnClick:!0,states:this.getPopupStates()});var g=function(e){var t=Math.round(e);return t>=100&&100>e&&t--,t||0};e={showingToday:c.isToday(l),prettyDate:this.getStrWeekday(l),mainGoal:{name:"steps",percent:g(o.steps/r.steps*100),absolute:this.formatNumber(o.steps),units:t.plural("step")(o.steps),goal:this.formatNumber(r.steps)},subGoals:[]},a.caloriesOut||e.subGoals.push({name:"caloriesOut",iconClass:"calories",percent:g(o.caloriesOut/r.caloriesOut*100),absolute:this.formatNumber(o.caloriesOut),units:t.plural("calorie_reduced")(o.caloriesOut),goal:this.formatNumber(r.caloriesOut)}),a.distance||e.subGoals.push({name:"distance",percent:g(o.distance/r.distance*100),absolute:this.formatNumber(o.distance,"#,##0.##"),units:w(o.distance),goal:this.formatNumber(r.distance,"#,##0.##")}),!a.activeMinutes&&h&&e.subGoals.push({name:"activeMinutes",percent:g(o.activeMinutes/r.activeMinutes*100),absolute:this.formatNumber(o.activeMinutes),units:t.plural("active_minute_reduced")(o.activeMinutes),goal:this.formatNumber(r.activeMinutes)}),!a.floors&&d&&e.subGoals.push({name:"floors",percent:g(o.floors/r.floors*100),absolute:this.formatNumber(o.floors),units:t.plural("floor")(o.floors),goal:this.formatNumber(r.floors)});var f=e.subGoals.length;e.subGoalNumber=_(f),this.$el.html(i(e)),this.animateArcs(this.makeMeters(f>2))}return this.trigger("render"),this.rendered=!0,this},makeMeters:function(e){return this.$(".meter").map(function(){var t,i,n=$(this),a=n.data("percent")/100,s=n.data("sizeclass");"large"===s?(t=p,i=g):(t=e?f:m,i=v),n.width(t);var o=new r.Arc(n[0],{width:t,height:t,radius:t/2-i/2,stroke:i});return o.goal=a,o.$el=n,o.setProgress(0),o.setColors(T(a).goalColors),o}).get()},celebrationAnimation:function(e){e.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){e.removeClass("animate-to-star").addClass("star"),e.outerWidth(e.outerWidth()),e.addClass("animate-star"),s.delay(function(){e.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){e.removeClass("flip-back-star star").addClass("flip-back-icon")}),e.removeClass("animate-star").addClass("flip-back-star limeify")},2e3)}),e.addClass("animate-to-star")},animateArcs:function(e){var t=this,i=jQuery&&jQuery.fx.interval||15,n=function(e){var t=1-Math.pow(1-e,3);return t>1?1:t},a=0,o=setInterval(function(){var l=n(a/y);s.each(e,function(i){var n=i.goal*l;i.setProgress(n),n>=1&&(t.celebrationAnimation(i.$el.next(".icon-image")),e=s.without(e,i))}),a+=i,1===l&&clearInterval(o)},i)},showPopup:function(){return this.popup.render().showAtIndex(0),!1},formatNumber:function(e,t){return e?this.user.formatNumber(e,t||"#,###"):0}});return k}),define("hbs!galileo/graph/template/tooltipCals",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){return"goalMet"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,l="",r=this,h="function",c=this.escapeExpression;return l+='<div class="graphTip ',o=i["if"].call(t,t.goalMet,{hash:{},inverse:r.noop,fn:r.program(1,s,a)}),(o||0===o)&&(l+=o),l+='">\n    <div class="date">\n        ',(o=i.date)?o=o.call(t,{hash:{}}):(o=t.date,o=typeof o===h?o.apply(t):o),l+=c(o)+'\n    </div>\n    <div class="details cals_burned">\n        ',(o=i.calsBurned)?o=o.call(t,{hash:{}}):(o=t.calsBurned,o=typeof o===h?o.apply(t):o),(o||0===o)&&(l+=o),l+="\n    </div>\n</div>\n\n"});return e.registerPartial("galileo_graph_template_tooltipCals",t),t}),define("hbs!galileo/graph/template/tooltipCalsIntake",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var s,o="",l="function",r=this.escapeExpression;return o+='<div class="graphTip">\n    <div class="date">\n        ',(s=i.date)?s=s.call(t,{hash:{}}):(s=t.date,s=typeof s===l?s.apply(t):s),o+=r(s)+'\n    </div>\n    <div class="details cals_burned">\n        <span class="icon"></span>\n        ',(s=i.calsBurned)?s=s.call(t,{hash:{}}):(s=t.calsBurned,s=typeof s===l?s.apply(t):s),(s||0===s)&&(o+=s),o+='\n    </div>\n    <div class="details cals_intake">\n        <span class="icon"></span>\n        ',(s=i.calsEaten)?s=s.call(t,{hash:{}}):(s=t.calsEaten,s=typeof s===l?s.apply(t):s),(s||0===s)&&(o+=s),o+='\n    </div>\n    <div class="details cals_diff">\n        <span class="icon"></span>\n        ',(s=i.calsDiff)?s=s.call(t,{hash:{}}):(s=t.calsDiff,s=typeof s===l?s.apply(t):s),(s||0===s)&&(o+=s),o+="\n     </div>\n</div>\n\n"});return e.registerPartial("galileo_graph_template_tooltipCalsIntake",t),t}),define("galileo/graph/caloriesBurnVsIntake",["require","mootools","./base","../color/graph","./configs/activity","./tooltip","i18n/i18n","galileo/model/user","./graphUtil","galileo/util/dateUtil","galileo/widget/metric","underscore","hbs!./template/tooltipCals","hbs!./template/tooltipCalsIntake","i18n-load!com/fitbit/app/unit"],function(e){e("mootools");var t=e("./base"),i=e("../color/graph"),n=e("./configs/activity"),a=e("./tooltip"),s=e("i18n/i18n")(),o=e("galileo/model/user").viewer,l=o.activities(),r=e("./graphUtil"),h=e("galileo/util/dateUtil"),c=e("galileo/widget/metric"),d=e("underscore"),u=e("hbs!./template/tooltipCals"),p=e("hbs!./template/tooltipCalsIntake"),g=2;return s.namespace(e("i18n-load!com/fitbit/app/unit")),function(e,s,f,m,v,y,b,w){f=f||new Date,w=w||{};var _=$("<div>").width(e).height(s),x=1===b,T=x?"EEE":"E",b=b||g;w.endOnToday="undefined"==typeof w.endOnToday?!1:w.endOnToday;var k=r(f,b,o.startDayOfWeek,w.leftMargin,w.rightMargin,T,w.endOnToday),S=l.loadDays.bind(l,"caloriesBurnedVsIntake",h.ajaxEncode(k.getStartDate()),h.ajaxEncode(f),"DAILY"),M=l.loadSummary.bind(l,"calories-burned",f);return Function.join(S,M,function(l,r){function f(e,t){return e.y>=t?{linearGradient:n.chart_column_gradient,stops:i.columnGradients.lime}:{linearGradient:n.chart_column_gradient,stops:i.columnGradients.teal}}var T,S,M=Object.clone(l.dataSets),C=[],D=Number(r.dailyGoal),A=v?.1:0;if(w.updateTileFooter&&w.updateTileFooter(v?null:r),k.setNumWeeks(b||g),v)for(var G=Math.min(M.caloriesIntake.dataPoints.length,M.activity.dataPoints.length),E=0;G>E;E++){var P=M.activity.dataPoints[E],I=M.caloriesIntake.dataPoints[E];P.burned=P.value,P.intake=I.value,I.burned=P.value,I.intake=I.value}else delete M.caloriesIntake;Object.each(M,function(e,t){var i=k.modifySeries(e.dataPoints.map(function(e){return{x:h.ajaxDecode(e.dateTime),y:Number(e.value),burned:e.burned,intake:e.intake,name:t}})),n=w.getColumnGradient?w.getColumnGradient:f;i.each(function(e){e.low=-1e4,e.color=n(e,D)}),C.push({name:t,data:i})});var L={fontFamily:n.labelStyle.fontFamily,fontSize:n.labelStyle.fontSize,color:i.labelText};C.sort(function(e){return"caloriesIntake"===e.name?-1:1}),S=x?n.column.weekWidth:n.column.weeksWidth;var F={chart:{animation:!1,marginLeft:0,marginRight:0,type:"column",events:{load:function(){var e=this.axes[1].getExtremes().max,t=this.plotSizeY,a=this.plotTop+t*(1-D/e),s=n.marginRect;this.renderer.path(["M",this.plotLeft,a,"L",this.plotLeft+this.plotSizeX,a]).attr({stroke:i.goal_line,dashstyle:n.goalLine.dashstyle,"stroke-width":n.goalLine.strokeWidth,zIndex:1}).add(),(!v||w.cutGoalLine)&&this.renderer.rect(s.x,s.y,s.width,s.height,s.radius).attr({fill:i.graphBgFill,zIndex:s.zIndex}).add()}}},plotOptions:{column:{pointPadding:0,pointWidth:w.colWidth?w.colWidth:S,groupPadding:w.groupPadding?w.groupPadding:A,borderWidth:0,shadow:!1}},xAxis:k.getXAxisOptions(x),yAxis:{showFirstLabel:!1,labels:{align:n.yAxisLabel.alignment,x:n.yAxisLabel.yAxisLabels_x,y:n.yAxisLabel.yAxisLabels_y,style:L,formatter:function(){return o.formatNumber(this.value,"#,##0.#")}},gridLineColor:i.yAxis},tooltip:{enabled:!1},series:C};w.alternateLayout&&(F.xAxis.lineColor=i.xAxis,F.xAxis.labels.style=L,F.xAxis.labels.y=16,F.yAxis.gridLineColor=i.yAxis,F.yAxis.gridLineWidth=1,F.yAxis.labels.style=L,F.yAxis.labels.formatter=function(){return this.value?o.thousands(this.value):""}),T=t(_,e,s,Object.merge(F,a.chartMixin(function(){var e,t;if(!this.date)return null;if(v){var i=new c(y,!1,!0),n=new c(y,!1,!0),a=new c(y,!1,!0);i.update(this.burned),n.update(this.intake),a.update(this.intake-this.burned),t=w.tooltipTemplate?w.tooltipTemplate:p,e=$(t({date:h.localeFormat(this.date,"MMM dd"),calsBurned:i.elements().html(),calsEaten:n.elements().html(),calsDiff:a.elements().html(),calsClass:w.getCalsClass?w.getCalsClass(n.getValue(),D):""}))}else{var i=new c(y,!1,!0);i.update(this.y),e=$(u({date:h.localeFormat(this.date,"MMM dd"),calsBurned:i.elements().html(),goalMet:this.y>=D}))}return e}))),x?d.isNumber(w.weekAxisMin)&&d.isNumber(w.weekAxisMax)&&T.xAxis[0].setExtremes(w.weekAxisMin,w.weekAxisMax,!0):d.isNumber(w.weeksAxisMin)&&d.isNumber(w.weeksAxisMax)&&T.xAxis[0].setExtremes(w.weeksAxisMin,w.weeksAxisMax,!0),m&&m(l,r)}),_}}),define("galileo/graph/weeksBeta",["require","mootools","./base","./caloriesBurnVsIntake","../color/graph","./configs/activity","./tooltip","i18n/i18n","galileo/model/user","./graphUtil","galileo/util/dateUtil","galileo/model/sleep","galileo/widget/metric","underscore","i18n-load!com/fitbit/app/unit"],function(e){e("mootools");var t=e("./base"),i=e("./caloriesBurnVsIntake"),n=e("../color/graph"),a=e("./configs/activity"),s=e("./tooltip"),o=e("i18n/i18n")(),l=e("galileo/model/user").viewer,r=e("./graphUtil"),h=e("galileo/util/dateUtil"),c=l.activities(),d=e("galileo/model/sleep"),u=e("galileo/widget/metric"),p=e("underscore");o.namespace(e("i18n-load!com/fitbit/app/unit"));var g={series_name:"steps",width:0,height:0,date:new Date,precision:0,readySummary:null,weeks:4,hideDateString:!1,goalColor:n.goal_line,maxY:null},f=[{unitPlural:o.plural("calorie"),unitThreshold:1/0,format:"#,##0"}];return function(e){function o(i,o){function r(e){var t=0;return e.values?e.values.forEach(function(e){t+=Number(e)}):t=Number(e.value),{x:h.ajaxDecode(e.dateTime),y:t}}function c(e){return e.y>=v?{linearGradient:a.chart_column_gradient,stops:n.columnGradients.lime}:{linearGradient:a.chart_column_gradient,stops:n.columnGradients.teal}}var d,g=i.dataSets,f=[],v=Number(o.dailyGoal),b=1===e.weeks,w=n.xAxis,_=y.getXAxisOptions(b);Object.each(g,function(t,i){var n;t.dataPoints=t.dataPoints?t.dataPoints:[{dateTime:h.ajaxEncode(e.date),value:0}],n=y.modifySeries(t.dataPoints.map(r)),n.each(function(e,t){e.low=-1e4,e.color=c(e)}),f.push({name:i,data:n})}),_.lineColor=w,_.labels.y=16,_.lineWidth=2;var x={chart:{animation:!1,marginLeft:0,marginRight:0,type:"column",events:{load:function(){var e=this.axes[1].getExtremes().max,t=this.plotSizeY,i=this.plotTop+t*(1-v/e),s=a.marginRect;o.dailyGoal&&(this.renderer.path(["M",this.plotLeft,i,"L",this.plotLeft+this.plotSizeX,i]).attr({stroke:n.goal_line,dashstyle:a.goalLine.dashstyle,"stroke-width":a.goalLine.strokeWidth,zIndex:1}).add(),this.renderer.rect(s.x,s.y,s.width,s.height,s.radius).attr({fill:n.graphBgFill,zIndex:s.zIndex}).add())}}},plotOptions:{column:{pointPadding:0,groupPadding:0,borderWidth:0,shadow:!1,pointWidth:b?a.column.weekWidth:a.column.weeksWidth},series:{}},xAxis:_,yAxis:{max:e.maxY,gridLineWidth:1,gridLineColor:w,minorGridLineColor:w,showFirstLabel:!1,labels:{style:{fontFamily:a.labelStyle.fontFamily,fontSize:a.labelStyle.fontSize,color:n.labelText},align:a.yAxisLabel.alignment,x:a.yAxisLabel.yAxisLabels_x,y:a.yAxisLabel.yAxisLabels_y,formatter:function(){return'<span class="yAxisLabel">'+l.thousands(this.value)+"</span>"}}},tooltip:{enabled:!1},series:f,legend:{enabled:!1}};d=t(m,e.width,e.height,Object.merge(x,s.chartMixin(function(){if(!this.date)return null;var t=new u(e.tooltipFormat);t.update(this.y);var i=$('<div class="graphTip">').append($('<div class="date">').text(h.localeFormat(this.date,"EEE, MMM d")),$('<div class="details">').append(t.elements()));return this.y>=v&&i.addClass("goalMet"),i}))),b?p.isNumber(e.weekAxisMin)&&p.isNumber(e.weekAxisMax)&&d.xAxis[0].setExtremes(e.weekAxisMin,e.weekAxisMax,!0):p.isNumber(e.weeksAxisMin)&&p.isNumber(e.weeksAxisMax)&&d.xAxis[0].setExtremes(e.weeksAxisMin,e.weeksAxisMax,!0)}var e=Object.merge({},g,e);e.date=e.date||new Date;var m=$("<div>").addClass(e.series_name).width(e.width).height(e.height),v=1===e.weeks?"EEE":"E",y=r(e.date,e.weeks,l.startDayOfWeek,e.marginLeft||0,e.marginRight||0,v,e.endOnToday);if("sleepQualityScoreA"==e.series_name||"sleepQualityScoreB"==e.series_name)Function.join(d.loadDaysforGraph.bind(d,y.getStartDate(),e.date,e.series_name),d.loadSummary.bind(d,y.getStartDate(),e.date,e.series_name),o);else if("calories-burned"===e.series_name)m.append(i(e.width,e.height,e.date,function(){},!1,f,e.weeks,e));else{var b;b="active-minutes"===e.series_name?"minutesActive":e.series_name,Function.join(c.loadDays.bind(c,b,y.getStartDate(),e.date,"DAILY"),c.loadSummary.bind(c,e.series_name,e.date),o);
}return m}}),define("galileo/graph/weekBeta",["require","mootools","galileo/graph/weeksBeta"],function(e){e("mootools");var t=e("galileo/graph/weeksBeta");return function(e){var i={weeks:1,borderRadius:16,hideDateString:!0};return e=Object.merge({},i,e),t(e)}}),define("hbs!galileo/tile/template/TripleWideActivity",["handlebars","galileo/tile/template/helpers/i18n-namespace","i18n-load!com/fitbit/app/ngd/activity","i18n-load!com/fitbit/app/ngd/tile","galileo/tile/template/helpers/i18n"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a="";return a+="\n",n=i["if"].call(e,e.showingSettings,{hash:{},inverse:y.program(4,l,t),fn:y.program(2,o,t)}),(n||0===n)&&(a+=n),a+="\n"}function o(e,t){var n,a,s,o="";return o+='\n<div class="settings">\n    <div class="settingsHeader">\n        <div class="settingsTitle">\n            <h2 title="activity_title">',s={hash:{}},n=i.i18n,a=n?n.call(e,"Remove_tile",s):f.call(e,"i18n","Remove_tile",s),(a||0===a)&&(o+=a),o+='</h2>\n        </div>\n    </div>\n    <div class="content">\n        <div>\n            <a class="removeTile removeButton">\n                <i class="fitglyph fitglyph-remove size-c"></i>\n                <span class="controlsLabel remove">',s={hash:{}},n=i.i18n,a=n?n.call(e,"Remove_tile",s):f.call(e,"i18n","Remove_tile",s),(a||0===a)&&(o+=a),o+='</span>\n            </a>\n        </div>\n    </div>\n    <div class="settingsFooter">\n        <a class="dashButton saveSettings saveButton">',s={hash:{}},n=i.i18n,a=n?n.call(e,"done",s):f.call(e,"i18n","done",s),(a||0===a)&&(o+=a),o+="</a>\n    </div>\n</div>\n"}function l(e,t){var n,a,s,o="";return o+='\n<div class="main">\n    <div class="content">\n        <h2 class="tileTitle">\n            <span class="title">',(n=i.title)?n=n.call(e,{hash:{}}):(n=e.title,n=typeof n===m?n.apply(e):n),o+=v(n)+'</span>\n            <span class="tileInfo">?</span>\n        </h2>\n        <div class="graph-container">\n            <nav class="graph-controls">\n                <select class="series" title="',s={hash:{}},n=i.i18n,a=n?n.call(e,"series",s):f.call(e,"i18n","series",s),(a||0===a)&&(o+=a),o+='">\n                    ',a=i.each.call(e,e.series,{hash:{},inverse:y.noop,fn:y.program(5,r,t)}),(a||0===a)&&(o+=a),o+='\n                </select>\n\n                <select class="period" title="',s={hash:{}},n=i.i18n,a=n?n.call(e,"time_period",s):f.call(e,"i18n","time_period",s),(a||0===a)&&(o+=a),o+='">\n                    ',a=i.each.call(e,e.periods,{hash:{},inverse:y.noop,fn:y.program(8,c,t)}),(a||0===a)&&(o+=a),o+='\n                </select>\n            </nav>\n            <div class="chartContainer"></div>\n            <div class="legendContainer chart"></div>\n        </div>\n        <div class="stats-container"></div>\n    </div>\n    <div class="controls">\n        <ul class="controlsList">\n            <li class="control settingsButton leftSide showSettings">\n                <a title="Settings">\n                    <i class="fitglyph fitglyph-show-settings size-f"></i>\n                </a>\n            </li>\n            <li class="control more largeRight">\n                <a href="/activities" title="See_More">\n                    <i class="fitglyph fitglyph-arrow-right size-f"></i>\n                    <span class="controlsLabel arrow-right">',s={hash:{}},n=i.i18n,a=n?n.call(e,"See_More",s):f.call(e,"i18n","See_More",s),(a||0===a)&&(o+=a),o+="</span>\n                </a>\n            </li>\n        </ul>\n    </div>\n</div>\n"}function r(e,t){var n,a="";return a+='\n                    <option\n                            value="',(n=i.value)?n=n.call(e,{hash:{}}):(n=e.value,n=typeof n===m?n.apply(e):n),a+=v(n)+'"\n                            title="',(n=i.text)?n=n.call(e,{hash:{}}):(n=e.text,n=typeof n===m?n.apply(e):n),a+=v(n)+'"\n                    ',n=i["if"].call(e,e.isSelected,{hash:{},inverse:y.noop,fn:y.program(6,h,t)}),(n||0===n)&&(a+=n),a+="\n                    ></option>\n                    "}function h(e,t){return'\n                    selected="selected"\n                    '}function c(e,t){var n,a="";return a+='\n                    <option\n                            value="',(n=i.value)?n=n.call(e,{hash:{}}):(n=e.value,n=typeof n===m?n.apply(e):n),a+=v(n)+'"\n                    ',n=i["if"].call(e,e.isSelected,{hash:{},inverse:y.noop,fn:y.program(6,h,t)}),(n||0===n)&&(a+=n),a+="\n                    >",(n=i.text)?n=n.call(e,{hash:{}}):(n=e.text,n=typeof n===m?n.apply(e):n),a+=v(n)+"</option>\n                    "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var d,u,p,g="",f=i.helperMissing,m="function",v=this.escapeExpression,y=this;return p={hash:{},inverse:y.noop,fn:y.program(1,s,a)},d=i["i18n-namespace"],u=d?d.call(t,"com.fitbit.app.ngd.activity","com.fitbit.app.ngd.tile",p):f.call(t,"i18n-namespace","com.fitbit.app.ngd.activity","com.fitbit.app.ngd.tile",p),(u||0===u)&&(g+=u),g+="\n"});return e.registerPartial("galileo_tile_template_TripleWideActivity",t),t}),define("galileo/model/TimeSeriesModel",["require","exports","module","backbone","galileo/util/dateUtil"],function(e,t,i){var n=e("backbone"),a=e("galileo/util/dateUtil"),s=n.Model.extend({parse:function(e){var t=parseInt(e.value,10);return""+t==e.value&&(e.value=t),e.dateTime=a.ajaxDecode(e.dateTime),e}});return s}),define("galileo/model/TimeSeriesCollection",["require","underscore","backbone","shared/scripts/modules/api-client","galileo/util/dateUtil","./TimeSeriesModel"],function(e){var t=e("underscore"),i=e("backbone"),n=1,a=e("shared/scripts/modules/api-client"),s=e("galileo/util/dateUtil"),o=e("./TimeSeriesModel"),l=i.Collection.extend({model:o,initialize:function(e,t){l.__super__.initialize.apply(this,arguments),t=t||{},this.user=t.user,this.type=t.type,this.baseDate=t.baseDate,this.endDate=t.endDate,this.period=t.period,this.detailLevel=t.detailLevel},url:function(){var e="/"+n+"/user/"+this.user.encodedId+"/"+t.result(this,"type")+"/date/"+s.ajaxEncode(t.result(this,"baseDate"))+"/",i=t.result(this,"endDate");e+=i?s.ajaxEncode(i):t.result(this,"period");var o=t.result(this,"detailLevel");return o&&(e+="/"+o),a.makeFullUrl(e+".json")},parse:function(e){var i=t.values(e)[0];return t.each(i,function(e){var i=parseFloat(e.value);t.isNaN(i)||(e.value=i)}),i},fetch:function(e){e=e||{},e.useDistanceUnitSystem=!0,l.__super__.fetch.call(this,e)}});return l}),define("galileo/model/LifetimeActivitiesModel",["require","exports","module","galileo/model/user","shared/scripts/modules/api-client","galileo/model/SharedModel"],function(e,t,i){var n=e("galileo/model/user").viewer,a=1,s=e("shared/scripts/modules/api-client"),o=e("galileo/model/SharedModel"),l=o.extend({user:n,initialize:function(e,t){l.__super__.initialize.apply(this,arguments),this.user=t&&t.user},url:function(){return s.makeFullUrl("/"+a+"/user/"+this.user.encodedId+"/activities.json")},lookup:function(e,t){return i.uri+"_"+t.user.encodedId},validate:function(){},fetch:function(e){e=e||{},e.useDistanceUnitSystem=!0,l.__super__.fetch.call(this,e)}});return l}),define("hbs!galileo/tile/template/ActivityStatsTemplate",["handlebars"],function(e){var t=e.template(function(e,t,i,n,a){function s(e,t){var n,a="";return a+="\n",n=i.each.call(e,e.stats,{hash:{},inverse:u.noop,fn:u.program(2,o,t)}),(n||0===n)&&(a+=n),a+="\n"}function o(e,t){var n,a="";return a+='\n<li class="stat">\n    <div class="name">',(n=i.name)?n=n.call(e,{hash:{}}):(n=e.name,n=typeof n===c?n.apply(e):n),a+=d(n)+" ",n=i["if"].call(e,e.subTitle,{hash:{},inverse:u.noop,fn:u.program(3,l,t)}),(n||0===n)&&(a+=n),a+='</div>\n    <span class="value">',(n=i.value)?n=n.call(e,{hash:{}}):(n=e.value,n=typeof n===c?n.apply(e):n),a+=d(n)+'</span><span class="unit">',(n=i.unit)?n=n.call(e,{hash:{}}):(n=e.unit,n=typeof n===c?n.apply(e):n),a+=d(n)+"</span>\n</li>\n"}function l(e,t){var n,a="";return a+='<span class="subTitle">',(n=i.subTitle)?n=n.call(e,{hash:{}}):(n=e.subTitle,n=typeof n===c?n.apply(e):n),a+=d(n)+"</span>"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,h="",c="function",d=this.escapeExpression,u=this;return h+='\n<ul class="stats">\n',r=i["if"].call(t,t.stats,{hash:{},inverse:u.noop,fn:u.program(1,s,a)}),(r||0===r)&&(h+=r),h+="\n</ul>"});return e.registerPartial("galileo_tile_template_ActivityStatsTemplate",t),t}),define("galileo/tile/ActivityStatsView",["require","jquery","underscore","backbone","galileo/model/user","galileo/model/WeeklyGoalModel","galileo/model/DailyGoalModel","galileo/model/TimeSeriesCollection","galileo/model/LifetimeActivitiesModel","galileo/util/dateUtil","i18n/i18n","hbs!galileo/tile/template/ActivityStatsTemplate","i18n-load!com/fitbit/app/ngd/activity","i18n-load!com/fitbit/app/unit","i18n-load!com/fitbit/app/ngd/goal"],function(e){var t=e("jquery"),i=e("underscore"),n=e("backbone"),a=e("galileo/model/user").viewer,s=e("galileo/model/WeeklyGoalModel"),o=e("galileo/model/DailyGoalModel"),l=e("galileo/model/TimeSeriesCollection"),r=e("galileo/model/LifetimeActivitiesModel"),h=e("galileo/util/dateUtil"),c=e("i18n/i18n"),d=new c,u=e("hbs!galileo/tile/template/ActivityStatsTemplate");d.namespace(e("i18n-load!com/fitbit/app/ngd/activity")),d.namespace(e("i18n-load!com/fitbit/app/unit")),d.namespace(e("i18n-load!com/fitbit/app/ngd/goal"));var p=function(e){return"calories-burned"===e?"caloriesOut":"active-minutes"===e?"activeMinutes":e},g={steps:d.plural("step"),"calories-burned":d.plural("calorie_reduced"),distance:d.plural("US"===a.heightSystem?"mile":"km"),"active-minutes":d.plural("active_minute_reduced"),floors:d.plural("floor"),"heart-rate":d.plural("minute_full"),resting_heart_rate:d.plural("resting_heart_rate")},f=n.View.extend({initialize:function(e){e||(e={});var i=this,a=e.user,c=e.period,d=e.series,u=e.date,p=t.Deferred().resolve();this.user=a,this.period=c,this.series=d,this.baseDate=u;var g=this.weeklyGoals=new s(null,{user:a}),f=g.isValid()?p:g.fetch(),m=this.dailyGoals=new o(null,{user:a}),v=m.isValid()?p:m.fetch(),y=this.lifetimeActivities=new r(null,{user:a}),b=a.trackerType?y.fetch():p,w=function(){return i.baseDate},_=function(){if("28d"===i.period){var e=2*i.get28Days();return h.minusDays(i.baseDate,e)}return h.minusDays(i.baseDate,7)},x=function(){var e,t=i.series;return e="calories-burned"===t?"calories":"active-minutes"===t?"minutesVeryActive":"heart-rate"===t?"heart":t,"activities/"+e},T=this.timeSeriesCollection=new l(null,{user:a,type:x,baseDate:w,endDate:_}),k=T.fetch(),S=this.fairlyActiveMinutesCollection=new l(null,{user:a,type:"activities/minutesFairlyActive",baseDate:w,endDate:_}),M="active-minutes"===d?S.fetch():p,C=this.viewModel=new n.Model;C.on("change",function(e){var t=e.changedAttributes();t.series&&(i.series=t.series),t.period&&(i.period=t.period),t.baseDate&&(i.baseDate=t.baseDate),"active-minutes"===i.series&&(S.reset(),S.fetch()),T.reset(),T.fetch()}),t.when(f,v,k,b,M).done(function(){i.render(),i.listenTo(T,"sync reset",function(){i.render()}),i.listenTo(S,"sync reset",function(){i.render()}),i.listenTo(g,"change",function(){i.render()}),i.listenTo(m,"change",function(){i.render()}),i.listenTo(y,"change",function(){i.render()})})},get28Days:function(){var e=this.user.startDayOfWeek,t=this.baseDate.getDay();return t-e+22},render:function(){var e,t,n,a,s=this,o=this.timeSeriesCollection,l=this.fairlyActiveMinutesCollection,r=this.weeklyGoals,c=this.dailyGoals,f=this.lifetimeActivities,m=this.period,v=this.series,y=[],b="heart-rate"===v,w="calories-burned"===v,_="active-minutes"===v,x="distance"===v,T=this.get28Days(),k=o.toJSON(),S=o.last(2),M=S[1],C=S[0];if(!o.length||_&&l.length!==o.length)return this.$el.html(),this;var D=function(e,t){return e?(t||(t=x?"#,##0.00":"#,###"),s.user.formatNumber(e,t)):0};if(_){var A=l.toJSON();k=i.map(k,function(e,t){return e.value+=A[t].value,e})}e=i.last(k,T),"28d"===m&&(t=i.first(k,T)),a=i.initial(e),n=i.rest(e);var G=i.pluck(a,"value");if(b){if("28d"===m||"7d"===m){var E=function(e){return i.chain(e).pluck("heartRateZones").flatten().reject(function(e){return"Out of Range"===e.name}).reduce(function(e,t){return e+(parseInt(t.minutes,10)||0)},0).value()},P=E(i.pluck(n,"value")),I=Math.round(P/n.length);if(y.push({name:d("28d"===m?"28_day_average_time_in_zones":"7_day_average_time_in_zones"),value:D(I),unit:g[v](I)}),"28d"===m){var L=E(i.pluck(t,"value")),F=Math.round(L/t.length),O=I-F;y.push({name:d(0>O?"decrease_over_previous_28_days":"increase_over_previous_28_days"),value:D(Math.abs(O),"#,###"),unit:g["heart-rate"](O)})}else"7d"===m&&y.push({name:d("7_day_total_time_in_zones"),value:D(P),unit:g[v](P)})}else if("1d"===m){var W=M.get("value").heartRateZones;y.push({name:d("peak_zone"),value:D(W[3].minutes),unit:g[v](W[3].minutes)}),y.push({name:d("cardio_zone"),value:D(W[2].minutes),unit:g[v](W[2].minutes)}),y.push({name:d("fat_burn_zone"),value:D(W[1].minutes),unit:g[v](W[1].minutes)})}}else{var N=i.reduce(G,function(e,t){return e+t},0),B=N/G.length;if(y.push({name:d("28d"===m?"28_day_average":"7_day_average"),value:D(B),unit:g[v](B)}),"28d"===m){var U=i.pluck(t,"value"),R=i.reduce(U,function(e,t){return e+t},0);if(R>0){var j=R/t.length,H=100*(B/j-1),z=H>0;y.push({name:d(z?"increase_over_previous_28_days":"decrease_over_previous_28_days"),value:D(Math.abs(H),"#,###")+"%",unit:d(z?"more":"less")+" "+g[v](j)})}var $=i.max(n,function(e){return e.value}),V=h.localeFormat($.dateTime,"EEE, MMM d");h.diffInDays(this.baseDate,$.dateTime)<1&&(V="today"),y.push({name:d("best_day"),subTitle:V,value:D($.value),unit:g[v]($.value)})}else if("7d"===m){var q=i.pluck(n,"value"),Y=i.reduce(q,function(e,t){return e+t},0);w||y.push({name:d("7_day_total"),value:D(Y),unit:g[v](Y)});var X;X=w||_?7*c.get(p(v)):r.get(p(v));var Z=Math.round(Y/X*100);y.push({name:d("weekly_goal_progress"),value:D(Z,"#,###")+"%",unit:d("of_goal_of")+" "+D(X)})}else if("1d"===m){var K=C.get("value")-M.get("value");if(y.push({name:d("beat_yesterday"),value:K>0?D(K):0,unit:g[v](K)+" "+d("to_go")}),!_&&!w&&this.user.trackerType){var J,Q=f.get("lifetime"),ee=Q.tracker[p(v)];"steps"===v?J=d("lifetime_steps"):"floors"===v?J=d("lifetime_floors"):"distance"===v&&(J=d("lifetime_distance")),y.push({name:J,value:D(ee),unit:g[v](ee)})}}}return this.$el.html(u({stats:y})),this}});return f}),define("galileo/tile/TripleWideActivity",["require","galileo/tile/BackboneTile","galileo/graph/weekBeta","hbs!./template/TripleWideActivity","galileo/graph/intraday","galileo/graph/perDayHeartRate","galileo/model/user","hbs!galileo/tile/template/chartLegend","hbs!galileo/tile/template/hrLegend","hbs!./template/help/activityHeartRate","popup","i18n/i18n","galileo/widget/metric","galileo/tile/template/helpers/domPlaceholder","jquery","underscore","cdn-logger/siteLogger","galileo/tile/ActivityStatsView","galileo/widget/TourPopup","jquery.selectbox","i18n-load!com/fitbit/app/ngd/activity","i18n-load!com/fitbit/app/unit"],function(e){var t=e("galileo/tile/BackboneTile"),i=e("galileo/graph/weekBeta"),n=e("hbs!./template/TripleWideActivity"),a=e("galileo/graph/intraday"),s=e("galileo/graph/perDayHeartRate"),o=e("galileo/model/user").viewer,l=e("hbs!galileo/tile/template/chartLegend"),r=e("hbs!galileo/tile/template/hrLegend"),h=e("hbs!./template/help/activityHeartRate"),c=e("popup"),d=e("i18n/i18n")(),u=e("galileo/widget/metric"),p=e("galileo/tile/template/helpers/domPlaceholder"),g=d.plural("METRIC"===o.distanceUnit?"Kilometer":"Mile"),f=e("jquery"),m=e("underscore"),v=e("cdn-logger/siteLogger"),y=e("galileo/tile/ActivityStatsView"),b=e("galileo/widget/TourPopup");e("jquery.selectbox"),d.namespace(e("i18n-load!com/fitbit/app/ngd/activity")),d.namespace(e("i18n-load!com/fitbit/app/unit"));var w="steps",_="1d",x=560,T=[{value:"1d",text:d("daily")},{value:"7d",text:d("seven_days")},{value:"28d",text:d("twenty_eight_days")}],k={marginLeft:0,marginRight:0,weekAxisMin:0,weekAxisMax:7.5,weeksAxisMin:-5,weeksAxisMax:33},S={steps:d("steps_title"),floors:d("floors_title"),"calories-burned":d("calories_title"),"heart-rate":d("heart_rate_title"),distance:d("distance_title"),"active-minutes":d("active_minutes_title")},M=[{unitPlural:d.plural("minute_reduced"),unitThreshold:60,format:"#0"},{unitPlural:d.plural("hour_reduced"),unitThreshold:1/0,format:"#0"}],C=t.extend({shape:"responsive-triple-wide",title:d("triple_activity_title"),tileName:"tripleWideActivity",logUrl:"/activities",savable:!1,options:{metricFormats:{steps:[{unitPlural:d.plural("step"),unitThreshold:1/0,format:"#,##0",editable:!0}],"calories-burned":[{unitPlural:d.plural("calorie"),unitThreshold:1/0,format:"#,##0",editable:!0}],floors:[{unitPlural:d.plural("floor"),unitThreshold:1/0,format:"#,##0",editable:!0}],distance:[{unitPlural:g,unitThreshold:1/0,format:"#,##0.00",editable:!0}],"active-minutes":[{unitPlural:d.plural("active_minute_reduced"),unitThreshold:1/0,format:"#,##0",editable:!0}]}},events:{"change .period, .series":"updateGraph","mouseover .contentInfo":"showHeartRatePopup","mouseenter .chartContainer":"showLegends","mouseleave .chartContainer":"showLegends","click .settings .saveButton":"hideSettings","click .tileInfo":"showPopup"},updateGraph:function(){var e=this.$period,t=this.$series,i=e.val(),n=t.val();this.selectedPeriod=i,this.selectedSeries=n,this.render(),o.saveSetting("tripleWideActivityTab",(n||w)+" "+(i||_)),this.statsView.viewModel.set({period:i,series:n})},showHeartRatePopup:function(){this.popup.showHTML(h,this.$(".contentInfo"))},showLegends:function(e){this.$(".legendContainer").css({visibility:"mouseleave"===e.type?"hidden":"visible"})},initialize:function(e){C.__super__.initialize.apply(this,arguments);var t=this,i=o.getSettingsModel().get("tripleWideActivityTab"),n=i?i.split(" "):[];e=e||{},this.date=e.date,n[0]&&"null"!==n[0]?this.selectedSeries=n[0]:this.selectedSeries=w,n[1]&&"null"!==n[1]?this.selectedPeriod=n[1]:this.selectedPeriod=_,this.tour=new b({className:"tiles-tooltip",closeOnClick:!0,states:this.getPopupStates(),getPopupAnchor:function(e){switch(e){case 0:return t.$(".sbHolder.series");case 1:return t.$(".sbHolder.period")}}});var a=this.statsView=new y({user:o,period:this.selectedPeriod,series:this.selectedSeries,date:this.date});this.on("changeDate",function(e){var t=e.date;this.date=t,this.render(),this.statsView.viewModel.set({baseDate:t})}),this.popup=new c({className:"tiles-tooltip"}),this.on("showSettings hideSettings",this.render),a.timeSeriesCollection.on("sync",function(e){if("heart-rate"===t.selectedSeries&&"activities/heart"===m.result(e,"type")){var i,n=new u(M),s=new u(M),o=new u(M);switch(t.selectedPeriod){case"28d":i=a.get28Days();break;case"7d":i=7;break;case"1d":i=1}var l=m.chain(e.toJSON()).last(i).pluck("value").pluck("heartRateZones").flatten().groupBy(function(e){return e.name}).value(),h=function(e){return m.reduce(e,function(e,t){return e+t.minutes},0)};n.update(h(l["Fat Burn"])),s.update(h(l.Cardio)),o.update(h(l.Peak));var c=p(r,{fatBurn:n.elements(),cardio:s.elements(),peak:o.elements()});t.$(".legendContainer").html(c)}}),this.render()},getPopupStates:function(){var e=this;return[{header:d("triple_wide_series_tooltip"),anchor:function(){return e.$(".sbHolder.series")}},{header:d("triple_wide_period_tooltip"),anchor:function(){return e.$(".sbHolder.period")}}]},render:function(){var e,t,i=this.selectedPeriod,a=this.selectedSeries;if(this.statsView.$el.detach(),this.showingSettings)return this.$el.html(n({showingSettings:!0})),this;this.$el.html(n({title:S[a],isHeartRate:"heart-rate"===a,series:this.getSeriesItems(),periods:f.map(T,function(e){return{value:e.value,text:e.text,isSelected:e.value===i}})})),this.$(".stats-container").append(this.statsView.$el),t=this.$period=this.$(".period").selectbox(),e=this.$series=this.$(".series").selectbox(),e.next(".sbHolder").addClass("series").prop("title",e.prop("title")).find(".sbSelector").prop("rel",a),t.next(".sbHolder").addClass("period").prop("title",t.prop("title")),this.loadGraph(a,i),this.trigger("render"),this.rendered=!0;var s=this.getInteractionId(a);return s&&v.logV2Event({id:s,type:"screen"}),this},loadGraph:function(e,t){var n="heart-rate"===e,o="active-minutes"===e,l=this.date,r=n&&("28d"===t||"7d"===t),h=this.$(".chartContainer"),c="7d"===t,d=this;this.selectedSeries=e,this.selectedPeriod=t,this.chartContainer=h,n||this.loadGraphLegends(),h.html("1d"===t?new a(e,!n&&!o,x,180,l):r?s(m.defaults({width:x,height:180,date:l,endOnToday:c,period:t,weeks:"28d"===t?4:1,leftPadding:"28d"===t?5:1},k)):i(m.defaults({series_name:e,width:x,height:180,date:l,weeks:"28d"===t?4:1,endOnToday:c,tooltipFormat:d.options.metricFormats[e],alternateLayout:!0,yAxis:{labels:{align:"right",x:55}}},k)))},loadGraphLegends:function(){var e=this.$(".legendContainer"),t="",i=this.selectedSeries,n=this.selectedPeriod,a="active-minutes"===i,s=["steps","distance","floors","calories-burned"],o=m.some(s,function(e){return i===e&&"1d"!==n});t=l(o||a&&"1d"!==n?{legendList:[{"class":"goal_met",name:d("goal_met")},{"class":"goal_unmet",name:d("goal_unmet")}]}:a?{legendList:[]}:{legendList:[{"class":"light",name:d("light")},{"class":"moderate",name:d("moderate")},{"class":"intense",name:d("intense")}]}),e.html(t)},getSeriesItems:function(){var e=[],t=o.getDeviceFeatures();return e.push(this.getSeriesData("steps")),t.HEART_RATE&&e.push(this.getSeriesData("heart-rate")),e.push(this.getSeriesData("distance")),e.push(this.getSeriesData("calories-burned")),t.ELEVATION&&e.push(this.getSeriesData("floors")),t.CALORIES&&!o.isOnlySoftTrackerUser&&e.push(this.getSeriesData("active-minutes")),e},getInteractionId:function(e){var t,i=v.INTERACTION_IDS,n={steps:"VIEW_STEPS","calories-burned":"VIEW_CALORIES_BURNED","heart-rate":"VIEW_HEART_RATE",distance:"VIEW_DISTANCE",floors:"VIEW_FLOORS","active-minutes":"VIEW_ACTIVE_MINUTES"};return e?(t=n[e],i[t]):void 0},showPopup:function(){return this.tour.render().showAtIndex(0),!1},getSeriesData:function(e){return{value:e,text:S[e]||"",isSelected:this.selectedSeries===e}}});return C}),define("galileo/widget/syncCapsule",["require","jquery","galileo/ajax/ajax","galileo/util/dateUtil","i18n/i18n","galileo/model/user","i18n-load!com/fitbit/app/ngd/sync_capsule","i18n-load!com/fitbit/util/relativedateutil"],function(e){e("jquery");var t=e("galileo/ajax/ajax"),i=e("galileo/util/dateUtil"),n=e("i18n/i18n")(),a=e("galileo/model/user").viewer;return n.namespace(e("i18n-load!com/fitbit/app/ngd/sync_capsule")),n.namespace(e("i18n-load!com/fitbit/util/relativedateutil")),new Class({initialize:function(e){this.capsule=$("<div class='clearfix syncCapsule'>"),e.container.append(this.capsule),this.loadSyncTime()},getRelativeDateMessage:function(e){var t=new Date(e),s=[],o=60,l=60*o,r=24*l,h=7*r,c=Math.floor(((new Date).getTime()-t.getTime())/1e3);return s=l>=c?[i.getRelativeDate(e)]:r>=c?[a.formatTime(t)]:2*r>=c?[n("yesterday"),a.formatTime(t)]:h>=c?[i.localeFormat(t,"EEE"),a.formatTime(t)]:[i.localeFormat(t,"MMMM dd")],s.join(" ")},updateSyncTime:function(e){var t;return e&&e.milliseconds?(t=n("last_sync")+" ",this.capsule.text(t+this.getRelativeDateMessage(e.milliseconds))):this.capsule.text(n("no_devices")),this},loadSyncTime:function(){return t.get("getLatestTrackerSyncTime","device",{},this.updateSyncTime.bind(this)),this}})}),define("galileo/page/dash",["require","jquery","mootools","fitbit-header","country-selector","galileo/fma/modal","galileo/util/dialog101Loader","galileo/modal/device101","galileo/util/foodGoalLoader","galileo/modal/VerificationEmailModal","hbs!galileo/modal/template/resentVerificationEmail","galileo/ajax/ajax","galileo/util/dateUtil","galileo/page/gearHelp","galileo/model/user","galileo/layout/tiles","galileo/page/tileDrawer","hbs!galileo/tile/template/dateNav","galileo/page/dateNav","underscore","backbone","i18n/i18n","galileo/widget/TourPopup","shared/scripts/modules/api-client","galileo/util/loggedInSwitchLocale","galileo/util/switchLocale","galileo/page/default_tiles","galileo/tile/steps","galileo/tile/distance","galileo/tile/floors","galileo/tile/sleep","galileo/tile/calories","galileo/tile/weight","galileo/tile/badges","galileo/tile/activity","galileo/tile/leaderboard","galileo/tile/calZone","galileo/tile/foodPlan","galileo/tile/trainer","galileo/tile/water","galileo/tile/weeklyActivity","galileo/tile/exercise","galileo/tile/activeMinutes","galileo/tile/restingHeartRate","galileo/tile/sedentaryTime","i18n-load!com/fitbit/util/dateutil","i18n-load!com/fitbit/app/ngd/verificationEmailModal","i18n-load!com/fitbit/app/notifications/label","galileo/tile/goalTile","galileo/tile/TripleWideActivity","galileo/widget/syncCapsule"],function(e){var t=e("jquery");e("mootools"),e("fitbit-header"),e("country-selector"),e("galileo/fma/modal");var i=e("galileo/util/dialog101Loader"),n=e("galileo/modal/device101"),a=e("galileo/util/foodGoalLoader"),s=e("galileo/modal/VerificationEmailModal"),o=e("hbs!galileo/modal/template/resentVerificationEmail"),l=e("galileo/ajax/ajax"),r=e("galileo/util/dateUtil"),h=e("galileo/page/gearHelp"),c=e("galileo/model/user").viewer,d=e("galileo/layout/tiles"),u=e("galileo/page/tileDrawer"),p=e("hbs!galileo/tile/template/dateNav"),g=e("galileo/page/dateNav"),f=e("underscore"),m=e("backbone"),v=e("i18n/i18n")();e("galileo/widget/TourPopup");e("shared/scripts/modules/api-client").updateBackbone(m),e("galileo/util/loggedInSwitchLocale"),e("galileo/util/switchLocale");var y=e("galileo/page/default_tiles"),b=1280,w={steps:e("galileo/tile/steps"),distance:e("galileo/tile/distance"),floors:e("galileo/tile/floors"),sleep:e("galileo/tile/sleep"),calories:e("galileo/tile/calories"),weight:e("galileo/tile/weight"),badges:e("galileo/tile/badges"),intradayActivities:e("galileo/tile/activity"),leaderboard:e("galileo/tile/leaderboard"),calZone:e("galileo/tile/calZone"),foodPlan:e("galileo/tile/foodPlan"),trainer:e("galileo/tile/trainer"),water:e("galileo/tile/water"),weeklyActivity:e("galileo/tile/weeklyActivity"),exercise:e("galileo/tile/exercise"),activeMinutes:e("galileo/tile/activeMinutes"),restingHeartRate:e("galileo/tile/restingHeartRate"),sedentaryTime:e("galileo/tile/sedentaryTime")};v.namespace(e("i18n-load!com/fitbit/util/dateutil")),v.namespace(e("i18n-load!com/fitbit/app/ngd/verificationEmailModal")),v.namespace(e("i18n-load!com/fitbit/app/notifications/label"));var _=function(e){if(window.history&&window.history.replaceState)try{var t=window.location.href,i=t.replace(/\/from\/[0-9]{4}\/[0-9]{2}\/[0-9]{2}\/to\/[0-9]{4}\/[0-9]{2}\/[0-9]{2}\/?$/,"");i=i.replace(/\/[0-9]{4}\/[0-9]{2}\/[0-9]{2}\/?$/,""),i=i.replace(/\/$/,""),r.isToday(e)||(i+=x(e)),window.history.replaceState(null,window.document.title,i)}catch(n){}},x=function(e){var t=e.getMonth()+1;t=10>t?"0"+t:t;var i=e.getDate();return i=10>i?"0"+i:i,"/"+e.getFullYear()+"/"+t+"/"+i},T={tiles:[],elements:{},interval:1,intervals:[{type:"day",value:1},{type:"week",value:7},{type:"month",value:30},{type:"year",value:365}],dateChangeCount:0,addTileTo:function(e,i){i in w&&-1===t.inArray(i,e)&&(this.availableTiles[i]=w[i],e.push(i),c.seeTile(i),this.hasModifiedTileState=!0)},addExtraTiles:function(){var t=!!c.getTrackerType();t&&(w.goalTile=e("galileo/tile/goalTile")),t&&(w.tripleWideActivity=e("galileo/tile/TripleWideActivity"))},initialize:function(e,i,n,a,l){var r,h,p,g,b,_,x,T,k,S,M=this,C=t(".system-alert");if(f.extend(this,m.Events),c.initSettings(i),this.addExtraTiles(),t.extend(!0,w,a),t.extend(!0,y,l),r=new Date(n.split("-").join("/")),this.currentDate=new Date,this.currentDate.setHours(0,0,0,0),h=this.date=r,h.setHours(0,0,0,0),h.getTime()>this.currentDate.getTime()&&(h=this.date=this.currentDate),p=M.elements.header=t('<div class="dashHeader">'),g=t('<div class="tileContainer">').css("position","relative"),M.dashElement=t("#dash").append(p,g).css({paddingLeft:76,paddingRight:66}),M.resizeDash(),t(window).on("resize",M.resizeDash.bind(M)),x=M.getUserFeatures(),T=y.getAvailable(x),M.availableTiles=Object.filter(w,function(e,t){return T.contains(t)}),0===e.length){var D=y.getVisible(x);f.each(D,function(t){M.addTileTo(e,t)})}"trainer"in M.availableTiles&&!c.hasSeenTile("trainer")&&M.addTileTo(e,"trainer"),M.tiles=M.initializeTiles(e,h),b=this.tileDrawer=new u(M.availableTiles,M.tiles,t("#container"),t("#dash"),{onAddTiles:function(e){f.each(e,function(e){_.addTile(e.tileName,w[e.tileName],M.date)}),_.saveTileState(M.tiles)}}),_=this.tileObj=new d(M.tiles,g,this),(c.isFirstVisit()||M.hasModifiedTileState)&&_.saveTileState(M.tiles),b.createElements(),b.createEvents(),c.isEmailVerificationRequired&&(k=new s({template:o,title:v("title"),subtitle:v("subtitle").replace("{0}",c.email)}),S=new s({template:o,title:v("failedTitle"),subtitle:v("failedSubtitle")}),C.find(".resend_verification_email").on("click",function(){t.get("/verifyEmail/send",{email:c.email}).done(function(){k.render(),C.filter(".verifyEmail").find(".exit").click()}).fail(function(){S.render()})})),c.getSettingsModel().on("change:goalAndTripleBeta",function(e,t){(t||void 0!==e.previous("goalAndTripleBeta"))&&M.resetDash()}),this.setupDateNav(),this.setupSyncCapsule(),t("html").hasClass("ie8")&&alert(v("ie8Sunset"))},resetDash:function(){var e=this,t=e.getUserFeatures(),i=y.getVisible(t),n=y.getAvailable(t);this.addExtraTiles(),this.availableTiles=f.reduce(w,function(e,t,i){return n.contains(i)&&(e[i]=t),e},{});var a=f.reject(this.tiles,function(e){return f.contains(i,e.tileName)});f.invoke(a,"remove");var s=f.pluck(this.tiles,"tileName"),o=f.reject(i,function(e){return f.contains(s,e)});f.each(o,function(t){e.tileObj.addTile(t,w[t],e.date)});var l=[],r=[];f.each(i,function(t,i){var n=f.findWhere(e.tiles,{tileName:t});if(n){var a=e.tileObj.positionTile(l,i,n);e.tileObj.animateToIndex(n,a,200),r.push(n)}}),this.tiles.splice(0,this.tiles.length),this.tiles.push.apply(this.tiles,r),this.tileDrawer.setUpBetas(),this.tileDrawer.updateTiles(this.availableTiles,this.tiles),this.tileDrawer.renderTilesList(),this.tileDrawer.updateSelections(),this.tileObj.setContainerSize(l),this.tileObj.saveTileState(this.tiles),this.setTodayOnTiles(this.tiles,this.date,!1)},gridColumnsForWidth:function(e){return e>=b?4:3},currentGridColumns:function(){return this.gridColumnsForWidth(t(window).width())},resizeDash:function(){var e=855;4===this.currentGridColumns()&&(e=1140),this.dashElement.css("width",e)},initializeTiles:function(e,t){var i=this,n=i.availableTiles,a=e.filter(function(e){return n[e]});return a.map(function(e){return new n[e]({date:t,user:c})})},getStrWeekday:function(e){var t;return t=r.isToday(e)?v("today"):r.isYesterday(e)?v("yesterday"):r.localeFormat(e,"EEEE")},setTodayOnTiles:function(e,t,i){var n=r.isToday(t);f.each(e,function(e){var t=e.container||e.$el;n?t.addClass("today"):t.removeClass("today"),i&&(e.setCanAnimate?e.setCanAnimate(!1):e.canAnimate=!1)})},setupDateNav:function(){var e=this.currentDate,i=this.date,n=this,a=0===r.diffInDays(e,i);a||n.tileDrawer.hideDrawer();var s=this.elements.dateNav=t(p({isToday:a,weekday:this.getStrWeekday(i),date:r.localeFormat(i,"MMMM dd")})),o=this.setTodayOnTiles;return this.dateNav=new g(s,{startDate:e,date:i,onUpdate:function(e){var t=this.getDateDiffFromStart(e);_(e),0===t?(this.element.addClass("today"),this.elements.next.addClass("invisible"),n.elements.capsule.removeClass("invisible"),n.tileDrawer.showDrawer()):(this.element.removeClass("today"),this.elements.next.removeClass("invisible"),n.elements.capsule.addClass("invisible"),n.tileDrawer.hideDrawer()),o(n.tiles,e,!0),n.setDate(e),n.trackDateChange(e)}}),o(n.tiles,i,!1),this.elements.header.append(this.elements.dateNav),this},setupSyncCapsule:function(){var t=e("galileo/widget/syncCapsule"),i=this.syncCapsule=new t({container:this.elements.header});return this.elements.capsule=i.capsule.css({padding:"0 20px"}),this},getUserFeatures:function(){var e=c.getDeviceFeatures();return c.isOnlySoftTrackerUser&&(e.ONLYSOFTTRACK=!0),c.isLegacyUser()&&(e.LEGACY=!0),(c.hasTrainerPlan()||c.hasPremium)&&(e.TRAINER=!0),e},load:function(){var s=this.tiles;e(["galileo/tile/loadDependencies"],function(){f.each(s,function(e){e.showTile&&e.showTile();
});var e=function(e){"GRAVITON"===e?n("chargehr"):"PROTON"===e?n("surge"):"ELECTRON"===e?n("blaze"):"LEPTON"===e?n("alta"):"FERMION"===e?n("flex2"):"LARYON"===e?n("charge2"):"ATOM"===e&&n("altahr")};c.isFirstVisit()&&l.get("getOwnerDevices","device",{},function(t){var i=t.find(function(e){return"QUARK"===e.type||"NEUTRINO"===e.type||"TAU"===e.type}),n=t.find(function(e){return"GRAVITON"===e.type||"PROTON"===e.type||"ELECTRON"===e.type||"LEPTON"===e.type||"FERMION"===e.type||"LARYON"===e.type||"ATOM"===e.type});i&&h(i.type),n&&e(n.type)});var o=[["launchAria101",function(){t.aria101()}],["launchOne101",function(){t.one101()}],["launchZip101",function(){t.zip101()}]];f.map(o,function(e){(window.location.hash.indexOf(e[0])>-1||window.location.search.indexOf(e[0])>-1)&&("launchAria101"===e[0]?a(function(){i(e[1])}):i(e[1]))})})},getTiles:function(){return this.tiles},getTilesState:function(){return this.tiles.map(function(e){return e.tileName})},setDate:function(e){return this.isDateEqual(e)||(this.date=e,f.each(this.getTiles(),function(t){t.setDate?t.setDate(e):t.trigger("changeDate",{date:e})})),this},getDate:function(){return this.date},isDateEqual:function(e){return this.getDate().getTime()===e.getTime()},trackDateChange:function(e){var t,i=++this.dateChangeCount,n=this.interval,a=this.intervals;for(n=this.intervals.find(function(e){return e.value===n}),a=a.slice(a.indexOf(n)),t=a.length;t--&&i%(n=a[t]).value!==0;);return this.interval!==n.value&&(this.interval=n.value),this}};return T}),function(e){var t=document,i="appendChild",n="styleSheet",a=t.createElement("style");a.type="text/css",t.getElementsByTagName("head")[0][i](a),a[n]?a[n].cssText=e:a[i](t.createTextNode(e))}(".sbHolder {\r\n    display: inline-block; vertical-align: top;\r\n    border: 1px solid #d4d4d4;\r\n    border-radius: 17px;\r\n    background: #fff;\r\n}\r\n.sbHolder .sbToggle {\r\n    display: none;\r\n}\r\n.sbHolder .sbToggleOpen + .sbSelector + .sbOptions {\r\n    height: auto; max-height: 280px;\r\n    padding-bottom: 5px;\r\n    visibility: visible;\r\n}\r\n.sbHolder a {\r\n    display: block;\r\n    padding: 10px 38px 10px 15px;\r\n    font-size: 12px; text-decoration: none;\r\n    color: #555;\r\n}\r\n.sbHolder .sbSelector {\r\n    display: block;\r\n    position: relative;\r\n}\r\n.sbHolder .sbSelector:after {\r\n    position: absolute; top: 50%; right: 15px;\r\n    width: 12px; height: 8px;\r\n    margin-top: -4px;\r\n    background: url(/images/dashboard/galileo/down-arrow.png) no-repeat;\r\n    content: '';\r\n}\r\n.sbHolder .sbOptions {\r\n    display: block !important;\r\n    overflow: hidden; overflow-y: auto;\r\n    visibility: hidden;\r\n    height: 0;\r\n}\r\n.sbHolder .sbOptions a {\r\n    padding-top: 5px; padding-bottom: 5px;\r\n}\r\n")}).call(window)}]);
//# sourceMappingURL=dash.js.a717e9ee79a789fb6d8ebedcb64632c8.js.map