!function(e){function t(i){if(n[i])return n[i].exports;var a=n[i]={exports:{},id:i,loaded:!1};return e[i].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(module,exports,__webpack_require__){(function(){!function(e){e.ajaxSettings.xdr=function(){return window.XDomainRequest?new window.XDomainRequest:null},function(t){e.extend(e.support,{iecors:!!t})}(e.ajaxSettings.xdr()),e.support.iecors&&e.ajaxTransport(function(e){var t=e.xdr();return{send:function(n,i){t.onload=function(){var e={"Content-Type":t.contentType};i(200,"OK",{text:t.responseText},e)},e.xhrFields&&(xhr.onerror=e.xhrFields.error,xhr.ontimeout=e.xhrFields.timeout),t.open(e.type,e.url),t.send(e.hasContent&&e.data||null)},abort:function(){t.abort()}}})}(jQuery),define("shared/scripts/libs/jquery/plugins/iecors/jquery.iecors",function(){}),function(){var e=this,t=e._,n=Array.prototype,i=Object.prototype,a=Function.prototype,r=n.push,s=n.slice,o=n.concat,l=i.toString,c=i.hasOwnProperty,u=Array.isArray,h=Object.keys,d=a.bind,p=function(e){return e instanceof p?e:this instanceof p?void(this._wrapped=e):new p(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=p),exports._=p):e._=p,p.VERSION="1.7.0";var f=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,a){return e.call(t,n,i,a)};case 4:return function(n,i,a,r){return e.call(t,n,i,a,r)}}return function(){return e.apply(t,arguments)}};p.iteratee=function(e,t,n){return null==e?p.identity:p.isFunction(e)?f(e,t,n):p.isObject(e)?p.matches(e):p.property(e)},p.each=p.forEach=function(e,t,n){if(null==e)return e;t=f(t,n);var i,a=e.length;if(a===+a)for(i=0;a>i;i++)t(e[i],i,e);else{var r=p.keys(e);for(i=0,a=r.length;a>i;i++)t(e[r[i]],r[i],e)}return e},p.map=p.collect=function(e,t,n){if(null==e)return[];t=p.iteratee(t,n);for(var i,a=e.length!==+e.length&&p.keys(e),r=(a||e).length,s=Array(r),o=0;r>o;o++)i=a?a[o]:o,s[o]=t(e[i],i,e);return s};var g="Reduce of empty array with no initial value";p.reduce=p.foldl=p.inject=function(e,t,n,i){null==e&&(e=[]),t=f(t,i,4);var a,r=e.length!==+e.length&&p.keys(e),s=(r||e).length,o=0;if(arguments.length<3){if(!s)throw new TypeError(g);n=e[r?r[o++]:o++]}for(;s>o;o++)a=r?r[o]:o,n=t(n,e[a],a,e);return n},p.reduceRight=p.foldr=function(e,t,n,i){null==e&&(e=[]),t=f(t,i,4);var a,r=e.length!==+e.length&&p.keys(e),s=(r||e).length;if(arguments.length<3){if(!s)throw new TypeError(g);n=e[r?r[--s]:--s]}for(;s--;)a=r?r[s]:s,n=t(n,e[a],a,e);return n},p.find=p.detect=function(e,t,n){var i;return t=p.iteratee(t,n),p.some(e,function(e,n,a){return t(e,n,a)?(i=e,!0):void 0}),i},p.filter=p.select=function(e,t,n){var i=[];return null==e?i:(t=p.iteratee(t,n),p.each(e,function(e,n,a){t(e,n,a)&&i.push(e)}),i)},p.reject=function(e,t,n){return p.filter(e,p.negate(p.iteratee(t)),n)},p.every=p.all=function(e,t,n){if(null==e)return!0;t=p.iteratee(t,n);var i,a,r=e.length!==+e.length&&p.keys(e),s=(r||e).length;for(i=0;s>i;i++)if(a=r?r[i]:i,!t(e[a],a,e))return!1;return!0},p.some=p.any=function(e,t,n){if(null==e)return!1;t=p.iteratee(t,n);var i,a,r=e.length!==+e.length&&p.keys(e),s=(r||e).length;for(i=0;s>i;i++)if(a=r?r[i]:i,t(e[a],a,e))return!0;return!1},p.contains=p.include=function(e,t){return null==e?!1:(e.length!==+e.length&&(e=p.values(e)),p.indexOf(e,t)>=0)},p.invoke=function(e,t){var n=s.call(arguments,2),i=p.isFunction(t);return p.map(e,function(e){return(i?t:e[t]).apply(e,n)})},p.pluck=function(e,t){return p.map(e,p.property(t))},p.where=function(e,t){return p.filter(e,p.matches(t))},p.findWhere=function(e,t){return p.find(e,p.matches(t))},p.max=function(e,t,n){var i,a,r=-(1/0),s=-(1/0);if(null==t&&null!=e){e=e.length===+e.length?e:p.values(e);for(var o=0,l=e.length;l>o;o++)i=e[o],i>r&&(r=i)}else t=p.iteratee(t,n),p.each(e,function(e,n,i){a=t(e,n,i),(a>s||a===-(1/0)&&r===-(1/0))&&(r=e,s=a)});return r},p.min=function(e,t,n){var i,a,r=1/0,s=1/0;if(null==t&&null!=e){e=e.length===+e.length?e:p.values(e);for(var o=0,l=e.length;l>o;o++)i=e[o],r>i&&(r=i)}else t=p.iteratee(t,n),p.each(e,function(e,n,i){a=t(e,n,i),(s>a||a===1/0&&r===1/0)&&(r=e,s=a)});return r},p.shuffle=function(e){for(var t,n=e&&e.length===+e.length?e:p.values(e),i=n.length,a=Array(i),r=0;i>r;r++)t=p.random(0,r),t!==r&&(a[r]=a[t]),a[t]=n[r];return a},p.sample=function(e,t,n){return null==t||n?(e.length!==+e.length&&(e=p.values(e)),e[p.random(e.length-1)]):p.shuffle(e).slice(0,Math.max(0,t))},p.sortBy=function(e,t,n){return t=p.iteratee(t,n),p.pluck(p.map(e,function(e,n,i){return{value:e,index:n,criteria:t(e,n,i)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return e.index-t.index}),"value")};var m=function(e){return function(t,n,i){var a={};return n=p.iteratee(n,i),p.each(t,function(i,r){var s=n(i,r,t);e(a,i,s)}),a}};p.groupBy=m(function(e,t,n){p.has(e,n)?e[n].push(t):e[n]=[t]}),p.indexBy=m(function(e,t,n){e[n]=t}),p.countBy=m(function(e,t,n){p.has(e,n)?e[n]++:e[n]=1}),p.sortedIndex=function(e,t,n,i){n=p.iteratee(n,i,1);for(var a=n(t),r=0,s=e.length;s>r;){var o=r+s>>>1;n(e[o])<a?r=o+1:s=o}return r},p.toArray=function(e){return e?p.isArray(e)?s.call(e):e.length===+e.length?p.map(e,p.identity):p.values(e):[]},p.size=function(e){return null==e?0:e.length===+e.length?e.length:p.keys(e).length},p.partition=function(e,t,n){t=p.iteratee(t,n);var i=[],a=[];return p.each(e,function(e,n,r){(t(e,n,r)?i:a).push(e)}),[i,a]},p.first=p.head=p.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:0>t?[]:s.call(e,0,t)},p.initial=function(e,t,n){return s.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},p.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:s.call(e,Math.max(e.length-t,0))},p.rest=p.tail=p.drop=function(e,t,n){return s.call(e,null==t||n?1:t)},p.compact=function(e){return p.filter(e,p.identity)};var v=function(e,t,n,i){if(t&&p.every(e,p.isArray))return o.apply(i,e);for(var a=0,s=e.length;s>a;a++){var l=e[a];p.isArray(l)||p.isArguments(l)?t?r.apply(i,l):v(l,t,n,i):n||i.push(l)}return i};p.flatten=function(e,t){return v(e,t,!1,[])},p.without=function(e){return p.difference(e,s.call(arguments,1))},p.uniq=p.unique=function(e,t,n,i){if(null==e)return[];p.isBoolean(t)||(i=n,n=t,t=!1),null!=n&&(n=p.iteratee(n,i));for(var a=[],r=[],s=0,o=e.length;o>s;s++){var l=e[s];if(t)s&&r===l||a.push(l),r=l;else if(n){var c=n(l,s,e);p.indexOf(r,c)<0&&(r.push(c),a.push(l))}else p.indexOf(a,l)<0&&a.push(l)}return a},p.union=function(){return p.uniq(v(arguments,!0,!0,[]))},p.intersection=function(e){if(null==e)return[];for(var t=[],n=arguments.length,i=0,a=e.length;a>i;i++){var r=e[i];if(!p.contains(t,r)){for(var s=1;n>s&&p.contains(arguments[s],r);s++);s===n&&t.push(r)}}return t},p.difference=function(e){var t=v(s.call(arguments,1),!0,!0,[]);return p.filter(e,function(e){return!p.contains(t,e)})},p.zip=function(e){if(null==e)return[];for(var t=p.max(arguments,"length").length,n=Array(t),i=0;t>i;i++)n[i]=p.pluck(arguments,i);return n},p.object=function(e,t){if(null==e)return{};for(var n={},i=0,a=e.length;a>i;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n},p.indexOf=function(e,t,n){if(null==e)return-1;var i=0,a=e.length;if(n){if("number"!=typeof n)return i=p.sortedIndex(e,t),e[i]===t?i:-1;i=0>n?Math.max(0,a+n):n}for(;a>i;i++)if(e[i]===t)return i;return-1},p.lastIndexOf=function(e,t,n){if(null==e)return-1;var i=e.length;for("number"==typeof n&&(i=0>n?i+n+1:Math.min(i,n+1));--i>=0;)if(e[i]===t)return i;return-1},p.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=n||1;for(var i=Math.max(Math.ceil((t-e)/n),0),a=Array(i),r=0;i>r;r++,e+=n)a[r]=e;return a};var y=function(){};p.bind=function(e,t){var n,i;if(d&&e.bind===d)return d.apply(e,s.call(arguments,1));if(!p.isFunction(e))throw new TypeError("Bind must be called on a function");return n=s.call(arguments,2),i=function(){if(!(this instanceof i))return e.apply(t,n.concat(s.call(arguments)));y.prototype=e.prototype;var a=new y;y.prototype=null;var r=e.apply(a,n.concat(s.call(arguments)));return p.isObject(r)?r:a}},p.partial=function(e){var t=s.call(arguments,1);return function(){for(var n=0,i=t.slice(),a=0,r=i.length;r>a;a++)i[a]===p&&(i[a]=arguments[n++]);for(;n<arguments.length;)i.push(arguments[n++]);return e.apply(this,i)}},p.bindAll=function(e){var t,n,i=arguments.length;if(1>=i)throw new Error("bindAll must be passed function names");for(t=1;i>t;t++)n=arguments[t],e[n]=p.bind(e[n],e);return e},p.memoize=function(e,t){var n=function(i){var a=n.cache,r=t?t.apply(this,arguments):i;return p.has(a,r)||(a[r]=e.apply(this,arguments)),a[r]};return n.cache={},n},p.delay=function(e,t){var n=s.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},p.defer=function(e){return p.delay.apply(p,[e,1].concat(s.call(arguments,1)))},p.throttle=function(e,t,n){var i,a,r,s=null,o=0;n||(n={});var l=function(){o=n.leading===!1?0:p.now(),s=null,r=e.apply(i,a),s||(i=a=null)};return function(){var c=p.now();o||n.leading!==!1||(o=c);var u=t-(c-o);return i=this,a=arguments,0>=u||u>t?(clearTimeout(s),s=null,o=c,r=e.apply(i,a),s||(i=a=null)):s||n.trailing===!1||(s=setTimeout(l,u)),r}},p.debounce=function(e,t,n){var i,a,r,s,o,l=function(){var c=p.now()-s;t>c&&c>0?i=setTimeout(l,t-c):(i=null,n||(o=e.apply(r,a),i||(r=a=null)))};return function(){r=this,a=arguments,s=p.now();var c=n&&!i;return i||(i=setTimeout(l,t)),c&&(o=e.apply(r,a),r=a=null),o}},p.wrap=function(e,t){return p.partial(t,e)},p.negate=function(e){return function(){return!e.apply(this,arguments)}},p.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,i=e[t].apply(this,arguments);n--;)i=e[n].call(this,i);return i}},p.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},p.before=function(e,t){var n;return function(){return--e>0?n=t.apply(this,arguments):t=null,n}},p.once=p.partial(p.before,2),p.keys=function(e){if(!p.isObject(e))return[];if(h)return h(e);var t=[];for(var n in e)p.has(e,n)&&t.push(n);return t},p.values=function(e){for(var t=p.keys(e),n=t.length,i=Array(n),a=0;n>a;a++)i[a]=e[t[a]];return i},p.pairs=function(e){for(var t=p.keys(e),n=t.length,i=Array(n),a=0;n>a;a++)i[a]=[t[a],e[t[a]]];return i},p.invert=function(e){for(var t={},n=p.keys(e),i=0,a=n.length;a>i;i++)t[e[n[i]]]=n[i];return t},p.functions=p.methods=function(e){var t=[];for(var n in e)p.isFunction(e[n])&&t.push(n);return t.sort()},p.extend=function(e){if(!p.isObject(e))return e;for(var t,n,i=1,a=arguments.length;a>i;i++){t=arguments[i];for(n in t)c.call(t,n)&&(e[n]=t[n])}return e},p.pick=function(e,t,n){var i,a={};if(null==e)return a;if(p.isFunction(t)){t=f(t,n);for(i in e){var r=e[i];t(r,i,e)&&(a[i]=r)}}else{var l=o.apply([],s.call(arguments,1));e=new Object(e);for(var c=0,u=l.length;u>c;c++)i=l[c],i in e&&(a[i]=e[i])}return a},p.omit=function(e,t,n){if(p.isFunction(t))t=p.negate(t);else{var i=p.map(o.apply([],s.call(arguments,1)),String);t=function(e,t){return!p.contains(i,t)}}return p.pick(e,t,n)},p.defaults=function(e){if(!p.isObject(e))return e;for(var t=1,n=arguments.length;n>t;t++){var i=arguments[t];for(var a in i)void 0===e[a]&&(e[a]=i[a])}return e},p.clone=function(e){return p.isObject(e)?p.isArray(e)?e.slice():p.extend({},e):e},p.tap=function(e,t){return t(e),e};var b=function(e,t,n,i){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return e===t;e instanceof p&&(e=e._wrapped),t instanceof p&&(t=t._wrapped);var a=l.call(e);if(a!==l.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}if("object"!=typeof e||"object"!=typeof t)return!1;for(var r=n.length;r--;)if(n[r]===e)return i[r]===t;var s=e.constructor,o=t.constructor;if(s!==o&&"constructor"in e&&"constructor"in t&&!(p.isFunction(s)&&s instanceof s&&p.isFunction(o)&&o instanceof o))return!1;n.push(e),i.push(t);var c,u;if("[object Array]"===a){if(c=e.length,u=c===t.length)for(;c--&&(u=b(e[c],t[c],n,i)););}else{var h,d=p.keys(e);if(c=d.length,u=p.keys(t).length===c)for(;c--&&(h=d[c],u=p.has(t,h)&&b(e[h],t[h],n,i)););}return n.pop(),i.pop(),u};p.isEqual=function(e,t){return b(e,t,[],[])},p.isEmpty=function(e){if(null==e)return!0;if(p.isArray(e)||p.isString(e)||p.isArguments(e))return 0===e.length;for(var t in e)if(p.has(e,t))return!1;return!0},p.isElement=function(e){return!(!e||1!==e.nodeType)},p.isArray=u||function(e){return"[object Array]"===l.call(e)},p.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},p.each(["Arguments","Function","String","Number","Date","RegExp"],function(e){p["is"+e]=function(t){return l.call(t)==="[object "+e+"]"}}),p.isArguments(arguments)||(p.isArguments=function(e){return p.has(e,"callee")}),"function"!=typeof/./&&(p.isFunction=function(e){return"function"==typeof e||!1}),p.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},p.isNaN=function(e){return p.isNumber(e)&&e!==+e},p.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===l.call(e)},p.isNull=function(e){return null===e},p.isUndefined=function(e){return void 0===e},p.has=function(e,t){return null!=e&&c.call(e,t)},p.noConflict=function(){return e._=t,this},p.identity=function(e){return e},p.constant=function(e){return function(){return e}},p.noop=function(){},p.property=function(e){return function(t){return t[e]}},p.matches=function(e){var t=p.pairs(e),n=t.length;return function(e){if(null==e)return!n;e=new Object(e);for(var i=0;n>i;i++){var a=t[i],r=a[0];if(a[1]!==e[r]||!(r in e))return!1}return!0}},p.times=function(e,t,n){var i=Array(Math.max(0,e));t=f(t,n,1);for(var a=0;e>a;a++)i[a]=t(a);return i},p.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},p.now=Date.now||function(){return(new Date).getTime()};var w={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},_=p.invert(w),x=function(e){var t=function(t){return e[t]},n="(?:"+p.keys(e).join("|")+")",i=RegExp(n),a=RegExp(n,"g");return function(e){return e=null==e?"":""+e,i.test(e)?e.replace(a,t):e}};p.escape=x(w),p.unescape=x(_),p.result=function(e,t){if(null==e)return void 0;var n=e[t];return p.isFunction(n)?e[t]():n};var k=0;p.uniqueId=function(e){var t=++k+"";return e?e+t:t},p.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var S=/(.)^/,T={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},M=/\\|'|\r|\n|\u2028|\u2029/g,C=function(e){return"\\"+T[e]};p.template=function(e,t,n){!t&&n&&(t=n),t=p.defaults({},t,p.templateSettings);var i=RegExp([(t.escape||S).source,(t.interpolate||S).source,(t.evaluate||S).source].join("|")+"|$","g"),a=0,r="__p+='";e.replace(i,function(t,n,i,s,o){return r+=e.slice(a,o).replace(M,C),a=o+t.length,n?r+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?r+="'+\n((__t=("+i+"))==null?'':__t)+\n'":s&&(r+="';\n"+s+"\n__p+='"),t}),r+="';\n",t.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{var s=new Function(t.variable||"obj","_",r)}catch(o){throw o.source=r,o}var l=function(e){return s.call(this,e,p)},c=t.variable||"obj";return l.source="function("+c+"){\n"+r+"}",l},p.chain=function(e){var t=p(e);return t._chain=!0,t};var E=function(e){return this._chain?p(e).chain():e};p.mixin=function(e){p.each(p.functions(e),function(t){var n=p[t]=e[t];p.prototype[t]=function(){var e=[this._wrapped];return r.apply(e,arguments),E.call(this,n.apply(p,e))}})},p.mixin(p),p.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];p.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0],E.call(this,n)}}),p.each(["concat","join","slice"],function(e){var t=n[e];p.prototype[e]=function(){return E.call(this,t.apply(this._wrapped,arguments))}}),p.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return p})}.call(this),define("Logger",[],function(){return function(){try{window.onerror.apply(window,arguments)}catch(e){}}}),function(){this.MooTools={version:"1.4.5",build:"ab8ea8824dc3b24b6666867a2c4ed58ebb762cf0"};var e=this.typeOf=function(e){if(null==e)return"null";if(null!=e.$family)return e.$family();if(e.nodeName){if(1==e.nodeType)return"element";if(3==e.nodeType)return/\S/.test(e.nodeValue)?"textnode":"whitespace"}else if("number"==typeof e.length){if(e.callee)return"arguments";if("item"in e)return"collection"}return typeof e},t=(this.instanceOf=function(e,t){if(null==e)return!1;for(var n=e.$constructor||e.constructor;n;){if(n===t)return!0;n=n.parent}return e.hasOwnProperty?e instanceof t:!1},this.Function),n=!0;for(var i in{toString:1})n=null;n&&(n=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"]),t.prototype.overloadSetter=function(e){var t=this;return function(i,a){if(null==i)return this;if(e||"string"!=typeof i){for(var r in i)t.call(this,r,i[r]);if(n)for(var s=n.length;s--;)r=n[s],i.hasOwnProperty(r)&&t.call(this,r,i[r])}else t.call(this,i,a);return this}},t.prototype.overloadGetter=function(e){var t=this;return function(n){var i,a;if("string"!=typeof n?i=n:arguments.length>1?i=arguments:e&&(i=[n]),i){a={};for(var r=0;r<i.length;r++)a[i[r]]=t.call(this,i[r])}else a=t.call(this,n);return a}},t.prototype.extend=function(e,t){this[e]=t}.overloadSetter(),t.prototype.implement=function(e,t){this.prototype[e]=t}.overloadSetter();var a=Array.prototype.slice;t.from=function(t){return"function"==e(t)?t:function(){return t}},Array.from=function(t){return null==t?[]:r.isEnumerable(t)&&"string"!=typeof t?"array"==e(t)?t:a.call(t):[t]},Number.from=function(e){var t=parseFloat(e);return isFinite(t)?t:null},String.from=function(e){return e+""},t.implement({hide:function(){return this.$hidden=!0,this},protect:function(){return this.$protected=!0,this}});var r=this.Type=function(t,n){if(t){var i=t.toLowerCase(),a=function(t){return e(t)==i};r["is"+t]=a,null!=n&&(n.prototype.$family=function(){return i}.hide())}return null==n?null:(n.extend(this),n.$constructor=r,n.prototype.$constructor=n,n)},s=Object.prototype.toString;r.isEnumerable=function(e){return null!=e&&"number"==typeof e.length&&"[object Function]"!=s.call(e)};var o={},l=function(t){var n=e(t.prototype);return o[n]||(o[n]=[])},c=function(t,n){if(!n||!n.$hidden){for(var i=l(this),r=0;r<i.length;r++){var s=i[r];"type"==e(s)?c.call(s,t,n):s.call(this,t,n)}var o=this.prototype[t];null!=o&&o.$protected||(this.prototype[t]=n),null==this[t]&&"function"==e(n)&&u.call(this,t,function(e){return n.apply(e,a.call(arguments,1))})}},u=function(e,t){if(!t||!t.$hidden){var n=this[e];null!=n&&n.$protected||(this[e]=t)}};r.implement({implement:c.overloadSetter(),extend:u.overloadSetter(),alias:function(e,t){c.call(this,e,this.prototype[t])}.overloadSetter(),mirror:function(e){return l(this).push(e),this}}),new r("Type",r);var h=function(e,t,n){var i=t!=Object,a=t.prototype;i&&(t=new r(e,t));for(var s=0,o=n.length;o>s;s++){var l=n[s],c=t[l],u=a[l];c&&c.protect(),i&&u&&t.implement(l,u.protect())}if(i){var d=a.propertyIsEnumerable(n[0]);t.forEachMethod=function(e){if(!d)for(var t=0,i=n.length;i>t;t++)e.call(a,a[n[t]],n[t]);for(var r in a)e.call(a,a[r],r)}}return h};h("String",String,["charAt","charCodeAt","concat","indexOf","lastIndexOf","match","quote","replace","search","slice","split","substr","substring","trim","toLowerCase","toUpperCase"])("Array",Array,["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice","indexOf","lastIndexOf","filter","forEach","every","map","some","reduce","reduceRight"])("Number",Number,["toExponential","toFixed","toLocaleString","toPrecision"])("Function",t,["apply","call","bind"])("RegExp",RegExp,["exec","test"])("Object",Object,["create","defineProperty","defineProperties","keys","getPrototypeOf","getOwnPropertyDescriptor","getOwnPropertyNames","preventExtensions","isExtensible","seal","isSealed","freeze","isFrozen"])("Date",Date,["now"]),Object.extend=u.overloadSetter(),Date.extend("now",function(){return+new Date}),new r("Boolean",Boolean),Number.prototype.$family=function(){return isFinite(this)?"number":"null"}.hide(),Number.extend("random",function(e,t){return Math.floor(Math.random()*(t-e+1)+e)});var d=Object.prototype.hasOwnProperty;Object.extend("forEach",function(e,t,n){for(var i in e)d.call(e,i)&&t.call(n,e[i],i,e)}),Object.each=Object.forEach,Array.implement({forEach:function(e,t){for(var n=0,i=this.length;i>n;n++)n in this&&e.call(t,this[n],n,this)},each:function(e,t){return Array.forEach(this,e,t),this}});var p=function(t){switch(e(t)){case"array":return t.clone();case"object":return Object.clone(t);default:return t}};Array.implement("clone",function(){for(var e=this.length,t=new Array(e);e--;)t[e]=p(this[e]);return t});var f=function(t,n,i){switch(e(i)){case"object":"object"==e(t[n])?Object.merge(t[n],i):t[n]=Object.clone(i);break;case"array":t[n]=i.clone();break;default:t[n]=i}return t};Object.extend({merge:function(t,n,i){if("string"==e(n))return f(t,n,i);for(var a=1,r=arguments.length;r>a;a++){var s=arguments[a];for(var o in s)f(t,o,s[o])}return t},clone:function(e){var t={};for(var n in e)t[n]=p(e[n]);return t},append:function(e){for(var t=1,n=arguments.length;n>t;t++){var i=arguments[t]||{};for(var a in i)e[a]=i[a]}return e}}),["Object","WhiteSpace","TextNode","Collection","Arguments"].each(function(e){new r(e)});var g=Date.now();String.extend("uniqueID",function(){return(g++).toString(36)})}(),Array.implement({every:function(e,t){for(var n=0,i=this.length>>>0;i>n;n++)if(n in this&&!e.call(t,this[n],n,this))return!1;return!0},filter:function(e,t){for(var n,i=[],a=0,r=this.length>>>0;r>a;a++)a in this&&(n=this[a],e.call(t,n,a,this)&&i.push(n));return i},indexOf:function(e,t){for(var n=this.length>>>0,i=0>t?Math.max(0,n+t):t||0;n>i;i++)if(this[i]===e)return i;return-1},map:function(e,t){for(var n=this.length>>>0,i=Array(n),a=0;n>a;a++)a in this&&(i[a]=e.call(t,this[a],a,this));return i},some:function(e,t){for(var n=0,i=this.length>>>0;i>n;n++)if(n in this&&e.call(t,this[n],n,this))return!0;return!1},clean:function(){return this.filter(function(e){return null!=e})},invoke:function(e){var t=Array.slice(arguments,1);return this.map(function(n){return n[e].apply(n,t)})},associate:function(e){for(var t={},n=Math.min(this.length,e.length),i=0;n>i;i++)t[e[i]]=this[i];return t},link:function(e){for(var t={},n=0,i=this.length;i>n;n++)for(var a in e)if(e[a](this[n])){t[a]=this[n],delete e[a];break}return t},contains:function(e,t){return-1!=this.indexOf(e,t)},append:function(e){return this.push.apply(this,e),this},getLast:function(){return this.length?this[this.length-1]:null},getRandom:function(){return this.length?this[Number.random(0,this.length-1)]:null},include:function(e){return this.contains(e)||this.push(e),this},combine:function(e){for(var t=0,n=e.length;n>t;t++)this.include(e[t]);return this},erase:function(e){for(var t=this.length;t--;)this[t]===e&&this.splice(t,1);return this},empty:function(){return this.length=0,this},flatten:function(){for(var e=[],t=0,n=this.length;n>t;t++){var i=typeOf(this[t]);"null"!=i&&(e=e.concat("array"==i||"collection"==i||"arguments"==i||instanceOf(this[t],Array)?Array.flatten(this[t]):this[t]))}return e},pick:function(){for(var e=0,t=this.length;t>e;e++)if(null!=this[e])return this[e];return null},hexToRgb:function(e){if(3!=this.length)return null;var t=this.map(function(e){return 1==e.length&&(e+=e),e.toInt(16)});return e?t:"rgb("+t+")"},rgbToHex:function(e){if(this.length<3)return null;if(4==this.length&&0==this[3]&&!e)return"transparent";for(var t=[],n=0;3>n;n++){var i=(this[n]-0).toString(16);t.push(1==i.length?"0"+i:i)}return e?t:"#"+t.join("")}}),String.implement({test:function(e,t){return("regexp"==typeOf(e)?e:new RegExp(""+e,t)).test(this)},contains:function(e,t){return t?(t+this+t).indexOf(t+e+t)>-1:String(this).indexOf(e)>-1},trim:function(){return String(this).replace(/^\s+|\s+$/g,"")},clean:function(){return String(this).replace(/\s+/g," ").trim()},camelCase:function(){return String(this).replace(/-\D/g,function(e){return e.charAt(1).toUpperCase()})},hyphenate:function(){return String(this).replace(/[A-Z]/g,function(e){return"-"+e.charAt(0).toLowerCase()})},capitalize:function(){return String(this).replace(/\b[a-z]/g,function(e){return e.toUpperCase()})},escapeRegExp:function(){return String(this).replace(/([-.*+?^{$}()|[\]\/\\])/g,"\\$1")},toInt:function(e){return parseInt(this,e||10)},toFloat:function(){return parseFloat(this)},hexToRgb:function(e){var t=String(this).match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);return t?t.slice(1).hexToRgb(e):null},rgbToHex:function(e){var t=String(this).match(/\d{1,3}/g);return t?t.rgbToHex(e):null},substitute:function(e,t){return String(this).replace(t||/\\?\{([^{}]+)\}/g,function(t,n){return"\\"==t.charAt(0)?t.slice(1):null!=e[n]?e[n]:""})}}),Number.implement({limit:function(e,t){return Math.min(t,Math.max(e,this))},round:function(e){return e=Math.pow(10,e||0).toFixed(0>e?-e:0),Math.round(this*e)/e},times:function(e,t){for(var n=0;this>n;n++)e.call(t,n,this)},toFloat:function(){return parseFloat(this)},toInt:function(e){return parseInt(this,e||10)}}),Number.alias("each","times"),function(e){var t={};e.each(function(e){Number[e]||(t[e]=function(){return Math[e].apply(null,[this].concat(Array.from(arguments)))})}),Number.implement(t)}(["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","pow","sin","sqrt","tan"]),Function.extend({attempt:function(){for(var e=0,t=arguments.length;t>e;e++)try{return arguments[e]()}catch(n){}return null}}),Function.implement({attempt:function(e,t){try{return this.apply(t,Array.from(e))}catch(n){}return null},bind:function(e){var t=this,n=arguments.length>1?Array.slice(arguments,1):null,i=function(){},a=function(){var r=e,s=arguments.length;this instanceof a&&(i.prototype=t.prototype,r=new i);var o=n||s?t.apply(r,n&&s?n.concat(Array.slice(arguments)):n||arguments):t.call(r);return r==e?o:r};return a},pass:function(e,t){var n=this;return null!=e&&(e=Array.from(e)),function(){return n.apply(t,e||arguments)}},delay:function(e,t,n){return setTimeout(this.pass(null==n?[]:n,t),e)},periodical:function(e,t,n){return setInterval(this.pass(null==n?[]:n,t),e)}}),function(){var e=this.document,t=e.window=this,n=navigator.userAgent.toLowerCase(),i=navigator.platform.toLowerCase(),a=n.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],r="ie"==a[1]&&e.documentMode,s=this.Browser={extend:Function.prototype.extend,name:"version"==a[1]?a[3]:a[1],version:r||parseFloat("opera"==a[1]&&a[4]?a[4]:a[2]),Platform:{name:n.match(/ip(?:ad|od|hone)/)?"ios":(n.match(/(?:webos|android)/)||i.match(/mac|win|linux/)||["other"])[0]},Features:{xpath:!!e.evaluate,air:!!t.runtime,query:!!e.querySelector,json:!!t.JSON},Plugins:{}};s[s.name]=!0,s[s.name+parseInt(s.version,10)]=!0,s.Platform[s.Platform.name]=!0,s.Request=function(){var e=function(){return new XMLHttpRequest},t=function(){return new ActiveXObject("MSXML2.XMLHTTP")},n=function(){return new ActiveXObject("Microsoft.XMLHTTP")};return Function.attempt(function(){return e(),e},function(){return t(),t},function(){return n(),n})}(),s.Features.xhr=!!s.Request;var o=(Function.attempt(function(){return navigator.plugins["Shockwave Flash"].description},function(){return new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")})||"0 r0").match(/\d+/g);if(s.Plugins.Flash={version:Number(o[0]||"0."+o[1])||0,build:Number(o[2])||0},s.exec=function(n){if(!n)return n;if(t.execScript)t.execScript(n);else{var i=e.createElement("script");i.setAttribute("type","text/javascript"),i.text=n,e.head.appendChild(i),e.head.removeChild(i)}return n},String.implement("stripScripts",function(e){var t="",n=this.replace(/<script[^>]*>([\s\S]*?)<\/script>/gi,function(e,n){return t+=n+"\n",""});return e===!0?s.exec(t):"function"==typeOf(e)&&e(t,n),n}),s.extend({Document:this.Document,Window:this.Window,Element:this.Element,Event:this.Event}),this.Window=this.$constructor=new Type("Window",function(){}),this.$family=Function.from("window").hide(),Window.mirror(function(e,n){t[e]=n}),this.Document=e.$constructor=new Type("Document",function(){}),e.$family=Function.from("document").hide(),Document.mirror(function(t,n){e[t]=n}),e.html=e.documentElement,e.head||(e.head=e.getElementsByTagName("head")[0]),e.execCommand)try{e.execCommand("BackgroundImageCache",!1,!0)}catch(l){}if(this.attachEvent&&!this.addEventListener){var c=function(){this.detachEvent("onunload",c),e.head=e.html=e.window=null};this.attachEvent("onunload",c)}var u=Array.from;try{u(e.html.childNodes)}catch(l){Array.from=function(e){if("string"!=typeof e&&Type.isEnumerable(e)&&"array"!=typeOf(e)){for(var t=e.length,n=new Array(t);t--;)n[t]=e[t];return n}return u(e)};var h=Array.prototype,d=h.slice;["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice"].each(function(e){var t=h[e];Array[e]=function(e){return t.apply(Array.from(e),d.call(arguments,1))}})}}(),function(){var e=Object.prototype.hasOwnProperty;Object.extend({subset:function(e,t){for(var n={},i=0,a=t.length;a>i;i++){var r=t[i];r in e&&(n[r]=e[r])}return n},map:function(t,n,i){var a={};for(var r in t)e.call(t,r)&&(a[r]=n.call(i,t[r],r,t));return a},filter:function(t,n,i){var a={};for(var r in t){var s=t[r];e.call(t,r)&&n.call(i,s,r,t)&&(a[r]=s)}return a},every:function(t,n,i){for(var a in t)if(e.call(t,a)&&!n.call(i,t[a],a))return!1;return!0},some:function(t,n,i){for(var a in t)if(e.call(t,a)&&n.call(i,t[a],a))return!0;return!1},keys:function(t){var n=[];for(var i in t)e.call(t,i)&&n.push(i);return n},values:function(t){var n=[];for(var i in t)e.call(t,i)&&n.push(t[i]);return n},getLength:function(e){return Object.keys(e).length},keyOf:function(t,n){for(var i in t)if(e.call(t,i)&&t[i]===n)return i;return null},contains:function(e,t){return null!=Object.keyOf(e,t)},toQueryString:function(e,t){var n=[];return Object.each(e,function(e,i){t&&(i=t+"["+i+"]");var a;switch(typeOf(e)){case"object":a=Object.toQueryString(e,i);break;case"array":var r={};e.each(function(e,t){r[t]=e}),a=Object.toQueryString(r,i);break;default:a=i+"="+encodeURIComponent(e)}null!=e&&n.push(a)}),n.join("&")}})}(),function(){var e={},t=this.DOMEvent=new Type("DOMEvent",function(t,n){if(n||(n=window),t=t||n.event,t.$extended)return t;this.event=t,this.$extended=!0,this.shift=t.shiftKey,this.control=t.ctrlKey,this.alt=t.altKey,this.meta=t.metaKey;for(var i=this.type=t.type,a=t.target||t.srcElement;a&&3==a.nodeType;)a=a.parentNode;if(this.target=document.id(a),0==i.indexOf("key")){var r=this.code=t.which||t.keyCode;this.key=e[r],"keydown"==i&&(r>111&&124>r?this.key="f"+(r-111):r>95&&106>r&&(this.key=r-96)),null==this.key&&(this.key=String.fromCharCode(r).toLowerCase())}else if("click"==i||"dblclick"==i||"contextmenu"==i||"DOMMouseScroll"==i||0==i.indexOf("mouse")){var s=n.document;if(s=s.compatMode&&"CSS1Compat"!=s.compatMode?s.body:s.html,this.page={x:null!=t.pageX?t.pageX:t.clientX+s.scrollLeft,y:null!=t.pageY?t.pageY:t.clientY+s.scrollTop},this.client={x:null!=t.pageX?t.pageX-n.pageXOffset:t.clientX,y:null!=t.pageY?t.pageY-n.pageYOffset:t.clientY},("DOMMouseScroll"==i||"mousewheel"==i)&&(this.wheel=t.wheelDelta?t.wheelDelta/120:-(t.detail||0)/3),this.rightClick=3==t.which||2==t.button,"mouseover"==i||"mouseout"==i){for(var o=t.relatedTarget||t[("mouseover"==i?"from":"to")+"Element"];o&&3==o.nodeType;)o=o.parentNode;this.relatedTarget=document.id(o)}}else if(0==i.indexOf("touch")||0==i.indexOf("gesture")){this.rotation=t.rotation,this.scale=t.scale,this.targetTouches=t.targetTouches,
this.changedTouches=t.changedTouches;var l=this.touches=t.touches;if(l&&l[0]){var c=l[0];this.page={x:c.pageX,y:c.pageY},this.client={x:c.clientX,y:c.clientY}}}this.client||(this.client={}),this.page||(this.page={})});t.implement({stop:function(){return this.preventDefault().stopPropagation()},stopPropagation:function(){return this.event.stopPropagation?this.event.stopPropagation():this.event.cancelBubble=!0,this},preventDefault:function(){return this.event.preventDefault?this.event.preventDefault():this.event.returnValue=!1,this}}),t.defineKey=function(t,n){return e[t]=n,this},t.defineKeys=t.defineKey.overloadSetter(!0),t.defineKeys({38:"up",40:"down",37:"left",39:"right",27:"esc",32:"space",8:"backspace",9:"tab",46:"delete",13:"enter"})}(),function(){var e=this.Class=new Type("Class",function(i){instanceOf(i,Function)&&(i={initialize:i});var a=function(){if(n(this),a.$prototyping)return this;this.$caller=null;var e=this.initialize?this.initialize.apply(this,arguments):this;return this.$caller=this.caller=null,e}.extend(this).implement(i);return a.$constructor=e,a.prototype.$constructor=a,a.prototype.parent=t,a}),t=function(){if(!this.$caller)throw new Error('The method "parent" cannot be called.');var e=this.$caller.$name,t=this.$caller.$owner.parent,n=t?t.prototype[e]:null;if(!n)throw new Error('The method "'+e+'" has no parent.');return n.apply(this,arguments)},n=function(e){for(var t in e){var i=e[t];switch(typeOf(i)){case"object":var a=function(){};a.prototype=i,e[t]=n(new a);break;case"array":e[t]=i.clone()}}return e},i=function(e,t,n){n.$origin&&(n=n.$origin);var i=function(){if(n.$protected&&null==this.$caller)throw new Error('The method "'+t+'" cannot be called.');var e=this.caller,a=this.$caller;this.caller=a,this.$caller=i;var r=n.apply(this,arguments);return this.$caller=a,this.caller=e,r}.extend({$owner:e,$origin:n,$name:t});return i},a=function(t,n,a){if(e.Mutators.hasOwnProperty(t)&&(n=e.Mutators[t].call(this,n),null==n))return this;if("function"==typeOf(n)){if(n.$hidden)return this;this.prototype[t]=a?n:i(this,t,n)}else Object.merge(this.prototype,t,n);return this},r=function(e){e.$prototyping=!0;var t=new e;return delete e.$prototyping,t};e.implement("implement",a.overloadSetter()),e.Mutators={Extends:function(e){this.parent=e,this.prototype=r(e)},Implements:function(e){Array.from(e).each(function(e){var t=new e;for(var n in t)a.call(this,n,t[n],!0)},this)}}}(),function(){this.Chain=new Class({$chain:[],chain:function(){return this.$chain.append(Array.flatten(arguments)),this},callChain:function(){return this.$chain.length?this.$chain.shift().apply(this,arguments):!1},clearChain:function(){return this.$chain.empty(),this}});var e=function(e){return e.replace(/^on([A-Z])/,function(e,t){return t.toLowerCase()})};this.Events=new Class({$events:{},addEvent:function(t,n,i){return t=e(t),this.$events[t]=(this.$events[t]||[]).include(n),i&&(n.internal=!0),this},addEvents:function(e){for(var t in e)this.addEvent(t,e[t]);return this},fireEvent:function(t,n,i){t=e(t);var a=this.$events[t];return a?(n=Array.from(n),a.each(function(e){i?e.delay(i,this,n):e.apply(this,n)},this),this):this},removeEvent:function(t,n){t=e(t);var i=this.$events[t];if(i&&!n.internal){var a=i.indexOf(n);-1!=a&&delete i[a]}return this},removeEvents:function(t){var n;if("object"==typeOf(t)){for(n in t)this.removeEvent(n,t[n]);return this}t&&(t=e(t));for(n in this.$events)if(!t||t==n)for(var i=this.$events[n],a=i.length;a--;)a in i&&this.removeEvent(n,i[a]);return this}}),this.Options=new Class({setOptions:function(){var e=this.options=Object.merge.apply(null,[{},this.options].append(arguments));if(this.addEvent)for(var t in e)"function"==typeOf(e[t])&&/^on[A-Z]/.test(t)&&(this.addEvent(t,e[t]),delete e[t]);return this}})}(),"undefined"==typeof JSON&&(this.JSON={}),function(){var special={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},escape=function(e){return special[e]||"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)};JSON.validate=function(e){return e=e.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""),/^[\],:{}\s]*$/.test(e)},JSON.encode=JSON.stringify?function(e){return JSON.stringify(e)}:function(e){switch(e&&e.toJSON&&(e=e.toJSON()),typeOf(e)){case"string":return'"'+e.replace(/[\x00-\x1f\\"]/g,escape)+'"';case"array":return"["+e.map(JSON.encode).clean()+"]";case"object":case"hash":var t=[];return Object.each(e,function(e,n){var i=JSON.encode(e);i&&t.push(JSON.encode(n)+":"+i)}),"{"+t+"}";case"number":case"boolean":return""+e;case"null":return"null"}return null},JSON.decode=function(string,secure){if(!string||"string"!=typeOf(string))return null;if(secure||JSON.secure){if(JSON.parse)return JSON.parse(string);if(!JSON.validate(string))throw new Error("JSON could not decode the input; security is enabled and the value is not secure.")}return eval("("+string+")")}}(),define("mootools",function(){}),define("galileo/prototype/function",["require","mootools"],function(e){e("mootools"),Function.extend({id:function(e){return e},takeKey:function(){var e=Array.from(arguments);return function(t){for(var n=e.slice(0);n.length;)t=t[n.shift()];return t}},join:function(){var e=Array.from(arguments),t=e.pop(),n=[],i=this,a=0;e.map(function(r,s){r(function(r){s in n||a++,n[s]=r,a==e.length&&t.apply(i,n)})})}})}),define("galileo/prototype/array",["require","mootools"],function(e){e("mootools"),Array.implement({reindex:function(e){for(var t=[],n=0;n<e.length;n++)t[n]=this[e[n]];return t},sortBy:function(e){return this.sort(function(t,n){var i=e(t),a=e(n);return a>i?-1:i>a?1:0}),this},group:function(e){if(this.length<e)return[];var t=this.slice(1).group(e);return t.unshift(this.slice(0,e)),t},zipWith:function(e,t){for(var n=Math.min(this.length,e.length),i=[],a=0;n>a;a++)i.push(t(this[a],e[a],a));return i},shuffle:function(){for(var e=this.length-1;e>0;e--){var t=Math.floor(Math.random()*(e+1)),n=this[e];this[e]=this[t],this[t]=n}return this},find:function(e){for(var t=0;t<this.length;t++)if(e(this[t])===!0)return this[t];return null}})}),define("galileo/prototype/number",["require","mootools"],function(e){e("mootools"),Number.withDigits=function(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)},Number.implement({mod:function(e){return(this%e+e)%e}})}),define("galileo/prototype/all",["require","./function","./array","./number"],function(e){e("./function"),e("./array"),e("./number")});var Hashtable=function(){function e(t){var n;if("string"==typeof t)return t;if(typeof t.hashCode==u)return n=t.hashCode(),"string"==typeof n?n:e(n);if(typeof t.toString==u)return t.toString();try{return String(t)}catch(i){return Object.prototype.toString.call(t)}}function t(e,t){return e.equals(t)}function n(e,t){return typeof t.equals==u?t.equals(e):e===t}function i(e){return function(t){if(null===t)throw new Error("null is not a valid "+e);if("undefined"==typeof t)throw new Error(e+" must not be undefined")}}function a(e,t,n,i){this[0]=e,this.entries=[],this.addEntry(t,n),null!==i&&(this.getEqualityFunction=function(){return i})}function r(e){return function(t){for(var n,i=this.entries.length,a=this.getEqualityFunction(t);i--;)if(n=this.entries[i],a(t,n[0]))switch(e){case f:return!0;case g:return n;case m:return[i,n[1]]}return!1}}function s(e){return function(t){for(var n=t.length,i=0,a=this.entries.length;a>i;++i)t[n+i]=this.entries[i][e]}}function o(e,t){for(var n,i=e.length;i--;)if(n=e[i],t===n[0])return i;return null}function l(e,t){var n=e[t];return n&&n instanceof a?n:null}function c(t,n){var i=this,r=[],s={},f=typeof t==u?t:e,g=typeof n==u?n:null;this.put=function(e,t){d(e),p(t);var n,i,o=f(e),c=null;return n=l(s,o),n?(i=n.getEntryForKey(e),i?(c=i[1],i[1]=t):n.addEntry(e,t)):(n=new a(o,e,t,g),r[r.length]=n,s[o]=n),c},this.get=function(e){d(e);var t=f(e),n=l(s,t);if(n){var i=n.getEntryForKey(e);if(i)return i[1]}return null},this.containsKey=function(e){d(e);var t=f(e),n=l(s,t);return n?n.containsKey(e):!1},this.containsValue=function(e){p(e);for(var t=r.length;t--;)if(r[t].containsValue(e))return!0;return!1},this.clear=function(){r.length=0,s={}},this.isEmpty=function(){return!r.length};var m=function(e){return function(){for(var t=[],n=r.length;n--;)r[n][e](t);return t}};this.keys=m("keys"),this.values=m("values"),this.entries=m("getEntries"),this.remove=function(e){d(e);var t,n=f(e),i=null,a=l(s,n);return a&&(i=a.removeEntryForKey(e),null!==i&&(a.entries.length||(t=o(r,n),h(r,t),delete s[n]))),i},this.size=function(){for(var e=0,t=r.length;t--;)e+=r[t].entries.length;return e},this.each=function(e){for(var t,n=i.entries(),a=n.length;a--;)t=n[a],e(t[0],t[1])},this.putAll=function(e,t){for(var n,a,r,s,o=e.entries(),l=o.length,c=typeof t==u;l--;)n=o[l],a=n[0],r=n[1],c&&(s=i.get(a))&&(r=t(a,s,r)),i.put(a,r)},this.clone=function(){var e=new c(t,n);return e.putAll(i),e}}var u="function",h=typeof Array.prototype.splice==u?function(e,t){e.splice(t,1)}:function(e,t){var n,i,a;if(t===e.length-1)e.length=t;else for(n=e.slice(t+1),e.length=t,i=0,a=n.length;a>i;++i)e[t+i]=n[i]},d=i("key"),p=i("value"),f=0,g=1,m=2;return a.prototype={getEqualityFunction:function(e){return typeof e.equals==u?t:n},getEntryForKey:r(g),getEntryAndIndexForKey:r(m),removeEntryForKey:function(e){var t=this.getEntryAndIndexForKey(e);return t?(h(this.entries,t[0]),t[1]):null},addEntry:function(e,t){this.entries[this.entries.length]=[e,t]},keys:s(0),values:s(1),getEntries:function(e){for(var t=e.length,n=0,i=this.entries.length;i>n;++n)e[t+n]=this.entries[n].slice(0)},containsKey:r(f),containsValue:function(e){for(var t=this.entries.length;t--;)if(e===this.entries[t][1])return!0;return!1}},c}();define("jshashtable",function(e){return function(){var t;return t||e.Hashtable}}(this)),function(e){function t(e,t,n){this.dec=e,this.group=t,this.neg=n}function n(){for(var e=0;e<h.length;e++){localeGroup=h[e];for(var t=0;t<localeGroup.length;t++)a.put(localeGroup[t],e)}}function i(e,i){0==a.size()&&n();var r=".",s=",",o="-";e=e.toLowerCase(),i===!1&&-1===c.indexOf(e)&&/[_-]/.test(e)&&(e=e.split(/[_-]/)[1]);var l=a.get(e);if(l){var h=u[l];h&&(r=h[0],s=h[1])}return new t(r,s,o)}var a=new Hashtable,r=["ae","au","nz","ca","cn","eg","gb","hk","il","in","sg","jp","sk","ko","us","mx","pa","pr","gt","cr","tw","th","my","ph","id","ie"],s=["br","de","dk","es","gr","it","nl","co","pt","vn","tr","cl","ec","ve","ar","py","pe","be"],o=["fr_ca","at","cz","fi","fr","ru","se","za","pl"],l=["ch"],c=["fr_ca"],u=[[".",","],[",","."],[","," "],[".","'"]],h=[r,s,o,l];e.fn.formatNumber=function(t,n,i){return this.each(function(){null==n&&(n=!0),null==i&&(i=!0);var a;a=new String(e(this).is(":input")?e(this).val():e(this).text());var r=e.formatNumber(a,t);return n&&(e(this).is(":input")?e(this).val(r):e(this).text(r)),i?r:void 0})},e.formatNumber=function(t,n){for(var n=e.extend({},e.fn.formatNumber.defaults,n),a=i(n.locale.toLowerCase(),n.isFullLocale),r=(a.dec,a.group,a.neg,"0#-,."),s="",o=!1,l=0;l<n.format.length;l++){if(-1!=r.indexOf(n.format.charAt(l))){if(0==l&&"-"==n.format.charAt(l)){o=!0;continue}break}s+=n.format.charAt(l)}for(var c="",l=n.format.length-1;l>=0&&-1==r.indexOf(n.format.charAt(l));l--)c=n.format.charAt(l)+c;n.format=n.format.substring(s.length),n.format=n.format.substring(0,n.format.length-c.length);var u=new Number(t);return e._formatNumber(u,n,c,s,o)},e._formatNumber=function(t,n,a,r,s){var n=e.extend({},e.fn.formatNumber.defaults,n),o=i(n.locale.toLowerCase(),n.isFullLocale),l=o.dec,c=o.group,u=o.neg,h=!1;if(isNaN(t)){if(1!=n.nanForceZero)return null;t=0,h=!0}"%"==a&&(t=100*t);var d="";if(n.format.indexOf(".")>-1){var p=l,f=n.format.substring(n.format.lastIndexOf(".")+1);if(1==n.round)t=new Number(t.toFixed(f.length));else{var g=t.toString();g=g.substring(0,g.lastIndexOf(".")+f.length+1),t=new Number(g)}var m=t%1,v=new String(m.toFixed(f.length));v=v.substring(v.lastIndexOf(".")+1);for(var y=0;y<f.length;y++)if("#"!=f.charAt(y)||"0"==v.charAt(y)){if("#"==f.charAt(y)&&"0"==v.charAt(y)){var b=v.substring(y);if(b.match("[1-9]")){p+=v.charAt(y);continue}break}"0"==f.charAt(y)&&(p+=v.charAt(y))}else p+=v.charAt(y);d+=p}else t=Math.round(t);var w=Math.floor(t);0>t&&(w=Math.ceil(t));var _="";_=-1==n.format.indexOf(".")?n.format:n.format.substring(0,n.format.indexOf("."));var x="";if(0!=w||"#"!=_.substr(_.length-1)||h){var k=new String(Math.abs(w)),S=9999;-1!=_.lastIndexOf(",")&&(S=_.length-_.lastIndexOf(",")-1);for(var T=0,y=k.length-1;y>-1;y--)x=k.charAt(y)+x,T++,T==S&&0!=y&&(x=c+x,T=0);if(_.length>x.length){var M=_.indexOf("0");if(-1!=M)for(var C=_.length-M,E=_.length-x.length-1;x.length<C;){var A=_.charAt(E);","==A&&(A=c),x=A+x,E--}}}return x||-1===_.indexOf("0",_.length-1)||(x="0"),d=x+d,0>t&&s&&r.length>0?r=u+r:0>t&&(d=u+d),n.decimalSeparatorAlwaysShown||d.lastIndexOf(l)==d.length-1&&(d=d.substring(0,d.length-1)),d=r+d+a},e.fn.parseNumber=function(t,n,i){null==n&&(n=!0),null==i&&(i=!0);var a;a=new String(e(this).is(":input")?e(this).val():e(this).text());var r=e.parseNumber(a,t);return r&&(n&&(e(this).is(":input")?e(this).val(r.toString()):e(this).text(r.toString())),i)?r:void 0},e.parseNumber=function(t,n){for(var n=e.extend({},e.fn.parseNumber.defaults,n),a=i(n.locale.toLowerCase(),n.isFullLocale),r=a.dec,s=a.group,o=a.neg,l="1234567890.-";t.indexOf(s)>-1;)t=t.replace(s,"");t=t.replace(r,".").replace(o,"-");var c="",u=!1;("%"==t.charAt(t.length-1)||1==n.isPercentage)&&(u=!0);for(var h=0;h<t.length;h++)l.indexOf(t.charAt(h))>-1&&(c+=t.charAt(h));var d=new Number(c);if(u){d/=100;var p=c.indexOf(".");if(-1!=p){var f=c.length-p-1;d=d.toFixed(f+2)}else d=d.toFixed(c.length-1)}return d},e.parseNumber.formatCodes=i,e.fn.parseNumber.defaults={locale:"us",decimalSeparatorAlwaysShown:!1,isPercentage:!1,isFullLocale:!1},e.fn.formatNumber.defaults={format:"#,###.00",locale:"us",decimalSeparatorAlwaysShown:!1,nanForceZero:!0,round:!0,isFullLocale:!1},Number.prototype.toFixed=function(t){return e._roundNumber(this,t)},e._roundNumber=function(e,t){var n=Math.pow(10,t||0),i=String(Math.round(e*n)/n);if(t>0){var a=i.indexOf(".");for(-1==a?(i+=".",a=0):a=i.length-(a+1);t>a;)i+="0",a++}return i}}(jQuery),define("jquery.numberformatter",function(){}),/**
	 * messageformat.js
	 *
	 * ICU PluralFormat + SelectFormat for JavaScript
	 *
	 * @author Alex Sexton - @SlexAxton
	 * @version 0.1.1
	 * @license WTFPL
	 * @contributor_license Dojo CLA
	*/
function(e){function t(e,n){if(e&&n&&(t.locale[e]=n),e=e||"en",n=n||t.locale[e],!n)throw new Error("Plural Function not found for locale: "+e);this.pluralFunc=n,this.locale=e}if(!e.MessageFormat){t.locale={en:function(e){return 1===e?"one":"other"},en_us:function(){return this.en.apply(this,arguments)}},t.SafeString=function(e){this.string=e},t.SafeString.prototype.toString=function(){return this.string.toString()},t.Utils={numSub:function(e,t,n){return e.replace(/^#|[^\\]#/g,function(e){var i=e&&2===e.length?e.charAt(0):"";return i+'" + (function(){ var x = '+t+';\nif( isNaN(x) ){\nthrow new Error("MessageFormat: `"+lastkey_'+n+'+"` isnt a number.");\n}\nreturn x;\n})() + "'})},escapeExpression:function(e){var n={"\n":"\\n"},i=/(\n)|[\n]/g,a=/[\n]/,r=function(e){return n[e]||"&amp;"};return e instanceof t.SafeString?e.toString():null===e||e===!1?"":a.test(e)?e.replace(i,r):e}};var n=function(){var e={parse:function(e,t){function n(e,t,n){for(var i=e,a=n-e.length,r=0;a>r;r++)i=t+i;return i}function i(e){var t=e.charCodeAt(0);if(255>=t)var i="x",a=2;else var i="u",a=4;return"\\"+i+n(t.toString(16).toUpperCase(),"0",a)}function a(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,i)+'"'}function r(e){P>A||(A>P&&(P=A,N=[]),N.push(e))}function s(){var e="start@"+A,t=I[e];if(t)return A=t.nextPos,t.result;var n=A,i=o(),a=null!==i?function(e){return{type:"program",program:e}}(i):null;if(null!==a)var r=a;else{var r=null;A=n}return I[e]={nextPos:A,result:r},r}function o(){var e="messageFormatPattern@"+A,t=I[e];if(t)return A=t.nextPos,t.result;var n=A,i=A,a=y();if(null!==a){for(var r=[],s=l();null!==s;){r.push(s);var s=l()}if(null!==r)var o=[a,r];else{var o=null;A=i}}else{var o=null;A=i}var c=null!==o?function(e,t){var n=[];e&&e.val&&n.push(e);for(var i in t)t.hasOwnProperty(i)&&n.push(t[i]);return{type:"messageFormatPattern",statements:n}}(o[0],o[1]):null;if(null!==c)var u=c;else{var u=null;A=n}return I[e]={nextPos:A,result:u},u}function l(){var t="messageFormatPatternRight@"+A,n=I[t];if(n)return A=n.nextPos,n.result;var i=A,a=A;if("{"===e.substr(A,1)){var s="{";A+=1}else{var s=null;D&&r('"{"')}if(null!==s){var o=S();if(null!==o){var l=c();if(null!==l){var u=S();if(null!==u){if("}"===e.substr(A,1)){var h="}";A+=1}else{var h=null;D&&r('"}"')}if(null!==h){var d=y();if(null!==d)var p=[s,o,l,u,h,d];else{var p=null;A=a}}else{var p=null;A=a}}else{var p=null;A=a}}else{var p=null;A=a}}else{var p=null;A=a}}else{var p=null;A=a}var f=null!==p?function(e,t){var n=[];return e&&n.push(e),t&&t.val&&n.push(t),{type:"messageFormatPatternRight",statements:n}}(p[2],p[5]):null;if(null!==f)var g=f;else{var g=null;A=i}return I[t]={nextPos:A,result:g},g}function c(){var t="messageFormatElement@"+A,n=I[t];if(n)return A=n.nextPos,n.result;var i=A,a=A,s=b();if(null!==s){var o=A;if(","===e.substr(A,1)){var l=",";A+=1}else{var l=null;D&&r('","')}if(null!==l){var c=u();if(null!==c)var h=[l,c];else{var h=null;A=o}}else{var h=null;A=o}var d=null!==h?h:"";if(null!==d)var p=[s,d];else{var p=null;A=a}}else{var p=null;A=a}var f=null!==p?function(e,t){var n={type:"messageFormatElement",argumentIndex:e};return t&&t.length?n.elementFormat=t[1]:n.output=!0,n}(p[0],p[1]):null;if(null!==f)var g=f;else{var g=null;A=i}return I[t]={nextPos:A,result:g},g}function u(){var t="elementFormat@"+A,n=I[t];if(n)return A=n.nextPos,n.result;var i=A,a=A,s=S();if(null!==s){if("plural"===e.substr(A,6)){var o="plural";A+=6}else{var o=null;D&&r('"plural"')}if(null!==o){var l=S();if(null!==l){if(","===e.substr(A,1)){var c=",";A+=1}else{var c=null;D&&r('","')}if(null!==c){var u=S();if(null!==u){var p=h();if(null!==p){var f=S();if(null!==f)var g=[s,o,l,c,u,p,f];else{var g=null;A=a}}else{var g=null;A=a}}else{var g=null;A=a}}else{var g=null;A=a}}else{var g=null;A=a}}else{var g=null;A=a}}else{var g=null;A=a}var m=null!==g?function(e,t){return{type:"elementFormat",key:e,val:t.val}}(g[1],g[5]):null;if(null!==m)var v=m;else{var v=null;A=i}if(null!==v)var y=v;else{var b=A,w=A,_=S();if(null!==_){if("select"===e.substr(A,6)){var x="select";A+=6}else{var x=null;D&&r('"select"')}if(null!==x){var k=S();if(null!==k){if(","===e.substr(A,1)){var T=",";A+=1}else{var T=null;D&&r('","')}if(null!==T){var M=S();if(null!==M){var C=d();if(null!==C){var E=S();if(null!==E)var P=[_,x,k,T,M,C,E];else{var P=null;A=w}}else{var P=null;A=w}}else{var P=null;A=w}}else{var P=null;A=w}}else{var P=null;A=w}}else{var P=null;A=w}}else{var P=null;A=w}var N=null!==P?function(e,t){return{type:"elementFormat",key:e,val:t.val}}(P[1],P[5]):null;if(null!==N)var O=N;else{var O=null;A=b}if(null!==O)var y=O;else var y=null}return I[t]={nextPos:A,result:y},y}function h(){var e="pluralStyle@"+A,t=I[e];if(t)return A=t.nextPos,t.result;var n=A,i=p(),a=null!==i?function(e){return{type:"pluralStyle",val:e}}(i):null;if(null!==a)var r=a;else{var r=null;A=n}return I[e]={nextPos:A,result:r},r}function d(){var e="selectStyle@"+A,t=I[e];if(t)return A=t.nextPos,t.result;var n=A,i=g(),a=null!==i?function(e){return{type:"selectStyle",val:e}}(i):null;if(null!==a)var r=a;else{var r=null;A=n}return I[e]={nextPos:A,result:r},r}function p(){var e="pluralFormatPattern@"+A,t=I[e];if(t)return A=t.nextPos,t.result;var n=A,i=A,a=f(),r=null!==a?a:"";if(null!==r){for(var s=[],o=m();null!==o;){s.push(o);var o=m()}if(null!==s)var l=[r,s];else{var l=null;A=i}}else{var l=null;A=i}var c=null!==l?function(e,t){var n={type:"pluralFormatPattern",pluralForms:t};return e?n.offset=e:n.offset=0,n}(l[0],l[1]):null;if(null!==c)var u=c;else{var u=null;A=n}return I[e]={nextPos:A,result:u},u}function f(){var t="offsetPattern@"+A,n=I[t];if(n)return A=n.nextPos,n.result;var i=A,a=A,s=S();if(null!==s){if("offset"===e.substr(A,6)){var o="offset";A+=6}else{var o=null;D&&r('"offset"')}if(null!==o){var l=S();if(null!==l){if(":"===e.substr(A,1)){var c=":";A+=1}else{var c=null;D&&r('":"')}if(null!==c){var u=S();if(null!==u){var h=x();if(null!==h){var d=S();if(null!==d)var p=[s,o,l,c,u,h,d];else{var p=null;A=a}}else{var p=null;A=a}}else{var p=null;A=a}}else{var p=null;A=a}}else{var p=null;A=a}}else{var p=null;A=a}}else{var p=null;A=a}var f=null!==p?function(e){return e}(p[5]):null;if(null!==f)var g=f;else{var g=null;A=i}return I[t]={nextPos:A,result:g},g}function g(){var e="selectFormatPattern@"+A,t=I[e];if(t)return A=t.nextPos,t.result;for(var n=A,i=[],a=m();null!==a;){i.push(a);var a=m()}var r=null!==i?function(e){return{type:"selectFormatPattern",pluralForms:e}}(i):null;if(null!==r)var s=r;else{var s=null;A=n}return I[e]={nextPos:A,result:s},s}function m(){var t="pluralForms@"+A,n=I[t];if(n)return A=n.nextPos,n.result;var i=A,a=A,s=S();if(null!==s){var l=v();if(null!==l){var c=S();if(null!==c){if("{"===e.substr(A,1)){var u="{";A+=1}else{var u=null;D&&r('"{"')}if(null!==u){var h=S();if(null!==h){var d=o();if(null!==d){var p=S();if(null!==p){if("}"===e.substr(A,1)){var f="}";A+=1}else{var f=null;D&&r('"}"')}if(null!==f)var g=[s,l,c,u,h,d,p,f];else{var g=null;A=a}}else{var g=null;A=a}}else{var g=null;A=a}}else{var g=null;A=a}}else{var g=null;A=a}}else{var g=null;A=a}}else{var g=null;A=a}}else{var g=null;A=a}var m=null!==g?function(e,t){return{type:"pluralForms",key:e,val:t}}(g[1],g[5]):null;if(null!==m)var y=m;else{var y=null;A=i}return I[t]={nextPos:A,result:y},y}function v(){var t="stringKey@"+A,n=I[t];if(n)return A=n.nextPos,n.result;var i=A,a=b(),s=null!==a?function(e){return e}(a):null;if(null!==s)var o=s;else{var o=null;A=i}if(null!==o)var l=o;else{var c=A,u=A;if("="===e.substr(A,1)){var h="=";A+=1}else{var h=null;D&&r('"="')}if(null!==h){var d=x();if(null!==d)var p=[h,d];else{var p=null;A=u}}else{var p=null;A=u}var f=null!==p?function(e){return e}(p[1]):null;if(null!==f)var g=f;else{var g=null;A=c}if(null!==g)var l=g;else var l=null}return I[t]={nextPos:A,result:l},l}function y(){var e="string@"+A,t=I[e];if(t)return A=t.nextPos,t.result;var n=A,i=A,a=S();if(null!==a){var r=[],s=A,o=S();if(null!==o){var l=w();if(null!==l){var c=S();if(null!==c)var u=[o,l,c];else{var u=null;A=s}}else{var u=null;A=s}}else{var u=null;A=s}for(;null!==u;){r.push(u);var s=A,o=S();if(null!==o){var l=w();if(null!==l){var c=S();if(null!==c)var u=[o,l,c];else{var u=null;A=s}}else{var u=null;A=s}}else{var u=null;A=s}}if(null!==r)var h=[a,r];else{var h=null;A=i}}else{var h=null;A=i}var d=null!==h?function(e,t){for(var n=[],i=0;i<t.length;++i)for(var a=0;a<t[i].length;++a)n.push(t[i][a]);return{type:"string",val:e+n.join("")}}(h[0],h[1]):null;if(null!==d)var p=d;else{var p=null;A=n}return I[e]={nextPos:A,result:p},p}function b(){var t="id@"+A,n=I[t];if(n)return A=n.nextPos,n.result;var i=A,a=A,s=S();if(null!==s){if(null!==e.substr(A).match(/^[a-zA-Z$_]/)){var o=e.charAt(A);A++}else{var o=null;D&&r("[a-zA-Z$_]")}if(null!==o){var l=[];if(null!==e.substr(A).match(/^[^ 	\n\r,.+={}]/)){var c=e.charAt(A);A++}else{var c=null;D&&r("[^ 	\\n\\r,.+={}]")}for(;null!==c;)if(l.push(c),null!==e.substr(A).match(/^[^ 	\n\r,.+={}]/)){var c=e.charAt(A);A++}else{var c=null;D&&r("[^ 	\\n\\r,.+={}]")}if(null!==l){var u=S();if(null!==u)var h=[s,o,l,u];else{var h=null;A=a}}else{var h=null;A=a}}else{var h=null;A=a}}else{var h=null;A=a}var d=null!==h?function(e,t){return e+(t?t.join(""):"")}(h[1],h[2]):null;if(null!==d)var p=d;else{var p=null;A=i}return I[t]={nextPos:A,result:p},p}function w(){var e="chars@"+A,t=I[e];if(t)return A=t.nextPos,t.result;var n=A,i=_();if(null!==i)for(var a=[];null!==i;){a.push(i);var i=_()}else var a=null;var r=null!==a?function(e){return e.join("")}(a):null;if(null!==r)var s=r;else{var s=null;A=n}return I[e]={nextPos:A,result:s},s}function _(){var t="char@"+A,n=I[t];if(n)return A=n.nextPos,n.result;var i=A;if(null!==e.substr(A).match(/^[^{}\\\0- 	\n\r]/)){var a=e.charAt(A);A++}else{var a=null;D&&r("[^{}\\\\\\0- 	\\n\\r]")}var s=null!==a?function(e){return e}(a):null;if(null!==s)var o=s;else{var o=null;A=i}if(null!==o)var l=o;else{var c=A;if("\\#"===e.substr(A,2)){var u="\\#";A+=2}else{var u=null;D&&r('"\\\\#"')}var h=null!==u?function(){return"\\#"}():null;if(null!==h)var d=h;else{var d=null;A=c}if(null!==d)var l=d;else{var p=A;if("\\{"===e.substr(A,2)){var f="\\{";A+=2}else{var f=null;D&&r('"\\\\{"')}var g=null!==f?function(){return"{"}():null;if(null!==g)var m=g;else{var m=null;A=p}if(null!==m)var l=m;else{var v=A;if("\\}"===e.substr(A,2)){var y="\\}";A+=2}else{var y=null;D&&r('"\\\\}"')}var b=null!==y?function(){return"}"}():null;if(null!==b)var w=b;else{var w=null;A=v}if(null!==w)var l=w;else{var _=A,x=A;if("\\u"===e.substr(A,2)){var S="\\u";A+=2}else{var S=null;D&&r('"\\\\u"')}if(null!==S){var T=k();if(null!==T){var M=k();if(null!==M){var C=k();if(null!==C){var E=k();if(null!==E)var P=[S,T,M,C,E];else{var P=null;A=x}}else{var P=null;A=x}}else{var P=null;A=x}}else{var P=null;A=x}}else{var P=null;A=x}var N=null!==P?function(e,t,n,i){return String.fromCharCode(parseInt("0x"+e+t+n+i))}(P[1],P[2],P[3],P[4]):null;if(null!==N)var O=N;else{var O=null;A=_}if(null!==O)var l=O;else var l=null}}}}return I[t]={nextPos:A,result:l},l}function x(){var t="digits@"+A,n=I[t];if(n)return A=n.nextPos,n.result;var i=A;if(null!==e.substr(A).match(/^[0-9]/)){var a=e.charAt(A);A++}else{var a=null;D&&r("[0-9]")}if(null!==a)for(var s=[];null!==a;)if(s.push(a),null!==e.substr(A).match(/^[0-9]/)){var a=e.charAt(A);A++}else{var a=null;D&&r("[0-9]")}else var s=null;var o=null!==s?function(e){return parseInt(e.join(""),10)}(s):null;if(null!==o)var l=o;else{var l=null;A=i}return I[t]={nextPos:A,result:l},l}function k(){var t="hexDigit@"+A,n=I[t];if(n)return A=n.nextPos,n.result;if(null!==e.substr(A).match(/^[0-9a-fA-F]/)){var i=e.charAt(A);A++}else{var i=null;D&&r("[0-9a-fA-F]")}return I[t]={nextPos:A,result:i},i}function S(){var e="_@"+A,t=I[e];if(t)return A=t.nextPos,t.result;var n=D;D=!1;for(var i=A,a=[],s=T();null!==s;){a.push(s);var s=T()}var o=null!==a?function(e){return e.join("")}(a):null;if(null!==o)var l=o;else{var l=null;A=i}return D=n,D&&null===l&&r("whitespace"),I[e]={nextPos:A,result:l},l}function T(){var t="whitespace@"+A,n=I[t];if(n)return A=n.nextPos,n.result;if(null!==e.substr(A).match(/^[ 	\n\r]/)){var i=e.charAt(A);A++}else{var i=null;D&&r("[ 	\\n\\r]")}return I[t]={nextPos:A,result:i},i}function M(){function t(e){e.sort();for(var t=null,n=[],i=0;i<e.length;i++)e[i]!==t&&(n.push(e[i]),t=e[i]);switch(n.length){case 0:return"end of input";case 1:return n[0];default:return n.slice(0,n.length-1).join(", ")+" or "+n[n.length-1]}}var n=t(N),i=Math.max(A,P),r=i<e.length?a(e.charAt(i)):"end of input";return"Expected "+n+" but "+r+" found."}function C(){for(var t=1,n=1,i=!1,a=0;P>a;a++){var r=e.charAt(a);"\n"===r?(i||t++,n=1,i=!1):"\r"===r|"\u2028"===r||"\u2029"===r?(t++,n=1,i=!0):(n++,i=!1)}return{line:t,column:n}}var E={_:S,"char":_,chars:w,digits:x,elementFormat:u,hexDigit:k,id:b,messageFormatElement:c,messageFormatPattern:o,messageFormatPatternRight:l,offsetPattern:f,pluralFormatPattern:p,pluralForms:m,pluralStyle:h,selectFormatPattern:g,selectStyle:d,start:s,string:y,stringKey:v,whitespace:T};if(void 0!==t){if(void 0===E[t])throw new Error("Invalid rule name: "+a(t)+".")}else t="start";var A=0,D=!0,P=0,N=[],I={},O=E[t]();if(null===O||A!==e.length){var F=C();throw new this.SyntaxError(M(),F.line,F.column)}return O},toSource:function(){return this._source}};return e.SyntaxError=function(e,t,n){this.name="SyntaxError",this.message=e,this.line=t,this.column=n},e.SyntaxError.prototype=Error.prototype,e}();t.prototype.parse=function(){return n.parse.apply(n,arguments)},t.prototype.precompile=function(e){function n(e,s){s=s||{};var o,l,c,u="";switch(e.type){case"program":return n(e.program);case"messageFormatPattern":for(o=0;o<e.statements.length;++o)u+=n(e.statements[o],s);return r.begin+u+r.end;case"messageFormatPatternRight":for(o=0;o<e.statements.length;++o)u+=n(e.statements[o],s);return u;case"messageFormatElement":return s.pf_count=s.pf_count||0,u+='if(!d){\nthrow new Error("MessageFormat: No data passed to function.");\n}\n',e.output?u+='r += d["'+e.argumentIndex+'"];\n':(c="lastkey_"+(s.pf_count+1),u+="var "+c+' = "'+e.argumentIndex+'";\n',u+="var k_"+(s.pf_count+1)+"=d["+c+"];\n",u+=n(e.elementFormat,s)),u;case"elementFormat":return"select"===e.key?(u+=n(e.val,s),u+="r += (pf_"+s.pf_count+"[ k_"+(s.pf_count+1)+" ] || pf_"+s.pf_count+'[ "other" ])( d );\n'):"plural"===e.key&&(u+=n(e.val,s),u+="if ( pf_"+s.pf_count+"[ k_"+(s.pf_count+1)+' + "" ] ) {\n',u+="r += pf_"+s.pf_count+"[ k_"+(s.pf_count+1)+' + "" ]( d ); \n',u+="}\nelse {\n",u+="r += (pf_"+s.pf_count+'[ MessageFormat.locale["'+i.locale+'"]( k_'+(s.pf_count+1)+" - off_"+s.pf_count+" ) ] || pf_"+s.pf_count+'[ "other" ] )( d );\n',u+="}\n"),u;case"pluralFormatPattern":for(s.pf_count=s.pf_count||0,u+="var off_"+s.pf_count+" = "+e.offset+";\n",u+="var pf_"+s.pf_count+" = { \n",a=!0,o=0;o<e.pluralForms.length;++o)"other"===e.pluralForms[o].key&&(a=!1),l?u+=",\n":l=1,u+='"'+e.pluralForms[o].key+'" : '+n(e.pluralForms[o].val,function(){var e=JSON.parse(JSON.stringify(s));return e.pf_count++,e}());if(u+="\n};\n",a)throw new Error("No 'other' form found in pluralFormatPattern "+s.pf_count);return u;case"selectFormatPattern":for(s.pf_count=s.pf_count||0,u+="var off_"+s.pf_count+" = 0;\n",u+="var pf_"+s.pf_count+" = { \n",a=!0,o=0;o<e.pluralForms.length;++o)"other"===e.pluralForms[o].key&&(a=!1),l?u+=",\n":l=1,u+='"'+e.pluralForms[o].key+'" : '+n(e.pluralForms[o].val,function(){var e=JSON.parse(JSON.stringify(s));return e.pf_count++,e}());if(u+="\n};\n",a)throw new Error("No 'other' form found in selectFormatPattern "+s.pf_count);return u;case"string":return'r += "'+t.Utils.numSub(t.Utils.escapeExpression(e.val),"k_"+s.pf_count+" - off_"+(s.pf_count-1),s.pf_count)+'";\n';default:throw new Error("Bad AST type: "+e.type)}}var i=this,a=!1,r={begin:'function(d){\nvar r = "";\n',end:"return r;\n}"};return n(e)},t.prototype.compile=function(e){return new Function("MessageFormat","return "+this.precompile(this.parse(e)))(t)},e.MessageFormat=t}}(this),define("messageformat/messageformat",function(e){return function(){var t;return t||e.MessageFormat}}(this)),MessageFormat.locale.en=function(e){return 1===e?"one":"other"},define("messageformat/locale/en",function(){}),MessageFormat.locale.ja=function(e){return 1===e?"one":"other"},define("messageformat/locale/ja",function(){}),MessageFormat.locale.zh=function(e){return"other"},define("messageformat/locale/zh",function(){}),MessageFormat.locale.ko=function(e){return"other"},define("messageformat/locale/ko",function(){}),MessageFormat.locale.fr=function(e){return e>=0&&2>e?"one":"other"},define("messageformat/locale/fr",function(){}),MessageFormat.locale.de=function(e){return 1===e?"one":"other"},define("messageformat/locale/de",function(){}),MessageFormat.locale.es=function(e){return 1===e?"one":"other"},define("messageformat/locale/es",function(){}),MessageFormat.locale.it=function(e){return 1===e?"one":"other"},define("messageformat/locale/it",function(){}),MessageFormat.locale.tr=function(e){return"other"},define("messageformat/locale/tr",function(){}),MessageFormat.locale.ru=function(e){return e%10==1&&e%100!=11?"one":e%10>=2&&4>=e%10&&(12>e%100||e%100>14)&&e==Math.floor(e)?"few":e%10===0||e%10>=5&&9>=e%10||e%100>=11&&14>=e%100&&e==Math.floor(e)?"many":"other"},define("messageformat/locale/ru",function(){}),MessageFormat.locale.pt=function(e){return 1===e?"one":"other"},define("messageformat/locale/pt",function(){}),MessageFormat.locale.no=function(e){return 1===e?"one":"other"},define("messageformat/locale/no",function(){}),MessageFormat.locale.sv=function(e){return 1===e?"one":"other"},define("messageformat/locale/sv",function(){}),MessageFormat.locale.nl=function(e){return 1===e?"one":"other"},define("messageformat/locale/nl",function(){}),MessageFormat.locale.pl=function(e){return 1==e?"one":e%10>=2&&4>=e%10&&(12>e%100||e%100>14)&&e==Math.floor(e)?"few":e%10===0||1!=e&&e%10==1||(e%10>=5&&9>=e%10||e%100>=12&&14>=e%100)&&e==Math.floor(e)?"many":"other"},define("messageformat/locale/pl",function(){}),MessageFormat.locale.cs=function(e){return 1==e?"one":2==e||3==e||4==e?"few":"other"},define("messageformat/locale/cs",function(){}),MessageFormat.locale.ro=function(e){return 1==e?"one":0===e||1!=e&&e%100>=1&&19>=e%100&&e==Math.floor(e)?"few":"other"},define("messageformat/locale/ro",function(){}),MessageFormat.locale["in"]=function(e){return"other"},define("messageformat/locale/in",function(){}),define("i18n/locale",["require"],function(e){if("object"==typeof global_page_viewer&&global_page_viewer.locale)return global_page_viewer.locale;if("object"==typeof fitbit&&"object"==typeof fitbit.i18n&&fitbit.i18n.locale)return fitbit.i18n.locale;var t=document.getElementsByTagName("body");if(t&&t[0]){var n=/locale-([a-z]{2}_[A-Z]{2})/.exec(t[0].className);if(n&&n[1])return n[1]}return"en_US"}),define("i18n/i18n",["require","exports","module","underscore","messageformat/messageformat","messageformat/locale/en","messageformat/locale/ja","messageformat/locale/zh","messageformat/locale/ko","messageformat/locale/fr","messageformat/locale/de","messageformat/locale/es","messageformat/locale/it","messageformat/locale/tr","messageformat/locale/ru","messageformat/locale/pt","messageformat/locale/no","messageformat/locale/sv","messageformat/locale/nl","messageformat/locale/pl","messageformat/locale/cs","messageformat/locale/ro","messageformat/locale/in","i18n/locale"],function(e,t,n){var i=e("underscore"),a=e("messageformat/messageformat");e("messageformat/locale/en"),e("messageformat/locale/ja"),e("messageformat/locale/zh"),e("messageformat/locale/ko"),e("messageformat/locale/fr"),e("messageformat/locale/de"),e("messageformat/locale/es"),e("messageformat/locale/it"),e("messageformat/locale/tr"),e("messageformat/locale/ru"),e("messageformat/locale/pt"),e("messageformat/locale/no"),e("messageformat/locale/sv"),e("messageformat/locale/nl"),e("messageformat/locale/pl"),e("messageformat/locale/cs"),e("messageformat/locale/ro"),e("messageformat/locale/in"),a.locale.nb=MessageFormat.locale.no;var r=new a(e("i18n/locale").slice(0,2)),s=n.config&&n.config()||{};return function o(e){function t(e){var n=i.toArray(arguments).slice(1),a=t._getNamespace(e);if(!a)return t._handleError(e);var r;return r=n.length?t._ensureMessageFormat(a,e).apply(t,n):a.translations[e]}var n=[];return t._ensureMessageFormat=function(e,t,n){var i=e.formatted[t];if(!i){var a=n||e.translations[t];i=e.formatted[t]=r.compile(a)}return i},t._getNamespace=function(e){return i.find(n,function(t){return t.translations[e]})},t._handleError=function(e){if(s.strict){var n=i.pluck(t.getNamespaces(),"namespace");throw new Error('missing translation for: "'+e+'" with loaded namespaces: '+JSON.stringify(n))}return e},t._handleReserveError=function(e){if(s.strict){var n=i.pluck(t.getNamespaces(),"namespace");throw new Error('missing namespace for: "'+e+'" with loaded namespaces: '+JSON.stringify(n))}},t.plural=function(e){var n=t._getNamespace(e);if(!n){var i=t._handleError(e);return function(){return i}}return function(i){return t._ensureMessageFormat(n,e,"{NUM_RESULTS, plural, "+n.translations[e]+"}")({NUM_RESULTS:i})}},t.namespace=function(){return i.each(arguments,function(e){e&&(e.formatted=e.formatted||{},n.unshift(e))}),this},t.getNamespaces=function(){return n},t.inNamespace=function(e){var n=i.find(t.getNamespaces(),function(t){return t.namespace===e});return n?new o([n]):(t._handleReserveError(e),t)},e&&t.namespace.apply(t,e),t}}),define("substitute",["require"],function(e){return function(e){if("string"!=typeof e)return"";if(arguments.length>1)for(var t=0,n=arguments.length;n>t;t++)e=e.replace("{"+t+"}",arguments[t+1]+"");return e}}),define("i18n/locales",[],function(){return["en_US","en_CA","en_AU","en_GB","en_IE","en_NL","en_NO","en_SE","en_BE","en_DK","en_FI","en_PL","en_NZ","en_HK","en_SG","en_ZA","en_IL","en_TH","en_MY","en_PH","en_ID","en_VN","en_IN","ja_JP","zh_CN","zh_TW","ko_KR","fr_FR","fr_CH","fr_CA","fr_BE","de_DE","de_AT","de_CH","es_ES","es_MX","es_CO","es_CL","es_EC","es_VE","es_AR","es_PE","es_PY","es_CR","es_PA","es_PR","es_GT","it_IT","it_CH","nl_NL","no_NO","sv_SE","tr_TR","ru","pt_BR","en_EU"]}),define("i18n/properties/parse",["require","exports","module"],function(e,t,n){var i=function(e){switch(e){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case"a":case"A":return 10;case"b":case"B":return 11;case"c":case"C":return 12;case"d":case"D":return 13;case"e":case"E":return 14;case"f":case"F":return 15}};n.exports=function(e,t,n,a){var r,s,o,l,c,u,h,d,p,f,g,m,v,y,b,w=!0,_=!0,x=!0,k="",S="",T=function(){(k||S||m)&&(n.line(k,S),k="",S="",m=!1)},M=function(e,t,n){return f&&p?(d=(d<<4)+i(t),--p?e:(o=!1,f=!1,e+String.fromCharCode(d))):117===n?(d=0,f=!0,p=4,e):(o=!1,116===n?e+"	":114===n?e+"\r":110===n?e+"\n":102===n?e+"\f":e+t)};t._strict?(y=function(e,t,n){return n._comments[e]},b=function(e,t,n){return n._separators[e]}):(y=function(e,t,n){return 35===t||33===t||n._comments[e]},b=function(e,t,n){return 61===t||58===t||n._separators[e]});for(var C=~~a.resume;C<e.length;C++){if(a.abort)return;if(a.pause)return void(a.resume=C);if(r=e[C],s=e.charCodeAt(C),13!==s)if(l)10===s&&(l=!1,_=!0,w=!0);else if(c&&93===s)n.section(h),v=!0;else{if(w){if(32===s||9===s||12===s)continue;if(!u&&10===s){x=!0,g=!1,_=!0,T();continue}w=!1,u=!1}if(_){if(_=!1,y(r,s,t)){l=!0;continue}if(t.sections&&91===s){h="",c=!0,a.skipSection=!1;continue}}if(10!==s){if(a.skipSection||v)continue;if(!c&&!o&&x&&b(r,s,t)){m=!0,x=!1,g=!1,w=!0;continue}if(92===s){if(o){if(f)continue;g&&(g=!1,x=!1),c?h+="\\":x?k+="\\":S+="\\"}o=!o}else if(g&&(g=!1,x=!1),c)o?h=M(h,r,s):h+=r;else if(x)if(o)k=M(k,r,s);else{if(32===s||9===s||12===s){g=!0,w=!0;continue}k+=r}else o?S=M(S,r,s):S+=r}else if(o)f||(o=!1),w=!0,u=!0;else{if(c){if(c=!1,!v)return void(a.error=new Error('The section line "'+h+'" must end with "]"'));v=!1}_=!0,w=!0,x=!0,T()}}}return a.parsed=!0,c&&!v?void(a.error=new Error('The section line "'+h+'" must endwith "]"')):void T()}}),define("properties",["require","exports","module","i18n/properties/parse"],function(e,t,n){var i=e("i18n/properties/parse"),a=function(e){if(null===e||"null"===e)return null;if("undefined"===e)return void 0;if("true"===e)return!0;if("false"===e)return!1;var t=Number(e);return isNaN(t)?e:t},r=function(e,t,n){for(var i,a=t.split("."),r=0;r<a.length-1;r++){if(i=a[r],void 0===e[i])return;e=e[i]}var s=e[a[a.length-1]];if(n){if("object"!=typeof s)return;return s}return"object"!=typeof s?s:void 0},s=function(e,t,n){for(var i,a=t.split("."),r=0;r<a.length-1;r++){if(i=a[r],void 0===e[i])e[i]={};else if("object"!=typeof e[i])throw new Error("Invalid namespace chain in the property name '"+t+"' ('"+i+"' has already a value)");e=e[i]}e[a[a.length-1]]=n},o=function(e,t){for(var n,i=t.split("."),a=0;a<i.length;a++){if(n=i[a],void 0===e[n])e[n]={};else if("object"!=typeof e[n])throw new Error("Invalid namespace chain in the section name '"+t+"' ('"+n+"' has already a value)");e=e[n]}return e},l=function(e,t,n,i){if(!n.variables||!t)return i(null,t);for(var a,s,o,l,c,u=[],h="",d=null,p=0;p<t.length;p++)if(a=t[p],"$"!==s||"{"!==a){if(u.length){if(n.sections&&"|"===a){d=h,h="";continue}if("}"===a){if(l=null!==d?r(e,d,!0):e,!l)return i(new Error('The section "'+d+'" does not exist'));if(o=n.namespaces?r(l,h):l[h],void 0===o&&(o=n.namespaces?r(n._vars,h):n._vars[h],void 0===o))return i(new Error('The property "'+h+'" does not exist'));c=u.pop(),d=c.section,h=c.key+(null===o?"":o);continue}}s=a,h+=a}else h=h.substring(0,h.length-1),u.push({key:h,section:d}),h="",d=null;return 0!==u.length?i(new Error("Malformed variable: "+t)):void i(null,h)},c=function(e,t,n,r){var c,u={};t.namespaces&&(c={});var h={abort:!1,skipSection:!1};if(!e)return r?r(null,u):u;var d,p=null,f=null,g=function(e){if(h.abort=!0,r)return r(e);throw e},m={},v={assert:function(){return this.isProperty?y.value:!0}},y={};d=t.reviver?t.sections?function(e,n){if(y.value=n,v.isProperty=!0,v.isSection=!1,n=t.reviver.call(v,e,n,f),void 0!==n)if(t.namespaces)try{s(null===p?c:p,e,n)}catch(i){g(i)}else null===p?u[e]=n:p[e]=n}:function(e,n){if(y.value=n,v.isProperty=!0,v.isSection=!1,n=t.reviver.call(v,e,n),void 0!==n)if(t.namespaces)try{s(c,e,n)}catch(i){g(i)}else u[e]=n}:t.sections?function(e,n){if(t.namespaces)try{s(null===p?c:p,e,n)}catch(i){g(i)}else null===p?u[e]=n:p[e]=n}:function(e,n){if(t.namespaces)try{s(c,e,n)}catch(i){g(i)}else u[e]=n};var b;return t.sections&&(b=t.reviver?function(e){f=e,y.section=e,v.isProperty=!1,v.isSection=!0;var n=t.reviver.call(v,null,null,e);if(n)if(t.namespaces)try{p=o(c,e)}catch(i){g(i)}else p=u[e]={};else h.skipSection=!0}:function(e){if(f=e,t.namespaces)try{p=o(c,e)}catch(n){g(n)}else p=u[e]={}}),t.variables?(m.line=function(e,n){l(t.namespaces?c:u,e,t,function(e,i){return e?g(e):void l(t.namespaces?c:u,n,t,function(e,t){return e?g(e):void d(i,a(t||null))})})},t.sections&&(m.section=function(e){l(t.namespaces?c:u,e,t,function(e,t){return e?g(e):void b(t)})})):(m.line=function(e,t){d(e,a(t||null))},t.sections&&(m.section=b)),i(e,t,m,h),h.error?g(h.error):h.abort||h.pause?void 0:r?r(null,t.namespaces?c:u):t.namespaces?c:u},u=function(e,t,n){"function"==typeof t&&(n=t,t={});var i;t=t||{},t._strict=t.strict&&(t.comments||t.separators),t._vars=t.vars||{};var a=t.comments||[];Array.isArray(a)||(a=[a]);var r={};a.forEach(function(e){if(i=e.charCodeAt(0),e.length>1||33>i||i>126)throw new Error("The comment token must be a single printable ASCII character");r[e]=!0}),t._comments=r;var s=t.separators||[];Array.isArray(s)||(s=[s]);var o={};return s.forEach(function(e){if(i=e.charCodeAt(0),e.length>1||33>i||i>126)throw new Error("The separator token must be a single printable ASCII character");o[e]=!0}),t._separators=o,c(e,t,".",n)};n.exports={parse:u}}),/**
	 * @license RequireJS text 2.0.14 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.
	 * Available via the MIT or new BSD license.
	 * see: http://github.com/requirejs/text for details
	 */
define("text",["module"],function(e){var t,n,i,a,r,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,u=c&&location.protocol&&location.protocol.replace(/\:/,""),h=c&&location.hostname,d=c&&(location.port||void 0),p={},f=e.config&&e.config()||{};return t={version:"2.0.14",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=s[t];try{e=new ActiveXObject(n)}catch(i){}if(e){s=[n];break}}return e},parseName:function(e){var t,n,i,a=!1,r=e.lastIndexOf("."),s=0===e.indexOf("./")||0===e.indexOf("../");return-1!==r&&(!s||r>1)?(t=e.substring(0,r),n=e.substring(r+1)):t=e,i=n||t,r=i.indexOf("!"),-1!==r&&(a="strip"===i.substring(r+1),i=i.substring(0,r),n?n=i:t=i),{moduleName:t,ext:n,strip:a}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,i,a){var r,s,o,l=t.xdRegExp.exec(e);return l?(r=l[2],s=l[3],s=s.split(":"),o=s[1],s=s[0],!(r&&r!==n||s&&s.toLowerCase()!==i.toLowerCase()||(o||s)&&o!==a)):!0},finishLoad:function(e,n,i,a){i=n?t.strip(i):i,f.isBuild&&(p[e]=i),a(i)},load:function(e,n,i,a){if(a&&a.isBuild&&!a.inlineText)return void i();f.isBuild=a&&a.isBuild;var r=t.parseName(e),s=r.moduleName+(r.ext?"."+r.ext:""),o=n.toUrl(s),l=f.useXhr||t.useXhr;
//!strip part to avoid file system issues.
return 0===o.indexOf("empty:")?void i():void(!c||l(o,u,h,d)?t.get(o,function(n){t.finishLoad(e,r.strip,n,i)},function(e){i.error&&i.error(e)}):n([s],function(e){t.finishLoad(r.moduleName+"."+r.ext,r.strip,e,i)}))},write:function(e,n,i,a){if(p.hasOwnProperty(n)){var r=t.jsEscape(p[n]);i.asModule(e+"!"+n,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,n,i,a,r){var s=t.parseName(n),o=s.ext?"."+s.ext:"",l=s.moduleName+o,c=i.toUrl(s.moduleName+o)+".js";t.load(l,i,function(n){var i=function(e){return a(c,e)};i.asModule=function(e,t){return a.asModule(e,c,t)},t.write(e,l,i,r)},r)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(n=require.nodeRequire("fs"),t.get=function(e,t,i){try{var a=n.readFileSync(e,"utf8");"\ufeff"===a[0]&&(a=a.substring(1)),t(a)}catch(r){i&&i(r)}}):"xhr"===f.env||!f.env&&t.createXhr()?t.get=function(e,n,i,a){var r,s=t.createXhr();if(s.open("GET",e,!0),a)for(r in a)a.hasOwnProperty(r)&&s.setRequestHeader(r.toLowerCase(),a[r]);f.onXhr&&f.onXhr(s,e),s.onreadystatechange=function(t){var a,r;4===s.readyState&&(a=s.status||0,a>399&&600>a?(r=new Error(e+" HTTP status: "+a),r.xhr=s,i&&i(r)):n(s.responseText),f.onXhrComplete&&f.onXhrComplete(s,e))},s.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,i,a="utf-8",r=new java.io.File(e),s=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),a)),l="";try{for(n=new java.lang.StringBuffer,i=o.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=o.readLine());)n.append(s),n.append(i);l=String(n.toString())}finally{o.close()}t(l)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(i=Components.classes,a=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),r="@mozilla.org/windows-registry-key;1"in i,t.get=function(e,t){var n,s,o,l={};r&&(e=e.replace(/\//g,"\\")),o=new FileUtils.File(e);try{n=i["@mozilla.org/network/file-input-stream;1"].createInstance(a.nsIFileInputStream),n.init(o,1,0,!1),s=i["@mozilla.org/intl/converter-input-stream;1"].createInstance(a.nsIConverterInputStream),s.init(n,"utf-8",n.available(),a.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(n.available(),l),s.close(),n.close(),t(l.value)}catch(c){throw new Error((o&&o.path||"")+": "+c)}}),t}),define("props",["module","properties","text"],function(e,t,n){function i(e,t){return"define('"+e+"', "+JSON.stringify(t)+");"}var a={};return{load:function(e,t,n){a[e]?n(a[e]):this.get(t.toUrl(e),function(t){a[e]=t,n(t)},function(e){n.error&&n.error(e)})},write:function r(e,t,r){r(i(e,t,a[t]))},get:function(e,i,a){n.get(e,function(e){return i(t.parse(e))},a)},writeOutput:i}}),define("i18n-load",["module","i18n/locales","underscore"],function(e,t,n){function i(e){var i=["en_US"];return n.each(r.fallbacks,function(t){t.test.test(e)&&-1===i.indexOf(t.fallback)&&i.push(t.fallback)}),-1!==t.indexOf(e)&&-1===i.indexOf(e)&&i.push(e),i}function a(e,t){return e+"."+n.last(i(t))}var r=e.config&&e.config()||{};return{load:function(e,t,n,i){i.isBuild||t(["i18n/locale"],function(i){var r=!0;if(r){var s=a(e,i);t([s],function(e){n(e)})}})}}}),define("galileo/util/dateUtil",["require","i18n/i18n","substitute","jquery","galileo/prototype/array","galileo/prototype/function","i18n-load!com/fitbit/util/relativedateutil","i18n-load!core/com/fitbit/util/dateformat"],function(e){function t(e,t){var n=e.split(",").map(function(e){return e.trim()});return n.length<=1?t:n}function n(e,t,n){var i=e.getFullYear()%100,a={yyyy:e.getFullYear(),yy:i>9?""+i:"0"+i,MMMM:w[e.getMonth()],MMM:_[e.getMonth()],MM:e.getMonth()>=9?""+(e.getMonth()+1):"0"+(e.getMonth()+1),M:""+(e.getMonth()+1),dd:e.getDate()>9?""+e.getDate():"0"+e.getDate(),d:""+e.getDate(),EEEE:v[e.getDay()],EEE:y[e.getDay()],E:b[e.getDay()],HH:e.getHours()>9?""+e.getHours():"0"+e.getHours(),hh:""+(e.getHours()%12||12),mm:e.getMinutes()>9?""+e.getMinutes():"0"+e.getMinutes(),ss:e.getSeconds()>9?""+e.getSeconds():"0"+e.getSeconds(),H:""+e.getHours(),h:""+(e.getHours()%12||12),m:""+e.getMinutes(),s:""+e.getSeconds(),a:e.getHours()>=12?m[1]:m[0]};if(n=n?n:g,!n[t]&&!a[t])throw"Unsupported localized date format: "+t;return a[t]?a[t]:(d=d||new RegExp("("+Object.keys(a).sortBy(Function.takeKey("length")).reverse().join("|")+")","g"),n[t].replace(d,function(e){return a[e]}))}function i(e,t,n){var i,r="",s=60,o=60*s,l=24*o,c=7*l,d=4*c,p=12*d,g=function(e,t){return n[e]?u(n[e],t):""};if(n=n?n:f,t)try{e=a(e,"Z"===e.charAt(e.length-1))}catch(m){return console&&console.log("_getRelativeDate: improperly formatted ISO8601 date string"),""}return i=Math.floor(((new Date).getTime()-new Date(e).getTime())/1e3),h.isNumeric(i)&&(r=30>i?g("just_now",i):s>i?g("seconds",i):2*s>i?g("minute","1"):o>i?g("minutes",Math.floor(i/s)):2*o>i?g("hour","1"):l>i?g("hours",Math.floor(i/o)):2*l>i?g("day","1"):c>i?g("days",Math.floor(i/l)):2*c>i?g("week","1"):3*d>i?g("weeks",Math.floor(i/c)):2*p>i?g("months",Math.floor(i/d)):g("years",Math.floor(i/p))),r}function a(e,t){var n,i=e.match(/([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?/),a=0,r=new Date(i[1],0,1);return i[3]&&r.setMonth(i[3]-1),i[5]&&r.setDate(i[5]),i[7]&&r.setHours(i[7]),i[8]&&r.setMinutes(i[8]),i[10]&&r.setSeconds(i[10]),i[12]&&r.setMilliseconds(1e3*Number("0."+i[12])),i[14]&&(a=60*Number(i[16])+Number(i[17]),a*="-"===i[15]?1:-1),t||(a-=r.getTimezoneOffset()),n=new Date,n.setTime(Number(Number(r)+60*a*1e3)),n}function r(e){var t=function(e){return 1===(""+e).length?"0"+e:""+e};return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())}function s(e){var t=e.split(" "),n=t[0].split("-");if(t.length>1){var i=t[1].split(":");return new Date(n[0],n[1]-1,n[2],i[0],i[1],i[2])}return new Date(n[0],n[1]-1,n[2])}function o(e){var t=e.split(":"),n=new Date;return n.setHours(t[0]),n.setMinutes(t[1]),n.setSeconds(0),n.setMilliseconds(0),n}function l(e,t){return function(n,i){var a=new Date(n.getTime());return a["set"+e](a["get"+e]()+t(i)),a}}var c=e("i18n/i18n")(),u=e("substitute"),h=e("jquery");e("galileo/prototype/array"),e("galileo/prototype/function"),c.namespace(e("i18n-load!com/fitbit/util/relativedateutil")),c.namespace(e("i18n-load!core/com/fitbit/util/dateformat"));var d,p=c.inNamespace("com.fitbit.util.dateformat"),f={just_now:c("just_now"),seconds:c("seconds"),minute:c("minute"),minutes:c("minutes"),hour:c("hour"),hours:c("hours"),day:c("day"),days:c("days"),week:c("week"),weeks:c("weeks"),months:c.inNamespace("com.fitbit.util.relativedateutil")("months"),years:c("years")},g={"EEE, MMM d":c("weekday_month_date_medium"),"EEE, M/d":c("weekday_month_date_short"),"M/dd/yyyy":c("month_date_year_short"),"MMMM dd, yyyy":c("month_date_year_long"),"MMM dd, yyyy":c("month_date_year_medium"),MMM:p("month"),"MMM dd":c("month_date"),"MMMM dd":c("month_date_long"),"MMMM d":c("month_long_date_short"),"MMM yyyy":c("month_year_medium"),"MMMM yyyy":c("month_year"),EEE:c("weekday"),"EEEE, MMMM dd":c("weekday_month_date_long"),"EEE, MMM d, yyyy":c("weekday_month_date_year"),"MMM d, hh:mm a":c("month_date_time"),"MMM d, HH:mm":c("month_date_time_24"),"hh:mm a":c("dash_time_12"),"hh:mm:ss":"hh:mm:ss","HH:mm":c("dash_time_24"),"HH:mm:ss":"HH:mm:ss","hh:mm":"hh:mm",hha:"hha"},m=t(p("am_pm"),["AM","PM"]),v=t(p("weekdays"),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]),y=t(p("short_weekdays"),["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]),b=t(p("extramin_weekdays"),["S","M","T","W","T","F","S"]),w=t(p("months"),["January","February","March","April","May","June","July","August","September","October","November","December"]),_=t(p("short_months"),["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]);return{getRelativeDate:i,getDateFromISO8601:a,ajaxEncode:r,ajaxDecode:s,forTime:o,plusMinutes:l("Time",function(e){return 60*e*1e3}),minusMinutes:l("Time",function(e){return-(60*e*1e3)}),plusDays:l("Date",function(e){return e}),minusDays:l("Date",function(e){return-e}),plusWeeks:l("Date",function(e){return 7*e}),minusWeeks:l("Date",function(e){return 7*-e}),plusMonths:l("Month",function(e){return e}),minusMonths:l("Month",function(e){return-e}),plusYears:l("FullYear",function(e){return e}),minusYears:l("FullYear",function(e){return-e}),localeFormat:n,diff:function(e,t){return e.getTime()-t.getTime()},diffInSeconds:function(e,t,n){var i=this.diff(e,t)/1e3;return n?i:Math.abs(i)!==i?Math.ceil(i):Math.floor(i)},diffInMinutes:function(e,t,n){var i=this.diffInSeconds(e,t,!0)/60;return n?i:Math.abs(i)!==i?Math.ceil(i):Math.floor(i)},diffInHours:function(e,t,n){var i=this.diffInMinutes(e,t,!0)/60;return n?i:Math.abs(i)!==i?Math.ceil(i):Math.floor(i)},diffInDays:function(e,t){return this.diffInHours(new Date(e.toDateString()),new Date(t.toDateString()))/24},getMonthNames:function(){return w},getShortMonthNames:function(){return _},getWeekdayNames:function(){return v},getShortWeekdayNames:function(){return y},isToday:function(e){return e?0===this.diffInDays(new Date,e):!1},isYesterday:function(e){return e?1===this.diffInDays(new Date,e):!1},isBefore:function(e,t){return this.diff(e,t)<0}}}),define("galileo/util/channel",["require"],function(e){return function(e){var t,n=[];return{fns:n,give:function(){t=arguments;for(var e=0;e<n.length;e++)n[e].apply(this,t)},take:function(i,a){return i=a?function(e){return function(){return e.apply(a,t)}}(i):i,n.push(i),e&&t&&i.apply(this,t),function(){for(var e=n.length-1;e>=0;e--)n[e]===i&&n.splice(e,1)}}}}}),define("galileo/ajax/ajax",["require","mootools","jquery","galileo/prototype/all","galileo/util/channel","underscore"],function(e){function t(e,t,n,i){var a=Object.keys(i).map(function(e){return[e,i[e]]});return a.sortBy(Function.takeKey(0)),JSON.encode([e,t,n,a])}function n(e,n,a,h,d,p,f){var g=t(n,h,d,p),m=a&&"undefined"!=typeof global_page_owner?"/ajaxapi/user/"+global_page_owner.encodedId:"/ajaxapi",v=p;s.isString(h)&&"post"===h.toLowerCase()&&s.isObject(p)&&!s.isArray(p)&&(v=s.extend({},p,{csrfToken:window.fitbitCsrfToken}));var y=function(){$.ajax(n?{type:"POST",url:m,data:$.param({request:JSON.stringify({template:"/ajaxTemplate.jsp",serviceCalls:[{name:d,args:p,method:h}]}),csrfToken:window.fitbitCsrfToken}),success:function(e){i(n,h,d,p,JSON.parse(e))}}:{type:h,url:d,data:v,success:i.bind(this,n,h,d,p)})};return e===!0?void $.ajax(n?{type:"POST",url:m,data:$.param({request:JSON.stringify({template:"/ajaxTemplate.jsp",serviceCalls:[{name:d,args:p,method:h}]}),csrfToken:window.fitbitCsrfToken}),success:f}:{type:h,url:d,data:v,success:f}):void 0==f?{update:function(){delete c[g],y()}}:(u[g]||(u[g]=r(),o?l.push(function(){c[g]||y()}):y()),u[g].fns.contains(f)||u[g].take(f),c.hasOwnProperty(g)?void f(c[g]):void 0)}function i(e,n,i,a,s){var o=t(e,n,i,a);c[o]=s,u[o]=u[o]||r(),u[o].give(s)}function a(){o=!1,l.map(function(e){e()}),delete l}e("mootools"),e("jquery"),e("galileo/prototype/all");var r=e("galileo/util/channel"),s=e("underscore"),o=!0,l=[],c={},u={};return window.channelThings=u,{getRaw:n.bind(this,!1,!1,!1,"get"),get:n.bind(this,!1,!0,!1),getOwner:n.bind(this,!1,!0,!0),post:n.bind(this,!0,!0,!1),postOwner:n.bind(this,!0,!0,!0),postRaw:n.bind(this,!0,!1,!1,"post"),preload:i.bind(this,!0),preloadRaw:i.bind(this,!1),preloadFinished:a}}),define("galileo/model/activities",["require","galileo/prototype/all","galileo/util/dateUtil","galileo/ajax/ajax"],function(e){e("galileo/prototype/all");var t=e("galileo/util/dateUtil"),n=e("galileo/ajax/ajax"),i=function(e){this.userId=e};return i.prototype={loadWeightSummary:function(e,i){n.get("getWeightTileDataAt","activityTileData",{date:t.ajaxEncode(e)},function(e){i(e)})},loadSummary:function(e,i,a){n.get("getTileData","activityTileData",{dataTypes:e,date:t.ajaxEncode(i)},function(e){a(e[0])})},loadDays:function(e,i,a,r,s,o){"string"!=typeof r&&(o=r,r=""),"function"==typeof s&&(o=s,s=!1),i.getTime&&(i=t.ajaxEncode(i),a=t.ajaxEncode(a)),n.getRaw("/graph/getNewGraphData",{type:e,dateFrom:i,dateTo:a,granularity:r.toUpperCase(),hidePrecreationData:!!s},function(e){o(e.graph)})},loadIntraday:function(e,i,a){i.getTime?this.loadIntraday(e,t.ajaxEncode(i),a):n.get("getIntradayData","activityTileData",{date:i,dataTypes:e},function(e){a(e[0])})},loadOwnerGraphDataPoints:function(e,t,i,a,r){var s={type:e,dateFrom:t,dateTo:i,granularity:a},o={graphDataRequest:JSON.encode(s)};n.postOwner("getDataPoints","graph",o,function(e){r(e)})},loadViewerGraphDataPoints:function(e,t,i,a,r){var s={type:e,dateFrom:t,dateTo:i,granularity:a},o={graphDataRequest:JSON.encode(s)};n.post("getDataPoints","graph",o,function(e){r(e)})}},i}),define("galileo/model/subscription",["require","mootools","galileo/ajax/ajax"],function(e){e("mootools");var t=e("galileo/ajax/ajax"),n=new Class({type:void 0,properties:{},initialize:function(e,t){this.type=e,Object.merge(this.properties,t)},isActive:function(){return!!this.properties.active},isPremium:function(){return!!this.properties.premium},isTrial:function(){return!!this.properties.trial},isExpired:function(){return!this.properties.active},getPlan:function(e,n){"function"==typeof e&&(n=e,e={}),void 0===e&&(e={});var i=this.type;if(i)var a="get"+i.capitalize()+"Plan",r=t.get(a,"activityTileData",e,n);return n?void 0:r}});return n}),define("galileo/model/goals",["require","galileo/prototype/all","galileo/ajax/ajax","galileo/util/dateUtil"],function(e){e("galileo/prototype/all");var t=e("galileo/ajax/ajax"),n=e("galileo/util/dateUtil");return{update:function(e,i,a){a||(a=new Date),t.post("updateDailyGoal","activityTileData",{dataType:e,goalValue:i},function(){t.get("getGoalData","activityTileData",{dataTypes:e}).update(),t.get("getTileData","activityTileData",{date:n.ajaxEncode(a),dataTypes:e}).update()})},updateWeekly:function(e,i,a){a||(a=new Date),t.post("updateWeeklyGoal","activityTileData",{dataType:e,goalValue:i},function(){t.get("getGoalData","activityTileData",{dataTypes:e}).update(),t.get("getTileData","activityTileData",{date:n.ajaxEncode(a),dataTypes:e}).update()})},loadActivityType:function(e,n){t.get("getGoalData","activityTileData",{dataTypes:e},function(e){n(e[0])})},loadTileActivity:function(e,n,i){t.getOwner("getTileData","activityTileData",{date:n,dataTypes:e},function(e){i(e)})},load:function(e){t.getRaw("/lab/galileo/dash",{apiFormat:"json",goals:"on"},function(t){e(t.goals)})}}}),define("ajaxQueue",["require","jquery","underscore"],function(e){function t(e){n[e.method](e.url,e.value,function(){"function"==typeof e.callback&&e.callback.apply(e.callbackContext||window,arguments),a.queue=i.without(a.queue,e),a.queue.length&&t(a.queue[0])})}var n=e("jquery"),i=e("underscore"),a={};return a.queue=[],a.push=function(e){a.queue.push(e),1===a.queue.length&&t(e)},a}),function(e,t){if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(n,i,a){e.Backbone=t(e,a,n,i)});else if("undefined"!=typeof exports){var n=require("underscore");t(e,exports,n)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,i){var a=e.Backbone,r=[],s=(r.push,r.slice);r.splice;t.VERSION="1.1.2",t.$=i,t.noConflict=function(){return e.Backbone=a,this},t.emulateHTTP=!1,t.emulateJSON=!1;var o=t.Events={on:function(e,t,n){if(!c(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var i=this._events[e]||(this._events[e]=[]);return i.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,i){if(!c(this,"once",e,[t,i])||!t)return this;var a=this,r=n.once(function(){a.off(e,r),t.apply(this,arguments)});return r._callback=t,this.on(e,r,i)},off:function(e,t,i){var a,r,s,o,l,u,h,d;if(!this._events||!c(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events=void 0,this;for(o=e?[e]:n.keys(this._events),l=0,u=o.length;u>l;l++)if(e=o[l],s=this._events[e]){if(this._events[e]=a=[],t||i)for(h=0,d=s.length;d>h;h++)r=s[h],(t&&t!==r.callback&&t!==r.callback._callback||i&&i!==r.context)&&a.push(r);a.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=s.call(arguments,1);if(!c(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&u(n,t),i&&u(i,arguments),this},stopListening:function(e,t,i){var a=this._listeningTo;if(!a)return this;var r=!t&&!i;i||"object"!=typeof t||(i=this),e&&((a={})[e._listenId]=e);for(var s in a)e=a[s],e.off(t,i,this),(r||n.isEmpty(e._events))&&delete this._listeningTo[s];return this}},l=/\s+/,c=function(e,t,n,i){if(!n)return!0;if("object"==typeof n){for(var a in n)e[t].apply(e,[a,n[a]].concat(i));return!1}if(l.test(n)){for(var r=n.split(l),s=0,o=r.length;o>s;s++)e[t].apply(e,[r[s]].concat(i));return!1}return!0},u=function(e,t){var n,i=-1,a=e.length,r=t[0],s=t[1],o=t[2];switch(t.length){case 0:for(;++i<a;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<a;)(n=e[i]).callback.call(n.ctx,r);return;case 2:for(;++i<a;)(n=e[i]).callback.call(n.ctx,r,s);return;case 3:for(;++i<a;)(n=e[i]).callback.call(n.ctx,r,s,o);return;default:for(;++i<a;)(n=e[i]).callback.apply(n.ctx,t);return}},h={listenTo:"on",listenToOnce:"once"};n.each(h,function(e,t){o[t]=function(t,i,a){var r=this._listeningTo||(this._listeningTo={}),s=t._listenId||(t._listenId=n.uniqueId("l"));return r[s]=t,a||"object"!=typeof i||(a=this),t[e](i,a,this),this}}),o.bind=o.on,o.unbind=o.off,n.extend(t,o);var d=t.Model=function(e,t){var i=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(i=this.parse(i,t)||{}),i=n.defaults({},i,n.result(this,"defaults")),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(d.prototype,o,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,i){var a,r,s,o,l,c,u,h;if(null==e)return this;if("object"==typeof e?(r=e,i=t):(r={})[e]=t,i||(i={}),!this._validate(r,i))return!1;s=i.unset,l=i.silent,o=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=n.clone(this.attributes),this.changed={}),h=this.attributes,u=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]);for(a in r)t=r[a],n.isEqual(h[a],t)||o.push(a),n.isEqual(u[a],t)?delete this.changed[a]:this.changed[a]=t,s?delete h[a]:h[a]=t;if(!l){o.length&&(this._pending=i);for(var d=0,p=o.length;p>d;d++)this.trigger("change:"+o[d],this,h[o[d]],i)}if(c)return this;if(!l)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t,i=!1,a=this._changing?this._previousAttributes:this.attributes;for(var r in e)n.isEqual(a[r],t=e[r])||((i||(i={}))[r]=t);return i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,i=e.success;return e.success=function(n){return t.set(t.parse(n,e),e)?(i&&i(t,n,e),void t.trigger("sync",t,n,e)):!1},L(this,e),this.sync("read",this,e)},save:function(e,t,i){var a,r,s,o=this.attributes;if(null==e||"object"==typeof e?(a=e,i=t):(a={})[e]=t,i=n.extend({validate:!0},i),a&&!i.wait){if(!this.set(a,i))return!1}else if(!this._validate(a,i))return!1;a&&i.wait&&(this.attributes=n.extend({},o,a)),void 0===i.parse&&(i.parse=!0);var l=this,c=i.success;return i.success=function(e){l.attributes=o;var t=l.parse(e,i);return i.wait&&(t=n.extend(a||{},t)),n.isObject(t)&&!l.set(t,i)?!1:(c&&c(l,e,i),void l.trigger("sync",l,e,i))},L(this,i),r=this.isNew()?"create":i.patch?"patch":"update","patch"===r&&(i.attrs=a),s=this.sync(r,this,i),a&&i.wait&&(this.attributes=o),s},destroy:function(e){e=e?n.clone(e):{};var t=this,i=e.success,a=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(n){(e.wait||t.isNew())&&a(),i&&i(t,n,e),t.isNew()||t.trigger("sync",t,n,e)},this.isNew())return e.success(),!1;L(this,e);var r=this.sync("delete",this,e);return e.wait||a(),r},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||j();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return i?(this.trigger("invalid",this,i,n.extend(t,{validationError:i})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];n.each(p,function(e){d.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var f=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};n.extend(f.prototype,o,{model:d,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,m))},remove:function(e,t){var i=!n.isArray(e);e=i?[e]:n.clone(e),t||(t={});var a,r,s,o;for(a=0,r=e.length;r>a;a++)o=e[a]=this.get(e[a]),o&&(delete this._byId[o.id],delete this._byId[o.cid],s=this.indexOf(o),this.models.splice(s,1),this.length--,t.silent||(t.index=s,o.trigger("remove",o,this,t)),this._removeReference(o,t));return i?e[0]:e},set:function(e,t){t=n.defaults({},t,g),t.parse&&(e=this.parse(e,t));var i=!n.isArray(e);e=i?e?[e]:[]:n.clone(e);var a,r,s,o,l,c,u,h=t.at,p=this.model,f=this.comparator&&null==h&&t.sort!==!1,m=n.isString(this.comparator)?this.comparator:null,v=[],y=[],b={},w=t.add,_=t.merge,x=t.remove,k=!f&&w&&x?[]:!1;for(a=0,r=e.length;r>a;a++){if(l=e[a]||{},s=l instanceof d?o=l:l[p.prototype.idAttribute||"id"],c=this.get(s))x&&(b[c.cid]=!0),_&&(l=l===o?o.attributes:l,t.parse&&(l=c.parse(l,t)),c.set(l,t),f&&!u&&c.hasChanged(m)&&(u=!0)),e[a]=c;else if(w){if(o=e[a]=this._prepareModel(l,t),!o)continue;v.push(o),this._addReference(o,t)}o=c||o,!k||!o.isNew()&&b[o.id]||k.push(o),b[o.id]=!0}if(x){for(a=0,r=this.length;r>a;++a)b[(o=this.models[a]).cid]||y.push(o);y.length&&this.remove(y,t)}if(v.length||k&&k.length)if(f&&(u=!0),this.length+=v.length,null!=h)for(a=0,r=v.length;r>a;a++)this.models.splice(h+a,0,v[a]);else{k&&(this.models.length=0);var S=k||v;for(a=0,r=S.length;r>a;a++)this.models.push(S[a])}if(u&&this.sort({silent:!0}),!t.silent){for(a=0,r=v.length;r>a;a++)(o=v[a]).trigger("add",o,this,t);(u||k&&k.length)&&this.trigger("sort",this,t)}return i?e[0]:e},reset:function(e,t){t||(t={});for(var i=0,a=this.models.length;a>i;i++)this._removeReference(this.models[i],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return s.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,i=this;return e.success=function(n){var a=e.reset?"reset":"set";i[a](n,e),t&&t(i,n,e),i.trigger("sync",i,n,e)},L(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?n.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var i=this,a=t.success;return t.success=function(e,n){t.wait&&i.add(e,t),a&&a(e,n,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof d)return e;t=t?n.clone(t):{},t.collection=this;var i=new this.model(e,t);return i.validationError?(this.trigger("invalid",this,i.validationError,t),!1):i},_addReference:function(e,t){this._byId[e.cid]=e,null!=e.id&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,i),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.each(v,function(e){f.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var y=["groupBy","countBy","sortBy","indexBy"];n.each(y,function(e){f.prototype[e]=function(t,i){var a=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,a,i)}});var b=t.View=function(e){this.cid=n.uniqueId("view"),e||(e={}),n.extend(this,n.pick(e,_)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,_=["model","collection","el","id","attributes","className","tagName","events"];n.extend(b.prototype,o,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var i=e[t];if(n.isFunction(i)||(i=this[e[t]]),i){var a=t.match(w),r=a[1],s=a[2];i=n.bind(i,this),r+=".delegateEvents"+this.cid,""===s?this.$el.on(r,i):this.$el.on(r,s,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className"));var i=t.$("<"+n.result(this,"tagName")+">").attr(e);this.setElement(i,!1)}}}),t.sync=function(e,i,a){var r=k[e];n.defaults(a||(a={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var s={type:r,dataType:"json"};if(a.url||(s.url=n.result(i,"url")||j()),null!=a.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(s.contentType="application/json",s.data=JSON.stringify(a.attrs||i.toJSON(a))),a.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),a.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){s.type="POST",a.emulateJSON&&(s.data._method=r);var o=a.beforeSend;a.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",r),o?o.apply(this,arguments):void 0}}"GET"===s.type||a.emulateJSON||(s.processData=!1),"PATCH"===s.type&&x&&(s.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=a.xhr=t.ajax(n.extend(s,a));return i.trigger("request",i,l,a),l};var x=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var S=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},T=/\((.*?)\)/g,M=/(\(\?)?:\w+/g,C=/\*\w+/g,E=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(S.prototype,o,{initialize:function(){},route:function(e,i,a){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(i)&&(a=i,i=""),a||(a=this[i]);var r=this;return t.history.route(e,function(n){var s=r._extractParameters(e,n);r.execute(a,s),r.trigger.apply(r,["route:"+i].concat(s)),r.trigger("route",i,s),t.history.trigger("route",r,i,s)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var e,t=n.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(E,"\\$&").replace(T,"(?:$1)?").replace(M,function(e,t){return t?e:"([^/?]+)"}).replace(C,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return n.map(i,function(e,t){return t===i.length-1?e||null:e?decodeURIComponent(e):null})}});var A=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},D=/^[#\/]|\s+$/g,P=/^\/+|\/+$/g,N=/msie [\w.]+/,I=/\/$/,O=/#.*$/;A.started=!1,n.extend(A.prototype,o,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(I,"");e.indexOf(n)||(e=e.slice(n.length))}else e=this.getHash();return e.replace(D,"")},start:function(e){if(A.started)throw new Error("Backbone.history has already been started");A.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),a=document.documentMode,r=N.exec(navigator.userAgent.toLowerCase())&&(!a||7>=a);if(this.root=("/"+this.root+"/").replace(P,"/"),r&&this._wantsHashChange){var s=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=s.hide().appendTo("body")[0].contentWindow,this.navigate(i)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),
this.fragment=i;var o=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&o.hash&&(this.fragment=this.getHash().replace(D,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),A.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(e){return e=this.fragment=this.getFragment(e),n.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(e,t){if(!A.started)return!1;t&&t!==!0||(t={trigger:!!t});var n=this.root+(e=this.getFragment(e||""));if(e=e.replace(O,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),t.history=new A;var F=function(e,t){var i,a=this;i=e&&n.has(e,"constructor")?e.constructor:function(){return a.apply(this,arguments)},n.extend(i,a,t);var r=function(){this.constructor=i};return r.prototype=a.prototype,i.prototype=new r,e&&n.extend(i.prototype,e),i.__super__=a.prototype,i};d.extend=f.extend=S.extend=b.extend=A.extend=F;var j=function(){throw new Error('A "url" property or function must be specified')},L=function(e,t){var n=t.error;t.error=function(i){n&&n(e,i,t),e.trigger("error",e,i,t)}};return t}),define("galileo/model/user",["require","galileo/prototype/all","jquery.numberformatter","galileo/model/activities","galileo/model/subscription","galileo/model/goals","galileo/ajax/ajax","i18n/i18n","galileo/util/dateUtil","ajaxQueue","underscore","backbone","i18n-load!com/fitbit/app/unit","i18n-load!com/fitbit/app/ngd/betas"],function(e){e("galileo/prototype/all"),e("jquery.numberformatter");var t=e("galileo/model/activities"),n=e("galileo/model/subscription"),i=e("galileo/model/goals"),a=e("galileo/ajax/ajax"),r=e("i18n/i18n")(),s=e("galileo/util/dateUtil"),o=e("ajaxQueue"),l=e("underscore"),c=e("backbone");r.namespace(e("i18n-load!com/fitbit/app/unit")),r.namespace(e("i18n-load!com/fitbit/app/ngd/betas"));var u=new Date("2013/05/01"),h=2592e6,d=["it_IT"],p={GALILEO:"zip",HADRON:"one",QUARK:"flex",NEUTRINO:"force"},f=c.Model.extend({parse:function(e){try{return JSON.parse(e.settings["galileo user settings"])}catch(t){}},sync:function(){o.push({method:"post",url:"/userSettings/dh/save?apiFormat=json",value:{"settings['galileo user settings']":JSON.stringify(this.toJSON()),csrfToken:window.fitbitCsrfToken}})}}),g=new f,m=new Class({_activities:null,_water:null,_isFirstVisit:!1,deviceFeatures:{},goals:i,trainerPlan:!1,initialize:function(e){Object.merge(this,e),Object.forEach(this.subscriptions,function(e,t){this.subscriptions[t]=new n(t,e)},this)},activities:function(){return this._activities=this._activities||new t,this._activities},loadFriends:function(e){a.getOwner("data","leaderboardAjaxService",{},function(t){e(t)})},loadActivitiesLogsSummary:function(e){a.get("user","getActivitiesLogsSummary",{},function(t){e(t)})},loadFriendSuggestions:function(e){a.get("getSuggestions","friend",{},function(t){e(t)})},unitsString:function(e,t,n){var i="US"===this.weightSystem&&453.592||"UK"===this.weightSystem&&6350.288||1e3;return this.gramsString(e*i,t,n)},gramsString:function(e,t,n){n=void 0===n?1:n;var i=n>0?"#,###."+new Array(n+1).join("0"):"#,###",a=e/453.592,s=Math.floor(a/14),o=r.plural(t?"stone_full":"stone_short"),l=r.plural(t?"kilogram_full":"kilogram_short"),c=r.plural(t?"pound_full":"pound_short"),u="";return-1!==$.inArray(this.locale,d)&&(u=" "),"UK"===this.weightSystem?(a-=14*s,s+u+o(s)+" "+this.formatNumber(a,i)+u+c(a)):"US"===this.weightSystem?this.formatNumber(a,i)+u+c(a):this.formatNumber(e/1e3,i)+u+l(e/1e3)},formatNumber:function(e,t){return $.formatNumber(e,{format:t,locale:this.locale})},parseNumber:function(e,t){return $.parseNumber(e,{format:t,locale:this.locale})},thousands:function(e){return this.formatNumber(e,"#,###")||"0"},formatTime:function(e){return this.clock12?s.localeFormat(e,"hh:mm a"):s.localeFormat(e,"HH:mm")},isFirstVisit:function(){return this._isFirstVisit},isNewUser:function(){return new Date-new Date(g.get("firstVisitDate"))<=h},isLegacyUser:function(){return g.get("firstVisitDate")<u},hasTrainerPlan:function(){var e=this.subscriptions.trainer;return e&&e.isActive()},hasSeenTile:function(e){return!(!g.get("seenTiles")||!g.get("seenTiles")[e])},seeTile:function(e){var t=l.clone(g.get("seenTiles"))||{};t[e]=1,this.saveSetting("seenTiles",t)},initSettings:function(e){g.set(e),e.firstVisitDate||(this._isFirstVisit=!0,this.saveSetting("firstVisitDate",(new Date).getTime()))},saveSetting:function(e,t,n){g.save(e,t,n)},getDeviceFeatures:function(){return l.clone(this.deviceFeatures)||{}},getTrackerType:function(){return this.trackerType},getTrackerProductName:function(){return p[this.trackerType]},getSettingsModel:function(){return g},hasRole:function(e){return this.roles&&this.roles.contains(e)}});return m.viewer=new m(window.global_page_viewer),m}),function(){function e(e){this.message=e}var t="undefined"!=typeof exports?exports:this,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.prototype=new Error,e.prototype.name="InvalidCharacterError",t.btoa||(t.btoa=function(t){for(var i,a,r=String(t),s=0,o=n,l="";r.charAt(0|s)||(o="=",s%1);l+=o.charAt(63&i>>8-s%1*8)){if(a=r.charCodeAt(s+=.75),a>255)throw new e("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");i=i<<8|a}return l}),t.atob||(t.atob=function(t){var i=String(t).replace(/=+$/,"");if(i.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var a,r,s=0,o=0,l="";r=i.charAt(o++);~r&&(a=s%4?64*a+r:r,s++%4)?l+=String.fromCharCode(255&a>>(-2*s&6)):0)r=n.indexOf(r);return l})}(),define("shared/scripts/libs/polyfills/base64",function(){}),define("shared/scripts/modules/api-client",["require","../libs/jquery/plugins/iecors/jquery.iecors","jquery","underscore","Logger","galileo/model/user","../libs/polyfills/base64"],function(e){function t(e){var t=e.useDistanceUnitSystem?s.distanceUnit:s.weightSystem;return e.acceptsLanguageHeader?e.acceptsLanguageHeader:"US"===t?"en_US":"UK"===t?"en_GB":"METRIC"}e("../libs/jquery/plugins/iecors/jquery.iecors");var n,i=e("jquery"),a=e("underscore"),r=e("Logger"),s=e("galileo/model/user").viewer||{},o=s.apiUrl,l=s.oauth2Token,c=window.atob||e("../libs/polyfills/base64"),u=300,h="Accept-Language";l||r("no oauth2Token in config ajax requests will not work"),o||r("no apiUrl in config ajax requests will not work");var d=function(e){var t=e.split(".");if(3===t.length){var n;try{n=JSON.parse(c(t[1])),a.isNumber(n.exp)||r("expire time is not a number it is a "+typeof n.exp+" of value "+n.exp)}catch(i){r("could not get/parse OAuth token payload token is: "+e)}return 1e3*n.exp}r("incorrect number of segments in oauth token to decode, number: "+t.length+" token: ")},p={Authorization:"Bearer "+l};"US"===s.weightSystem?p[h]="en_US":"UK"===s.weightSystem?p[h]="en_GB":p[h]="METRIC";var f=function(e){return"https://"+o+("/"===e.charAt(0)?"":"/")+e},g=function(){return i.get("/dashOAuth/token").done(function(e){p.Authorization="Bearer "+e.oauthToken}).fail(function(e,t,n){r("cannot refresh oauth token: "+n)})},m=function(e){if(a.isObject(e)||window.onerror("settings must be an object not: "+e),Date.now()+u>=d(p.Authorization)){n&&"resolved"!==n.state()||(n=g());var r=new i.Deferred;return n.done(function(){var t=m(e);t.done(function(){r.resolve.apply(this,arguments)}),t.fail(function(){r.reject.apply(this,arguments)})}),r}return e.headers=a.defaults(e.headers||{},p),e.headers[h]=t(e),i.ajax(e)},v=function(e){e.ajax=m};return{ajax:m,refreshToken:g,makeFullUrl:f,updateBackbone:v}}),"undefined"==typeof define&&(define=function(e){return e(function(){return{fn:{},isFunction:function(){return!1}}})}),define("fitbit-jquery-friendBlockedModal",["require","jquery","shared/scripts/modules/api-client"],function(e){var t=e("jquery"),n=e("shared/scripts/modules/api-client"),i=1;t.isFunction(t.fn.friendBlockedModal)||(t.fn.friendBlockedModal=function(e){var a=t(this),r=!1,s=!1,o=function(){c(),a.data("overlay",null),r&&!s?(u(),setTimeout(function(){t("#unblockingError").data("overlay").close()},2e3)):r&&s&&t("#friendRequestModal").friendRequestModal({userName:e.userName,callback:e.callback,closeBeforeCallback:e.closeBeforeCallback})},l=function(){a.find(".friend-blocked-controls .send").click(function(t){t.stopPropagation();var o=e.userId,l=n.makeFullUrl("/"+i+"/user/-/blocked-users/"+o+".json");r=!0,n.ajax({url:l,type:"DELETE",success:function(e,t,n){s=!0,a.data("overlay").close()},error:function(e,t,n){s=!1,a.data("overlay").close()}})}),a.find(".friend-blocked-controls .cancel").click(function(e){e.stopPropagation(),a.data("overlay").close()}),t("#blocking-mask").click(function(e){e.stopPropagation(),a.data("overlay").close()})},c=function(){a.find(".friend-blocked-controls .send").unbind("click"),t("#blocking-mask").unbind("click")},u=function(){t("#unblockingError").overlay({mask:{maskId:"blocking-mask",color:"#000",zIndex:199998,closeOnClick:!1},onClose:function(){t("#blocking-mask").unbind("click")}}),t("#blocking-mask").click(function(e){e.stopPropagation(),t("#unblockingError").data("overlay").close()}),t("#unblockingError").data("overlay").load()},h=function(){e.userName&&a.find(".name").text(e.userName)};h(),a.overlay({mask:{maskId:"blocking-mask",color:"#000",onClose:function(){setTimeout(o,0)},zIndex:199998,closeOnClick:!1}}),a.data("overlay").load(),l()})})}).call(window)}]);
//# sourceMappingURL=friendBlockedModal.js.15044ca32cd229fed222418756a1eb59.js.map